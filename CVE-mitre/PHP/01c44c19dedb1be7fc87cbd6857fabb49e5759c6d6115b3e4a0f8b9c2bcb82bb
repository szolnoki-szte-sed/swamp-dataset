--- docs/NEWS ---
@@ -1,5 +1,11 @@
 # $Id$
 
+Version 1.6.2 (May 16th, 2012)
+------------------------------------------------------------------------
+
+    * Fix SQL injection for comment.php used in read-context.     
+      (Thanks to High-Tech Bridge SA Security Release Lab, Advisory HTB23092)
+          
 Version 1.6.1 (May 8th, 2012)
 ------------------------------------------------------------------------
 

--- include/functions_trackbacks.inc.php ---
@@ -364,7 +364,7 @@ function add_trackback ($id, $title, $url, $name, $excerpt) {
 
     if ($id>0) {
         // first check, if we already have this trackback
-        $comments = serendipity_fetchComments($id,1,'co.id',true,'TRACKBACK'," AND co.url='$url'");
+        $comments = serendipity_fetchComments($id,1,'co.id',true,'TRACKBACK'," AND co.url='" . serendipity_db_escape_string($url) . "'");
         if (is_array($comments) && sizeof($comments) == 1) {
             log_pingback("We already have that TRACKBACK!");
             return 0; // We already have it!

--- serendipity_config.inc.php ---
@@ -45,7 +45,7 @@
 }
 
 // The version string
-$serendipity['version']         = '1.6.1';
+$serendipity['version']         = '1.6.2';
 
 // Setting this to 'false' will enable debugging output. All alpa/beta/cvs snapshot versions will emit debug information by default. To increase the debug level (to enable Smarty debugging), set this flag to 'debug'.
 $serendipity['production']      = (preg_match('@\-(alpha|beta|cvs)@', $serendipity['version']) ? false : true);

