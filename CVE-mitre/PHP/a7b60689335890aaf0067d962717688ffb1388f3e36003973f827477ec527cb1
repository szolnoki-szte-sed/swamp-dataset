--- addressing.xml ---
@@ -27,6 +27,11 @@
       <author>Nelly Mahu-Lasson</author>
    </authors>
    <versions>
+       <version>
+           <num>3.0.3</num>
+           <compatibility>~10.0</compatibility>
+           <download_url>https://github.com/pluginsGLPI/addressing/releases/download/3.0.3/glpi-addressing-3.0.3.tar.bz2</download_url>
+       </version>
        <version>
            <num>3.0.2</num>
            <compatibility>~10.0</compatibility>

--- front/addressing.form.php ---
@@ -29,6 +29,8 @@
 
 include ('../../../inc/includes.php');
 
+Session::checkLoginUser();
+
 if (!isset($_GET["id"])) {
    $_GET["id"] = "";
 }

--- front/addressing.php ---
@@ -29,20 +29,25 @@
 
 include ('../../../inc/includes.php');
 
+Session::checkLoginUser();
+
+$PluginAddressingAddressing = new PluginAddressingAddressing();
+
 if (isset($_GET['action']) && $_GET['action'] == 'isName') {
-   $item  = new $_GET['type']();
-   $datas = $item->find(['name' => ['LIKE', $_GET['name']]]);
-   if (count($datas) > 0) {
-      echo json_encode(true);
-   } else {
-      echo json_encode(false);
-   }
+
+    if ($PluginAddressingAddressing->canView() || Session::haveRight("config", UPDATE)) {
+        $item = new $_GET['type']();
+        $datas = $item->find(['name' => ['LIKE', $_GET['name']]]);
+        if (count($datas) > 0) {
+            echo json_encode(true);
+        } else {
+            echo json_encode(false);
+        }
+    }
 } else {
 
    Html::header(PluginAddressingAddressing::getTypeName(2), '', "tools", "pluginaddressingaddressing");
 
-   $PluginAddressingAddressing = new PluginAddressingAddressing();
-
    if ($PluginAddressingAddressing->canView() || Session::haveRight("config", UPDATE)) {
       Search::show("PluginAddressingAddressing");
 

--- front/filter.form.php ---
@@ -29,7 +29,7 @@
 
 include ('../../../inc/includes.php');
 
-
+Session::checkLoginUser();
 
 $filter = new PluginAddressingFilter();
 

--- front/report.form.php ---
@@ -35,6 +35,8 @@
 
 Html::header(PluginAddressingAddressing::getTypeName(2), '', "tools", "pluginaddressingaddressing");
 
+Session::checkLoginUser();
+
 if (!isset($_GET["start"])) {
    $_GET["start"] = 0;
 }

--- front/reserveip.form.php ---
@@ -29,6 +29,8 @@
 
 include ('../../../inc/includes.php');
 
+Session::checkLoginUser();
+
 $reserveip = new PluginAddressingReserveip();
 
 if (isset($_POST['add'])) {

--- setup.php ---
@@ -27,7 +27,7 @@
  --------------------------------------------------------------------------
  */
 
-define('PLUGIN_ADDRESSING_VERSION', '3.0.2');
+define('PLUGIN_ADDRESSING_VERSION', '3.0.3');
 
 if (!defined("PLUGIN_ADDRESSING_DIR")) {
     define("PLUGIN_ADDRESSING_DIR", Plugin::getPhpDir("addressing"));

