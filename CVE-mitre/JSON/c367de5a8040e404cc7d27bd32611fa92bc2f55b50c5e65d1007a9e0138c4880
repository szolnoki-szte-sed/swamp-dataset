--- .gitignore ---
@@ -0,0 +1,61 @@
+# Logs
+logs
+*.log
+npm-debug.log*
+yarn-debug.log*
+yarn-error.log*
+
+# Runtime data
+pids
+*.pid
+*.seed
+*.pid.lock
+
+# Directory for instrumented libs generated by jscoverage/JSCover
+lib-cov
+
+# Coverage directory used by tools like istanbul
+coverage
+
+# nyc test coverage
+.nyc_output
+
+# Grunt intermediate storage (http://gruntjs.com/creating-plugins#storing-task-files)
+.grunt
+
+# Bower dependency directory (https://bower.io/)
+bower_components
+
+# node-waf configuration
+.lock-wscript
+
+# Compiled binary addons (https://nodejs.org/api/addons.html)
+build/Release
+
+# Dependency directories
+node_modules/
+jspm_packages/
+
+# Typescript v1 declaration files
+typings/
+
+# Optional npm cache directory
+.npm
+
+# Optional eslint cache
+.eslintcache
+
+# Optional REPL history
+.node_repl_history
+
+# Output of 'npm pack'
+*.tgz
+
+# Yarn Integrity file
+.yarn-integrity
+
+# dotenv environment variables file
+.env
+
+# next.js build output
+.next

--- .travis.yml ---
@@ -1,6 +1,7 @@
 language: node_js
 node_js:
-  - "4.0"
-  - "0.12"
-  - "0.11"
-  - "0.10"
+  - node
+  - lts/*
+  - 8
+  - 6
+  - 4

--- index.js ---
@@ -70,6 +70,11 @@ Glance.prototype.serveRequest = function Glance$serveRequest (req, res) {
   request.method = req.method.toLowerCase()
   request.response = res
 
+  // prevent traversing directories that are parents of the root
+  if (request.fullPath.slice(0, self.dir.length) !== self.dir) {
+    return self.emit('error', 403, request, res)
+  }
+
   if (request.method !== 'get') {
     return self.emit('error', 405, request, res)
   }

--- package.json ---
@@ -31,6 +31,7 @@
     "bash-color": "0.0.3",
     "filed": "0.1.0",
     "html-ls": "1.0.0",
+    "mime": "1.2.6",
     "nopt": "3.0.4",
     "utils-fs-exists": "1.0.1",
     "xtend": "4.0.0"

--- test/index.js ---
@@ -71,6 +71,14 @@ test('403s on dir list if configured', function (t) {
   })
 })
 
+test('403s if path traversal is attempted', function (t) {
+  t.plan(1)
+
+  http.get('http://localhost:1666/../index.js', function (res) {
+    t.strictEqual(res.statusCode, 403)
+  })
+})
+
 test('serves index page', function (t) {
   t.plan(2)
 

