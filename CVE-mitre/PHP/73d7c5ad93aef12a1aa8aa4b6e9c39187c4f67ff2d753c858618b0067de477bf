--- interface/forms/eye_mag/js/eye_base.php ---
@@ -369,7 +369,7 @@ function create_task(to_id,task,to_type) {
     var url = "../../forms/eye_mag/taskman.php";
     var formData = {
         'action'            : "make_task",
-        'from_id'           : <?php echo js_escape($providerID); ?>,
+        'from_id'           : <?php echo attr_js($providerID); ?>,
         'to_id'             : to_id,
         'pid'               : $('#pid').val(),
         'doc_type'          : task,

--- interface/main/finder/dynamic_finder.php ---
@@ -250,10 +250,10 @@
     $(function () {
         // Initializing the DataTable.
         //
-        let serverUrl = "dynamic_finder_ajax.php?csrf_token_form=" + <?php echo js_url(CsrfUtils::collectCsrfToken()); ?>;
+        let serverUrl = "dynamic_finder_ajax.php";
         let srcAny = <?php echo js_url($searchAny); ?>;
         if (srcAny) {
-            serverUrl += "&search_any=" + srcAny;
+            serverUrl += "?search_any=" + srcAny;
         }
         var oTable = $('#pt_table').dataTable({
             "processing": true,

--- interface/main/finder/dynamic_finder_ajax.php ---
@@ -23,10 +23,10 @@
 use OpenEMR\Events\PatientFinder\PatientFinderFilterEvent;
 use OpenEMR\Events\PatientFinder\ColumnFilter;
 
-// Not checking csrf for good reasons.
-//  1. Not needed since no state changes in this script
-//  2. It will cause potential session clash fails because it throws a popup which messes things up
-//     when opening a patient in a new window.
+// Not checking csrf since it breaks when opening up a patient in a new frame.
+//  Also note that csrf checking is not needed in this script because of following 2 reasons.
+//  1. cookie_samesite in OpenEMR is set to 'Strict', which is an effective security measure to stop csrf vulnerabilities.
+//  2. Additionally, in this script there are no state changes, thus it is not even sensitive to csrf vulnerabilities.
 
 $popup = empty($_REQUEST['popup']) ? 0 : 1;
 $searchAny = !empty($_GET['search_any']) && empty($_GET['sSearch']) ? $_GET['search_any'] : "";

--- library/custom_template/share_template.php ---
@@ -55,7 +55,7 @@ function add_template(){
                 url: "ajax_code.php",
                 dataType: "html",
                 data: {
-                     list_id: <?php echo htmlspecialchars($list_id, ENT_QUOTES);?>,
+                     list_id: <?php echo js_escape($list_id); ?>,
                      multi: val,
                      source: "save_provider"
                 },
@@ -71,7 +71,7 @@ function add_template(){
                 return;
                 }
                 else{
-                    alert("<?php echo addslashes(xl('You should select at least one Provider'));?>");
+                    alert(<?php echo xlj('You should select at least one Provider');?>);
                 }
 
         }
@@ -97,13 +97,13 @@ function add_template(){
                                         $sel = '';
                                     }
                                 }
-                                echo "<option value='" . htmlspecialchars($row['id'], ENT_QUOTES) . "' $sel>" . htmlspecialchars($row['lname'] . "," . $row['fname'], ENT_QUOTES) . "</option>";
+                                echo "<option value='" . attr($row['id']) . "' $sel>" . text($row['lname'] . "," . $row['fname']) . "</option>";
                             }
                             ?>
                         </select>
                     </td>
                     <td>
-                    <a href="#" onclick="add_template()" class="btn btn-primary"><span><?php echo htmlspecialchars(xl('Save'), ENT_QUOTES);?></span></a>
+                    <a href="#" onclick="add_template()" class="btn btn-primary"><span><?php echo xlt('Save');?></span></a>
                     </td>
                 </tr>
             </table>

