--- CHANGELOG.md ---
@@ -7,7 +7,7 @@ Versioning].
 
 ## [Unreleased]
 
-- _No changes yet_
+- Strip null characters from arguments.
 
 ## [1.1.2] - 2021-01-07
 

--- src/unix.js ---
@@ -11,7 +11,7 @@
  * @returns {string} The escaped argument.
  */
 function escapeShellArg(arg) {
-  return arg.replace(/'/g, `'\\''`);
+  return arg.replace(/\u{0}/gu, "").replace(/'/g, `'\\''`);
 }
 
 module.exports.escapeShellArg = escapeShellArg;

--- src/win.js ---
@@ -11,7 +11,7 @@
  * @returns {string} The escaped argument.
  */
 function escapeShellArg(arg) {
-  return arg.replace(/"/g, `""`);
+  return arg.replace(/\u{0}/gu, "").replace(/"/g, `""`);
 }
 
 module.exports.escapeShellArg = escapeShellArg;

--- test/unix.test.js ---
@@ -22,4 +22,20 @@ describe("unix.js", function () {
       assert.strictEqual(output, `'\\'' & echo '\\''Hello world!'\\''`);
     });
   });
+
+  describe("null characters", function () {
+    const nullChar = String.fromCharCode(0);
+
+    it("removes one null character", function () {
+      const input = `foo' && ls${nullChar} -al ; echo 'bar`;
+      const output = escapeShellArg(input);
+      assert.strictEqual(output, `foo'\\'' && ls -al ; echo '\\''bar`);
+    });
+
+    it("removes multiple null character", function () {
+      const input = `foo'${nullChar}&&ls -al${nullChar};echo 'bar`;
+      const output = escapeShellArg(input);
+      assert.strictEqual(output, `foo'\\''&&ls -al;echo '\\''bar`);
+    });
+  });
 });

--- test/win.test.js ---
@@ -22,4 +22,20 @@ describe("win.js", function () {
       assert.strictEqual(output, `"" & echo ""Hello world!`);
     });
   });
+
+  describe("null characters", function () {
+    const nullChar = String.fromCharCode(0);
+
+    it("removes one null character", function () {
+      const input = `foo" && ls${nullChar} -al ; echo "bar`;
+      const output = escapeShellArg(input);
+      assert.strictEqual(output, `foo"" && ls -al ; echo ""bar`);
+    });
+
+    it("removes multiple null character", function () {
+      const input = `foo"${nullChar}&&ls -al${nullChar};echo "bar`;
+      const output = escapeShellArg(input);
+      assert.strictEqual(output, `foo""&&ls -al;echo ""bar`);
+    });
+  });
 });

