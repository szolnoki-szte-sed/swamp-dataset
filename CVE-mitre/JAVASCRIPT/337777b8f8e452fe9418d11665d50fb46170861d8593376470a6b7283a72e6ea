--- server.js ---
@@ -389,21 +389,27 @@ function calculateDirectorySize(directoryPath) {
     return totalSize;
 }
 
-// Modify the sendNotification function
+// Modify the sendNotification function to safely escape the message
 async function sendNotification(filename, fileSize) {
     if (!APPRISE_URL) return;
 
     try {
         const formattedSize = formatFileSize(fileSize);
         const totalStorage = formatFileSize(calculateDirectorySize(uploadDir));
+        
+        // Sanitize the message components
+        const sanitizedFilename = JSON.stringify(filename).slice(1, -1); // Escape special characters
         const message = APPRISE_MESSAGE
-            .replace('{filename}', filename)
+            .replace('{filename}', sanitizedFilename)
             .replace('{size}', formattedSize)
             .replace('{storage}', totalStorage);
+
+        // Use array syntax to avoid shell interpretation
+        await execAsync(['apprise', APPRISE_URL, '-b', message], {
+            shell: false
+        });
         
-        // Execute apprise command
-        await execAsync(`apprise "${APPRISE_URL}" -b "${message}"`);
-        log.info(`Notification sent for: ${filename} (${formattedSize}, Total storage: ${totalStorage})`);
+        log.info(`Notification sent for: ${sanitizedFilename} (${formattedSize}, Total storage: ${totalStorage})`);
     } catch (err) {
         log.error(`Failed to send notification: ${err.message}`);
     }

