--- extras/lib_contentmap/json/articlesmarkers.php ---
@@ -355,7 +355,7 @@ protected function Load()
 		$query->from("#__content");
 
 		// Condition: content id passed py plugin
-		$query->where("id = '" . JRequest::getVar("contentid", 0, "GET") . "'");
+		$query->where("id = '" . intval(JRequest::getVar("contentid", 0, "GET")) . "'");
 
 		// Condition: metadata field contains "xreference":"coordinates"
 		// {\"xreference\":\"} the string "xreference":"

--- site/views/smartloader/view.html.php ---
@@ -11,6 +11,10 @@ function display($tpl = null)
 		// Load module || component || plugin parameters. Defaults to plugin
 		$owner = JRequest::getVar("owner", "", "GET") or $owner = "plugin"; // getVar() default value doesn't work with ?owner=""
 
+		if (!in_array($owner,array('module','plugin','component','article'))){
+			die();
+		}
+		
 		$db = JFactory::getDbo();
 		jimport("joomla.database.databasequery");
 		$query = $db->getQuery(true);

