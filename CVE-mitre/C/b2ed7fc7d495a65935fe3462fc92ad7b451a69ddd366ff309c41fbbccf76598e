--- ChangeLog ---
@@ -1,3 +1,7 @@
+06/25/2021
+- avoid XSS vulnerability when using OIDCPreservePost On and supplying URLs that contain single quotes
+  thanks @oss-aimoto
+
 06/21/2021
 - strip A256GCM JWT header from encrypted JWTS used for state cookies, cache encryption and by-value session cookies
   resulting in smaller cookies and reduced cache content size

--- src/mod_auth_openidc.c ---
@@ -513,7 +513,7 @@ static int oidc_request_post_preserved_restore(request_rec *r,
 					"          input.type = \"hidden\";\n"
 					"          document.forms[0].appendChild(input);\n"
 					"        }\n"
-					"        document.forms[0].action = '%s';\n"
+					"        document.forms[0].action = \"%s\";\n"
 					"        document.forms[0].submit();\n"
 					"      }\n"
 					"    </script>\n", method, original_url);

