--- .gitignore ---
@@ -1,4 +1,2 @@
 .env
-.DS_Store
-
-feedback/*/***
\ No newline at end of file
+.DS_Store
\ No newline at end of file

--- .htaccess ---
@@ -1,24 +1,25 @@
-# Prevent Access to svg
-<Files "*.svg">
-  Order allow,deny
-  Allow from all
-</Files>
+# DISABLE DIRECTORY LISTINGS
+Options -Indexes
 
-# Prevent Access to log files
-<Files "*.log">
-    Order Allow,Deny
-    Deny from all
-</Files>
+<IfModule mod_rewrite.c>
+    RewriteEngine On
+    RewriteBase /
 
-# Prevent Access to dot files
-<FilesMatch "^\.">
-    Order allow,deny
-    Deny from all
-</FilesMatch>
+    # Remove .php extension from URLs
+    RewriteCond %{REQUEST_FILENAME}.php -f
+    RewriteRule ^ %{REQUEST_URI}.php [L]
+
+    # Remove trailing dot from URLs
+    RewriteRule ^(.*)\.$ /$1 [R=301,L]
+
+    # Redirect all requests to index.php except existing files or directories
+    RewriteCond %{REQUEST_FILENAME} !-f
+    RewriteCond %{REQUEST_FILENAME} !-d
+    RewriteRule ^ index.php [L]
+</IfModule>
 
-# DISABLE CACHING 
 <IfModule mod_headers.c> 	
-Header set Cache-Control "no-cache, no-store, must-revalidate" 	
-Header set Pragma "no-cache" 	
-Header set Expires 0 
+    Header set Cache-Control "no-cache, no-store, must-revalidate" 	
+    Header set Pragma "no-cache" 	
+    Header set Expires 0 
 </IfModule>
\ No newline at end of file

--- Changelog.txt ---
@@ -0,0 +1,21 @@
+CHANGE LOG:
+
+16.04.2024 Changelog – HAWKI V1. 
+
+    - Multi language package added.
+    - Dark mode theme added.
+    - Syntax Highlighting update.
+    - KaTeX implimentation for math formulas.
+    - Azure AI integration
+    - BUGFIX: Test user enabled w/ cridentials from .env file.
+    - Shibboleth connection 
+    - System prompts panel added.
+    - Security updates for escaped HTML, sanitized inputs, csrf token. 
+
+23.01.2024
+
+    - Message Inputfield scroll panel added.
+    - Autoscroll function adjusted. Scroll up stops the auto scroll.
+    - Stop Generating function added. During the generation process send button switches to stop generation button.
+    - Copy Button added. The function copies the whole message as plain text.
+    - BUGFIX: Parsing error from json "Chunks" corrected (merged code from Niklas Wode).

--- README.md ---
@@ -1,11 +1,5 @@
 # HAWKI
 
-# NEU NEU NEU
-
-Im Rahmen der gemeinsamen Weiterentwicklung von HAWKI möchten wir ein Dokument zur Verfügung stellen, das verschiedene Nutzungsmöglichkeiten von HAWKI aufzeigt. Hier ist Platz, um Promptvorschläge für die Hochschullehre zu machen oder weitere fiktive Expert*innen für das virtuelle Büro hinzuzufügen.
-https://pad.hawk.de/p/Offener_Prompt-Katalog
-
-
 ## About
 
 HAWKI is a didactic interface for universities based on the OpenAI API. It is not necessary for users to create an account, the university ID is sufficient for login - no user-related data is stored.
@@ -20,42 +14,38 @@ Learning Space: The learning spaces are designed to help you understand the diff
 
 We welcome constructive feedback to further develop this project based on your needs and insights.
 
-![HAWKI Login](/img/hawki-screenshot-login.png)
+<!-- ![HAWKI Login](/img/hawki-screenshot-login.png) -->
+![HAWKI Login](/img/readmePic1.jpeg)
 _HAWKI Login Screen_
 
-![HAWKI Dashboard](/img/hawki-screenshot-dashboard.jpg)
+<!-- ![HAWKI Dashboard](/img/hawki-screenshot-dashboard.jpg) -->
+![HAWKI Dashboard](/img/readmePic3.jpg)
 _HAWKI Dashboard_
 
-## ChangeLog 23.01.2024
+![HAWKI Dashboard](/img/readmePic2.jpg)
+_HAWKI Settings Panel_
+
+
+## Changelog – HAWKI V1. 
 
-Quality of Life Features:
+###Functionality 
 
-- Message Inputfield scroll panel added
-It is now possible to scroll in the text input field. Previously, long text entries were too inconvenient.
-- Autoscroll function adjusted. Scroll up stops the auto scroll.
-When a response is generated, the user can still scroll up and read the text that has already been generated.
-- Stop Generating function added. During the generation process “send” button switches to “stop generation” button.
-Now users no longer have to wait until the end of the generation, but can end the process manually.
-- Copy Button added. The function copies the whole message as plain text.
-Users can use the Copy button to copy the text without formatting. This simplifies the further processing of the generated answers.
+Shibboleth connection as an additional authentication option. (Thanks to Marvin Mundry from the University of Hamburg)
 
+Multi-language with translated texts for English, Italian, French and Spanish.
+Display of mathematical formulas, LaTex and improvement of syntax highlighting.
 
-Bugfix
-- Parsing error from json "Chunks" corrected (merged code from Uni Kassel / thx to Niklas Wode).
-Previously, the response was sometimes not generated completely or contained errors.
+###Quality of Life 
 
-Other
+Dark Mode for our night owls.
 
-- Removed testing files
-Redundant files from the development phase
+System prompts can now be viewed transparently.
 
-- Removed docker container 
-We cannot offer long-term support for a docker integration and find the setup process simple enough and have therefore removed the docker container.
+###Security updates
 
-- Changed standard model to GPT-4-Turbo
-At times we had a model switcher built in, but this has now become unnecessary. We have removed the model switcher and set gpt 4 turbo as the standard model.
+We have made HAWKI more secure in some areas and updated the code structure.
 
-- Previously, the generated text that was in double asterisks was deleted, now we make it available as bold text, as intended.
+We would like to thank Thorger Jansen (discovery, analysis, coordination) from SEC Consult Vulnerability Lab for responsibly reporting the identified issues and working with us to fix them.
 
 ## Getting started
 
@@ -65,7 +55,7 @@ At times we had a model switcher built in, but this has now become unnecessary.
 
 HAWKI uses LDAP under the hood in order to authenticate users. Make sure you have LDAP setup first and that it is accessible from your HAWKI instance. Provide your LDAP config according to chapter [Configuration](#configuration). You can find more information on how to use LDAP on the official website https://ldap.com
 
-_**Testing without LDAP:**_ You can try out HAWKI without an LDAP server. To do so, set `TESTUSER` and `TESTPASSWORD` in the configuration file (see [Configuration](#configuration)).
+_**Testing without LDAP:**_ You can try out HAWKI without an LDAP server. To do so, set `TESTUSER` to your prefered user name `tester` in the configuration file (see [Configuration](#configuration)) and sign in with username `tester` and password `superlangespasswort123`
 
 ### OpenID Connect
 
@@ -74,35 +64,40 @@ authenticate users. It requires the jumbojett/openid-connect-php
 library (https://github.com/jumbojett/OpenID-Connect-PHP)
 to be installed with composer.
 
-### Open AI Access
+### Shibboleth 
+
+The new version also supports the Shibboleth for user authentication. Define your Shibboleth url and login page in the environment file (see [Configuration](#configuration)).
 
-To generate answers HAWKI uses the _Open AI API_. Follow the instructions on https://platform.openai.com/docs/introduction to generate an API key and paste it in the configuration file like instructed in chapter [Configuration](#configuration).
+### Open AI Access
 
-The API also works with _Microsoft Azure AI_. Follow the instructions on https://learn.microsoft.com/en-us/azure/ai-services/openai/how-to/create-resource?pivots=web-portal to create a resource, deploy a GPT-4 model and generate the API URL and API key. For Microsoft Azure AI, this URL should look like _https://<AZURE_OPENAI_ENDPOINT>/openai/deployments/<DEPLOYMENT_NAME>/chat/completions?api-version=2023-05-15_ with AZURE_OPENAI_ENDPOINT and DEPLOYMENT_NAME being replaced by your values. Paste the API URL and API key in the configuration file like instructed in chapter [Configuration](#configuration).
+To generate answers HAWKI uses the Open AI api. Follow the instructions on https://platform.openai.com/docs/introduction to generate an API key and paste it in the configuration file like instructed in chapter [Configuration](#configuration).
 
 ## Configuration
 
 To get started you need to add a configuration file to the project first. Copy the file ".env.example" from the root directory and rename it to ".env". Replace the example values in it with your own configuration. A detailed description of all values is listed below.
 
 | Value            | Type    | Example                                | Description                                                                                                                                        |
 | ---------------- | ------- | -------------------------------------- | -------------------------------------------------------------------------------------------------------------------------------------------------- |
-| Authentication   | string  | 'LDAP' or 'OIDC'                        | Authentication method: LDAP or OpenID Connect                                                                                                      |
+| Authentication   | string  | 'LDAP' / 'OIDC' / 'Shibboleth'                     | Authentication method: LDAP or OpenID Connect                                                                                                      |
 | LDAP_HOST        | string  | "ldaps://...de"                        | The URL of your LDAP server.                                                                                                                       |
 | LDAP_BIND_PW     | string  | secretpassword                         | Password of the user that is trying to bind to the LDAP Server.                                                                                    |
 | LDAP_BASE_DN     | string  | "cn=...,ou=...,dc=..."                 | Distinguised name that is used to initially bind to your LDAP server.                                                                              |
 | LDAP_SEARCH_DN   | string  | "ou=...,dc=..."                        | Distinguished name that is used for authenticating users.                                                                                          |
+| LDAP_PORT  | string  | "..."                        | The LDAP port.                                                                                          |
+| SHIBBOLET_LOGIN_PATH    | string  | "..."                                  | Path to shibboleth login page.                                                                                               |
+| SHIBBOLET_LOGIN_PAGE    | string  | "..."                                  | Shibboleth login page.                                                                                               |
 | OIDC_IDP          | string  | "https://...."                         | URL of the Identity provider supporting OpenID Connect.                                                                                            |
 | OIDC_CLIENT_ID    | string  | "..."                                  | Client Id for this application in Identity provider.                                                                                               |
 | OIDC_CLIENT_SECRET | string  | "..."                                 | Secret key for OpenID Connect. 
 | OIDC_LOGOUT_URI | string  | "https://...."                                 | URL to logout from Identity provider                                                                                                                  |
-| OPENAI_API_KEY   | string  | sk-...                                 | Open AI API key                                                                                                                                    |
-| OPENAI_API_URL   | string  | https://api.openai.com/v1/chat/completions | Open AI API URL. Also works with Microsoft Azure AI.                                                         |
+| OPENAI_API_URL   | string  | "https://api.openai.com/v1/chat/completions" | Open AI URL                                                                                                                                    |
+| OPENAI_API_KEY   | string  | sk-...                                 | Open AI Api key                                                                                                                                    |
 | IMPRINT_LOCATION | string  | https://your-university/imprint        | A link to your imprint. Alternatively you can replace the file index.php under /impressum with your own html/ php of your imprint.                 |
 | PRIVACY_LOCATION | string  | https://your-university/privacy-policy | A link to your privacy policy. Alternatively you can replace the file index.php under /datenschutz with your own html/ php of your privacy policy. |
-| TESTUSER         | string  | `tester`                                | Can be set for testing purposes. Requires `Authentication=LDAP`. You can then sign in using the given username and password.                      |
-| TESTPASSWORD     | string  | `superlangespasswort123`                | Can be set for testing purposes. Requires `Authentication=LDAP`. You can then sign in using the given username and password.                      |
-| FAVICON_URI  | string  | "https://...."                                 | Link to favicon 
-
+| TESTUSER         | string | "tester"                                | Set value for testing purposes. Leave TESTUSER and TESTPASSWORD empty or comment them out to disable test user.                    |
+| TESTPASSWORD         | string | "superlangespasswort123"  | Set value for testing purposes. Leave TESTUSER and TESTPASSWORD empty or comment them out to disable test user.                           |
+| FAVICON_URI  | string  | "https://...."                                 | Link to favicon |
+| DEFAULT_LANGUAGE  | string  | "de_DE"/ "en_US"/ "es_ES"/ "fr_FR"/ "it_IT"               | Default website language. Only applicable if the user has not previously changed the language or their browser language is not one of the supported languages. Current supported languages: 'de_DE', 'en_US', 'es_ES', 'fr_FR', 'it_IT'  |
 ## Web Server Configuration
 
 There are a few things to keep in mind when publishing your HAWKI instance on a webserver.

--- SECURITY.md ---
@@ -1,18 +1,38 @@
-# Security Policy
+# Sicherheitsrichtlinie
 
-We take the security of our projects very seriously. This means we aim to disclose and patch any arising issues as soon as possible. Moderate to major security issues will be fixed and included in a new release. Smaller issues will be given a hotfix.
+## Melden von Sicherheitslücken
 
-## Reporting a Vulnerability
+Wir nehmen die Sicherheit unseres Projekts ernst. Wenn Sie eine Sicherheitslücke in unserem Projekt entdeckt haben, bitten wir Sie, uns dies sicher über E-Mail zu berichten. Bitte senden Sie keine Sicherheitsprobleme über öffentliche GitHub-Issues.
 
-In order to report a (possible) vulnerability, please create a report here with the GitHub Security Advisory Tool and include a description as detailed as possible as well as the steps to reproduce the issue. 
-Alternatively you can contact us via E-Mail under vincent.timm2(at)hawk.de - please include the same information that you would fill in here on GitHub.
+**E-Mail:** arian.sadafi1@hawk.de
 
-We will try to reply to your request within two weeks. You should expect a close collaboration as we work to resolve the security vulnerability you have reported. 
-Please avoid revealing information about vulnerabilities in public without prior disclosure if that could put users at risk.
+**Verschlüsselte Kommunikation:**
+- Bitte senden Sie Ihre Meldung verschlüsselt, wenn möglich. Unten finden Sie meinen öffentlichen PGP-Schlüssel.
 
-## Prefered Language
-We prefer all communications to be in English or German.
+-----BEGIN PGP PUBLIC KEY BLOCK-----
 
-## Attribution
-We will include a "thank you section" in the project description for those who disclosed vulnurabilities in accordance to this policy.
-After vulnurabilities are fixed a public disclosure is possible.
+mDMEZiDaSBYJKwYBBAHaRw8BAQdA0Pay7iQXr1eKz4ndzp9BUSCBb0F1ZMOpCpj+
+qacOYdq0JEFyaWFuIFNhZGFmaSA8YXJpYW4uc2FkYWZpMUBoYXdrLmRlPoiZBBMW
+CgBBFiEEWXmdELYk4obrfmZGH11shzhB3/MFAmYg2kgCGwMFCQWjmoAFCwkIBwIC
+IgIGFQoJCAsCBBYCAwECHgcCF4AACgkQH11shzhB3/MbUwD9EAUlUw+z2W0RAVzg
+eezchrJI9ujASKnttzUx5q3MyzYBAM1orN5fGQxscp5JmqzIDVmftrHSSU6B0EZP
+z8ZFOREEuDgEZiDaSBIKKwYBBAGXVQEFAQEHQBiGyFSbtRTDcmr4kB//16cEaPI7
+bs9uQ8mvIfAzo9cxAwEIB4h+BBgWCgAmFiEEWXmdELYk4obrfmZGH11shzhB3/MF
+AmYg2kgC...
+-----END PGP PUBLIC KEY BLOCK-----
+
+
+## Was passiert nach der Meldung?
+
+- Wir bestätigen den Erhalt Ihrer Meldung innerhalb von 24 Stunden.
+- Wir geben Ihnen eine Einschätzung der Schwere und des Einflusses der gemeldeten Sicherheitslücke.
+- Wir bemühen uns, Sicherheitsprobleme so schnell wie möglich zu beheben und eine neue Version bereitzustellen, die das Problem löst.
+- Wir informieren Sie über den Zeitplan der Korrekturen.
+
+## Öffentliche Anerkennung
+
+Wir erkennen alle Sicherheitsforscher an, die bei der Identifizierung und Meldung von Problemen gemäß dieser Richtlinie helfen. Wenn Sie es wünschen, fügen wir Ihren Namen oder Ihr Pseudonym in die Liste der Beitragenden ein, nachdem das Problem behoben wurde.
+
+## Weitere Informationen
+
+Für weitere Informationen über die Sicherheit dieses Projekts oder die Sicherheitspraktiken wenden Sie sich bitte an arian.sadafi1@hawk.de.
\ No newline at end of file

--- composer.lock ---
@@ -0,0 +1,288 @@
+{
+    "_readme": [
+        "This file locks the dependencies of your project to a known state",
+        "Read more about it at https://getcomposer.org/doc/01-basic-usage.md#installing-dependencies",
+        "This file is @generated automatically"
+    ],
+    "content-hash": "f6fbbdce9293efa736f194e1c2a02ae3",
+    "packages": [
+        {
+            "name": "jumbojett/openid-connect-php",
+            "version": "v0.9.10",
+            "source": {
+                "type": "git",
+                "url": "https://github.com/jumbojett/OpenID-Connect-PHP.git",
+                "reference": "45aac47b525f0483dd4db3324bb1f1cab4666061"
+            },
+            "dist": {
+                "type": "zip",
+                "url": "https://api.github.com/repos/jumbojett/OpenID-Connect-PHP/zipball/45aac47b525f0483dd4db3324bb1f1cab4666061",
+                "reference": "45aac47b525f0483dd4db3324bb1f1cab4666061",
+                "shasum": ""
+            },
+            "require": {
+                "ext-curl": "*",
+                "ext-json": "*",
+                "paragonie/random_compat": ">=2",
+                "php": ">=5.4",
+                "phpseclib/phpseclib": "~2.0 || ^3.0"
+            },
+            "require-dev": {
+                "roave/security-advisories": "dev-master",
+                "yoast/phpunit-polyfills": "^1.0"
+            },
+            "type": "library",
+            "autoload": {
+                "classmap": [
+                    "src/"
+                ]
+            },
+            "notification-url": "https://packagist.org/downloads/",
+            "license": [
+                "Apache-2.0"
+            ],
+            "description": "Bare-bones OpenID Connect client",
+            "support": {
+                "issues": "https://github.com/jumbojett/OpenID-Connect-PHP/issues",
+                "source": "https://github.com/jumbojett/OpenID-Connect-PHP/tree/v0.9.10"
+            },
+            "time": "2022-09-30T12:34:46+00:00"
+        },
+        {
+            "name": "paragonie/constant_time_encoding",
+            "version": "v2.6.3",
+            "source": {
+                "type": "git",
+                "url": "https://github.com/paragonie/constant_time_encoding.git",
+                "reference": "58c3f47f650c94ec05a151692652a868995d2938"
+            },
+            "dist": {
+                "type": "zip",
+                "url": "https://api.github.com/repos/paragonie/constant_time_encoding/zipball/58c3f47f650c94ec05a151692652a868995d2938",
+                "reference": "58c3f47f650c94ec05a151692652a868995d2938",
+                "shasum": ""
+            },
+            "require": {
+                "php": "^7|^8"
+            },
+            "require-dev": {
+                "phpunit/phpunit": "^6|^7|^8|^9",
+                "vimeo/psalm": "^1|^2|^3|^4"
+            },
+            "type": "library",
+            "autoload": {
+                "psr-4": {
+                    "ParagonIE\\ConstantTime\\": "src/"
+                }
+            },
+            "notification-url": "https://packagist.org/downloads/",
+            "license": [
+                "MIT"
+            ],
+            "authors": [
+                {
+                    "name": "Paragon Initiative Enterprises",
+                    "email": "security@paragonie.com",
+                    "homepage": "https://paragonie.com",
+                    "role": "Maintainer"
+                },
+                {
+                    "name": "Steve 'Sc00bz' Thomas",
+                    "email": "steve@tobtu.com",
+                    "homepage": "https://www.tobtu.com",
+                    "role": "Original Developer"
+                }
+            ],
+            "description": "Constant-time Implementations of RFC 4648 Encoding (Base-64, Base-32, Base-16)",
+            "keywords": [
+                "base16",
+                "base32",
+                "base32_decode",
+                "base32_encode",
+                "base64",
+                "base64_decode",
+                "base64_encode",
+                "bin2hex",
+                "encoding",
+                "hex",
+                "hex2bin",
+                "rfc4648"
+            ],
+            "support": {
+                "email": "info@paragonie.com",
+                "issues": "https://github.com/paragonie/constant_time_encoding/issues",
+                "source": "https://github.com/paragonie/constant_time_encoding"
+            },
+            "time": "2022-06-14T06:56:20+00:00"
+        },
+        {
+            "name": "paragonie/random_compat",
+            "version": "v9.99.100",
+            "source": {
+                "type": "git",
+                "url": "https://github.com/paragonie/random_compat.git",
+                "reference": "996434e5492cb4c3edcb9168db6fbb1359ef965a"
+            },
+            "dist": {
+                "type": "zip",
+                "url": "https://api.github.com/repos/paragonie/random_compat/zipball/996434e5492cb4c3edcb9168db6fbb1359ef965a",
+                "reference": "996434e5492cb4c3edcb9168db6fbb1359ef965a",
+                "shasum": ""
+            },
+            "require": {
+                "php": ">= 7"
+            },
+            "require-dev": {
+                "phpunit/phpunit": "4.*|5.*",
+                "vimeo/psalm": "^1"
+            },
+            "suggest": {
+                "ext-libsodium": "Provides a modern crypto API that can be used to generate random bytes."
+            },
+            "type": "library",
+            "notification-url": "https://packagist.org/downloads/",
+            "license": [
+                "MIT"
+            ],
+            "authors": [
+                {
+                    "name": "Paragon Initiative Enterprises",
+                    "email": "security@paragonie.com",
+                    "homepage": "https://paragonie.com"
+                }
+            ],
+            "description": "PHP 5.x polyfill for random_bytes() and random_int() from PHP 7",
+            "keywords": [
+                "csprng",
+                "polyfill",
+                "pseudorandom",
+                "random"
+            ],
+            "support": {
+                "email": "info@paragonie.com",
+                "issues": "https://github.com/paragonie/random_compat/issues",
+                "source": "https://github.com/paragonie/random_compat"
+            },
+            "time": "2020-10-15T08:29:30+00:00"
+        },
+        {
+            "name": "phpseclib/phpseclib",
+            "version": "3.0.37",
+            "source": {
+                "type": "git",
+                "url": "https://github.com/phpseclib/phpseclib.git",
+                "reference": "cfa2013d0f68c062055180dd4328cc8b9d1f30b8"
+            },
+            "dist": {
+                "type": "zip",
+                "url": "https://api.github.com/repos/phpseclib/phpseclib/zipball/cfa2013d0f68c062055180dd4328cc8b9d1f30b8",
+                "reference": "cfa2013d0f68c062055180dd4328cc8b9d1f30b8",
+                "shasum": ""
+            },
+            "require": {
+                "paragonie/constant_time_encoding": "^1|^2",
+                "paragonie/random_compat": "^1.4|^2.0|^9.99.99",
+                "php": ">=5.6.1"
+            },
+            "require-dev": {
+                "phpunit/phpunit": "*"
+            },
+            "suggest": {
+                "ext-dom": "Install the DOM extension to load XML formatted public keys.",
+                "ext-gmp": "Install the GMP (GNU Multiple Precision) extension in order to speed up arbitrary precision integer arithmetic operations.",
+                "ext-libsodium": "SSH2/SFTP can make use of some algorithms provided by the libsodium-php extension.",
+                "ext-mcrypt": "Install the Mcrypt extension in order to speed up a few other cryptographic operations.",
+                "ext-openssl": "Install the OpenSSL extension in order to speed up a wide variety of cryptographic operations."
+            },
+            "type": "library",
+            "autoload": {
+                "files": [
+                    "phpseclib/bootstrap.php"
+                ],
+                "psr-4": {
+                    "phpseclib3\\": "phpseclib/"
+                }
+            },
+            "notification-url": "https://packagist.org/downloads/",
+            "license": [
+                "MIT"
+            ],
+            "authors": [
+                {
+                    "name": "Jim Wigginton",
+                    "email": "terrafrost@php.net",
+                    "role": "Lead Developer"
+                },
+                {
+                    "name": "Patrick Monnerat",
+                    "email": "pm@datasphere.ch",
+                    "role": "Developer"
+                },
+                {
+                    "name": "Andreas Fischer",
+                    "email": "bantu@phpbb.com",
+                    "role": "Developer"
+                },
+                {
+                    "name": "Hans-Jürgen Petrich",
+                    "email": "petrich@tronic-media.com",
+                    "role": "Developer"
+                },
+                {
+                    "name": "Graham Campbell",
+                    "email": "graham@alt-three.com",
+                    "role": "Developer"
+                }
+            ],
+            "description": "PHP Secure Communications Library - Pure-PHP implementations of RSA, AES, SSH2, SFTP, X.509 etc.",
+            "homepage": "http://phpseclib.sourceforge.net",
+            "keywords": [
+                "BigInteger",
+                "aes",
+                "asn.1",
+                "asn1",
+                "blowfish",
+                "crypto",
+                "cryptography",
+                "encryption",
+                "rsa",
+                "security",
+                "sftp",
+                "signature",
+                "signing",
+                "ssh",
+                "twofish",
+                "x.509",
+                "x509"
+            ],
+            "support": {
+                "issues": "https://github.com/phpseclib/phpseclib/issues",
+                "source": "https://github.com/phpseclib/phpseclib/tree/3.0.37"
+            },
+            "funding": [
+                {
+                    "url": "https://github.com/terrafrost",
+                    "type": "github"
+                },
+                {
+                    "url": "https://www.patreon.com/phpseclib",
+                    "type": "patreon"
+                },
+                {
+                    "url": "https://tidelift.com/funding/github/packagist/phpseclib/phpseclib",
+                    "type": "tidelift"
+                }
+            ],
+            "time": "2024-03-03T02:14:58+00:00"
+        }
+    ],
+    "packages-dev": [],
+    "aliases": [],
+    "minimum-stability": "stable",
+    "stability-flags": [],
+    "prefer-stable": false,
+    "prefer-lowest": false,
+    "platform": [],
+    "platform-dev": [],
+    "plugin-api-version": "2.6.0"
+}

--- datenschutz/index.php ---
@@ -1,8 +0,0 @@
-<?php
-if (file_exists("../.env")){
-    $env = parse_ini_file('../.env');
-}	
-$privacyLocation = isset($env) ? $env["PRIVACY_LOCATION"] : getenv("PRIVACY_LOCATION");
-
-header("Location: $privacyLocation");
-exit;

--- downvote.php ---
@@ -1,28 +0,0 @@
-<?php
-
-session_start();
-if (!isset($_SESSION['username'])) {
-	http_response_code(401);
-	exit;
-}
-
-if ($_SERVER['REQUEST_METHOD'] === 'POST') {
-	$id = file_get_contents("php://input");
-
-	$sanitizedId = htmlspecialchars($id, ENT_QUOTES, 'UTF-8');
-
-	$file = "feedback/" . $sanitizedId;
-
-	if (!file_exists($file)) {
-		echo('File does not exist');
-		http_response_code(404);
-		exit;
-	}
-
-	$json = json_decode(file_get_contents("feedback/$sanitizedId"), true);
-	$json["down"] = $json["down"] + 1;
-	file_put_contents("feedback/$sanitizedId", json_encode($json));
-	echo json_encode($json);
-}
-
-

--- feedback/.gitignore ---
@@ -1,2 +0,0 @@
-*
-!.gitignore
\ No newline at end of file

--- feedback/.htaccess ---
@@ -1,2 +0,0 @@
-# DISABLE DIRECTORY INDEXES
-Options -Indexes
\ No newline at end of file

--- impressum/index.php ---
@@ -1,11 +0,0 @@
-<?php
-if (file_exists("../.env")){
-    $env = parse_ini_file('../.env');
-}	
-$imprintLocation = isset($env) ? $env["IMPRINT_LOCATION"] : getenv("IMPRINT_LOCATION");
-
-header("Location: $imprintLocation");
-exit;
-
-
-

--- index.php ---
@@ -1,4 +1,60 @@
 <?php
-header("Location: login.php");
-exit;
+define('ROOT_PATH', __DIR__);
+define('PRIVATE_PATH', ROOT_PATH . '/private');
+define('BOOTSTRAP_PATH', PRIVATE_PATH . '/bootstrap.php');
 
+require_once BOOTSTRAP_PATH;
+
+// Get the requested URI from the query parameter
+$request_uri = isset($_GET['url']) ? $_GET['url'] : $_SERVER['REQUEST_URI'] ?? '/';
+$request_uri = str_replace('.php', '', $request_uri);
+$request_path = parse_url($request_uri, PHP_URL_PATH);
+if (file_exists(ENV_FILE_PATH)){
+    $env = parse_ini_file(ENV_FILE_PATH);
+}	
+
+switch($request_path){
+    case('/login'):
+        include_once LOGIN_PAGE_PATH;
+        exit();
+
+    case('/interface'):
+        include_once INTERFACE_PAGE_PATH;
+        exit();
+
+    case('/logout'):
+        include_once LOGOUT_PAGE_PATH;
+        exit();
+
+    case('/impressum'):
+        $imprintLocation = isset($env) ? $env["IMPRINT_LOCATION"] : getenv("IMPRINT_LOCATION");
+        header("Location: $imprintLocation");
+        exit;
+
+    case('/dataprotection'):
+        $dataProtectionLocation = isset($env) ? $env["PRIVACY_LOCATION"] : getenv("PRIVACY_LOCATION");
+        header("Location: $dataProtectionLocation");
+        exit;
+        
+    case('/api/feedback_send'):
+        if($_SERVER["REQUEST_METHOD"] == "POST"){
+            include_once( LIBRARY_PATH . "feedback_send.php");
+        }
+        exit;
+        
+    case('/api/submit_vote'):
+        if($_SERVER["REQUEST_METHOD"] == "POST"){
+            include_once( LIBRARY_PATH . "submit_vote.php");
+        }
+        exit;
+
+    case('/api/stream-api'):
+        if($_SERVER["REQUEST_METHOD"] == "POST"){
+            include_once( LIBRARY_PATH . "stream-api.php");
+        }
+        exit;
+
+    default:
+        header("Location: /login");
+        exit();
+}
\ No newline at end of file

--- interface.php ---
@@ -1,749 +0,0 @@
-<meta name="viewport" content="width=device-width, initial-scale=1">
-<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/vs.min.css">
-<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
-
-<!-- and it's easy to individually load additional languages -->
-<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/go.min.js"></script>
-
-<?php
-	session_start();
-	if (!isset($_SESSION['username'])) {
-		header("Location: login.php");
-		exit;
-	}
-?>
-
-<link rel="stylesheet" href="app.css">	
-
-<div class="wrapper">
-	<div class="sidebar">
-		<div class="logo">
-			<img src="/img/logo.svg" alt="HAWK Logo" width="150px">
-		</div>
-		<div class="menu">
-			<details>
-				<summary>
-					<h3>Konversation ⓘ</h3>
-				</summary>
-				Ein Chatbereich wie bei ChatGPT, für einen schnellen Einstieg in jede beliebige Aufgabe.
-			</details>
-			<div class="menu-item" id="chatMenuButton" onclick="load(this, 'chat.htm')">
-				<svg viewBox="0 0 24 24"><path d="M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2M20 16H5.2L4 17.2V4H20V16Z" /></svg>
-				Chat
-			</div>
-		
-			<details>
-				<summary>
-					<h3>Virtuelles Büro ⓘ</h3>
-				</summary>
-				Gespräche mit fiktiven Expert*innen, um sich in fachfremden Bereichen einzuarbeiten und gezieltere Anfragen an echte Hochschul-Expert*innen zu stellen.
-			</details>
-			<div class="menu-item" onclick="submenu(this)">
-				<svg viewBox="0 0 24 24"><path d="M13.07 10.41A5 5 0 0 0 13.07 4.59A3.39 3.39 0 0 1 15 4A3.5 3.5 0 0 1 15 11A3.39 3.39 0 0 1 13.07 10.41M5.5 7.5A3.5 3.5 0 1 1 9 11A3.5 3.5 0 0 1 5.5 7.5M7.5 7.5A1.5 1.5 0 1 0 9 6A1.5 1.5 0 0 0 7.5 7.5M16 17V19H2V17S2 13 9 13 16 17 16 17M14 17C13.86 16.22 12.67 15 9 15S4.07 16.31 4 17M15.95 13A5.32 5.32 0 0 1 18 17V19H22V17S22 13.37 15.94 13Z" /></svg>
-				Team
-			</div>
-			<div class="submenu">
-				<div class="submenu-item" onclick="load(this, 'finance.htm')">Finanzen</div>
-				<div class="submenu-item" onclick="load(this, 'science.htm')">Forschung</div>
-				<div class="submenu-item" onclick="load(this, 'marketing.htm')">Marketing</div>
-				<div class="submenu-item" onclick="load(this, 'programming.htm')">Programmierung</div>
-				<div class="submenu-item" onclick="load(this, 'law.htm')">Rechtsberatung</div>
-				<div class="submenu-item" onclick="load(this, 'socialmedia.htm')">Social Media</div>
-			</div>
-			
-			<details>
-				<summary>
-					<h3>Lernraum ⓘ</h3>
-				</summary>
-				Die Lernräume sollen helfen, die verschiedenen Unterstützungsmöglichkeiten zu verstehen und zu lernen, was einen effektiven Prompt ausmacht.
-			</details>
-			<div class="menu-item" onclick="submenu(this)">
-				<svg viewBox="0 0 24 24"><path d="M14.6,16.6L19.2,12L14.6,7.4L16,6L22,12L16,18L14.6,16.6M9.4,16.6L4.8,12L9.4,7.4L8,6L2,12L8,18L9.4,16.6Z" /></svg>
-				Wiss. Arbeiten
-			</div>
-			<div class="submenu">
-				<div class="submenu-item" onclick="load(this, 'datascience.htm')">Datenanalyse</div>
-				<div class="submenu-item" onclick="load(this, 'feedback.htm')">Feedback</div>
-				<div class="submenu-item" onclick="load(this, 'methodologie.htm')">Methodologie</div>
-				<div class="submenu-item" onclick="load(this, 'literature.htm')">Literaturrecherche</div>
-				<div class="submenu-item" onclick="load(this, 'research.htm')">Rechercheunterstützung</div>
-				<div class="submenu-item" onclick="load(this, 'writing.htm')">Schreibhilfe</div>
-			</div>
-			
-			<div class="menu-item" onclick="submenu(this)">
-				<svg viewBox="0 0 24 24"><path d="M6,3A1,1 0 0,1 7,4V4.88C8.06,4.44 9.5,4 11,4C14,4 14,6 16,6C19,6 20,4 20,4V12C20,12 19,14 16,14C13,14 13,12 11,12C8,12 7,14 7,14V21H5V4A1,1 0 0,1 6,3M7,7.25V11.5C7,11.5 9,10 11,10C13,10 14,12 16,12C18,12 18,11 18,11V7.5C18,7.5 17,8 16,8C14,8 13,6 11,6C9,6 7,7.25 7,7.25Z" /></svg>
-				Organisation
-			</div>
-			<div class="submenu">
-				<div class="submenu-item" onclick="load(this, 'eventmanagement.htm')">Eventmanagement</div>
-				<div class="submenu-item" onclick="load(this, 'learning.htm')">Lernstrategien</div>
-				<div class="submenu-item" onclick="load(this, 'motivation.htm')">Motivation</div>
-				<div class="submenu-item" onclick="load(this, 'stressmanagement.htm')">Stressmanagement</div>
-				<div class="submenu-item" onclick="load(this, 'tables.htm')">Tabellen</div>
-				<div class="submenu-item" onclick="load(this, 'timemanagement.htm')">Zeitmanagement</div>
-			</div>
-			
-			<div class="menu-item" onclick="submenu(this)">
-				<svg viewBox="0 0 24 24"><path d="M15.54,3.5L20.5,8.47L19.07,9.88L14.12,4.93L15.54,3.5M3.5,19.78L10,13.31C9.9,13 9.97,12.61 10.23,12.35C10.62,11.96 11.26,11.96 11.65,12.35C12.04,12.75 12.04,13.38 11.65,13.77C11.39,14.03 11,14.1 10.69,14L4.22,20.5L14.83,16.95L18.36,10.59L13.42,5.64L7.05,9.17L3.5,19.78Z" /></svg>
-				Kreativität
-			</div>
-			<div class="submenu">
-				<div class="submenu-item" onclick="load(this, 'copywriting.htm')">Copywriting</div>
-				<div class="submenu-item" onclick="load(this, 'designthinking.htm')">Design Thinking</div>
-				<div class="submenu-item" onclick="load(this, 'gamification.htm')">Gamification</div>
-				<div class="submenu-item" onclick="load(this, 'ideageneration.htm')">Ideenfindung</div>
-				<div class="submenu-item" onclick="load(this, 'interview.htm')">Interviewfragen</div>
-				<div class="submenu-item" onclick="load(this, 'prototyping.htm')">Prototyping</div>
-			</div>
-			
-		</div>
-		<div class="info">
-			<a href="#" onclick="load(this, 'about.htm')">Über HAWK-KI</a>
-			<a href="#" id="feedback" onclick="load(this, 'userpost.php')">Feedback</a>
-			<a href="logout.php">Abmelden</a>
-			<br>
-			<a href="#" onclick="load(this, 'datenschutz.htm')">Datenschutz</a>
-			<a href="/impressum" target="_blank">Impressum</a>
-		</div>
-	</div>
-	
-	<div class="main">
-		<div></div>
-		<div class="messages">
-		
-		
-			<div class="limitations">
-				<div>
-					<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
-					<path d="M22 11.08V12C21.9988 14.1564 21.3005 16.2547 20.0093 17.9818C18.7182 19.709 16.9033 20.9725 14.8354 21.5839C12.7674 22.1953 10.5573 22.1219 8.53447 21.3746C6.51168 20.6273 4.78465 19.2461 3.61096 17.4371C2.43727 15.628 1.87979 13.4881 2.02168 11.3363C2.16356 9.18455 2.99721 7.13631 4.39828 5.49706C5.79935 3.85781 7.69279 2.71537 9.79619 2.24013C11.8996 1.7649 14.1003 1.98232 16.07 2.85999" stroke="#06B044" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
-					<path d="M22 4L12 14.01L9 11.01" stroke="#06B044" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
-					</svg>
-					<h2>Möglichkeiten</h2>
-					<div>
-						<div class="limitation-item">
-							<strong>Kontextverständnis</strong> - Merkt sich, was vorab in der Konversation gesagt wurde.
-						</div>
-						<div class="limitation-item">
-							<strong>Iteration</strong> - Erlaubt nachträgliche Korrekturen generierter Ergebnisse.
-						</div>
-						<div class="limitation-item">
-							<strong>Formatierung</strong> - Gibt generierte Ergebnisse in gewünschter Form aus.
-						</div>
-					</div>
-				</div>
-				<div>
-					<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
-					<path d="M12 22C17.5228 22 22 17.5228 22 12C22 6.47715 17.5228 2 12 2C6.47715 2 2 6.47715 2 12C2 17.5228 6.47715 22 12 22Z" stroke="#FF5C00" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
-					<path d="M12 8V12" stroke="#FF5C00" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
-					<path d="M12 16H12.01" stroke="#FF5C00" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
-					</svg>
-					<h2>Limitationen</h2>
-					<div>
-						<div class="limitation-item">
-							<strong>Unvollständig</strong> - Generiert gelegentlich falsche Informationen.
-						</div>
-						<div class="limitation-item">
-							<strong>Vorsicht</strong> - Generiert gelegentlich gefährdende oder voreingenommene Informationen.
-						</div>
-						<div class="limitation-item">
-							<strong>Limitierung</strong> - Das Sprachmodell greift ausschließlich auf Wissen bis zum April 2023 zu.
-						</div>
-					</div>
-				</div>
-			</div>
-	 
-	 
-			<div class="message me" data-role="system">
-				<div class="message-content">
-					<div class="message-icon">System</div>
-					<div class="message-text">You are a helpful assistant who works at the University of Applied Arts and Sciences in Lower Saxony.</div>
-				</div>
-			</div>
-	  
-
-		</div>
-	
-		<div class="input-container">
-			<div class="input">
-				<div class="input-wrapper">
-					<textarea class="input-field" type="text" placeholder="Hier kannst Du deine Anfrage stellen" oninput="resize(this),resize(document.getElementsByClassName('input-wrapper')[0])" onkeypress="handleKeydown(event)"></textarea>
-				</div>
-					<div class="input-send" onclick="OnSendClick()">
-						<svg viewBox="2 2 21 21" width="80" height="80">
-							<g fill="none" stroke="rgb(35, 48, 176)" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="rgba(35, 48, 176)">
-								<path d="M12,2c5.5,0,10,4.5,10,10s-4.5,10-10,10S2,17.5,2,12S6.5,2,12,2z"  />
-								<path id="input-send-icon" d="M16,12l-4-4l-4,4 M12,16V8"/>
-							</g>
-						</svg>
-					</div>
-				</div>
-			<div class="betaMessage">
-				Betaversion - Modell GPT4-Turbo
-			</div>
-		</div>
-	
-		<div class="userpost-container">
-		 	 <div class="userpost">
-				  <textarea class="userpost-field" type="text" placeholder="Hier können Sie Ihr Feedback hinterlassen" oninput="resize(this)" onkeypress="handleKeydownUserPost(event)"></textarea>
-			 	<div class="userpost-send" onclick="send_userpost()">
-				  <svg viewBox="0 0 24 24">
-					  <path d="M3 20V4L22 12M5 17L16.85 12L5 7V10.5L11 12L5 13.5M5 17V7 13.5Z" />
-				  </svg>
-			  	</div>
-		  	</div>
-	  	</div>
-	  
-	  
-  	</div>
-  
-  	<template id="message">
-		<div class="message">
-			<div class="message-content">
-				<div class="message-icon">
-					KI
-				</div>
-				<div class="message-text">
-					Lorem ipsum dolor sit amet consectetur, adipisicing elit. Quos incidunt, quidem soluta excepturi, ullam enim tempora.
-				</div>
-				<div class="message-copypanel" >
-					<div class="message-copyButton">
-						<svg viewBox="0 0 24 24">
-							<path d="M 17.01 14.91 H 8.47 c -0.42 0 -0.7 -0.35 -0.7 -0.7 V 2.8 c 0 -0.42 0.35 -0.7 0.7 -0.7 H 14.7 l 3.01 3.01 v 9.03 C 17.71 14.56 17.43 14.91 17.01 14.91 z M 8.47 17.01 h 8.47 c 1.54 0 2.8 -1.26 2.8 -2.8 V 5.11 c 0 -0.56 -0.21 -1.12 -0.63 -1.47 l -3.01 -3.01 C 15.82 0.21 15.26 0 14.7 0 h -6.23 c -1.54 0 -2.8 1.26 -2.8 2.8 v 11.34 C 5.67 15.75 6.93 17.01 8.47 17.01 z M 2.8 5.67 c -1.54 0 -2.8 1.26 -2.8 2.8 v 11.34 c 0 1.54 1.26 2.8 2.8 2.8 h 8.47 c 1.54 0 2.8 -1.26 2.8 -2.8 v -1.4 h -2.1 v 1.4 c 0 0.42 -0.35 0.7 -0.7 0.7 H 2.8 c -0.42 0 -0.7 -0.35 -0.7 -0.7 V 8.47 c 0 -0.42 0.35 -0.7 0.7 -0.7 h 1.4 v -2.1 H 2.8 z" />
-						</svg>
-						<span class="tooltiptext">Kopieren</span>
-					</div>
-				</div>
-			</div>
-		</div>
-	</template>
-</div>
-
-<div class="modal" onclick="modalClick(this)" id="data-protection"> 
-	<div class="modal-content">
-		<h2>Nutzungshinweis</h2>
-		<p>Bitte geben Sie keine personenbezogenen Daten ein. Wir verwenden die API von OpenAI. Das bedeutet, dass die von Ihnen eingegebenen Daten direkt an OpenAI gesendet werden. Es besteht die Möglichkeit, dass OpenAI diese Daten weiterverwendet.</p>
-		<button>Bestätigen</button>
-	</div>
-</div>
-
-<script>
-	visualViewport.addEventListener("resize", update);
-	visualViewport.addEventListener("scroll", update);
-	addEventListener("scroll", update);
-	addEventListener("load", update);
-	
-	let abortCtrl = new AbortController();
-	let isReceivingData;
-	const icon = document.querySelector('#input-send-icon');
-	const startIcon = 'M16,12l-4-4l-4,4 M12,16V8';
-	const stopIcon = 'M9,9h6v6H9V9z'
-
-	//Load chat by default when the page is loaded.
-	window.addEventListener('DOMContentLoaded', (event) => {
-		const chatBtn = document.querySelector("#chatMenuButton");
-		load(chatBtn ,'chat.htm');
-    });
-
-	function update(event) {
-		event.preventDefault();
-		if (!window.visualViewport) {
-			return;
-		}
-	
-		window.scrollTo(0, 0);
-		document.querySelector(".wrapper").style.height = window.visualViewport.height + "px";
-	}
-	
-	function load(element, filename){
-		let messagesElement = document.querySelector(".messages");
-		fetch(`views/${filename}`)
-			.then((response) => {
-				return response.text();
-			})
-			.then((html) => {
-				messagesElement.innerHTML = html;
-				return  
-			}).then(()=>{
-				/*
-				let messages = document.querySelectorAll(".message-text");
-				messages.forEach(message => {
-					message.contentEditable = true;
-				})
-				*/
-				if(localStorage.getItem("truth")){
-					document.querySelector("#truth")?.remove();
-				}
-				
-				if(filename == "userpost.php"){
-					voteHover();
-				}
-			}
-		);
-		
-		document.querySelector(".menu-item.active")?.classList.remove("active");
-		document.querySelector(".menu-item.open")?.classList.remove("open");
-		document.querySelector(".submenu-item.active")?.classList.remove("active");
-		element.classList.add("active");
-		
-		element.closest(".submenu")?.previousElementSibling.classList.add("open");
-		element.closest(".submenu")?.previousElementSibling.classList.add("active");
-		
-		document.querySelector(".main").scrollIntoView({ behavior: "smooth", block: "end", inline: "nearest" });
-	}
-	
-	function submenu(element){
-		if(element.classList.contains('active')){
-			element.classList.remove("active");
-			element.nextElementSibling.classList.remove("active");
-		}else{
-			document.querySelector(".menu-item.active")?.classList.remove("active");
-			document.querySelector(".submenu.active")?.classList.remove("active");
-			document.querySelector(".menu-item.open")?.classList.remove("open");
-			element.classList.add("active");
-			element.nextElementSibling.classList.add("active");
-		}
-	}
-	
-	function handleKeydown(event){
-		if(event.key == "Enter" && !event.shiftKey){
-			event.preventDefault();
-			request();
-		} 
-	}
-	
-	function handleKeydownUserPost(event){
-		if(event.key == "Enter" && !event.shiftKey){
-			event.preventDefault();
-			send_userpost();
-		} 
-	}
-
-	function OnSendClick(){
-		if(!isReceivingData){
-			request();
-		} else{
-			abortCtrl.abort();
-		}
-	}
-
-	async function request(){
-		const messagesElement = document.querySelector(".messages");
-		const messageTemplate = document.querySelector('#message');
-		const inputField = document.querySelector(".input-field");
-		const inputWrapper = document.querySelector(".input-wrapper");
-
-		if(inputField.value.trim() == ""){
-			return;
-		}
-
-		//handle input-send button.
-		isReceivingData = true;
-		const icon = document.querySelector('#input-send-icon');
-		icon.setAttribute('d', stopIcon)
-
-		let message = {};
-		message.role = "user";
-		//prevent html input to be rendered as html elements.
-		message.content = escapeHTML(inputField.value.trim());
-		inputField.value = "";
-		addMessage(message);
-		resize(inputField);
-		resize(inputWrapper);
-
-		document.querySelector('.limitations')?.remove();
-		
-		const requestObject = {};
-		requestObject.model = 'gpt-4-turbo-preview';
-		requestObject.stream = true;
-		requestObject.messages = [];
-		const messageElements = messagesElement.querySelectorAll(".message");
-		messageElements.forEach(messageElement => {
-			let messageObject = {};
-			messageObject.role = messageElement.dataset.role;
-			messageObject.content = messageElement.querySelector(".message-text").textContent;
-			requestObject.messages.push(messageObject);
-		})
-		
-		postData('stream-api.php', requestObject)
-		.then(stream => processStream(stream))
-		.catch(error => console.error('Error:', error));
-	}
-	
-	async function postData(url = '', data = {}) {
-		try{
-			abortCtrl = new AbortController();
-
-			const response = await fetch(url, {
-				method: 'POST',
-				headers: {
-					'Content-Type': 'application/json'
-				},
-				body: JSON.stringify(data),
-				signal: abortCtrl.signal
-			});
-			return response.body;
-
-		} catch(error){
-			console.log('Fetching Aborted $error');
-		}
-	}
-	
-	async function processStream(stream) {
-		// if fetching is aborted before it's complete the stream will be empty.
-		// stream should be checked to avoid throwing error.
-		if (!stream) {
-			isReceivingData = false;
-			const icon = document.querySelector('#input-send-icon');
-			icon.setAttribute('d', startIcon)
-			return;
-    	}
-
-		const reader = stream.getReader();
-		const messagesElement = document.querySelector(".messages");
-		const messageTemplate = document.querySelector('#message');
-		const messageElement = messageTemplate.content.cloneNode(true);
-		
-		messageElement.querySelector(".message-text").innerHTML = "";
-		messageElement.querySelector(".message").dataset.role = "assistant";
-		messagesElement.appendChild(messageElement);
-		
-		const messageText = messageElement.querySelector(".message-text");
-	
-		// Throws error if the read operation on the response body stream is aborted while the reader.read() operation is still active.
-		// Try Catch block will handle the error.
-		try {
-
-			let incompleteSlice = "";
-			while (true) {
-				const { done, value } = await reader.read();
-
-				if (done) {
-					console.log('Stream closed.');
-					document.querySelector(".message:last-child").querySelector(".message-text").innerHTML = linkify(document.querySelector(".message:last-child").querySelector(".message-text").innerHTML);
-					
-					isReceivingData = false;
-					const icon = document.querySelector('#input-send-icon');
-					icon.setAttribute('d', startIcon)
-					
-					ShowCopyButton();
-
-					break;
-				}
-		
-				//Parsing error from json "Chunks" corrected
-				let decodedData = new TextDecoder().decode(value);
-				decodedData = incompleteSlice + decodedData;
-
-
-				const delimiter = '\n\n';
-				const delimiterPosition = decodedData.lastIndexOf(delimiter);
-				if (delimiterPosition > -1) {
-					incompleteSlice = decodedData.substring(delimiterPosition + delimiter.length);
-					decodedData = decodedData.substring(0,delimiterPosition + delimiter.length);
-				} else {
-					incompleteSlice = decodedData;
-					continue;
-				}
- 				// if (decodedData.slice(-2) != '\n\n') { console.log("missing newline in end of chunk"); }
-                // if (decodedData.slice(-2) != '\n\n') {
-                //      incompleteSlice = decodedData;
-                //      continue;
-                // } else {
-                //      incompleteSlice = "";
-                // }
-				// console.log(decodedData);
-
-				
-				let chunks = decodedData.split("data: ");
-				chunks.forEach((chunk, index) => {
-
-					if(!isJSON(chunk)){
-						return;
-					}
-					if(chunk.indexOf('finish_reason":"stop"') > 0) return false;
-					if(chunk.indexOf('DONE') > 0) return false;
-					if(chunk.indexOf('role') > 0) return false;
-					if(chunk.length == 0) return false;
-					document.querySelector(".message:last-child").querySelector(".message-text").innerHTML +=  escapeHTML(JSON.parse(chunk)["choices"][0]["delta"].content);
-				})
-				let messageTextElement = document.querySelector(".message:last-child").querySelector(".message-text");
-
-				// Check if the content has code block
-				let innerHTML = document.querySelector(".message:last-child").querySelector(".message-text").innerHTML;
-				messageTextElement.innerHTML = ApplyMarkdownFormatting(innerHTML);
-
-				hljs.highlightAll();
-				scrollToLast();
-			}
-		} catch (error) {
-			// Check if the error is due to aborting the request
-			if (error.name == 'AbortError') {
-				console.log('Fetch aborted while reading response body stream.');
-			} else {
-				console.error('Error:', error);
-			}
-			isReceivingData = false;
-			const icon = document.querySelector('#input-send-icon');
-			icon.setAttribute('d', startIcon);
-			ShowCopyButton();
-		}
-	}
-
-	function isJSON(str) {
-		try {
-			JSON.parse(str);
-			return true;
-		} catch (e) {
-			return false;
-		}
-	}
-
-	function ApplyMarkdownFormatting(text) {
-		text = text.replace(/```([\s\S]+?)```/g, '<pre><code>$1</code></pre>')
-		// Bold
-		text = text.replace(/\*\*(.*?)\*\*/g, '<b>$1</b>');
-		text = text.replace(/###\s(.*)$/gm, '<b>$1</b>');
-		// Links
-		text = text.replace(/\[([^\]]+)\]\(([^\)]+)\)/g, '<a href="$2">$1</a>');
-		text = text.replace();
-		return text;
-	}
-
-	function escapeHTML(str) {
-    return str.replace(/&/g, '&amp;')
-              .replace(/</g, '&lt;')
-              .replace(/>/g, '&gt;')
-              .replace(/"/g, '&quot;')
-              .replace(/'/g, '&#039;');
-	}
-
-	function addMessage(message){
-		const messagesElement = document.querySelector(".messages");
-		const messageTemplate = document.querySelector('#message');
-		const inputField = document.querySelector(".input-field");
-		const messageElement = messageTemplate.content.cloneNode(true);
-		
-		messageElement.querySelector(".message-text").innerHTML = message.content;
-		messageElement.querySelector(".message").dataset.role = message.role;
-		
-		if(message.role == "assistant"){
-			messageElement.querySelector(".message-icon").textContent = "AI";
-		}else{
-			messageElement.querySelector(".message-icon").textContent = '<?= $_SESSION['username'] ?>';
-			messageElement.querySelector(".message").classList.add("me");
-		}
-		
-		messagesElement.appendChild(messageElement);
-		
-		scrollToLast(true);
-		return messageElement;
-	}
-	
-	//#region Scrolling Controls
-	//scrolls to the end of the panel.
-	//if new message is send, it forces the panel to scroll down.
-	//if the current message is continuing to expand force expand is false.
-	//(if the user is trying to read the upper parts it wont jump back down.)
-	let isScrolling = false;
-	function scrollToLast(forceScroll){
-		
-		const msgsPanel = document.querySelector('.messages');
-		const documentHeight = msgsPanel.scrollHeight;
-		const currentScroll = msgsPanel.scrollTop + msgsPanel.clientHeight;
-		if (!isScrolling && (forceScroll || documentHeight - currentScroll < 150)) {
-			const messagesElement = document.querySelector(".messages");
-
-			messagesElement.scrollTo({
-				top: messagesElement.scrollHeight,
-				left: 0,
-				behavior: "smooth",
-			});
-		}
-	}
-
-	document.querySelector('.messages').addEventListener('scroll', function() {
-		isScrolling = true;
-	});
-	document.querySelector('.messages').addEventListener('scroll', function() {
-		setTimeout(function() {
-			isScrolling = false;
-		}, 700); // Adjust the threshold
-	});
-	//#endregion
-
-
-	function resize(element) {
-		element.style.height = 'auto';
-		element.style.height = element.scrollHeight + "px";
-		element.scrollTop = element.scrollHeight;
-		element.scrollTo(element.scrollTop, (element.scrollTop + element.scrollHeight));
-	}
-
-	function copyToInput(selector) {
-		const originalText = document.querySelector(selector).textContent;
-		const cleanedText = originalText.split('\n')  // Split text by new lines
-									.map(line => line.trim())  // Remove leading and trailing spaces from each line
-									.filter(line => line !== '')  // Filter out empty lines
-									.join(' ');  // Join lines back together with a single space
-
-		document.querySelector(".input-field").value = cleanedText;
-		resize(document.querySelector(".input-field"));
-	}
-	
-	if(localStorage.getItem("data-protection")){
-		document.querySelector("#data-protection").remove();
-	}
-	
-	function modalClick(element){
-		localStorage.setItem(element.id, "true")
-		element.remove();
-	}
-	
-	
-	async function send_userpost(){
-		const messagesElement = document.querySelector(".messages");
-		const messageTemplate = document.querySelector('#message');
-		const inputField = document.querySelector(".userpost-field");
-		
-		let message = {};
-		message.role = '<?= $_SESSION['username'] ?>';
-		message.content = inputField.value.trim();
-		
-		fetch('userpost.php', {
-			method: 'POST',
-			body: JSON.stringify(message),
-		})
-		.then(response => response.json())
-		.then(data => {
-			console.log(data)
-			load(document.querySelector("#feedback"), 'userpost.php');
-			inputField.value = "";
-		})
-		.catch(error => console.error(error));
-	}
-	
-	async function upvote(element){
-		if(localStorage.getItem(element.dataset.id)){
-			return;
-		}
-		localStorage.setItem(element.dataset.id, "true");
-		fetch('upvote.php', {
-			method: 'POST',
-			body: element.dataset.id,
-		})
-		.then(response => response.text())
-		.then(data => {
-			console.log(data)
-			element.querySelector("span").textContent = parseInt(element.querySelector("span").textContent) + 1;
-		})
-		.catch(error => console.error(error));
-		
-		voteHover();
-	}
-	
-	async function downvote(element){
-		if(localStorage.getItem(element.dataset.id)){
-			return;
-		}
-		localStorage.setItem(element.dataset.id, "true");
-		fetch('downvote.php', {
-			method: 'POST',
-			body: element.dataset.id,
-		})
-		.then(response => response.text())
-		.then(data => {
-			console.log(data)
-			element.querySelector("span").textContent = parseInt(element.querySelector("span").textContent) + 1;
-		})
-		.catch(error => console.error(error));
-		
-		voteHover();
-	}
-	
-	async function voteHover(){
-		let messages = document.querySelectorAll(".message");
-		
-		messages.forEach((message)=>{
-			let voteButtons = message.querySelectorAll(".vote")
-
-			voteButtons.forEach((voteButton)=>{
-				if(localStorage.getItem(voteButton.dataset.id)){
-					voteButton.classList.remove("vote-hover");
-				}else{
-					voteButton.classList.add("vote-hover");
-				}
-			})
-		})
-	}
-	
-	document.querySelectorAll('details').forEach((D,_,A)=>{
-	  	D.ontoggle =_=>{ if(D.open) A.forEach(d =>{ if(d!=D) d.open=false })}
-	})
-	
-	function linkify(htmlString) {
-		const urlRegex = /((https?:\/\/|www\.)[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,6}\b([-a-zA-Z0-9@:%_\+.~#?&//=]*))/g;
-		return htmlString.replace(urlRegex, '<a href="$1" target="_blank">$1</a>');
-	}
-
-
-//#region Copy Button
-
-	function ShowCopyButton() {
-		const copyPanel = document.querySelector(".message:last-child").querySelector(".message-copypanel");
-		if (copyPanel !== null) {
-			copyPanel.style.display = "flex";
-			const copyButton = copyPanel.querySelector(".message-copyButton");
-			copyButton.dataset.clicked = "false"; // Initialize the clicked state for this button
-			AddEventListenersToCopyButton(copyButton);
-		}
-	}
-
-	function AddEventListenersToCopyButton(TargetButton){
-		
-		TargetButton.addEventListener("mouseenter", function() {
-			setTimeout(function() {
-				TargetButton.querySelector(".tooltiptext").classList.add("active");
-			}, 1000);
-		});
-
-		TargetButton.addEventListener("mouseleave", function () {
-			if (TargetButton.dataset.clicked !== "true") { // Check the clicked state of this button
-				TargetButton.querySelector(".tooltiptext").classList.remove("active");
-			}
-    	});
-
-		TargetButton.addEventListener("mousedown", function () {
-			TargetButton.dataset.clicked = "true"; // Set the clicked state of this button to true
-			CopyContentToClipboard(TargetButton);
-		});
-
-		TargetButton.addEventListener("mouseup", function() {
-			CopyBtnRelease(TargetButton);
-		});
-	}
-
-	function CopyContentToClipboard(target) {
-		const msgTxt = target.parentElement.previousElementSibling.textContent;
-		const trimmedMsg = msgTxt.trim();
-		navigator.clipboard.writeText(trimmedMsg);
-
-		target.style.fill = "rgba(35, 48, 176, 1)";
-		target.style.scale = "1.1";
-
-		target.querySelector(".tooltiptext").classList.add("active");
-		target.querySelector(".tooltiptext").innerHTML = "Kopiert!"
-	}
-
-	function CopyBtnRelease(target) {
-		target.style.scale = "1";
-
-		setTimeout(function () {
-			target.style.fill = "rgba(35, 48, 176, .5)";
-
-			target.querySelector(".tooltiptext").classList.remove("active");
-			target.querySelector(".tooltiptext").innerHTML = "Kopieren"
-			target.dataset.clicked = "false"; // Reset the clicked state of this button
-		}, 2000);
-	}
-//#endregion
-</script>
\ No newline at end of file

--- login.php ---
@@ -1,199 +0,0 @@
-<?php
-/*
-	ini_set('display_errors', 1);
-	ini_set('display_startup_errors', 1);
-	error_reporting(E_ALL);
-*/
-  	session_start();
-  	// Redirect user to interface if already logged in
-	if (isset($_SESSION['username'])) {
-		header("Location: interface.php");
-		exit;
-	}
-
-	if (isset($_POST["account"]) && isset($_POST["password"])) {
-		function auth(
-		$username,
-		$password
-		) {
-			// Load LDAP configurations from .env file if exists
-			if (file_exists(".env")){
-				$env = parse_ini_file('.env');
-				$ldap_host = $env['LDAP_HOST'];
-				$ldap_port = $env['LDAP_PORT'];
-				$ldap_binddn = $env['LDAP_BASE_DN'];
-				$ldap_bindpw = $env['LDAP_BIND_PW'];
-				$ldap_base = $env['LDAP_SEARCH_DN'];
-			}
-
-			if (!$username || !$password) {
-				echo "Invalid input.";
-				header("Location: login.php");
-				exit;
-			}
-
-			// *** ACTIVATES TEST ACCESS ***
-			// Please set a unique test username and password in .env
-			if(isset($env['TESTUSER']) && isset($env['TESTPASSWORD']) && $username == $env['TESTUSER'] && $password == $env['TESTPASSWORD']) {
-				$_SESSION['username'] = $env['TESTUSER'];
-				$_SESSION['employeetype'] = "Tester";
-				return true;
-			}
-
-			$ldapConn = ldap_connect($ldap_host, $ldap_port);
-			if (!$ldapConn) {
-				echo "Unable to connect to LDAP server.";
-				header("Location: login.php");
-				exit;
-			}
-
-			if (!ldap_set_option($ldapConn, LDAP_OPT_PROTOCOL_VERSION, 3)) {
-				echo "Unable to set LDAP protocol version.";
-				header("Location: login.php");
-				exit;
-			}
-
-			if (!ldap_bind($ldapConn, $ldap_binddn, $ldap_bindpw)) {
-				echo "Unable to bind to LDAP server with provided DN and password.";
-				header("Location: login.php");
-				exit;
-			}
-
-			$filter = "(|(sAMAccountName=$username)(mail=$username))";
-
-			$sr = ldap_search($ldapConn, $ldap_base, $filter);
-			if (!$sr) {
-				echo "LDAP search failed.";
-				header("Location: login.php");
-				exit;
-			}
-
-			$entryId = ldap_first_entry($ldapConn, $sr);
-			if (!$entryId) {
-				echo "Unable to get the first entry from the search results.";
-				header("Location: login.php");
-				exit;
-			}
-
-			$userDn = ldap_get_dn($ldapConn, $entryId);
-			if (!$userDn) {
-				echo "Unable to get DN from the entry.";
-				header("Location: login.php");
-				exit;
-			}
-
-			$passValid = ldap_bind($ldapConn, $userDn, $password);
-			if (!$passValid) {
-				echo "Unable to bind with provided user DN and password.";
-				header("Location: login.php");
-				exit;
-			}
-
-			$info = ldap_get_entries($ldapConn, $sr);
-
-			ldap_close($ldapConn);
-
-		$name = $info[0]["displayname"][0];
-		$parts = explode(", ", $name);
-		$initials = substr($parts[1], 0, 1) . substr($parts[0], 0, 1);
-		$_SESSION['username'] = $initials;
-		$_SESSION['employeetype'] = $info[0]["employeetype"][0];
-		return true;
-		}
-
-		if (auth($_POST["account"], $_POST["password"])) {
-			header("Location: interface.php");
-			header("Location: login.php");
-		} else {
-			echo "Anmelden fehlgeschlagen";
-		}
-	} else {
-		// Handling for GET request (do nothing)
-	}
-?>
-
-<!DOCTYPE html>
-<html lang="en" >
-	<head>
-		<meta charset="UTF-8">
-		<meta name="viewport" content="width=device-width, initial-scale=1">
-		<title>HAWKI</title>
-
-		<link rel="stylesheet" href="./style.css">
-		<link rel="stylesheet" href="https://sibforms.com/forms/end-form/build/sib-styles.css">
-	</head>
-	<body>
-		<!-- partial:index.partial.html -->
-		<div class="wrapper">
-			<aside>
-				<div class="loginPanel">
-					<img id="HAWK_logo" src="/img/logo.svg" alt="">
-					<h3>Willkommen zurück!</h3>
-					<?php
-						if (file_exists(".env")){
-							$env = parse_ini_file('.env');
-						}
-						$login_available = false;
-						// Check for OIDC authentication method
-						if ((isset($env) ? $env["Authentication"] : getenv("Authentication")) == "OIDC") {
-							// Open ID Connect
-							$login_available = true;
-							$oidc_login = isset($env) ? $env["OIDC_LOGIN_BUTTON"] ??'Login' : getenv("OIDC_LOGIN_BUTTON"); // Option for changing login button
-							echo
-							"<form action='oidc_login.php' class='column' method='post'>
-								<button>$oidc_login</button>
-							</form>";
-						}
-						// Check for LDAP authentication method
-						if ((isset($env) ? $env["Authentication"] : getenv("Authentication")) == "LDAP") {
-							$login_available = true;
-							$server = $_SERVER['PHP_SELF'];
-							$ldap_login = isset($env) ? $env["LDAP_LOGIN_BUTTON"] ??'Login' : getenv("LDAP_LOGIN_BUTTON");
-							echo
-								'<form action = "' . $server . '" class="column" method = "post" >
-								<label for="account" > Benutzername</label >
-								<input type = "text" name = "account" id = "account" >
-								<label for="password" > Kennwort</label >
-								<input type = "password" name = "password" id = "password" >
-								<button>' . $ldap_login . '</button >
-							</form>';
-						}
-						// If no authentication method defined, display error
-						if (!$login_available) {
-							echo 'No authentication method defined';
-							die;
-						}
-					?>
-				</div>
-			</aside>
-			<main>
-				<div class="infoPanel">
-					<div class="textPanel">
-						<div class="page">
-							<h1 class="headerLine"><span class="accentText">GPT</span> FÜR DIE HOCHSCHULE</h1>
-							<p>
-								HAWKI ist ein didaktisches Interface für Hochschulen, das auf der API von OpenAI basiert. Für die Nutzerinnen und Nutzer ist es nicht notwendig, einen Account anzulegen, die Hochschul-ID reicht für den Login aus - es werden keine nutzerbezogenen Daten gespeichert.<br>
-								Das Angebot wurde im Interaction Design Lab der <a href="https://www.hawk.de/de/hochschule/fakultaeten-und-standorte/fakultaet-gestaltung/werkstaetten/interaction-design-lab" target="_blank"><b>HAWK</b></a>  entwickelt, um allen Hochschulangehörigen die Möglichkeit zu geben, Künstliche Intelligenz in ihre Arbeitsprozesse zu integrieren und einen Begegnungsraum zu haben, damit sich eventuell neue Arbeitsweisen ergeben und eine hochschulinterne Diskussion über den Einsatz von K.I. entstehen kann. Derzeit ist die Oberfläche in drei Bereiche unterteilt:<br>
-							</p>
-
-							<h3>Konversation</h3>
-							<p>Ein Chatbereich wie bei ChatGPT, für einen schnellen Einstieg in jede beliebige Aufgabe.<br>
-							</p>
-
-							<h3>Virtuelles Büro</h3>
-							<p>Gespräche mit fiktiven Expertinnen und Experten als mentales Modell, um sich in fachfremde Bereiche einzuarbeiten und gezieltere Anfragen an echte Hochschul-Expertinnen und -Experten zu stellen.
-							</p>
-
-							<h3>Lernraum</h3>
-							<p>Die Lernräume sollen helfen, die verschiedenen Unterstützungsmöglichkeiten zu verstehen und zu lernen, was einen effektiven Prompt ausmacht.<br><br>
-							</p>
-						</div>
-					</div>
-				</div>
-				<div class="backgroundImageContainer">
-					<video class="image_preview_container" src="./img/HAWKIBG.m4v" type="video/m4v" autoplay loop muted></video>
-				</div>
-			</main>
-		</div>
-	</body>
-</html>

--- logo.svg ---
@@ -1,16 +0,0 @@
- <svg class="primary-menu__logo is-international" viewBox="0 0 529 155" preserveAspectRatio="xMidYMid meet" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
-  <g stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
-	<g class="logo-simple">
-	  <polygon class="logo-background-color" fill="#3B3D40" points="0 78 175 78 175 0 0 0"></polygon>
-	  <path d="M20.9155181,41.6974087 L39.6124586,41.6974087 L39.6124586,65 L47.5245486,65 L47.5245486,14 L39.6124586,14 L39.6124586,34.3750255 L20.9155181,34.3750255 L20.9155181,14 L13,14 L13,65 L20.9155181,65 L20.9155181,41.6974087 Z M63.9932142,14 L49.7528235,65 L58.3848177,65 L63.6812557,46.0193838 L75.9779051,46.0193838 L74.2364226,38.7351561 L65.7106999,38.7351561 L72.6252084,14 L63.9932142,14 Z M73.3416845,14 L85.641762,65 L94.2737561,65 L103.995891,23.6706795 L113.694029,65 L122.322595,65 L134.622673,14 L125.990678,14 L117.900326,54.8853295 L108.298176,14 L99.6661814,14 L90.0811712,54.8853295 L81.9702505,14 L73.3416845,14 Z M133.82735,38.7386248 L149.65153,65 L159,65 L143.179248,38.7455621 L158.646904,14 L149.291578,14 L133.82735,38.7386248 Z" class="logo-foreground-color" fill="#FFFFFF"></path>
-	</g>
-	  <g class="logo-extended">
-		<path d="M181.270582,52 L335.239773,52 L335.239773,84.4989224 L181.270582,84.4989224 L181.270582,52 Z M41,84.4989224 L529,84.4989224 L529,116.997845 L41,116.997845 L41,84.4989224 Z M116.030865,156 L116.030865,123.501078 L485.294582,123.501078 L485.294582,156 L116.030865,156 Z" class="logo-background-color" fill="#3B3D40"></path>
-		<g transform="translate(49.000000, 59.000000)" class="logo-foreground-color" fill="#FFFFFF">
-		  <path d="M151.329618,16.7780128 L151.329618,0.887985882 L148.070406,0.887985882 L148.070406,7.06037244 L143.478508,7.06037244 L143.478508,0.887985882 L140.288347,0.887985882 L140.288347,16.7780128 L143.478508,16.7780128 L143.478508,9.68750521 L148.070406,9.68750521 L148.070406,16.7780128 L151.329618,16.7780128 Z M168.088318,8.75562958 C168.088318,3.7661405 165.474734,0.678227899 161.228092,0.678227899 C160.030055,0.678227899 158.859639,0.953320336 157.920545,1.45880269 C155.624596,2.71047328 154.316077,5.45795899 154.316077,8.88973714 C154.316077,11.2245842 154.937537,13.2361976 156.152836,14.7904699 C157.368136,16.3653741 158.928691,17.025596 161.342026,17.025596 C162.674712,17.025596 163.568924,16.8227153 164.532187,16.2931624 C166.848851,15.0414918 168.088318,12.3455859 168.088318,8.75562958 L168.088318,8.75562958 Z M164.394085,8.84159597 C164.394085,12.8923321 163.45499,14.5807119 161.228092,14.5807119 C160.46853,14.5807119 159.822902,14.4019018 159.318829,14.0374044 C158.355566,13.3496733 157.896377,11.6337842 157.896377,8.88973714 C157.896377,6.96409008 158.148413,5.57143462 158.700822,4.53983798 C159.160012,3.69392874 160.099107,3.15062118 161.179756,3.15062118 C162.881866,3.15062118 163.731194,4.3610279 163.983231,5.16223462 C164.259435,6.05284639 164.394085,7.21855059 164.394085,8.84159597 L164.394085,8.84159597 Z M181.957231,15.5641674 L180.48299,13.5559926 C179.547347,14.3056195 178.698019,14.5807119 177.752019,14.5807119 C176.377902,14.5807119 175.32142,13.9686313 174.679245,12.8029271 C174.195888,11.9329472 174.00945,10.7156632 174.00945,8.5458716 C174.00945,6.68899765 174.285654,5.36855395 174.910566,4.4538716 C175.483691,3.60796235 176.540172,3.08184807 177.617369,3.08184807 C178.515034,3.08184807 179.364362,3.37757244 180.165355,3.96902118 L181.611975,1.80266824 C180.741931,1.04616403 179.157209,0.540681681 177.572486,0.540681681 C174.99688,0.540681681 172.704384,1.91614387 171.468369,4.22348168 C170.732975,5.59550521 170.38772,7.17384807 170.38772,9.16482958 C170.38772,11.4996766 171.029895,13.4150077 172.314245,14.8558044 C173.622764,16.3447422 175.32142,17.0531052 177.527603,17.0531052 C179.336742,17.0531052 180.693596,16.5923254 181.957231,15.5641674 L181.957231,15.5641674 Z M195.801975,16.7780128 L195.801975,0.887985882 L192.542764,0.887985882 L192.542764,7.06037244 L187.947413,7.06037244 L187.947413,0.887985882 L184.760705,0.887985882 L184.760705,16.7780128 L187.947413,16.7780128 L187.947413,9.68750521 L192.542764,9.68750521 L192.542764,16.7780128 L195.801975,16.7780128 Z M210.589267,11.7713304 C210.589267,9.41241277 209.163362,7.74810353 206.549778,7.03630185 L204.6198,6.51018756 C203.287114,6.14225143 202.852092,5.73305143 202.852092,4.91121277 C202.852092,3.83147496 203.767019,3.08184807 205.075537,3.08184807 C206.273574,3.08184807 207.354223,3.4188363 208.797391,4.29225479 L210.313063,2.00554891 C208.911326,1.00146151 206.936464,0.403135462 204.985771,0.403135462 C201.609172,0.403135462 199.271793,2.41474891 199.271793,5.32041277 C199.271793,6.21446319 199.499661,7.03630185 199.938136,7.74810353 C200.507807,8.70404975 201.495238,9.32644639 203.079961,9.75971697 L204.847669,10.2411287 C206.273574,10.6296968 206.936464,11.2658481 206.936464,12.2940061 C206.936464,13.7141708 205.973201,14.470675 204.136442,14.470675 C202.527552,14.470675 201.243201,13.9686313 199.751698,13.1914951 L198.560566,15.6810817 C200.166004,16.5923254 202.182296,17.1218783 203.99834,17.1218783 C207.968778,17.1218783 210.589267,14.9933506 210.589267,11.7713304 L210.589267,11.7713304 Z M224.219953,15.5641674 L222.752618,13.5559926 C221.813523,14.3056195 220.964194,14.5807119 220.021647,14.5807119 C218.644077,14.5807119 217.584143,13.9686313 216.94542,12.8029271 C216.462063,11.9329472 216.279077,10.7156632 216.279077,8.5458716 C216.279077,6.68899765 216.555282,5.36855395 217.173289,4.4538716 C217.746413,3.60796235 218.806347,3.08184807 219.880092,3.08184807 C220.781209,3.08184807 221.627085,3.37757244 222.43153,3.96902118 L223.87815,1.80266824 C223.008107,1.04616403 221.423384,0.540681681 219.838661,0.540681681 C217.266508,0.540681681 214.974012,1.91614387 213.734545,4.22348168 C212.99915,5.59550521 212.657347,7.17384807 212.657347,9.16482958 C212.657347,11.4996766 213.29607,13.4150077 214.58042,14.8558044 C215.892391,16.3447422 217.584143,17.0531052 219.793778,17.0531052 C221.602917,17.0531052 222.959771,16.5923254 224.219953,15.5641674 L224.219953,15.5641674 Z M237.608961,16.7780128 L237.608961,0.887985882 L234.353201,0.887985882 L234.353201,7.06037244 L229.757851,7.06037244 L229.757851,0.887985882 L226.571143,0.887985882 L226.571143,16.7780128 L229.757851,16.7780128 L229.757851,9.68750521 L234.353201,9.68750521 L234.353201,16.7780128 L237.608961,16.7780128 Z M252.71734,11.585643 L252.71734,0.887985882 L249.458128,0.887985882 L249.458128,11.0629674 C249.458128,11.9088766 249.458128,12.1358279 249.413245,12.4796934 C249.275143,13.6488363 248.377479,14.3331287 246.979194,14.3331287 C245.91926,14.3331287 245.16315,13.9445607 244.790274,13.2361976 C244.610742,12.8923321 244.520975,12.3215153 244.520975,11.3380598 L244.520975,0.887985882 L241.237596,0.887985882 L241.237596,11.9570178 C241.237596,13.4872195 241.399866,14.1268094 241.928107,14.9520867 C242.822318,16.3447422 244.610742,17.0737371 247.048245,17.0737371 C250.490442,17.0737371 252.050997,15.3406548 252.465304,14.0821069 C252.68972,13.3943758 252.71734,13.0986514 252.71734,11.585643 L252.71734,11.585643 Z M265.33988,14.1268094 L259.625902,14.1268094 L259.625902,0.887985882 L256.345975,0.887985882 L256.345975,16.7780128 L264.766756,16.7780128 L265.33988,14.1268094 Z M276.823077,16.7780128 L276.823077,14.0374044 L270.784559,14.0374044 L270.784559,9.78034891 L275.307406,9.78034891 L275.307406,7.17728672 L270.784559,7.17728672 L270.784559,3.49104807 L276.20507,3.49104807 L276.615924,0.887985882 L267.525347,0.887985882 L267.525347,16.7780128 L276.823077,16.7780128 Z"></path>
-		  <path d="M86.4578401,88.0799092 L86.4578401,72.1898824 L83.1986285,72.1898824 L83.1986285,78.3622689 L78.6067307,78.3622689 L78.6067307,72.1898824 L75.4165701,72.1898824 L75.4165701,88.0799092 L78.6067307,88.0799092 L78.6067307,80.9894017 L83.1986285,80.9894017 L83.1986285,88.0799092 L86.4578401,88.0799092 Z M92.9797161,88.0799092 L92.9797161,76.096195 L89.9034898,76.5776067 L89.9034898,88.0799092 L92.9797161,88.0799092 Z M93.3456869,73.1492672 C93.3456869,72.0970387 92.5205263,71.2476908 91.4882124,71.2476908 C90.4317307,71.2476908 89.5582343,72.0970387 89.5582343,73.1492672 C89.5582343,74.1980571 90.4075628,75.047405 91.4433292,75.047405 C92.4963584,75.047405 93.3456869,74.1980571 93.3456869,73.1492672 L93.3456869,73.1492672 Z M101.151913,88.0352067 L100.623672,86.205842 C100.464855,86.2505445 100.395804,86.2505445 100.278417,86.2505445 C100.02638,86.2505445 99.7743438,86.1370689 99.6604095,85.9307496 C99.4774241,85.6109546 99.4532562,85.3358622 99.4532562,83.3242487 L99.4532562,74.2014958 C99.4532562,72.5509412 99.408373,71.8013143 99.2909861,71.1617244 L96.1491613,71.8700874 C96.2630956,72.922316 96.3114314,73.8576303 96.3114314,75.3912706 L96.3114314,84.1254555 C96.3114314,85.7932034 96.3563146,86.1542622 96.5841832,86.7525882 C96.9536066,87.732605 98.0100883,88.3550017 99.315154,88.3550017 C99.9814971,88.3550017 100.623672,88.2415261 101.151913,88.0352067 L101.151913,88.0352067 Z M112.814643,88.0799092 C112.60749,87.6225681 112.379621,86.6838151 112.379621,83.8022218 L112.379621,71.6396975 L109.327563,71.1617244 L109.327563,75.1849513 C109.327563,75.8726824 109.372446,76.6704504 109.420782,76.9214723 C108.844205,76.4641311 108.181315,76.2578118 107.328534,76.2578118 C104.342074,76.2578118 102.301614,78.7714689 102.301614,82.4267597 C102.301614,86.0682958 104.183256,88.3756336 107.166264,88.3756336 C108.226198,88.3756336 109.120409,88.0558387 109.879972,87.3956168 C109.924855,87.7154118 109.969738,87.8976605 110.062957,88.0799092 L112.814643,88.0799092 Z M109.372446,85.0401378 C109.075526,85.4080739 108.433351,85.796642 107.856774,85.796642 C106.247884,85.796642 105.719643,84.9713647 105.719643,82.4577076 C105.719643,79.8443294 106.316935,78.7026958 107.697957,78.7026958 C108.250366,78.7026958 108.799322,78.9571563 109.372446,79.4592 L109.372446,85.0401378 Z M125.25765,83.1867025 L125.25765,82.4783395 C125.25765,80.0334555 124.777745,78.4516739 123.697096,77.3581815 C122.940986,76.5810454 121.653183,76.1202655 120.299782,76.1202655 C118.739227,76.1202655 117.568811,76.6257479 116.602096,77.6951697 C115.573234,78.8368034 115.138212,80.2397748 115.138212,82.3407933 C115.138212,86.0201546 117.316774,88.3997042 120.68992,88.3997042 C122.343694,88.3997042 123.766147,87.8701513 125.123001,86.7800975 L123.928417,84.9507328 C122.985869,85.7244303 121.998439,86.116437 120.941957,86.116437 C119.357234,86.116437 118.463023,85.088279 118.463023,83.2795462 L118.463023,83.1867025 L125.25765,83.1867025 Z M122.06749,80.9481378 L118.507906,80.9481378 L118.507906,80.9034353 C118.507906,79.2735126 119.174249,78.3622689 120.344665,78.3622689 C120.966125,78.3622689 121.401147,78.5892202 121.701519,79.0465613 C121.977723,79.4832706 122.06749,79.9406118 122.06749,80.8105916 L122.06749,80.9481378 Z M136.761563,84.3764773 C136.761563,83.5993412 136.554409,82.9356807 136.119388,82.3889345 C135.705081,81.8593815 135.225176,81.4226723 133.778555,81.0581748 L132.35265,80.6936773 C131.275453,80.4151462 130.885315,80.0987899 130.885315,79.5039025 C130.885315,78.8196101 131.482607,78.3622689 132.380271,78.3622689 C133.250315,78.3622689 134.099643,78.6132908 135.270059,79.2081782 L136.281658,77.1518622 C135.201008,76.6257479 133.964993,76.0549311 132.079899,76.0549311 C129.345475,76.0549311 127.536336,77.5851328 127.536336,79.8718387 C127.536336,80.6249042 127.788373,81.4742521 128.199227,81.9762958 C128.613534,82.4783395 129.576796,83.0285244 130.357074,83.1660706 L131.734643,83.4170924 C132.977563,83.6474824 133.550687,84.0566824 133.550687,84.8578891 C133.550687,85.6109546 132.860176,86.1852101 131.98668,86.1852101 C130.653993,86.1852101 129.024388,85.4287059 128.085293,84.8578891 L126.983928,87.0998924 C128.706753,87.9870655 130.288023,88.4409681 131.734643,88.4409681 C134.745271,88.4409681 136.761563,86.8007294 136.761563,84.3764773 L136.761563,84.3764773 Z M148.931818,88.0799092 L148.931818,79.8924706 C148.931818,78.7714689 148.862767,78.3829008 148.631446,77.722679 C148.265475,76.6910824 147.074344,76.0549311 145.579388,76.0549311 C144.388256,76.0549311 143.052118,76.5535361 142.251125,77.313479 C142.251125,77.1759328 142.296008,76.6910824 142.296008,76.3300235 L142.296008,73.9951765 C142.296008,72.8741748 142.226957,71.7772437 142.088855,71.1376538 L138.94703,71.8700874 C139.08168,72.3480605 139.174899,73.4484303 139.174899,74.5419227 L139.174899,88.0799092 L142.296008,88.0799092 L142.296008,79.6861513 C142.983066,79.0706319 143.970497,78.6132908 144.730059,78.6132908 C145.603555,78.6132908 145.924643,79.0465613 145.924643,80.2122655 L145.924643,88.0799092 L148.931818,88.0799092 Z M161.350658,83.1867025 L161.350658,82.4783395 C161.350658,80.0334555 160.870753,78.4516739 159.790103,77.3581815 C159.033993,76.5810454 157.746191,76.1202655 156.392789,76.1202655 C154.832234,76.1202655 153.661818,76.6257479 152.698555,77.6951697 C151.666242,78.8368034 151.227767,80.2397748 151.227767,82.3407933 C151.227767,86.0201546 153.406329,88.3997042 156.782928,88.3997042 C158.436701,88.3997042 159.859154,87.8701513 161.212555,86.7800975 L160.021424,84.9507328 C159.078877,85.7244303 158.091446,86.116437 157.034964,86.116437 C155.450242,86.116437 154.55603,85.088279 154.55603,83.2795462 L154.55603,83.1867025 L161.350658,83.1867025 Z M158.160497,80.9481378 L154.600913,80.9481378 L154.600913,80.9034353 C154.600913,79.2735126 155.267256,78.3622689 156.437672,78.3622689 C157.059132,78.3622689 157.494154,78.5892202 157.794526,79.0465613 C158.067278,79.4832706 158.160497,79.9406118 158.160497,80.8105916 L158.160497,80.9481378 Z M167.299409,88.0799092 L167.299409,76.096195 L164.223183,76.5776067 L164.223183,88.0799092 L167.299409,88.0799092 Z M167.66538,73.1492672 C167.66538,72.0970387 166.84022,71.2476908 165.804453,71.2476908 C164.751424,71.2476908 163.877928,72.0970387 163.877928,73.1492672 C163.877928,74.1980571 164.730709,75.047405 165.75957,75.047405 C166.816052,75.047405 167.66538,74.1980571 167.66538,73.1492672 L167.66538,73.1492672 Z M185.736052,88.0799092 L185.736052,79.7549244 C185.736052,78.1559496 185.528899,77.4716571 184.859103,76.9008403 C184.334315,76.4434992 183.464271,76.1684067 182.545891,76.1684067 C181.258088,76.1684067 180.294826,76.6016773 179.214176,77.6951697 C179.076074,77.4957277 178.917256,77.2894084 178.754986,77.1243529 C178.133526,76.4882017 177.332534,76.1684067 176.369271,76.1684067 C175.288621,76.1684067 174.301191,76.5810454 173.493293,77.3581815 C173.382811,76.7632941 173.289592,76.4882017 173.082439,76.1684067 L170.306585,76.9214723 C170.631125,77.4957277 170.745059,78.2247227 170.745059,79.9165412 L170.745059,88.0799092 L173.748782,88.0799092 L173.748782,79.5520437 C174.415125,78.9571563 175.195402,78.6579933 175.771979,78.6579933 C176.621307,78.6579933 176.828461,78.9984202 176.828461,80.4667261 L176.828461,88.0799092 L179.742417,88.0799092 L179.742417,79.6655193 C180.40876,79.0706319 181.213205,78.6820639 181.786329,78.6820639 C182.590774,78.6820639 182.753045,78.9571563 182.753045,80.3498118 L182.753045,88.0799092 L185.736052,88.0799092 Z M196.659935,70.6115395 L194.640191,70.6115395 L188.491191,91.5976538 L190.510935,91.5976538 L196.659935,70.6115395 Z M210.463249,88.0799092 L210.463249,72.1898824 L207.204037,72.1898824 L207.204037,78.3622689 L202.608687,78.3622689 L202.608687,72.1898824 L199.421979,72.1898824 L199.421979,88.0799092 L202.608687,88.0799092 L202.608687,80.9894017 L207.204037,80.9894017 L207.204037,88.0799092 L210.463249,88.0799092 Z M223.731417,82.1826151 C223.731417,80.2776 223.320563,78.9984202 222.378015,77.9049277 C221.369869,76.7185916 220.061351,76.1443361 218.379957,76.1443361 C215.210512,76.1443361 213.104453,78.5892202 213.104453,82.2754588 C213.104453,85.9548202 215.193249,88.3309311 218.379957,88.3309311 C220.199453,88.3309311 221.369869,87.7154118 222.260628,86.7113244 C223.268774,85.5662521 223.731417,84.1942286 223.731417,82.1826151 L223.731417,82.1826151 Z M220.382439,82.1551059 C220.382439,84.9266622 219.809315,86.116437 218.476628,86.116437 C217.879336,86.116437 217.188826,85.796642 216.912621,85.1501748 C216.660585,84.5621647 216.522482,83.5546387 216.522482,82.2066857 C216.522482,81.0375429 216.639869,80.2122655 216.84357,79.5967462 C217.099059,78.8643126 217.692899,78.4069714 218.428293,78.4069714 C218.980701,78.4069714 219.464059,78.6373613 219.764431,79.0259294 C220.175285,79.5520437 220.382439,80.576763 220.382439,82.1551059 L220.382439,82.1551059 Z M230.643431,88.0352067 L230.115191,86.205842 C229.956373,86.2505445 229.883869,86.2505445 229.769935,86.2505445 C229.517899,86.2505445 229.265862,86.1370689 229.151928,85.9307496 C228.968942,85.6109546 228.944774,85.3358622 228.944774,83.3242487 L228.944774,74.2014958 C228.944774,72.5509412 228.899891,71.8013143 228.782504,71.1617244 L225.64068,71.8700874 C225.754614,72.922316 225.80295,73.8576303 225.80295,75.3912706 L225.80295,84.1254555 C225.80295,85.7932034 225.847833,86.1542622 226.075701,86.7525882 C226.445125,87.732605 227.498154,88.3550017 228.806672,88.3550017 C229.473015,88.3550017 230.115191,88.2415261 230.643431,88.0352067 L230.643431,88.0352067 Z M241.757205,85.9548202 L236.357409,85.9548202 L241.550052,78.4757445 L241.550052,76.3747261 L232.825446,76.3747261 L232.825446,78.5204471 L237.897249,78.5204471 L232.366256,86.1852101 L232.366256,88.0799092 L241.021811,88.0799092 L241.757205,85.9548202 Z M259.272015,88.0799092 L259.272015,79.7549244 C259.272015,78.1559496 259.068315,77.4716571 258.401972,76.9008403 C257.873731,76.4434992 257.000234,76.1684067 256.085307,76.1684067 C254.797504,76.1684067 253.834242,76.6016773 252.753592,77.6951697 C252.612037,77.4957277 252.45322,77.2894084 252.294402,77.1243529 C251.672942,76.4882017 250.87195,76.1684067 249.908687,76.1684067 C248.828037,76.1684067 247.840607,76.5810454 247.036161,77.3581815 C246.922227,76.7632941 246.829008,76.4882017 246.621855,76.1684067 L243.842548,76.9214723 C244.170541,77.4957277 244.284475,78.2247227 244.284475,79.9165412 L244.284475,88.0799092 L247.288198,88.0799092 L247.288198,79.5520437 C247.954541,78.9571563 248.731366,78.6579933 249.30449,78.6579933 C250.160723,78.6579933 250.367877,78.9984202 250.367877,80.4667261 L250.367877,88.0799092 L253.27838,88.0799092 L253.27838,79.6655193 C253.948176,79.0706319 254.752621,78.6820639 255.325745,78.6820639 C256.130191,78.6820639 256.292461,78.9571563 256.292461,80.3498118 L256.292461,88.0799092 L259.272015,88.0799092 Z M265.793891,88.0799092 L265.793891,76.096195 L262.721118,76.5776067 L262.721118,88.0799092 L265.793891,88.0799092 Z M266.159862,73.1492672 C266.159862,72.0970387 265.334701,71.2476908 264.302388,71.2476908 C263.245906,71.2476908 262.375862,72.0970387 262.375862,73.1492672 C262.375862,74.1980571 263.221738,75.047405 264.257504,75.047405 C265.310534,75.047405 266.159862,74.1980571 266.159862,73.1492672 L266.159862,73.1492672 Z M278.50965,88.0799092 L278.50965,79.5279731 C278.50965,78.7955395 278.444052,78.2934958 278.281782,77.8533479 C277.915811,76.8526992 276.769563,76.1684067 275.461045,76.1684067 C274.767081,76.1684067 273.969541,76.3506555 273.348081,76.6704504 C272.844008,76.9455429 272.450417,77.2206353 271.991227,77.5404303 C271.991227,77.0590185 271.832409,76.5535361 271.556205,76.075563 L268.828687,76.8526992 C269.101439,77.6332739 269.239541,78.5926588 269.239541,79.6001849 L269.239541,88.0799092 L272.312315,88.0799092 L272.312315,79.8030655 C273.026993,79.1634756 273.831439,78.750837 274.449446,78.750837 C275.257344,78.750837 275.485212,79.1359664 275.485212,80.4667261 L275.485212,88.0799092 L278.50965,88.0799092 Z M291.094212,88.0799092 C290.883607,87.6225681 290.655738,86.6838151 290.655738,83.8022218 L290.655738,71.6396975 L287.607132,71.1617244 L287.607132,75.1849513 C287.607132,75.8726824 287.652015,76.6704504 287.696899,76.9214723 C287.123774,76.4641311 286.457431,76.2578118 285.608103,76.2578118 C282.625096,76.2578118 280.581183,78.7714689 280.581183,82.4267597 C280.581183,86.0682958 282.462826,88.3756336 285.449285,88.3756336 C286.502315,88.3756336 287.399979,88.0558387 288.152636,87.3956168 C288.204424,87.7154118 288.249307,87.8976605 288.339074,88.0799092 L291.094212,88.0799092 Z M287.652015,85.0401378 C287.355096,85.4080739 286.706015,85.796642 286.132891,85.796642 C284.527453,85.796642 283.999212,84.9713647 283.999212,82.4577076 C283.999212,79.8443294 284.596504,78.7026958 285.977526,78.7026958 C286.526482,78.7026958 287.078891,78.9571563 287.652015,79.4592 L287.652015,85.0401378 Z M303.07803,83.1867025 L303.07803,82.4783395 C303.07803,80.0334555 302.594672,78.4516739 301.517475,77.3581815 C300.757913,76.5810454 299.473563,76.1202655 298.120161,76.1202655 C296.556154,76.1202655 295.385738,76.6257479 294.425928,77.6951697 C293.390161,78.8368034 292.955139,80.2397748 292.955139,82.3407933 C292.955139,86.0201546 295.137154,88.3997042 298.506847,88.3997042 C300.164074,88.3997042 301.586526,87.8701513 302.939928,86.7800975 L301.745344,84.9507328 C300.802796,85.7244303 299.818818,86.116437 298.762336,86.116437 C297.177614,86.116437 296.283402,85.088279 296.283402,83.2795462 L296.283402,83.1867025 L303.07803,83.1867025 Z M299.887869,80.9481378 L296.328285,80.9481378 L296.328285,80.9034353 C296.328285,79.2735126 296.994628,78.3622689 298.165045,78.3622689 C298.786504,78.3622689 299.221526,78.5892202 299.514993,79.0465613 C299.79465,79.4832706 299.887869,79.9406118 299.887869,80.8105916 L299.887869,80.9481378 Z M314.761475,88.0799092 L314.761475,79.5279731 C314.761475,78.7955395 314.695877,78.2934958 314.533607,77.8533479 C314.167636,76.8526992 313.021388,76.1684067 311.712869,76.1684067 C311.022358,76.1684067 310.221366,76.3506555 309.599906,76.6704504 C309.09238,76.9455429 308.702242,77.2206353 308.243052,77.5404303 C308.243052,77.0590185 308.084234,76.5535361 307.80803,76.075563 L305.077059,76.8526992 C305.353264,77.6332739 305.491366,78.5926588 305.491366,79.6001849 L305.491366,88.0799092 L308.564139,88.0799092 L308.564139,79.8030655 C309.278818,79.1634756 310.083264,78.750837 310.704723,78.750837 C311.505716,78.750837 311.737037,79.1359664 311.737037,80.4667261 L311.737037,88.0799092 L314.761475,88.0799092 Z M325.692264,70.6115395 L323.675972,70.6115395 L317.523519,91.5976538 L319.543264,91.5976538 L325.692264,70.6115395 Z M340.203351,86.8488706 L340.203351,79.2563193 L334.026731,79.2563193 L334.44449,81.8559429 L336.878541,81.8559429 L336.878541,85.4768471 C336.3503,85.7485008 335.773723,85.8619765 335.062497,85.8619765 C334.026731,85.8619765 333.156687,85.5456202 332.559395,84.9713647 C331.75495,84.1735966 331.364811,82.7052908 331.364811,80.4460941 C331.364811,78.0665445 331.641015,76.3506555 332.718212,75.3190588 C333.270621,74.7929445 334.075066,74.5212908 335.017614,74.5212908 C336.232913,74.5212908 337.313563,74.9098588 338.345877,75.7557681 L340.044534,73.7647866 C338.639344,72.5509412 336.899256,71.9388605 334.972731,71.9388605 C333.453607,71.9388605 332.259023,72.2827261 331.088607,73.0598622 C328.861709,74.538484 327.763796,76.9214723 327.763796,80.2810387 C327.763796,82.6605882 328.285132,84.3558454 329.462453,85.8413445 C330.743351,87.4850218 332.511059,88.262158 334.900227,88.262158 C336.785322,88.262158 338.577198,87.8048168 340.203351,86.8488706 L340.203351,86.8488706 Z M353.24365,82.1826151 C353.24365,80.2776 352.832796,78.9984202 351.890249,77.9049277 C350.882103,76.7185916 349.570132,76.1443361 347.895643,76.1443361 C344.726198,76.1443361 342.616687,78.5892202 342.616687,82.2754588 C342.616687,85.9548202 344.705482,88.3309311 347.895643,88.3309311 C349.711687,88.3309311 350.882103,87.7154118 351.776315,86.7113244 C352.784461,85.5662521 353.24365,84.1942286 353.24365,82.1826151 L353.24365,82.1826151 Z M349.894672,82.1551059 C349.894672,84.9266622 349.321548,86.116437 347.985409,86.116437 C347.39157,86.116437 346.697607,85.796642 346.424855,85.1501748 C346.172818,84.5621647 346.034716,83.5546387 346.034716,82.2066857 C346.034716,81.0375429 346.14865,80.2122655 346.355804,79.5967462 C346.60784,78.8643126 347.205132,78.4069714 347.940526,78.4069714 C348.492935,78.4069714 348.976293,78.6373613 349.276665,79.0259294 C349.687519,79.5520437 349.894672,80.576763 349.894672,82.1551059 L349.894672,82.1551059 Z M347.253468,73.5584672 C347.253468,72.602521 346.473191,71.8013143 345.530643,71.8013143 C344.56738,71.8013143 343.738767,72.602521 343.738767,73.5584672 C343.738767,74.5212908 344.53976,75.3190588 345.48576,75.3190588 C346.449023,75.3190588 347.253468,74.5212908 347.253468,73.5584672 L347.253468,73.5584672 Z M352.097402,73.5584672 C352.097402,72.602521 351.317125,71.8013143 350.374577,71.8013143 C349.411315,71.8013143 348.582701,72.602521 348.582701,73.5584672 C348.582701,74.5212908 349.387147,75.3190588 350.329694,75.3190588 C351.292957,75.3190588 352.097402,74.5212908 352.097402,73.5584672 L352.097402,73.5584672 Z M361.764555,87.8288874 L361.367512,86.0029613 C360.822008,86.1577008 360.545804,86.2299126 360.269599,86.2299126 C359.209665,86.2299126 358.940366,85.8413445 358.940366,84.3558454 L358.940366,78.4757445 L360.911774,78.4757445 L361.695504,76.3747261 L358.940366,76.3747261 C358.940366,75.1849513 359.005964,73.9057714 359.123351,72.8260336 L356.002242,73.6066084 C355.888307,74.4765882 355.888307,75.2296538 355.888307,76.3747261 L354.717891,76.3747261 L354.717891,78.4757445 L355.888307,78.4757445 L355.888307,84.8338185 C355.888307,85.9101176 355.90557,86.1370689 356.095461,86.6425513 C356.461431,87.6672706 357.697446,88.3550017 359.261453,88.3550017 C360.062446,88.3550017 360.866891,88.1933849 361.764555,87.8288874 L361.764555,87.8288874 Z M370.282008,87.8288874 L369.891869,86.0029613 C369.339461,86.1577008 369.063256,86.2299126 368.787052,86.2299126 C367.734023,86.2299126 367.457818,85.8413445 367.457818,84.3558454 L367.457818,78.4757445 L369.429227,78.4757445 L370.212957,76.3747261 L367.457818,76.3747261 C367.457818,75.1849513 367.526869,73.9057714 367.640804,72.8260336 L364.519694,73.6066084 C364.40576,74.4765882 364.40576,75.2296538 364.40576,76.3747261 L363.235344,76.3747261 L363.235344,78.4757445 L364.40576,78.4757445 L364.40576,84.8338185 C364.40576,85.9101176 364.429928,86.1370689 364.612913,86.6425513 C364.978884,87.6672706 366.218351,88.3550017 367.778906,88.3550017 C368.583351,88.3550017 369.384344,88.1933849 370.282008,87.8288874 L370.282008,87.8288874 Z M376.113373,88.0799092 L376.113373,76.096195 L373.037147,76.5776067 L373.037147,88.0799092 L376.113373,88.0799092 Z M376.475891,73.1492672 C376.475891,72.0970387 375.654183,71.2476908 374.621869,71.2476908 C373.565388,71.2476908 372.695344,72.0970387 372.695344,73.1492672 C372.695344,74.1980571 373.544672,75.047405 374.573534,75.047405 C375.630015,75.047405 376.475891,74.1980571 376.475891,73.1492672 L376.475891,73.1492672 Z M388.71865,88.0799092 L388.71865,79.5279731 C388.71865,78.7955395 388.649599,78.2934958 388.487329,77.8533479 C388.121358,76.8526992 386.971658,76.1684067 385.666592,76.1684067 C384.976081,76.1684067 384.171636,76.3506555 383.550176,76.6704504 C383.046103,76.9455429 382.655964,77.2206353 382.196774,77.5404303 C382.196774,77.0590185 382.034504,76.5535361 381.761753,76.075563 L379.030782,76.8526992 C379.306986,77.6332739 379.445088,78.5926588 379.445088,79.6001849 L379.445088,88.0799092 L382.514409,88.0799092 L382.514409,79.8030655 C383.229088,79.1634756 384.033534,78.750837 384.654993,78.750837 C385.459439,78.750837 385.683855,79.1359664 385.683855,80.4667261 L385.683855,88.0799092 L388.71865,88.0799092 Z M403.802862,77.6539059 L402.511607,75.7076269 C401.803833,76.3506555 400.926884,76.7185916 400.081008,76.7185916 C399.694322,76.7185916 399.280015,76.6257479 398.634388,76.4641311 C397.785059,76.2578118 397.187767,76.1684067 396.524877,76.1684067 C393.514249,76.1684067 391.567008,77.722679 391.567008,80.1228605 C391.567008,81.8593815 392.392169,82.9356807 394.090826,83.3689513 C392.160847,83.8675563 391.932979,84.579358 391.932979,85.3393008 C391.932979,86.1370689 392.278234,86.6631832 392.827191,86.8660639 C393.379599,87.0964538 394.273811,87.2099294 395.65138,87.234 L396.959899,87.2580706 C398.17865,87.2787025 399.121198,87.5950588 399.121198,88.6541647 C399.121198,89.1355765 398.820826,89.5688471 398.361636,89.8439395 C397.878278,90.1396639 397.211935,90.2325076 396.431658,90.2325076 C395.009205,90.2325076 394.228928,89.7270252 394.228928,88.7917109 C394.228928,88.471916 394.249643,88.3068605 394.363577,88.0352067 L391.522125,88.0352067 C391.404738,88.262158 391.24592,88.5819529 391.24592,89.2249815 C391.24592,90.0227496 391.567008,90.7104807 392.209183,91.3019294 C393.262212,92.2888235 394.985037,92.5604773 396.662979,92.5604773 C398.499738,92.5604773 400.267446,92.1512773 401.29976,91.0543462 C401.938482,90.3700538 402.238855,89.6135496 402.238855,88.6300941 C402.238855,87.5778655 401.917767,86.7766588 401.230709,86.1370689 C400.402096,85.3840034 399.463001,85.1089109 397.671125,85.088279 L396.017351,85.0642084 C395.696264,85.0642084 395.513278,84.9507328 395.513278,84.789116 C395.513278,84.469321 395.9483,84.1942286 396.728577,83.8262924 C396.959899,83.850363 397.049665,83.850363 397.187767,83.850363 C399.694322,83.850363 401.527628,82.3889345 401.527628,80.377321 C401.527628,79.6001849 401.29976,79.0018588 400.84057,78.4551126 C401.023555,78.4791832 401.344643,78.5238857 401.645015,78.5238857 C402.494344,78.5238857 403.136519,78.2694252 403.802862,77.6539059 L403.802862,77.6539059 Z M398.361636,80.1434924 C398.361636,81.2232303 397.695293,81.8181176 396.473088,81.8181176 C395.399344,81.8181176 394.66395,81.3367059 394.66395,80.1434924 C394.66395,79.0465613 395.330293,78.4069714 396.500709,78.4069714 C397.671125,78.4069714 398.361636,79.0465613 398.361636,80.1434924 L398.361636,80.1434924 Z M414.523045,83.1867025 L414.523045,82.4783395 C414.523045,80.0334555 414.039687,78.4516739 412.959037,77.3581815 C412.202928,76.5810454 410.915125,76.1202655 409.558271,76.1202655 C408.001169,76.1202655 406.8273,76.6257479 405.86749,77.6951697 C404.838628,78.8368034 404.400154,80.2397748 404.400154,82.3407933 C404.400154,86.0201546 406.578716,88.3997042 409.951862,88.3997042 C411.605636,88.3997042 413.028088,87.8701513 414.384942,86.7800975 L413.190358,84.9507328 C412.247811,85.7244303 411.26038,86.116437 410.203899,86.116437 C408.619176,86.116437 407.724964,85.088279 407.724964,83.2795462 L407.724964,83.1867025 L414.523045,83.1867025 Z M411.329431,80.9481378 L407.769847,80.9481378 L407.769847,80.9034353 C407.769847,79.2735126 408.436191,78.3622689 409.606607,78.3622689 C410.228066,78.3622689 410.663088,78.5892202 410.963461,79.0465613 C411.239665,79.4832706 411.329431,79.9406118 411.329431,80.8105916 L411.329431,80.9481378 Z M426.66568,88.0799092 L426.66568,79.5279731 C426.66568,78.7955395 426.596628,78.2934958 426.437811,77.8533479 C426.07184,76.8526992 424.925592,76.1684067 423.617074,76.1684067 C422.926563,76.1684067 422.122118,76.3506555 421.500658,76.6704504 C421.000037,76.9455429 420.606446,77.2206353 420.147256,77.5404303 C420.147256,77.0590185 419.988439,76.5535361 419.712234,76.075563 L416.981264,76.8526992 C417.257468,77.6332739 417.39557,78.5926588 417.39557,79.6001849 L417.39557,88.0799092 L420.468344,88.0799092 L420.468344,79.8030655 C421.183023,79.1634756 421.984015,78.750837 422.605475,78.750837 C423.40992,78.750837 423.641242,79.1359664 423.641242,80.4667261 L423.641242,88.0799092 L426.66568,88.0799092 Z"></path>
-		  <path d="M8.68938978,33.2966259 L0.0372875912,33.2966259 L0.0372875912,49.1866528 L3.2481635,49.1866528 L3.2481635,42.1202158 L7.31182044,42.1202158 L7.31182044,39.5205923 L3.2481635,39.5205923 L3.2481635,35.8790561 L8.32341898,35.8790561 L8.68938978,33.2966259 Z M22.4202,43.9977217 L22.4202,33.2966259 L19.1609883,33.2966259 L19.1609883,43.4716074 C19.1609883,44.3175166 19.1609883,44.5479066 19.1161051,44.8917721 C18.9780029,46.0574763 18.0837912,46.7417687 16.6786015,46.7417687 C15.6221197,46.7417687 14.8660102,46.3532007 14.4965869,45.6448376 C14.3136015,45.3009721 14.223835,44.7301553 14.223835,43.7466998 L14.223835,33.2966259 L10.9404555,33.2966259 L10.9404555,44.3690965 C10.9404555,45.8958595 11.1027255,46.5388881 11.6309664,47.3607267 C12.5251781,48.7533822 14.3136015,49.4858158 16.7476526,49.4858158 C20.1933022,49.4858158 21.7538569,47.7492948 22.1681635,46.4907469 C22.3960321,45.8098931 22.4202,45.5072914 22.4202,43.9977217 L22.4202,43.9977217 Z M16.0122584,31.0064813 C16.0122584,30.0539738 15.231981,29.2493284 14.2928861,29.2493284 C13.3261708,29.2493284 12.5010102,30.0539738 12.5010102,31.0064813 C12.5010102,31.9693049 13.3054555,32.7705116 14.2445504,32.7705116 C15.2112657,32.7705116 16.0122584,31.9693049 16.0122584,31.0064813 L16.0122584,31.0064813 Z M20.8354774,31.0064813 C20.8354774,30.0539738 20.0552,29.2493284 19.1126526,29.2493284 C18.1493898,29.2493284 17.3207766,30.0539738 17.3207766,31.0064813 C17.3207766,31.9693049 18.1252219,32.7705116 19.0677693,32.7705116 C20.0310321,32.7705116 20.8354774,31.9693049 20.8354774,31.0064813 L20.8354774,31.0064813 Z M37.1591562,49.1866528 C36.5860321,48.1791267 34.1554336,44.0424242 33.3268204,43.0142662 C33.1196672,42.7391738 32.981565,42.6016276 32.6604774,42.3506057 C34.6318861,42.3024645 36.2166088,40.3389923 36.2166088,37.9594427 C36.2166088,35.1706931 34.3591343,33.2966259 31.5349445,33.2966259 L25.5896453,33.2966259 L25.5896453,49.1866528 L28.7314701,49.1866528 L28.7314701,42.556925 C28.9386234,42.577557 29.0767255,42.6256982 29.2389956,42.6910326 C29.8121197,42.9489318 30.2954774,43.7226292 31.8802,46.5801519 C32.5016599,47.7011536 32.7536964,48.1344242 33.3717036,49.1866528 L37.1591562,49.1866528 Z M32.8434628,38.0282158 C32.8434628,38.6918763 32.6155942,39.2626931 32.2254555,39.6271906 C31.7904336,40.0157587 31.1931416,40.1533049 29.8121197,40.1533049 L28.7314701,40.1533049 L28.7314701,35.8549855 L29.8811708,35.8549855 C30.6614482,35.8549855 31.3312438,35.9478292 31.6972146,36.0888141 C32.4533241,36.3604679 32.8434628,37.0447603 32.8434628,38.0282158 L32.8434628,38.0282158 Z M56.4692949,49.1866528 L51.4389226,33.2519234 L47.9725577,33.2519234 L42.7384847,49.1866528 L46.0909153,49.1866528 L47.2164482,45.4144477 L51.8981124,45.4144477 L53.0236453,49.1866528 L56.4692949,49.1866528 Z M51.117835,42.7632444 L47.9967255,42.7632444 C48.341981,41.7110158 48.5456818,40.9613889 48.846054,39.8163166 C49.1222584,38.7606494 49.5123971,37.1169721 49.6021635,36.749036 L50.2443387,39.5618561 C50.4998277,40.6622259 51.0039007,42.4193788 51.117835,42.7632444 L51.117835,42.7632444 Z M69.4370905,49.1866528 L69.4370905,33.2966259 L66.3850321,33.2966259 L66.4540832,39.7922461 C66.4782511,40.8857385 66.5921854,42.9214225 66.7095723,44.1558998 C66.3850321,43.0142662 65.7670248,41.3430797 64.9625796,39.6581385 L61.9070686,33.2966259 L58.3509372,33.2966259 L58.3509372,49.1866528 L61.4478788,49.1866528 L61.3546599,42.3953082 C61.3339445,41.0679872 61.3097766,39.1973587 61.1958423,37.8941082 C61.492762,38.8775637 62.4594774,41.1161284 63.3536891,43.1071099 L66.0881124,49.1866528 L69.4370905,49.1866528 Z M84.8665577,47.9556141 L84.8665577,40.3665015 L78.6899372,40.3665015 L79.1076964,42.9695637 L81.5382949,42.9695637 L81.5382949,46.5835906 C81.0135066,46.8552444 80.4369299,46.9755973 79.7257036,46.9755973 C78.6899372,46.9755973 77.8164409,46.6523637 77.2226015,46.0781082 C76.4181562,45.2769015 76.0280175,43.8154729 76.0280175,41.549399 C76.0280175,39.1732881 76.3042219,37.457399 77.381419,36.4258024 C77.9338277,35.8996881 78.7348204,35.6314729 79.6808204,35.6314729 C80.8961197,35.6314729 81.9767693,36.0166024 83.0090832,36.8625116 L84.7042876,34.8715301 C83.3060029,33.6611234 81.5624628,33.0490427 79.6324847,33.0490427 C78.1168131,33.0490427 76.9222292,33.3894696 75.7518131,34.1631671 C73.5283679,35.6521049 72.4235504,38.0282158 72.4235504,41.3912208 C72.4235504,43.7673318 72.9517912,45.4625889 74.1222073,46.9515267 C75.4065577,48.5917654 77.1742657,49.3689015 79.5668861,49.3689015 C81.4485285,49.3689015 83.2369518,48.9115603 84.8665577,47.9556141 L84.8665577,47.9556141 Z M97.6099372,49.1866528 L97.6099372,46.4460444 L91.571419,46.4460444 L91.571419,42.1889889 L96.0942657,42.1889889 L96.0942657,39.5859267 L91.571419,39.5859267 L91.571419,35.8996881 L96.9884774,35.8996881 L97.4027839,33.2966259 L88.3122073,33.2966259 L88.3122073,49.1866528 L97.6099372,49.1866528 Z M118.090492,33.2966259 L114.713893,33.2966259 L113.405375,39.3349049 C113.06012,40.8651066 112.580215,44.0424242 112.531879,44.5891704 C112.486996,44.3381486 112.14174,41.8244914 111.84482,40.4043267 L110.374032,33.2966259 L106.862784,33.2966259 L105.436879,39.7234729 C104.956974,41.8691939 104.680769,44.114636 104.611718,44.7748578 C104.566835,44.4550629 104.359682,42.3265351 103.76239,39.5618561 L102.38482,33.2966259 L98.9875066,33.2966259 L102.799127,49.324199 L106.448477,49.324199 L107.781164,42.8113855 C108.192018,40.7722629 108.468222,38.8122292 108.537273,38.37552 C108.582156,38.9910393 108.858361,40.9098091 109.296835,42.8526494 L110.719288,49.324199 L114.230536,49.324199 L118.090492,33.2966259 Z M131.35866,49.1866528 L126.33174,33.2519234 L122.865375,33.2519234 L117.631302,49.1866528 L120.98028,49.1866528 L122.105813,45.4144477 L126.79093,45.4144477 L127.916463,49.1866528 L131.35866,49.1866528 Z M126.010653,42.7632444 L122.886091,42.7632444 C123.231346,41.7110158 123.438499,40.9613889 123.735419,39.8163166 C124.011623,38.7606494 124.401762,37.1169721 124.494981,36.749036 L125.137156,39.5618561 C125.389193,40.6622259 125.896718,42.4193788 126.010653,42.7632444 L126.010653,42.7632444 Z M144.329908,49.1866528 L144.329908,33.2966259 L141.281302,33.2966259 L141.350353,39.7922461 C141.371069,40.8857385 141.488455,42.9214225 141.60239,44.1558998 C141.281302,43.0142662 140.659842,41.3430797 139.855397,39.6581385 L136.799886,33.2966259 L133.243755,33.2966259 L133.243755,49.1866528 L136.340696,49.1866528 L136.247477,42.3953082 C136.223309,41.0679872 136.202594,39.1973587 136.08866,37.8941082 C136.38558,38.8775637 137.352295,41.1161284 138.246507,43.1071099 L140.98093,49.1866528 L144.329908,49.1866528 Z M159.666156,41.2983771 C159.666156,38.4408545 158.958382,36.4051704 157.487594,34.9643738 C156.524331,34.0049889 155.353915,33.5063839 153.997061,33.3894696 C153.354886,33.3447671 152.139587,33.2966259 151.217755,33.2966259 L148.006879,33.2966259 L148.006879,49.1866528 L151.884098,49.1866528 C152.826645,49.1866528 153.582755,49.1419503 154.180047,49.0972477 C155.675003,48.9837721 157.097455,48.1172309 158.060718,46.8139805 C159.137915,45.3731839 159.666156,43.4716074 159.666156,41.2983771 L159.666156,41.2983771 Z M156.065142,41.5941015 C156.065142,44.9639839 155.098426,46.5835906 152.988915,46.5835906 L151.262638,46.5835906 L151.262638,35.810283 L152.733426,35.810283 C153.997061,35.810283 154.732455,36.2676242 155.260696,37.137604 C155.902872,38.1863939 156.065142,39.7441049 156.065142,41.5941015 L156.065142,41.5941015 Z M172.271434,33.2966259 L160.774426,33.2966259 L160.774426,35.9478292 L164.675813,35.9478292 L164.675813,49.1866528 L167.931572,49.1866528 L167.931572,35.9478292 L171.743193,35.9478292 L172.271434,33.2966259 Z M183.637244,49.1866528 L183.637244,46.4460444 L177.598726,46.4460444 L177.598726,42.1889889 L182.121572,42.1889889 L182.121572,39.5859267 L177.598726,39.5859267 L177.598726,35.8996881 L183.015784,35.8996881 L183.430091,33.2966259 L174.339514,33.2966259 L174.339514,49.1866528 L183.637244,49.1866528 Z M208.271222,33.2966259 L204.898076,33.2966259 L203.589558,39.3349049 C203.244302,40.8651066 202.760945,44.0424242 202.716061,44.5891704 C202.671178,44.3381486 202.325923,41.8244914 202.02555,40.4043267 L200.558215,33.2966259 L197.043514,33.2966259 L195.621061,39.7234729 C195.137704,41.8691939 194.864952,44.114636 194.795901,44.7748578 C194.747565,44.4550629 194.540412,42.3265351 193.946572,39.5618561 L192.569003,33.2966259 L189.168236,33.2966259 L192.979857,49.324199 L196.63266,49.324199 L197.961893,42.8113855 C198.3762,40.7722629 198.652404,38.8122292 198.721455,38.37552 C198.766339,38.9910393 199.042543,40.9098091 199.477565,42.8526494 L200.900018,49.324199 L204.414718,49.324199 L208.271222,33.2966259 Z M210.798492,49.1866528 L214.14747,49.1866528 L214.14747,33.2966259 L210.798492,33.2966259 L210.798492,49.1866528 Z M228.931309,44.1799704 C228.931309,41.8244914 227.512309,40.1533049 224.895273,39.4449418 L222.965295,38.9188276 C221.632609,38.5543301 221.194134,38.1416914 221.194134,37.3198528 C221.194134,36.2435536 222.112514,35.4939267 223.424485,35.4939267 C224.619069,35.4939267 225.696266,35.830915 227.142886,36.7008948 L228.658558,34.4141889 C227.260273,33.4101015 225.285412,32.8152141 223.334718,32.8152141 C219.95812,32.8152141 217.617288,34.8268276 217.617288,37.7290528 C217.617288,38.6231032 217.845156,39.4449418 218.283631,40.1533049 C218.856755,41.1161284 219.844185,41.7316477 221.425455,42.168357 L223.196616,42.6532074 C224.619069,43.0383368 225.285412,43.6813654 225.285412,44.7060847 C225.285412,46.1262494 224.318696,46.879315 222.481937,46.879315 C220.873047,46.879315 219.592149,46.3807099 218.097193,45.6001351 L216.906061,48.0931603 C218.511499,49.004404 220.531244,49.533957 222.347288,49.533957 C226.317726,49.533957 228.931309,47.4088679 228.931309,44.1799704 L228.931309,44.1799704 Z M242.341032,44.1799704 C242.341032,41.8244914 240.91858,40.1533049 238.301543,39.4449418 L236.375018,38.9188276 C235.038879,38.5543301 234.603857,38.1416914 234.603857,37.3198528 C234.603857,36.2435536 235.522236,35.4939267 236.834207,35.4939267 C238.028791,35.4939267 239.105988,35.830915 240.552609,36.7008948 L242.064828,34.4141889 C240.666543,33.4101015 238.691682,32.8152141 236.740988,32.8152141 C233.367842,32.8152141 231.023558,34.8268276 231.023558,37.7290528 C231.023558,38.6231032 231.254879,39.4449418 231.689901,40.1533049 C232.263025,41.1161284 233.250455,41.7316477 234.835178,42.168357 L236.602886,42.6532074 C238.028791,43.0383368 238.691682,43.6813654 238.691682,44.7060847 C238.691682,46.1262494 237.728419,46.879315 235.89166,46.879315 C234.282769,46.879315 232.998419,46.3807099 231.506915,45.6001351 L230.312331,48.0931603 C231.921222,49.004404 233.937514,49.533957 235.753558,49.533957 C239.727448,49.533957 242.341032,47.4088679 242.341032,44.1799704 L242.341032,44.1799704 Z M254.166032,49.1866528 L254.166032,46.4460444 L248.127514,46.4460444 L248.127514,42.1889889 L252.650361,42.1889889 L252.650361,39.5859267 L248.127514,39.5859267 L248.127514,35.8996881 L253.544572,35.8996881 L253.958879,33.2966259 L244.868302,33.2966259 L244.868302,49.1866528 L254.166032,49.1866528 Z M268.238645,49.1866528 L268.238645,33.2966259 L265.186587,33.2966259 L265.255638,39.7922461 C265.279806,40.8857385 265.39374,42.9214225 265.511127,44.1558998 C265.186587,43.0142662 264.56858,41.3430797 263.764134,39.6581385 L260.708623,33.2966259 L257.152492,33.2966259 L257.152492,49.1866528 L260.249434,49.1866528 L260.156215,42.3953082 C260.135499,41.0679872 260.111331,39.1973587 259.997397,37.8941082 C260.294317,38.8775637 261.261032,41.1161284 262.155244,43.1071099 L264.889667,49.1866528 L268.238645,49.1866528 Z M283.025937,44.1799704 C283.025937,41.8244914 281.603485,40.1533049 278.986448,39.4449418 L277.05647,38.9188276 C275.723784,38.5543301 275.288762,38.1416914 275.288762,37.3198528 C275.288762,36.2435536 276.207142,35.4939267 277.519112,35.4939267 C278.710244,35.4939267 279.790893,35.830915 281.234061,36.7008948 L282.749733,34.4141889 C281.347996,33.4101015 279.376587,32.8152141 277.425893,32.8152141 C274.049295,32.8152141 271.708463,34.8268276 271.708463,37.7290528 C271.708463,38.6231032 271.939784,39.4449418 272.374806,40.1533049 C272.94793,41.1161284 273.931908,41.7316477 275.516631,42.168357 L277.284339,42.6532074 C278.710244,43.0383368 279.376587,43.6813654 279.376587,44.7060847 C279.376587,46.1262494 278.413324,46.879315 276.573112,46.879315 C274.967674,46.879315 273.679872,46.3807099 272.19182,45.6001351 L270.997236,48.0931603 C272.602674,49.004404 274.622419,49.533957 276.43501,49.533957 C280.408901,49.533957 283.025937,47.4088679 283.025937,44.1799704 L283.025937,44.1799704 Z M296.663528,47.9796847 L295.19274,45.9680713 C294.253645,46.7211368 293.404317,46.9927906 292.461769,46.9927906 C291.0842,46.9927906 290.027718,46.3807099 289.385543,45.2115671 C288.902185,44.3415872 288.7192,43.1277418 288.7192,40.9579503 C288.7192,39.1010763 288.995404,37.7806326 289.613412,36.8625116 C290.189988,36.0166024 291.24647,35.4939267 292.323667,35.4939267 C293.217879,35.4939267 294.07066,35.7896511 294.871653,36.3810998 L296.318273,34.2113082 C295.448229,33.4582427 293.863507,32.9527603 292.278784,32.9527603 C289.706631,32.9527603 287.410682,34.3247839 286.174667,36.6355603 C285.439273,38.0041452 285.094018,39.5824881 285.094018,41.5734696 C285.094018,43.9083166 285.736193,45.830525 287.020543,47.267883 C288.329061,48.7533822 290.027718,49.4617452 292.233901,49.4617452 C294.046492,49.4617452 295.399893,49.004404 296.663528,47.9796847 L296.663528,47.9796847 Z M310.049083,49.1866528 L310.049083,33.2966259 L306.789872,33.2966259 L306.789872,39.4724511 L302.197974,39.4724511 L302.197974,33.2966259 L299.007813,33.2966259 L299.007813,49.1866528 L302.197974,49.1866528 L302.197974,42.1030225 L306.789872,42.1030225 L306.789872,49.1866528 L310.049083,49.1866528 Z M325.661536,49.1866528 L320.634616,33.2519234 L317.164799,33.2519234 L311.930726,49.1866528 L315.283156,49.1866528 L316.408689,45.4144477 L321.093806,45.4144477 L322.215886,49.1866528 L325.661536,49.1866528 Z M320.310076,42.7632444 L317.188966,42.7632444 C317.534222,41.7110158 317.741375,40.9613889 318.038295,39.8163166 C318.314499,38.7606494 318.704638,37.1169721 318.797857,36.749036 L319.440032,39.5618561 C319.692069,40.6622259 320.196142,42.4193788 320.310076,42.7632444 L320.310076,42.7632444 Z M336.198733,33.2966259 L327.546631,33.2966259 L327.546631,49.1866528 L330.757507,49.1866528 L330.757507,42.1202158 L334.821164,42.1202158 L334.821164,39.5205923 L330.757507,39.5205923 L330.757507,35.8790561 L335.829309,35.8790561 L336.198733,33.2966259 Z M349.239032,33.2966259 L337.738572,33.2966259 L337.738572,35.9478292 L341.639959,35.9478292 L341.639959,49.1866528 L344.899171,49.1866528 L344.899171,35.9478292 L348.710791,35.9478292 L349.239032,33.2966259 Z M367.351134,43.9977217 L367.351134,33.2966259 L364.095375,33.2966259 L364.095375,43.4716074 C364.095375,44.3175166 364.095375,44.5479066 364.050492,44.8917721 C363.91239,46.0574763 363.014726,46.7417687 361.612988,46.7417687 C360.556507,46.7417687 359.800397,46.3532007 359.430974,45.6448376 C359.247988,45.3009721 359.154769,44.7301553 359.154769,43.7466998 L359.154769,33.2966259 L355.874842,33.2966259 L355.874842,44.3690965 C355.874842,45.8958595 356.037112,46.5388881 356.561901,47.3607267 C357.456112,48.7533822 359.247988,49.4858158 361.682039,49.4858158 C365.127689,49.4858158 366.688244,47.7492948 367.099098,46.4907469 C367.326966,45.8098931 367.351134,45.5072914 367.351134,43.9977217 L367.351134,43.9977217 Z M381.610185,49.1866528 L381.610185,33.2966259 L378.56158,33.2966259 L378.627178,39.7922461 C378.651346,40.8857385 378.76528,42.9214225 378.879215,44.1558998 C378.56158,43.0142662 377.936667,41.3430797 377.135674,39.6581385 L374.076711,33.2966259 L370.524032,33.2966259 L370.524032,49.1866528 L373.617521,49.1866528 L373.527755,42.3953082 C373.503587,41.0679872 373.482872,39.1973587 373.365485,37.8941082 C373.665857,38.8775637 374.632572,41.1161284 375.526784,43.1071099 L378.261207,49.1866528 L381.610185,49.1866528 Z M396.946434,41.2983771 C396.946434,38.4408545 396.235207,36.4051704 394.767872,34.9643738 C393.801156,34.0049889 392.63074,33.5063839 391.277339,33.3894696 C390.635164,33.3447671 389.416412,33.2966259 388.498032,33.2966259 L385.283704,33.2966259 L385.283704,49.1866528 L389.160923,49.1866528 C390.106923,49.1866528 390.863032,49.1419503 391.460324,49.0972477 C392.951828,48.9837721 394.377733,48.1172309 395.340996,46.8139805 C396.418193,45.3731839 396.946434,43.4716074 396.946434,41.2983771 L396.946434,41.2983771 Z M393.341966,41.5941015 C393.341966,44.9639839 392.378704,46.5835906 390.269193,46.5835906 L388.542915,46.5835906 L388.542915,35.810283 L390.013704,35.810283 C391.277339,35.810283 392.012733,36.2676242 392.540974,37.137604 C393.183149,38.1863939 393.341966,39.7441049 393.341966,41.5941015 L393.341966,41.5941015 Z M417.354485,49.1866528 L411.681937,40.6622259 L416.781361,33.2966259 L412.831638,33.2966259 L408.284623,40.5418729 L408.284623,33.2966259 L405.008149,33.2966259 L405.008149,49.1866528 L408.284623,49.1866528 L408.284623,40.8857385 L413.128558,49.1866528 L417.354485,49.1866528 Z M430.394784,43.9977217 L430.394784,33.2966259 L427.139025,33.2966259 L427.139025,43.4716074 C427.139025,44.3175166 427.139025,44.5479066 427.094142,44.8917721 C426.956039,46.0574763 426.058375,46.7417687 424.656638,46.7417687 C423.600156,46.7417687 422.840594,46.3532007 422.474623,45.6448376 C422.291638,45.3009721 422.198419,44.7301553 422.198419,43.7466998 L422.198419,33.2966259 L418.921945,33.2966259 L418.921945,44.3690965 C418.921945,45.8958595 419.080762,46.5388881 419.60555,47.3607267 C420.503215,48.7533822 422.291638,49.4858158 424.725689,49.4858158 C428.171339,49.4858158 429.731893,47.7492948 430.142747,46.4907469 C430.374069,45.8098931 430.394784,45.5072914 430.394784,43.9977217 L430.394784,43.9977217 Z M445.113025,49.1866528 L445.113025,33.2966259 L442.060966,33.2966259 L442.130018,39.7922461 C442.154185,40.8857385 442.26812,42.9214225 442.382054,44.1558998 C442.060966,43.0142662 441.442959,41.3430797 440.638514,39.6581385 L437.583003,33.2966259 L434.026872,33.2966259 L434.026872,49.1866528 L437.123813,49.1866528 L437.030594,42.3953082 C437.006426,41.0679872 436.985711,39.1973587 436.868324,37.8941082 C437.168696,38.8775637 438.131959,41.1161284 439.029623,43.1071099 L441.764047,49.1866528 L445.113025,49.1866528 Z M459.896864,44.1799704 C459.896864,41.8244914 458.477864,40.1533049 455.860828,39.4449418 L453.93085,38.9188276 C452.598164,38.5543301 452.159689,38.1416914 452.159689,37.3198528 C452.159689,36.2435536 453.078069,35.4939267 454.390039,35.4939267 C455.584623,35.4939267 456.66182,35.830915 458.108441,36.7008948 L459.624112,34.4141889 C458.225828,33.4101015 456.250966,32.8152141 454.300273,32.8152141 C450.923674,32.8152141 448.582842,34.8268276 448.582842,37.7290528 C448.582842,38.6231032 448.810711,39.4449418 449.249185,40.1533049 C449.825762,41.1161284 450.80974,41.7316477 452.39101,42.168357 L454.162171,42.6532074 C455.584623,43.0383368 456.250966,43.6813654 456.250966,44.7060847 C456.250966,46.1262494 455.284251,46.879315 453.447492,46.879315 C451.838601,46.879315 450.557704,46.3807099 449.062747,45.6001351 L447.871616,48.0931603 C449.477054,49.004404 451.496799,49.533957 453.30939,49.533957 C457.28328,49.533957 459.896864,47.4088679 459.896864,44.1799704 L459.896864,44.1799704 Z M472.550477,33.2966259 L461.050018,33.2966259 L461.050018,35.9478292 L464.951404,35.9478292 L464.951404,49.1866528 L468.210616,49.1866528 L468.210616,35.9478292 L472.022236,35.9478292 L472.550477,33.2966259 Z"></path>
-		</g>
-	  </g>
-  </g>
-</svg>
\ No newline at end of file

--- logout.php ---
@@ -1,6 +0,0 @@
-<?php
-session_start();
-session_destroy();
-header("Location: login.php");
-exit;
-?>
\ No newline at end of file

--- private/.env.example ---
@@ -1,42 +1,45 @@
-; Authentication method: LDAP or OIDC
+# Authentication method: LDAP, OIDC or Shibboleth
 Authentication="LDAP"
-; LDAP config
+# LDAP config
 LDAP_HOST="ldaps://..."
 LDAP_BASE_DN="cn=...,ou=...,dc=..."
 LDAP_BIND_PW="..."
 LDAP_SEARCH_DN="ou=...,dc=..."
+LDAP_PORT=""
 
-; Open AI config (also works with Microsoft Azure)
-OPENAI_API_KEY="sk-..."
+#Shibbolet
+SHIBBOLETH_LOGIN_PATH="Shibboleth.sso/Login?target="
+SHIBBOLETH_LOGIN_PAGE="login.php"
+
+# Open Ai config
 OPENAI_API_URL="https://api.openai.com/v1/chat/completions"
+OPENAI_API_KEY="sk-..."
 
-; Legal config
+# Legal config
 IMPRINT_LOCATION="https://my-univiersity.com/imprint"
 PRIVACY_LOCATION="https://my-univiersity.com/ai-privacy-policy"
 
-; Testuser accout
-;TESTUSER=tester
-;TESTPASSWORD=superlangespasswort123
+# Testuser accout
+TESTUSER="tester"
+TESTPASSWORD="superlangespasswort123"
 
-; OpenID Connect configuration
+# OpenID Connect configuration
 ; ID provider
 OIDC_IDP="https://xxx"
 ; Client ID
 OIDC_CLIENT_ID="xxx"
 ; Client secret
 OIDC_CLIENT_SECRET="xxx"
-;oidc logout uri
+; oidc logout uri
 OIDC_LOGOUT=""
 
-; Path to composer auoload file (without /vendor/autoload.php)
+; Path to composer autoload file (without /vendor/autoload.php)
 ; normally set to "."
 ; is always in the same directory in Docker container
-;COMPOSER_PATH="/composer/lib"
+; COMPOSER_PATH="/composer/lib"
 
 ;Favicon
 FAVICON_URI=""
 
-;GPT model to be used
-GPT_MODEL="gpt-4-turbo-preview"
-;whether or not to force usage of the predetermined GPT model
-FORCE_MODEL=true
+# Default Language, leave blank to use default language of the user's browser.
+DEFAULT_LANGUAGE="de_DE"

--- private/.htaccess ---
@@ -0,0 +1,2 @@
+Order allow,deny
+Deny from all
\ No newline at end of file

--- private/app/php/auth.php ---
@@ -0,0 +1,165 @@
+<?php
+    if (isset($_POST["submit"])) {
+        // Check if csrf tocken from the user is euqal to the session csrf token.
+        if (!isset($_POST['csrf_token']) || !hash_equals($_POST['csrf_token'], $_SESSION['csrf_token'])) {
+            die('Invalid CSRF token');
+        }
+
+        if (array_key_exists('REMOTE_USER', $_SERVER) && !empty($_SERVER['REMOTE_USER'])) {
+            // If user is already authenticated via shibboleth.
+            $_SESSION['username'] = $_SERVER['REMOTE_USER'];
+            
+            //REGENERATE CSRF TOKEN FOR MORE SECURITY
+            $_SESSION['csrf_token'] = bin2hex(random_bytes(32));
+            //REGENERATE SESSION ID
+            session_regenerate_id();
+
+            header("Location: /interface");
+            exit;
+        } else {
+            // Redirect user to shibboleth login page.
+            if (file_exists(ENV_FILE_PATH)){
+                $env = parse_ini_file(ENV_FILE_PATH);
+                $loginPath = $env['SHIBBOLETH_LOGIN_PATH'];
+                $loginPage = $env['SHIBBOLETH_LOGIN_PAGE'];
+
+                //REQUEST SCHEME MAY BE UNDEFINED BASED ON THE SERVER CONFIG
+                //MAKE SURE TO PREPARE THE SERVER MODS.
+                $scheme = isset($_SERVER['REQUEST_SCHEME']) ? $_SERVER['REQUEST_SCHEME'] : 'http';
+                $shibLogin = 'Location: /' . $loginPath . $scheme. '://' . $_SERVER['HTTP_HOST'] . '/' . $loginPage;
+                header($shibLogin);
+                // header('Location: /Shibboleth.sso/Login?target='.$_SERVER['REQUEST_SCHEME'].'://'.$_SERVER['HTTP_HOST'].'/login.php');
+                exit;
+            }
+            else{
+                echo 'Shibbolet authentication not defined.';
+            }
+        }
+    }
+
+    if (isset($_POST["account"]) && isset($_POST["password"])) {
+
+        function handleLdapLogin($username, $password){
+            // Check if .env file exists for LDAP configuration
+            if (file_exists(ENV_FILE_PATH)){
+                $env = parse_ini_file(ENV_FILE_PATH);
+                $ldap_host = $env['LDAP_HOST'];
+                $ldap_port = $env['LDAP_PORT'];
+                $ldap_binddn = $env['LDAP_BASE_DN'];
+                $ldap_bindpw = $env['LDAP_BIND_PW'];
+                $ldap_base = $env['LDAP_SEARCH_DN'];	
+            }
+
+            // Check if username or password is empty
+            if (!$username || !$password) {
+                // echo "Invalid input.";
+                return false;
+            }
+            
+            // *** ACTIVATES TEST ACCESS ***
+            // Please set a unique test username and password in .env
+            if(isset($env['TESTUSER']) && isset($env['TESTPASSWORD']) &&
+                     !empty($env['TESTUSER']) && !empty($env['TESTPASSWORD']) &&
+                     $username == $env['TESTUSER'] && $password == $env['TESTPASSWORD']) {
+                $_SESSION['username'] = $env['TESTUSER'];
+                $_SESSION['employeetype'] = "Tester";
+                return true;
+            }
+            
+            // Connect to LDAP server
+            $ldapUri = $ldap_host . ':' . $ldap_port;
+            $ldapConn = ldap_connect($ldapUri);
+            if (!$ldapConn) {
+                // echo "Unable to connect to LDAP server.";
+                return false;
+            }
+            
+            // Set LDAP protocol version
+            if (!ldap_set_option($ldapConn, LDAP_OPT_PROTOCOL_VERSION, 3)) {
+                // echo "Unable to set LDAP protocol version.";
+                return false;
+            }
+        
+            // Bind to LDAP server
+            if (!@ldap_bind($ldapConn, $ldap_binddn, $ldap_bindpw)) {
+                // echo "Unable to bind to LDAP server with provided DN and password.";
+                return false;
+            }
+
+            // Search LDAP for user
+            $filter = "(|(sAMAccountName=$username)(mail=$username))";
+        
+            $sr = ldap_search($ldapConn, $ldap_base, $filter);
+            if (!$sr) {
+                // echo "LDAP search failed.";
+                return false;
+            }
+            
+            // Get first entry from search results
+            $entryId = ldap_first_entry($ldapConn, $sr);
+            if (!$entryId) {
+                // echo "Unable to get the first entry from the search results.";
+                return false;
+            }
+            
+            // Get DN from entry
+            $userDn = ldap_get_dn($ldapConn, $entryId);
+            if (!$userDn) {
+                // echo "Unable to get DN from the entry.";
+                return false;
+            }
+            
+            // Bind with user DN and password
+            $passValid = ldap_bind($ldapConn, $userDn, $password); 
+            if (!$passValid) {
+                // echo "Unable to bind with provided user DN and password.";
+                return false;
+            }
+            // Get user information
+            $info = ldap_get_entries($ldapConn, $sr);
+            
+            // Close LDAP connection
+            ldap_close($ldapConn);
+
+            // Extract initials from user's display name
+            $name = $info[0]["displayname"][0];
+            $parts = explode(", ", $name);
+            $initials = substr($parts[1], 0, 1) . substr($parts[0], 0, 1);
+
+            // Set session variables
+            $_SESSION['username'] = $initials;
+            $_SESSION['employeetype'] = $info[0]["employeetype"][0];
+            return true;
+        }
+
+
+        // filter username to prevent unwanted inputs.
+        $username = filter_var($_POST["account"], FILTER_UNSAFE_RAW);
+        $username = ldap_escape($username, "", LDAP_ESCAPE_FILTER);
+        
+        // Use hashed password if LDAP Server is configured accordingly.
+        // $password = password_hash($_POST["password"], PASSWORD_DEFAULT);
+        $password = $_POST["password"];
+
+        // Validate CSRF token on login request
+        // Check if csrf tocken from the user is euqal to the session csrf token.
+        if (!isset($_POST['csrf_token']) || !hash_equals($_POST['csrf_token'], $_SESSION['csrf_token'])) {
+            $csrf = generate_csrf_token();
+            echo json_encode(array("success" => false, 'csrf_token' => $csrf, "message" => "BAD CSRF..."));
+            exit;
+        }
+        else{
+            // Authenticate user with submitted credentials
+            if (handleLdapLogin($username, $password)) {
+                $csrf = generate_csrf_token();
+                echo json_encode(array("success" => true, 'csrf_token' => $csrf, "message" => "logging in..."));
+                exit;
+            } else {
+                $csrf = generate_csrf_token();
+                echo json_encode(array("success" => false, 'csrf_token' => $csrf, "message" => $_SESSION['translation']['LoginFailedMSG']));
+                exit;
+            }
+        }
+    }
+ 
+    
\ No newline at end of file

--- private/app/php/csrf.php ---
@@ -0,0 +1,6 @@
+<?php
+function generate_csrf_token() {
+    $token = bin2hex(random_bytes(32));
+    $_SESSION['csrf_token'] = $token;
+    return $token;
+}
\ No newline at end of file

--- private/app/php/feedback_send.php ---
@@ -0,0 +1,106 @@
+<?php
+
+if (session_status() == PHP_SESSION_NONE) {
+    session_start();
+}
+
+require_once  LIBRARY_PATH . 'csrf.php';
+
+// Check if the user is logged in, if not return 401 Unauthorized
+if (!isset($_SESSION['username'])) {
+    http_response_code(401);
+    exit;
+}
+
+// Function to sanitize input data
+function sanitizeInput($data) {
+    // Remove leading/trailing whitespace
+    $data = trim($data);
+    // Convert special characters to HTML entities
+    $data = htmlspecialchars($data, ENT_QUOTES, 'UTF-8');
+    return $data;
+}
+
+// Check if the request method is POST
+if ($_SERVER['REQUEST_METHOD'] === 'POST') {
+    // Get the JSON string from the request body
+    $jsonString = file_get_contents("php://input");
+    
+    // Decode the JSON string into an array
+    $jsonData = json_decode($jsonString, true);
+    error_log($jsonString);
+    // CSRF Protection
+	if (!isset($_SERVER['HTTP_X_CSRF_TOKEN']) || $_SERVER['HTTP_X_CSRF_TOKEN'] !== $_SESSION['csrf_token']) {
+        http_response_code(403);
+
+        $csrf_token = generate_csrf_token();
+        $respond = array(
+            'success' => false,
+            'csrf_token' => $csrf_token
+        );
+        echo json_encode($respond);
+        // exit('CSRF token validation failed.');
+        exit;
+    }
+
+    // Check if decoding was successful and if the JSON is valid
+    if ($jsonData === null && json_last_error() !== JSON_ERROR_NONE) {
+        // If decoding fails or JSON is invalid, return 400 Bad Request
+        echo('invalid data');
+        http_response_code(400);
+        exit;
+    }
+
+
+    if (isset($jsonData['message']) && $jsonData['message'] !== null){
+        $message = $jsonData['message'];
+    }
+
+    // Extract 'content' and 'role' fields from the message
+    $content = sanitizeInput($message['content']);
+    $role = sanitizeInput($message['role']);
+    
+    // Check if content or role is empty after sanitization
+    if(empty($content) || empty($role)) {
+        // If content or role is empty, return 400 Bad Request
+        error_log('invalid data');
+        http_response_code(400);
+        exit;
+    }
+
+    // Generate a unique identifier for the feedback file
+    $uniqid = time() . uniqid();
+    
+    // Create an array with 'role' and 'content' fields
+    $feedbackData = array(
+        'id' => $uniqid,
+        'role' => $role,
+        'content' => $content
+    );
+
+    $dir = RESOURCES_PATH . 'feedback/';
+    $feedbackDB = $dir . 'feedback_db.json';
+
+    $currentFeedbackData = [];
+    if (file_exists($feedbackDB)) {
+        $currentFeedbackData = json_decode(file_get_contents($feedbackDB), true);
+    }
+    $currentFeedbackData[] = $feedbackData;
+
+    // Convert array to JSON string
+    $jsonFeedbackData = json_encode($currentFeedbackData);
+    
+    // Write the JSON string to a new feedback file
+    file_put_contents($feedbackDB, $jsonFeedbackData);
+    
+
+    $csrf_token = generate_csrf_token();
+    $response = array(
+        'success' => true,
+        'csrf_token' => $csrf_token
+    );
+    
+    // Return the JSON string
+    echo json_encode($response);
+}
+?>

--- private/app/php/language_controller.php ---
@@ -0,0 +1,90 @@
+<?php
+    if (session_status() == PHP_SESSION_NONE) {
+        session_start();
+    }
+    require_once BOOTSTRAP_PATH;
+    require_once  LIBRARY_PATH . 'csrf.php';
+    
+    function setLanguage(){
+        //LANGUAGE CHANGE...
+        if(isset($_SESSION['language'])){
+            $language = $_SESSION['language'];
+        }
+        else{
+            //try to get cookie from last use
+            if (isset($_COOKIE['lastLanguage_cookie']) && $_COOKIE['lastLanguage_cookie'] != '') {
+                $language = $_COOKIE['lastLanguage_cookie'];
+            }			
+            //If theres not cookie try env default language
+            elseif((file_exists(ENV_FILE_PATH) && parse_ini_file(ENV_FILE_PATH)['DEFAULT_LANGUAGE'] != '')) {
+                $env = parse_ini_file(ENV_FILE_PATH);
+                $language = $env['DEFAULT_LANGUAGE'];
+            }
+            else{
+                //hard code to german
+                $languages = ['de_DE', 'en_US', 'es_ES', 'fr_FR', 'it_IT'];
+                $acceptLang = $_SERVER['HTTP_ACCEPT_LANGUAGE'];
+                $matchingLang = substr($acceptLang, 0, 2);
+                foreach ($languages as $lang) {
+                    if (strpos($lang, $matchingLang) === 0) {
+                        $defaultLanguage = $lang;
+                        break;
+                    }
+                }
+                if ($defaultLanguage === null) {
+                    $defaultLanguage = 'de_DE';
+                }
+                $language = $defaultLanguage;
+            }
+        }
+        $_SESSION['language'] = $language;
+        $languageSanitized = preg_replace('~[^a-zA-Z_]~', '', $language);
+        $langFile = file_get_contents(LANGUAGE_PATH . $languageSanitized . '.json');
+        $translation = json_decode($langFile, true);
+        $_SESSION['translation'] = $translation;
+    }
+
+
+
+    // Check if the request is POST
+    if ($_SERVER['REQUEST_METHOD'] === 'POST') {
+        // CSRF Protection
+        if (!isset($_SERVER['HTTP_X_CSRF_TOKEN']) || $_SERVER['HTTP_X_CSRF_TOKEN'] !== $_SESSION['csrf_token']) {
+            $csrf_token = generate_csrf_token();
+            $response = array(
+                'success' => false,
+                'csrf_token' => $csrf_token
+            );
+            http_response_code(403);
+            exit(json_encode($response));
+        }
+
+        // Check if the requested language is valid
+        $languages = ['de_DE', 'en_US', 'es_ES', 'fr_FR', 'it_IT'];
+
+        $jsonString = file_get_contents("php://input");
+
+        $lang = json_decode($jsonString, true)['inputLang'];
+
+        if (!in_array($lang, $languages)) {
+            http_response_code(400);
+            exit(json_encode(array('success' => false, 'error' => 'Invalid language')));
+        }
+
+        // Store the new language in session
+        $_SESSION['language'] = $lang;
+        $langFile = file_get_contents(RESOURCES_PATH . "language/{$lang}.json");
+        $translation = json_decode($langFile, true);
+        $_SESSION['translation'] = $translation;
+
+        setcookie('lastLanguage_cookie', $_SESSION['language'], strtotime('2038-01-01'), '/', '', true, true);
+
+        // Prepare the JSON response
+        $response = array(
+            'success' => true,
+            'csrf_token' => generate_csrf_token()
+        );
+
+        // Return the JSON string
+        exit(json_encode($response));
+    }

--- private/app/php/stream-api.php ---
@@ -1,4 +1,6 @@
 <?php
+define('BOOTSTRAP_PATH',  '../../bootstrap.php');
+require_once BOOTSTRAP_PATH;
 
 session_start();
 if (!isset($_SESSION['username'])) {
@@ -19,8 +21,8 @@
 	exit;
 }
 
-if (file_exists(".env")){
-    $env = parse_ini_file('.env');
+if (file_exists(ENV_FILE_PATH)){
+    $env = parse_ini_file(ENV_FILE_PATH);
 }
 
 // Replace with your API URL and API key
@@ -29,11 +31,6 @@
 
 // Read the request payload from the client
 $requestPayload = file_get_contents('php://input');
-if (true == $env['FORCE_MODEL']) {
-	$r = json_decode($requestPayload, true);
-	$r['model'] = $env['GPT_MODEL'];
-	$requestPayload  = json_encode($r);
-}
 
 $ch = curl_init();
 curl_setopt($ch, CURLOPT_URL, $apiUrl);

--- private/app/php/submit_vote.php ---
@@ -0,0 +1,101 @@
+<?php
+
+if (session_status() == PHP_SESSION_NONE) {
+    session_start();
+}
+require_once  LIBRARY_PATH . 'csrf.php';
+
+if (!isset($_SESSION['username'])) {
+    http_response_code(401);
+    exit;
+}
+
+if ($_SERVER['REQUEST_METHOD'] === 'POST') {
+    $data = json_decode(file_get_contents("php://input"), true);
+
+    // CSRF Protection
+    if (!isset($_SERVER['HTTP_X_CSRF_TOKEN']) || $_SERVER['HTTP_X_CSRF_TOKEN'] !== $_SESSION['csrf_token']) {
+        http_response_code(403);
+        $csrf_token = generate_csrf_token();
+        $respond = array(
+            'success' => false,
+            'csrf_token' => $respond
+        );
+        echo json_encode($callback);
+        exit('CSRF token validation failed.');
+    }
+
+    // Input Validation
+    if (!isset($data['id']) || !preg_match('/^\w+$/', $data['id'])) {
+        // Id is either not set, or doesn't match the expected pattern (alphanumeric + underscore)
+        http_response_code(400);
+        exit('Invalid ID.');
+    }
+
+    $feedbackDB = RESOURCES_PATH . 'feedback/' . 'feedback_db.json';
+
+    // Read existing JSON data from the feedback DB file
+    $feedbackData = [];
+    if (file_exists($feedbackDB)) {
+        $jsonContent = file_get_contents($feedbackDB);
+        if (!empty($jsonContent)) {
+            $feedbackData = json_decode($jsonContent, true);
+            // Check if the decoded data is an array
+            if (!is_array($feedbackData)) {
+                // Handle the case of invalid JSON data
+                http_response_code(500);
+                exit("Invalid JSON data in feedback_db.json");
+            }
+        }
+    }
+
+    // If $feedbackData is empty or not an array, set it as an empty array
+    if (!is_array($feedbackData)) {
+        $feedbackData = [];
+    }
+
+    // Find the feedback entry by ID
+    $foundFeedback = null;
+    foreach ($feedbackData as $feedback) {
+        if ($feedback['id'] === $data['id']) {
+            $foundFeedback = $feedback;
+            break;
+        }
+    }
+
+    if ($foundFeedback === null) {
+        http_response_code(404);
+        exit('Feedback entry not found.');
+    }
+
+    // Update the found feedback entry based on the action
+    if ($data['action'] === 'upvote') {
+        if (isset($foundFeedback["up"])) {
+            $foundFeedback["up"]++;
+        } else {
+            $foundFeedback["up"] = 1;
+        }
+    } elseif ($data['action'] === 'downvote') {
+        if (isset($foundFeedback["down"])) {
+            $foundFeedback["down"]++;
+        } else {
+            $foundFeedback["down"] = 1;
+        }
+    }
+
+    // Rewrite the feedback data back to the feedback DB file
+    file_put_contents($feedbackDB, json_encode($feedbackData));
+
+    $csrf_token = generate_csrf_token();
+    $respond = array(
+        'content' => $foundFeedback,
+        'success' => true,
+        'csrf_token' => $csrf_token
+    );
+
+    // Output JSON response
+    echo json_encode($respond);
+} else {
+    http_response_code(405);
+    exit('Method Not Allowed');
+}

--- private/bootstrap.php ---
@@ -0,0 +1,16 @@
+<?php
+    defined('PRIVATE_PATH') || define('PRIVATE_PATH', $_SERVER['DOCUMENT_ROOT']. '/private');
+    defined('APPLICATION_PATH') || define('APPLICATION_PATH', PRIVATE_PATH . '/app');
+    defined('BASE_URL') || define('BASE_URL', 'localhost:8000/');
+    
+    define('ENV_FILE_PATH', PRIVATE_PATH . '/.env');
+    define('LIBRARY_PATH', APPLICATION_PATH . '/'. 'php/');
+    define('RESOURCES_PATH', PRIVATE_PATH . '/' . 'resources/');
+
+    define('PAGES_PATH', PRIVATE_PATH . '/pages');
+    define('LOGIN_PAGE_PATH', PAGES_PATH . '/login.php');
+    define('INTERFACE_PAGE_PATH', PAGES_PATH . '/interface.php');
+    define('LOGOUT_PAGE_PATH', PAGES_PATH . '/logout.php');
+    define('VIEWS_PATH', PRIVATE_PATH . '/' . 'views/' );
+    define('LAGNUAGE_CONTROLLER_PATH', LIBRARY_PATH . 'language_controller.php');
+    define('LANGUAGE_PATH', RESOURCES_PATH . 'language/');

--- private/pages/interface.php ---
@@ -0,0 +1,755 @@
+<?php
+	session_start();
+
+	require_once BOOTSTRAP_PATH;
+	require_once LIBRARY_PATH . 'language_controller.php';
+
+	if(!isset($_SESSION['translation'])){
+		setLanguage();
+	}
+	$translation = $_SESSION['translation'];
+    
+	if (!isset($_SESSION['username'])) {
+		header("Location: login.php");
+		exit;
+	}
+
+
+	// IF CSRF IS NOT SET -> user is in Interface without logging in. -> logout to remove variables and set a new session.
+	if (!isset($_SESSION['csrf_token']) || $_SESSION['csrf_token'] === '') {
+		header("Location: logout");
+		exit;
+	}
+
+    // Temporary forward for now private views
+    $requested_page = ($_GET['page'] ?? null);
+    if(is_string($requested_page)){
+        $requested_page = preg_replace('~(\.php$|[^a-zA-Z_])~', '', $requested_page);
+        $viewFile = VIEWS_PATH . '/' . $requested_page . '.php';
+        if(!file_exists($viewFile)){
+            http_response_code(404);
+            echo 'Page not found.';
+            exit();
+        }
+
+        include_once $viewFile;
+        exit();
+
+    }
+?>
+<!DOCTYPE html>
+<head>
+	<meta charset="UTF-8">
+	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
+
+	<!-- SAVE CSRF TOKEN ON THE CLIENT SIDE. -->
+	<?php if (isset($_SESSION['csrf_token'])) : ?>
+		<meta name="csrf-token" content="<?php echo $_SESSION['csrf_token']; ?>">
+	<?php endif; ?>
+	<title>HAWKI</title>
+
+
+	<link rel="stylesheet" href="/public/style/style.css">
+	<link rel="stylesheet" href="/public/style/interface_style.css">
+	<link rel="stylesheet" href="/public/style/settings_style.css">
+
+	<!-- COMMON SCRIPTS -->
+	<script src="/public/js/scripts.js"></script>
+	<script src="/public/js/interface_functions.js"></script>
+	<script src="/public/js/syntax_modifier.js"></script>
+
+	<!-- HLJS -->
+	<link id="hljsTheme" type="text/css" rel="stylesheet" href="/public/assets/highlightJS/hljsLight.css">
+	<script src="/public/assets/highlightJS/highlight.min.js"></script>
+	<script src="/public/assets/highlightJS/go.min.js"></script>
+
+	<!-- KaTex detects and renders math formulas -->
+	<link rel="stylesheet" href="/public/assets/katex/katex.min.css">
+	<script defer src="/public/assets/katex/katex.min.js"></script>
+	<script defer src="/public/assets/katex/contrib/auto-render.min.js"></script>
+
+	<!-- Jquery v3.7.1 -->
+	<script src="/public/assets/jquery/jquery.min.js"></script>
+
+
+	<!-- TO PREVENT FOUC WHEN RELOADING THE PAGE IN DARK MODE
+		 THE SETTINGS AND IT'S START FUNCTIONS SHOULD BE INCLUDED IN THE HEADER BEFORE THE PAGE IS LOADED -->
+	<?php include VIEWS_PATH . 'settings.php'; ?>
+  	<script>
+		SwitchDarkMode(false);
+		UpdateSettingsLanguage(`<?php echo $_SESSION['language'] ?>`);
+	</script>
+
+</head>
+
+<div class="wrapper">
+  	<div class="sidebar">
+		<div class="logo">
+			<img id="HAWK_logo" src="/public/img/logo.svg" alt="">
+		</div>
+		<div class="menu">
+			<details>
+				<summary>
+					<h3><?php echo $translation["Conversation"]; ?>
+						<svg viewBox="0 0 50 50"><path d="M 25 2 C 12.309295 2 2 12.309295 2 25 C 2 37.690705 12.309295 48 25 48 C 37.690705 48 48 37.690705 48 25 C 48 12.309295 37.690705 2 25 2 z M 25 4 C 36.609824 4 46 13.390176 46 25 C 46 36.609824 36.609824 46 25 46 C 13.390176 46 4 36.609824 4 25 C 4 13.390176 13.390176 4 25 4 z M 25 11 A 3 3 0 0 0 22 14 A 3 3 0 0 0 25 17 A 3 3 0 0 0 28 14 A 3 3 0 0 0 25 11 z M 21 21 L 21 23 L 22 23 L 23 23 L 23 36 L 22 36 L 21 36 L 21 38 L 22 38 L 23 38 L 27 38 L 28 38 L 29 38 L 29 36 L 28 36 L 27 36 L 27 21 L 26 21 L 22 21 L 21 21 z"/></svg>
+					</h3>
+				</summary>
+				<?php echo $translation["Conversation_Info"]; ?>
+			</details>
+			<div class="menu-item" id="chatMenuButton" onclick="load(this, 'chat.php')">
+				<svg viewBox="0 0 24 24"><path d="M20 2H4C2.9 2 2 2.9 2 4V22L6 18H20C21.1 18 22 17.1 22 16V4C22 2.9 21.1 2 20 2M20 16H5.2L4 17.2V4H20V16Z" /></svg>
+				<?php echo $translation["Chat"]; ?>
+			</div>
+
+			<details>
+				<summary>
+					<h3><?php echo $translation["VirtualOffice"]; ?>
+						<svg viewBox="0 0 50 50"><path d="M 25 2 C 12.309295 2 2 12.309295 2 25 C 2 37.690705 12.309295 48 25 48 C 37.690705 48 48 37.690705 48 25 C 48 12.309295 37.690705 2 25 2 z M 25 4 C 36.609824 4 46 13.390176 46 25 C 46 36.609824 36.609824 46 25 46 C 13.390176 46 4 36.609824 4 25 C 4 13.390176 13.390176 4 25 4 z M 25 11 A 3 3 0 0 0 22 14 A 3 3 0 0 0 25 17 A 3 3 0 0 0 28 14 A 3 3 0 0 0 25 11 z M 21 21 L 21 23 L 22 23 L 23 23 L 23 36 L 22 36 L 21 36 L 21 38 L 22 38 L 23 38 L 27 38 L 28 38 L 29 38 L 29 36 L 28 36 L 27 36 L 27 21 L 26 21 L 22 21 L 21 21 z"/></svg>
+					</h3>
+				</summary>
+				<?php echo $translation["VirtualOffice_Info"]; ?>
+			</details>
+			<div class="menu-item" onclick="submenu(this)">
+				<svg viewBox="0 0 24 24"><path d="M13.07 10.41A5 5 0 0 0 13.07 4.59A3.39 3.39 0 0 1 15 4A3.5 3.5 0 0 1 15 11A3.39 3.39 0 0 1 13.07 10.41M5.5 7.5A3.5 3.5 0 1 1 9 11A3.5 3.5 0 0 1 5.5 7.5M7.5 7.5A1.5 1.5 0 1 0 9 6A1.5 1.5 0 0 0 7.5 7.5M16 17V19H2V17S2 13 9 13 16 17 16 17M14 17C13.86 16.22 12.67 15 9 15S4.07 16.31 4 17M15.95 13A5.32 5.32 0 0 1 18 17V19H22V17S22 13.37 15.94 13Z" /></svg>
+				Team
+			</div>
+			<div class="submenu">
+				<div class="submenu-item" onclick="load(this, 'finance.php')"><?php echo $translation["Finance"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'science.php')"><?php echo $translation["Research"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'marketing.php')"><?php echo $translation["Marketing"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'programming.php')"><?php echo $translation["Programming"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'law.php')"><?php echo $translation["LegalConsultation"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'socialmedia.php')"><?php echo $translation["SocialMedia"]; ?></div>
+			</div>
+
+			<details>
+				<summary>
+					<h3><?php echo $translation["LearnSpace"]; ?>
+						<svg viewBox="0 0 50 50"><path d="M 25 2 C 12.309295 2 2 12.309295 2 25 C 2 37.690705 12.309295 48 25 48 C 37.690705 48 48 37.690705 48 25 C 48 12.309295 37.690705 2 25 2 z M 25 4 C 36.609824 4 46 13.390176 46 25 C 46 36.609824 36.609824 46 25 46 C 13.390176 46 4 36.609824 4 25 C 4 13.390176 13.390176 4 25 4 z M 25 11 A 3 3 0 0 0 22 14 A 3 3 0 0 0 25 17 A 3 3 0 0 0 28 14 A 3 3 0 0 0 25 11 z M 21 21 L 21 23 L 22 23 L 23 23 L 23 36 L 22 36 L 21 36 L 21 38 L 22 38 L 23 38 L 27 38 L 28 38 L 29 38 L 29 36 L 28 36 L 27 36 L 27 21 L 26 21 L 22 21 L 21 21 z"/></svg>
+					</h3>
+				</summary>
+				<?php echo $translation["LearnSpace_Info"]; ?>
+			</details>
+			<div class="menu-item" onclick="submenu(this)">
+				<svg viewBox="0 0 24 24"><path d="M14.6,16.6L19.2,12L14.6,7.4L16,6L22,12L16,18L14.6,16.6M9.4,16.6L4.8,12L9.4,7.4L8,6L2,12L8,18L9.4,16.6Z" /></svg>
+				<?php echo $translation["ResearchWork"]; ?>
+			</div>
+			<div class="submenu">
+				<div class="submenu-item" onclick="load(this, 'datascience.php')"><?php echo $translation["DataAnalysis"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'feedback.php')"><?php echo $translation["FeedBack"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'methodologie.php')"><?php echo $translation["Methodology"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'literature.php')"><?php echo $translation["LiteratureSearch"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'research.php')"><?php echo $translation["ResearchSupport"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'writing.php')"><?php echo $translation["WritingHelp"]; ?></div>
+			</div>
+
+			<div class="menu-item" onclick="submenu(this)">
+				<svg viewBox="0 0 24 24"><path d="M6,3A1,1 0 0,1 7,4V4.88C8.06,4.44 9.5,4 11,4C14,4 14,6 16,6C19,6 20,4 20,4V12C20,12 19,14 16,14C13,14 13,12 11,12C8,12 7,14 7,14V21H5V4A1,1 0 0,1 6,3M7,7.25V11.5C7,11.5 9,10 11,10C13,10 14,12 16,12C18,12 18,11 18,11V7.5C18,7.5 17,8 16,8C14,8 13,6 11,6C9,6 7,7.25 7,7.25Z" /></svg>
+				<?php echo $translation["Organization"]; ?>
+			</div>
+			<div class="submenu">
+				<div class="submenu-item" onclick="load(this, 'eventmanagement.php')"><?php echo $translation["EventManagement"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'learning.php')"><?php echo $translation["LearnStrategy"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'motivation.php')"><?php echo $translation["Motivation"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'stressmanagement.php')"><?php echo $translation["StressManagement"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'tables.php')"><?php echo $translation["Tables"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'timemanagement.php')"><?php echo $translation["TimeManagement"]; ?></div>
+			</div>
+
+			<div class="menu-item" onclick="submenu(this)">
+				<svg viewBox="0 0 24 24"><path d="M15.54,3.5L20.5,8.47L19.07,9.88L14.12,4.93L15.54,3.5M3.5,19.78L10,13.31C9.9,13 9.97,12.61 10.23,12.35C10.62,11.96 11.26,11.96 11.65,12.35C12.04,12.75 12.04,13.38 11.65,13.77C11.39,14.03 11,14.1 10.69,14L4.22,20.5L14.83,16.95L18.36,10.59L13.42,5.64L7.05,9.17L3.5,19.78Z" /></svg>
+				<?php echo $translation["Creativity"]; ?>
+			</div>
+			<div class="submenu">
+				<div class="submenu-item" onclick="load(this, 'copywriting.php')"><?php echo $translation["Copywriting"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'designthinking.php')"><?php echo $translation["DesignThinking"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'gamification.php')"><?php echo $translation["Gamification"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'ideageneration.php')"><?php echo $translation["BrainStorming"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'interview.php')"><?php echo $translation["InterviewQuestions"]; ?></div>
+				<div class="submenu-item" onclick="load(this, 'prototyping.php')"><?php echo $translation["Prototyping"]; ?></div>
+			</div>
+
+		</div>
+		<div class="settings-btn" onclick="toggleSettingsPanel(true)">
+			<svg  viewBox="0 0 24 24" width="24">
+				<path fill-rule="evenodd" clip-rule="evenodd" d="M12 8.00002C9.79085 8.00002 7.99999 9.79088 7.99999 12C7.99999 14.2092 9.79085 16 12 16C14.2091 16 16 14.2092 16 12C16 9.79088 14.2091 8.00002 12 8.00002ZM9.99999 12C9.99999 10.8955 10.8954 10 12 10C13.1046 10 14 10.8955 14 12C14 13.1046 13.1046 14 12 14C10.8954 14 9.99999 13.1046 9.99999 12Z"/>
+				<path fill-rule="evenodd" clip-rule="evenodd" d="M12 8.00002C9.79085 8.00002 7.99999 9.79088 7.99999 12C7.99999 14.2092 9.79085 16 12 16C14.2091 16 16 14.2092 16 12C16 9.79088 14.2091 8.00002 12 8.00002ZM9.99999 12C9.99999 10.8955 10.8954 10 12 10C13.1046 10 14 10.8955 14 12C14 13.1046 13.1046 14 12 14C10.8954 14 9.99999 13.1046 9.99999 12Z"/>
+				<path fill-rule="evenodd" clip-rule="evenodd" d="M10.7673 1.01709C10.9925 0.999829 11.2454 0.99993 11.4516 1.00001L12.5484 1.00001C12.7546 0.99993 13.0075 0.999829 13.2327 1.01709C13.4989 1.03749 13.8678 1.08936 14.2634 1.26937C14.7635 1.49689 15.1915 1.85736 15.5007 2.31147C15.7454 2.67075 15.8592 3.0255 15.9246 3.2843C15.9799 3.50334 16.0228 3.75249 16.0577 3.9557L16.1993 4.77635L16.2021 4.77788C16.2369 4.79712 16.2715 4.81659 16.306 4.8363L16.3086 4.83774L17.2455 4.49865C17.4356 4.42978 17.6693 4.34509 17.8835 4.28543C18.1371 4.2148 18.4954 4.13889 18.9216 4.17026C19.4614 4.20998 19.9803 4.39497 20.4235 4.70563C20.7734 4.95095 21.0029 5.23636 21.1546 5.4515C21.2829 5.63326 21.4103 5.84671 21.514 6.02029L22.0158 6.86003C22.1256 7.04345 22.2594 7.26713 22.3627 7.47527C22.4843 7.7203 22.6328 8.07474 22.6777 8.52067C22.7341 9.08222 22.6311 9.64831 22.3803 10.1539C22.1811 10.5554 21.9171 10.8347 21.7169 11.0212C21.5469 11.1795 21.3428 11.3417 21.1755 11.4746L20.5 12L21.1755 12.5254C21.3428 12.6584 21.5469 12.8205 21.7169 12.9789C21.9171 13.1653 22.1811 13.4446 22.3802 13.8461C22.631 14.3517 22.7341 14.9178 22.6776 15.4794C22.6328 15.9253 22.4842 16.2797 22.3626 16.5248C22.2593 16.7329 22.1255 16.9566 22.0158 17.14L21.5138 17.9799C21.4102 18.1535 21.2828 18.3668 21.1546 18.5485C21.0028 18.7637 20.7734 19.0491 20.4234 19.2944C19.9803 19.6051 19.4613 19.7901 18.9216 19.8298C18.4954 19.8612 18.1371 19.7852 17.8835 19.7146C17.6692 19.6549 17.4355 19.5703 17.2454 19.5014L16.3085 19.1623L16.306 19.1638C16.2715 19.1835 16.2369 19.2029 16.2021 19.2222L16.1993 19.2237L16.0577 20.0443C16.0228 20.2475 15.9799 20.4967 15.9246 20.7157C15.8592 20.9745 15.7454 21.3293 15.5007 21.6886C15.1915 22.1427 14.7635 22.5032 14.2634 22.7307C13.8678 22.9107 13.4989 22.9626 13.2327 22.983C13.0074 23.0002 12.7546 23.0001 12.5484 23H11.4516C11.2454 23.0001 10.9925 23.0002 10.7673 22.983C10.5011 22.9626 10.1322 22.9107 9.73655 22.7307C9.23648 22.5032 8.80849 22.1427 8.49926 21.6886C8.25461 21.3293 8.14077 20.9745 8.07542 20.7157C8.02011 20.4967 7.97723 20.2475 7.94225 20.0443L7.80068 19.2237L7.79791 19.2222C7.7631 19.2029 7.72845 19.1835 7.69396 19.1637L7.69142 19.1623L6.75458 19.5014C6.5645 19.5702 6.33078 19.6549 6.11651 19.7146C5.86288 19.7852 5.50463 19.8611 5.07841 19.8298C4.53866 19.7901 4.01971 19.6051 3.57654 19.2944C3.2266 19.0491 2.99714 18.7637 2.84539 18.5485C2.71718 18.3668 2.58974 18.1534 2.4861 17.9798L1.98418 17.14C1.87447 16.9566 1.74067 16.7329 1.63737 16.5248C1.51575 16.2797 1.36719 15.9253 1.32235 15.4794C1.26588 14.9178 1.36897 14.3517 1.61976 13.8461C1.81892 13.4446 2.08289 13.1653 2.28308 12.9789C2.45312 12.8205 2.65717 12.6584 2.82449 12.5254L3.47844 12.0054V11.9947L2.82445 11.4746C2.65712 11.3417 2.45308 11.1795 2.28304 11.0212C2.08285 10.8347 1.81888 10.5554 1.61972 10.1539C1.36893 9.64832 1.26584 9.08224 1.3223 8.52069C1.36714 8.07476 1.51571 7.72032 1.63732 7.47528C1.74062 7.26715 1.87443 7.04347 1.98414 6.86005L2.48605 6.02026C2.58969 5.84669 2.71714 5.63326 2.84534 5.45151C2.9971 5.23637 3.22655 4.95096 3.5765 4.70565C4.01966 4.39498 4.53862 4.20999 5.07837 4.17027C5.50458 4.1389 5.86284 4.21481 6.11646 4.28544C6.33072 4.34511 6.56444 4.4298 6.75451 4.49867L7.69141 4.83775L7.69394 4.8363C7.72844 4.8166 7.7631 4.79712 7.79791 4.77788L7.80068 4.77635L7.94225 3.95571C7.97723 3.7525 8.02011 3.50334 8.07542 3.2843C8.14077 3.0255 8.25461 2.67075 8.49926 2.31147C8.80849 1.85736 9.23648 1.49689 9.73655 1.26937C10.1322 1.08936 10.5011 1.03749 10.7673 1.01709ZM14.0938 4.3363C14.011 3.85634 13.9696 3.61637 13.8476 3.43717C13.7445 3.2858 13.6019 3.16564 13.4352 3.0898C13.2378 3.00002 12.9943 3.00002 12.5073 3.00002H11.4927C11.0057 3.00002 10.7621 3.00002 10.5648 3.0898C10.3981 3.16564 10.2555 3.2858 10.1524 3.43717C10.0304 3.61637 9.98895 3.85634 9.90615 4.3363L9.75012 5.24064C9.69445 5.56333 9.66662 5.72467 9.60765 5.84869C9.54975 5.97047 9.50241 6.03703 9.40636 6.13166C9.30853 6.22804 9.12753 6.3281 8.76554 6.52822C8.73884 6.54298 8.71227 6.55791 8.68582 6.57302C8.33956 6.77078 8.16643 6.86966 8.03785 6.90314C7.91158 6.93602 7.83293 6.94279 7.70289 6.93196C7.57049 6.92094 7.42216 6.86726 7.12551 6.7599L6.11194 6.39308C5.66271 6.2305 5.43809 6.14921 5.22515 6.16488C5.04524 6.17811 4.87225 6.23978 4.72453 6.34333C4.5497 6.46589 4.42715 6.67094 4.18206 7.08103L3.72269 7.84965C3.46394 8.2826 3.33456 8.49907 3.31227 8.72078C3.29345 8.90796 3.32781 9.09665 3.41141 9.26519C3.51042 9.4648 3.7078 9.62177 4.10256 9.9357L4.82745 10.5122C5.07927 10.7124 5.20518 10.8126 5.28411 10.9199C5.36944 11.036 5.40583 11.1114 5.44354 11.2504C5.47844 11.379 5.47844 11.586 5.47844 12C5.47844 12.414 5.47844 12.621 5.44354 12.7497C5.40582 12.8887 5.36944 12.9641 5.28413 13.0801C5.20518 13.1875 5.07927 13.2876 4.82743 13.4879L4.10261 14.0643C3.70785 14.3783 3.51047 14.5352 3.41145 14.7349C3.32785 14.9034 3.29349 15.0921 3.31231 15.2793C3.33461 15.501 3.46398 15.7174 3.72273 16.1504L4.1821 16.919C4.4272 17.3291 4.54974 17.5342 4.72457 17.6567C4.8723 17.7603 5.04528 17.8219 5.2252 17.8352C5.43813 17.8508 5.66275 17.7695 6.11199 17.607L7.12553 17.2402C7.42216 17.1328 7.5705 17.0791 7.7029 17.0681C7.83294 17.0573 7.91159 17.064 8.03786 17.0969C8.16644 17.1304 8.33956 17.2293 8.68582 17.427C8.71228 17.4421 8.73885 17.4571 8.76554 17.4718C9.12753 17.6719 9.30853 17.772 9.40635 17.8684C9.50241 17.963 9.54975 18.0296 9.60765 18.1514C9.66662 18.2754 9.69445 18.4367 9.75012 18.7594L9.90615 19.6637C9.98895 20.1437 10.0304 20.3837 10.1524 20.5629C10.2555 20.7142 10.3981 20.8344 10.5648 20.9102C10.7621 21 11.0057 21 11.4927 21H12.5073C12.9943 21 13.2378 21 13.4352 20.9102C13.6019 20.8344 13.7445 20.7142 13.8476 20.5629C13.9696 20.3837 14.011 20.1437 14.0938 19.6637L14.2499 18.7594C14.3055 18.4367 14.3334 18.2754 14.3923 18.1514C14.4502 18.0296 14.4976 17.963 14.5936 17.8684C14.6915 17.772 14.8725 17.6719 15.2344 17.4718C15.2611 17.4571 15.2877 17.4421 15.3141 17.427C15.6604 17.2293 15.8335 17.1304 15.9621 17.0969C16.0884 17.064 16.167 17.0573 16.2971 17.0681C16.4295 17.0791 16.5778 17.1328 16.8744 17.2402L17.888 17.607C18.3372 17.7696 18.5619 17.8509 18.7748 17.8352C18.9547 17.8219 19.1277 17.7603 19.2754 17.6567C19.4502 17.5342 19.5728 17.3291 19.8179 16.919L20.2773 16.1504C20.536 15.7175 20.6654 15.501 20.6877 15.2793C20.7065 15.0921 20.6721 14.9034 20.5885 14.7349C20.4895 14.5353 20.2921 14.3783 19.8974 14.0643L19.1726 13.4879C18.9207 13.2876 18.7948 13.1875 18.7159 13.0801C18.6306 12.9641 18.5942 12.8887 18.5564 12.7497C18.5215 12.6211 18.5215 12.414 18.5215 12C18.5215 11.586 18.5215 11.379 18.5564 11.2504C18.5942 11.1114 18.6306 11.036 18.7159 10.9199C18.7948 10.8126 18.9207 10.7124 19.1725 10.5122L19.8974 9.9357C20.2922 9.62176 20.4896 9.46479 20.5886 9.26517C20.6722 9.09664 20.7065 8.90795 20.6877 8.72076C20.6654 8.49906 20.5361 8.28259 20.2773 7.84964L19.8179 7.08102C19.5728 6.67093 19.4503 6.46588 19.2755 6.34332C19.1277 6.23977 18.9548 6.1781 18.7748 6.16486C18.5619 6.14919 18.3373 6.23048 17.888 6.39307L16.8745 6.75989C16.5778 6.86725 16.4295 6.92093 16.2971 6.93195C16.167 6.94278 16.0884 6.93601 15.9621 6.90313C15.8335 6.86965 15.6604 6.77077 15.3142 6.57302C15.2877 6.55791 15.2611 6.54298 15.2345 6.52822C14.8725 6.3281 14.6915 6.22804 14.5936 6.13166C14.4976 6.03703 14.4502 5.97047 14.3923 5.84869C14.3334 5.72467 14.3055 5.56332 14.2499 5.24064L14.0938 4.3363Z"/>
+			</svg>
+		</div>
+		<div class="info">
+			<a href="#" id="feedback" onclick="load(this, 'feedback_loader.php')"><?php echo $translation["FeedBack"]; ?></a>
+			<a href="logout"><?php echo $translation["SignOut"]; ?></a>
+			<br>
+			<!-- CHANGE THIS PART TO ONCLICK EVENT TO LOAD THE PAGE IN MESSAGES PANEL.
+				 DON'T FORGET TO ADD A PROPER PAGE IN VIEWS FOLDER. -->
+			<a href="/dataprotection"><?php echo $translation["DataSecurity"]; ?></a>
+			<a href="/impressum" target="_blank"><?php echo $translation["Impressum"]; ?></a>
+		</div>
+
+	</div>
+
+
+  	<div class="main">
+	  	<div></div>
+	<div class="messages">
+		<!-- THE VIEW WILL BE LOADED HERE... -->
+	</div>
+
+	<!-- TOGGLES BETWEEN INPUT_CONTAINER AND USERPOST-CONTAINER FOR USERS FEEDBACK MODULE -->
+	<div class="input-container">
+		<div class="input">
+			<div class="input-wrapper">
+				<textarea class="input-field" type="text" placeholder="<?php echo $translation["InputField_Placeholder"]; ?>" oninput="resize(this),resize(document.getElementsByClassName('input-wrapper')[0])" onkeypress="handleKeydown(event)"></textarea>
+			</div>
+			<div class="input-send" onclick="OnSendClick()">
+				<svg viewBox="2 2 21 21" width="80" height="80">
+					<g class="send-button" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" stroke="rgba(35, 48, 176)">
+						<path d="M12,2c5.5,0,10,4.5,10,10s-4.5,10-10,10S2,17.5,2,12S6.5,2,12,2z"  />
+						<path id="input-send-icon" d="M16,12l-4-4l-4,4 M12,16V8"/>
+					</g>
+				</svg>
+			</div>
+
+			<div id="system-prompt-btn" onclick="ToggleSystemPrompt(true)">
+				<svg viewBox="0 0 50 50"><path d="M 25 2 C 12.309295 2 2 12.309295 2 25 C 2 37.690705 12.309295 48 25 48 C 37.690705 48 48 37.690705 48 25 C 48 12.309295 37.690705 2 25 2 z M 25 4 C 36.609824 4 46 13.390176 46 25 C 46 36.609824 36.609824 46 25 46 C 13.390176 46 4 36.609824 4 25 C 4 13.390176 13.390176 4 25 4 z M 25 11 A 3 3 0 0 0 22 14 A 3 3 0 0 0 25 17 A 3 3 0 0 0 28 14 A 3 3 0 0 0 25 11 z M 21 21 L 21 23 L 22 23 L 23 23 L 23 36 L 22 36 L 21 36 L 21 38 L 22 38 L 23 38 L 27 38 L 28 38 L 29 38 L 29 36 L 28 36 L 27 36 L 27 21 L 26 21 L 22 21 L 21 21 z"/></svg>
+			</div>
+			<div id="system-prompt-panel">
+				<div>
+					<div id="system-prompt-title">
+						<p><b>System Prompt:</b></p>
+						<div onclick="toggleSystemPromptInfo()">
+							<svg viewBox="0 0 32 32" >
+								<path  d="M16 0c-8.836 0-16 7.163-16 16s7.163 16 16 16c8.837 0 16.001-7.163 16.001-16s-7.163-16-16.001-16zM16 30.032c-7.72 0-14-6.312-14-14.032s6.28-14 14-14 14.001 6.28 14.001 14-6.281 14.032-14.001 14.032zM14.53 25.015h2.516v-2.539h-2.516zM15.97 6.985c-1.465 0-2.672 0.395-3.62 1.184s-1.409 2.37-1.386 3.68l0.037 0.073h2.295c0-0.781 0.261-1.904 0.781-2.308s1.152-0.604 1.893-0.604c0.854 0 1.511 0.232 1.971 0.696s0.689 1.127 0.689 1.989c0 0.725-0.17 1.343-0.512 1.855-0.343 0.512-0.916 1.245-1.721 2.198-0.831 0.749-1.344 1.351-1.538 1.806s-0.297 1.274-0.305 2.454h2.405c0-0.74 0.047-1.285 0.14-1.636s0.36-0.744 0.799-1.184c0.945-0.911 1.703-1.802 2.277-2.674 0.573-0.87 0.86-1.831 0.86-2.881 0-1.465-0.443-2.607-1.331-3.424s-2.134-1.226-3.736-1.226z"></path>
+							</svg>
+						</div>
+					</div>
+
+					<p id="system-prompt-info" style="display: none">
+						<?php echo $translation["SystemPromptInfo"]; ?>
+					</p>
+				</div>
+
+
+				<p id="system-prompt"></p>
+			</div>
+
+		</div>
+		<div class="betaMessage">
+			<?php echo $translation["BetaMessage"]; ?>
+		</div>
+	</div>
+
+
+	<div class="userpost-container">
+		<div class="userpost">
+			<div class="userpost-wrapper">
+				<textarea class="userpost-field" type="text" placeholder="<?php echo $translation["Feedback_Placeholder"]; ?>" oninput="resize(this)" onkeypress="handleKeydownUserPost(event)"></textarea>
+			</div>
+			<div class="userpost-send" onclick="send_feedback()">
+				<svg viewBox="2 2 21 21" width="80" height="80">
+					<g class="send-button" fill="none" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
+						<path d="M12,2c5.5,0,10,4.5,10,10s-4.5,10-10,10S2,17.5,2,12S6.5,2,12,2z"  />
+						<path d="M16,12l-4-4l-4,4 M12,16V8"/>
+					</g>
+				</svg>
+			</div>
+		</div>
+		<div class="betaMessage">
+			<?php echo $translation["BetaMessage"]; ?>
+		</div>
+	</div>
+
+  	<template id="message">
+		<div class="message">
+			<div class="message-content">
+				<div class="message-icon">
+					<?php echo $translation["AI_Icon"]; ?>
+				</div>
+				<div class="message-text">
+					Lorem ipsum dolor sit amet consectetur, adipisicing elit. Quos incidunt, quidem soluta excepturi, ullam enim tempora.
+				</div>
+				<div class="message-copypanel " >
+					<div class="message-copyButton">
+						<svg viewBox="0 0 24 24">
+							<path d="M 17.01 14.91 H 8.47 c -0.42 0 -0.7 -0.35 -0.7 -0.7 V 2.8 c 0 -0.42 0.35 -0.7 0.7 -0.7 H 14.7 l 3.01 3.01 v 9.03 C 17.71 14.56 17.43 14.91 17.01 14.91 z M 8.47 17.01 h 8.47 c 1.54 0 2.8 -1.26 2.8 -2.8 V 5.11 c 0 -0.56 -0.21 -1.12 -0.63 -1.47 l -3.01 -3.01 C 15.82 0.21 15.26 0 14.7 0 h -6.23 c -1.54 0 -2.8 1.26 -2.8 2.8 v 11.34 C 5.67 15.75 6.93 17.01 8.47 17.01 z M 2.8 5.67 c -1.54 0 -2.8 1.26 -2.8 2.8 v 11.34 c 0 1.54 1.26 2.8 2.8 2.8 h 8.47 c 1.54 0 2.8 -1.26 2.8 -2.8 v -1.4 h -2.1 v 1.4 c 0 0.42 -0.35 0.7 -0.7 0.7 H 2.8 c -0.42 0 -0.7 -0.35 -0.7 -0.7 V 8.47 c 0 -0.42 0.35 -0.7 0.7 -0.7 h 1.4 v -2.1 H 2.8 z" />
+						</svg>
+						<span class="tooltiptext">
+							<?php echo $translation["copyTooTip"]; ?>
+						</span>
+					</div>
+				</div>
+			</div>
+		</div>
+	</template>
+</div>
+
+<?php
+	include( VIEWS_PATH . 'guidelines.php');
+?>
+
+<script>
+
+	visualViewport.addEventListener("resize", update);
+	visualViewport.addEventListener("scroll", update);
+	addEventListener("scroll", update);
+	addEventListener("load", update);
+
+	let abortCtrl = new AbortController();
+	let isReceivingData = false;
+
+	const sendicon = document.querySelector('#input-send-icon');
+	const startIcon = 'M16,12l-4-4l-4,4 M12,16V8';
+	const stopIcon = 'M9,9h6v6H9V9z'
+
+	CheckModals();
+
+	//Load chat by default when the page is loaded.
+	window.addEventListener('DOMContentLoaded', (event) => {
+		const chatBtn = document.querySelector("#chatMenuButton");
+		load(chatBtn ,'chat.php');
+    });
+
+	document.querySelector('.messages').addEventListener('scroll', function() {
+    	isScrolling = true;
+	});
+	document.querySelector('.messages').addEventListener('scroll', function() {
+		setTimeout(function() {
+			isScrolling = false;
+		}, 800); // Adjust the threshold
+	});
+
+
+	//#region HANDLE MESSAGES...
+	//----------------------------------------------------------------------------------------//
+	function handleKeydown(event){
+		if(isReceivingData) return;
+		if(event.key == "Enter" && !event.shiftKey){
+			event.preventDefault();
+			request();
+		}
+	}
+
+	function handleKeydownUserPost(event){
+		if(isReceivingData) return;
+		if(event.key == "Enter" && !event.shiftKey){
+			event.preventDefault();
+			send_feedback();
+		}
+	}
+
+	function OnSendClick(){
+		if(!isReceivingData){
+			request();
+		} else{
+			abortCtrl.abort();
+		}
+	}
+
+	async function request(){
+		const messagesElement = document.querySelector(".messages");
+		const messageTemplate = document.querySelector('#message');
+		const inputField = document.querySelector(".input-field");
+		const inputWrapper = document.querySelector(".input-wrapper");
+
+		if(inputField.value.trim() == ""){
+			return;
+		}
+
+		InitializeMessage();
+
+		//handle input-send button.
+		isReceivingData = true;
+		sendicon.setAttribute('d', stopIcon);
+		sendicon.style.color = "red";
+
+		let message = {};
+		message.role = "user";
+		//prevent html input to be rendered as html elements.
+		message.content = escapeHTML(inputField.value.trim());
+		inputField.value = "";
+		addMessage(message);
+		resize(inputField);
+		resize(inputWrapper);
+
+		document.querySelector('.limitations')?.remove();
+
+		const requestObject = {};
+		requestObject.model = 'gpt-4-turbo-preview';
+		requestObject.stream = true;
+		requestObject.messages = [];
+		const messageElements = messagesElement.querySelectorAll(".message");
+		messageElements.forEach(messageElement => {
+			let messageObject = {};
+			messageObject.role = messageElement.dataset.role;
+			messageObject.content = messageElement.querySelector(".message-text").textContent;
+			requestObject.messages.push(messageObject);
+		})
+
+		
+		const streamAPI = "/api/stream-api";
+		postData(streamAPI, requestObject)
+		.then(stream => processStream(stream))
+		.catch(error => console.error('Error:', error));
+	}
+
+	async function postData(url = '', data = {}) {
+		try{
+			abortCtrl = new AbortController();
+
+			const response = await fetch(url, {
+				method: 'POST',
+				headers: {
+					'Content-Type': 'application/json'
+				},
+				body: JSON.stringify(data),
+				signal: abortCtrl.signal
+			});
+			return response.body;
+
+		} catch(error){
+			console.log('Fetching Aborted $error');
+		}
+	}
+
+	async function processStream(stream) {
+		// if fetching is aborted before it's complete the stream will be empty.
+		// stream should be checked to avoid throwing error.
+		if (!stream) {
+			isReceivingData = false;
+			sendicon.setAttribute('d', startIcon)
+
+			return;
+		}
+
+		const reader = stream.getReader();
+
+		const messagesElement = document.querySelector(".messages");
+		const messageTemplate = document.querySelector('#message');
+		const messageElement = messageTemplate.content.cloneNode(true);
+
+		messageElement.querySelector(".message-text").innerHTML = "";
+		messageElement.querySelector(".message").dataset.role = "assistant";
+		messagesElement.appendChild(messageElement);
+
+		const messageText = messageElement.querySelector(".message-text");
+
+		// Throws error if the read operation on the response body stream is aborted while the reader.read() operation is still active.
+		// Try Catch block will handle the error.
+		try {
+			//NOTE: Niklas Wode
+			let incompleteSlice = "";
+			while (true) {
+				const { done, value } = await reader.read();
+
+				if (done) {
+					console.log('Stream closed.');
+					document.querySelector(".message:last-child").querySelector(".message-text").innerHTML = document.querySelector(".message:last-child").querySelector(".message-text").innerHTML;
+
+					isReceivingData = false;
+					sendicon.setAttribute('d', startIcon)
+
+					ShowCopyButton();
+					break;
+				}
+
+				//Parsing error from json "Chunks" corrected
+				let decodedData = new TextDecoder().decode(value);
+				decodedData = incompleteSlice + decodedData;
+
+				const delimiter = '\n\n';
+				const delimiterPosition = decodedData.lastIndexOf(delimiter);
+				if (delimiterPosition > -1) {
+					incompleteSlice = decodedData.substring(delimiterPosition + delimiter.length);
+					decodedData = decodedData.substring(0,delimiterPosition + delimiter.length);
+				} else {
+					incompleteSlice = decodedData;
+					continue;
+				}
+				// end of inserted code
+
+				let chunks = decodedData.split("data: ");
+				chunks.forEach((chunk, index) => {
+
+					if(!isJSON(chunk)){
+						return;
+					}
+					if(chunk.indexOf('finish_reason":"stop"') > 0) return false;
+					if(chunk.indexOf('DONE') > 0) return false;
+					if(chunk.indexOf('role') > 0) return false;
+					if(chunk.length == 0) return false;
+
+					document.querySelector(".message:last-child").querySelector(".message-text").innerHTML =  FormatChunk(JSON.parse(chunk)["choices"][0]["delta"].content);
+
+				})
+
+				FormatMathFormulas();
+
+				hljs.highlightAll();
+				scrollToLast();
+			}
+		} catch (error) {
+			// Check if the error is due to aborting the request
+			if (error.name == 'AbortError') {
+				console.log('Fetch aborted while reading response body stream.');
+			} else {
+				console.error('Error:', error);
+			}
+			isReceivingData = false;
+			sendicon.setAttribute('d', startIcon);
+			ShowCopyButton();
+		}
+	}
+
+	//MESSAGE SENT FROM STREAM MANAGER...
+	function addMessage(message){
+		const messagesElement = document.querySelector(".messages");
+		const messageTemplate = document.querySelector('#message');
+		const inputField = document.querySelector(".input-field");
+		const messageElement = messageTemplate.content.cloneNode(true);
+
+		messageElement.querySelector(".message-text").innerHTML = message.content;
+		messageElement.querySelector(".message").dataset.role = message.role;
+
+		if(message.role == "assistant"){
+			messageElement.querySelector(".message-icon").textContent = "AI";
+		}else{
+			messageElement.querySelector(".message-icon").textContent = '<?= htmlspecialchars($_SESSION['username']) ?>';
+			messageElement.querySelector(".message").classList.add("me");
+		}
+
+		messagesElement.appendChild(messageElement);
+
+		scrollToLast(true);
+		return messageElement;
+	}
+
+	//#endregion
+
+
+
+	//#region Copy Button
+	//----------------------------------------------------------------------------------------//
+	function ShowCopyButton() {
+		const copyPanel = document.querySelector(".message:last-child").querySelector(".message-copypanel");
+		if (copyPanel !== null) {
+			copyPanel.style.display = "flex";
+			const copyButton = copyPanel.querySelector(".message-copyButton");
+			copyButton.dataset.clicked = "false"; // Initialize the clicked state for this button
+			AddEventListenersToCopyButton(copyButton);
+		}
+		AddCodeCopyButton();
+	}
+
+	function AddCodeCopyButton(){
+		const lastMsg = document.querySelector(".message:last-child").querySelector(".message-text");
+		const codes = lastMsg.querySelectorAll('pre');
+
+		for (let i = 0; i < codes.length; i++) {
+			const code = codes[i];
+			if (!code.querySelector('.code-copypanel')) {
+				const copyPanel = document.createElement('div');
+				copyPanel.classList.add('code-copypanel');
+
+				const copyButton = document.createElement('div');
+				copyButton.classList.add('code-copyButton', 'ignoreTextCopy');
+				copyButton.innerHTML = `
+					<svg viewBox="0 0 24 24">
+						<path d="M 17.01 14.91 H 8.47 c -0.42 0 -0.7 -0.35 -0.7 -0.7 V 2.8 c 0 -0.42 0.35 -0.7 0.7 -0.7 H 14.7 l 3.01 3.01 v 9.03 C 17.71 14.56 17.43 14.91 17.01 14.91 z M 8.47 17.01 h 8.47 c 1.54 0 2.8 -1.26 2.8 -2.8 V 5.11 c 0 -0.56 -0.21 -1.12 -0.63 -1.47 l -3.01 -3.01 C 15.82 0.21 15.26 0 14.7 0 h -6.23 c -1.54 0 -2.8 1.26 -2.8 2.8 v 11.34 C 5.67 15.75 6.93 17.01 8.47 17.01 z M 2.8 5.67 c -1.54 0 -2.8 1.26 -2.8 2.8 v 11.34 c 0 1.54 1.26 2.8 2.8 2.8 h 8.47 c 1.54 0 2.8 -1.26 2.8 -2.8 v -1.4 h -2.1 v 1.4 c 0 0.42 -0.35 0.7 -0.7 0.7 H 2.8 c -0.42 0 -0.7 -0.35 -0.7 -0.7 V 8.47 c 0 -0.42 0.35 -0.7 0.7 -0.7 h 1.4 v -2.1 H 2.8 z" />
+					</svg>
+					<span class="tooltiptext">Copy</span>`;
+
+				copyButton.dataset.clicked = "false";
+				AddEventListenersToCopyButton(copyButton);
+				copyPanel.appendChild(copyButton);
+				code.appendChild(copyPanel);
+			}
+		}
+	}
+
+
+	//Event listeners help control the tooltip box transitions
+	function AddEventListenersToCopyButton(TargetButton){
+		let activationTimer;
+		TargetButton.addEventListener("mouseenter", function() {
+			activationTimer = setTimeout(function() {
+				TargetButton.querySelector(".tooltiptext").classList.add("active");
+			}, 1000);
+		});
+
+		TargetButton.addEventListener("mouseleave", function () {
+			clearTimeout(activationTimer);
+			if (TargetButton.dataset.clicked !== "true") { // Check the clicked state of this button
+				TargetButton.querySelector(".tooltiptext").classList.remove("active");
+			}
+		});
+
+		TargetButton.addEventListener("mousedown", function () {
+			TargetButton.dataset.clicked = "true"; // Set the clicked state of this button to true
+			CopyContentToClipboard(TargetButton);
+		});
+
+		TargetButton.addEventListener("mouseup", function() {
+			CopyBtnRelease(TargetButton);
+		});
+	}
+
+	// Copies content of the message box without the css attributes
+	function CopyContentToClipboard(target) {
+
+		const parentElement = target.parentElement.previousElementSibling;
+		const clone = parentElement.cloneNode(true);
+
+		// Remove elements with the "ignoreTextCopy" class from the clone (copy buttons for instance)
+		clone.querySelectorAll('.ignoreTextCopy').forEach(element => {
+			element.parentNode.removeChild(element);
+		});
+
+		    // Convert tables to plain text
+			clone.querySelectorAll('table').forEach(table => {
+				const plainTextTable = tableToPlainText(table);
+				const textNode = document.createTextNode(plainTextTable);
+				table.parentNode.replaceChild(textNode, table);
+			});
+
+
+		// Get the text content of the modified clone
+		const msgTxt = clone.textContent.trim();
+
+		const trimmedMsg = msgTxt.trim();
+		navigator.clipboard.writeText(trimmedMsg);
+
+		target.style.opacity = "1";
+		target.style.scale = "1.1";
+		target.querySelector(".tooltiptext").classList.add("active");
+		target.querySelector(".tooltiptext").innerHTML = '<?php echo $translation["copiedToolTip"]; ?>'
+	}
+
+	function CopyBtnRelease(target) {
+		target.style.scale = "1";
+
+		setTimeout(function () {
+			target.style.opacity = "0.5";
+
+			target.querySelector(".tooltiptext").classList.remove("active");
+			target.querySelector(".tooltiptext").innerHTML = '<?php echo $translation["copyTooTip"]; ?>';
+			target.dataset.clicked = "false"; // Reset the clicked state of this button
+		}, 2000);
+	}
+
+	// Helper function to convert HTML table to plain text
+	function tableToPlainText(table) {
+		let plainText = '';
+		table.querySelectorAll('tr').forEach(row => {
+			row.querySelectorAll('th, td').forEach(cell => {
+				plainText += cell.textContent.trim() + '\t';
+			});
+			plainText += '\n';
+		});
+		return plainText;
+	}
+	//#endregion
+
+	//#region USER FEEDBACK
+	//----------------------------------------------------------------------------------------//
+	//save users feedback on server.
+	//other users can up or downvote othes feedback
+	async function send_feedback(){
+		const messagesElement = document.querySelector(".messages");
+		const inputField = document.querySelector(".userpost-field");
+
+		if(inputField.value == ''){
+			return;
+		}
+
+		let message = {};
+		message.role = '<?= htmlspecialchars($_SESSION['username']) ?>';
+		message.content = inputField.value.trim();
+
+		// const feedback_send = "../private/app/php/feedback_send.php";
+		const feedback_send = "/api/feedback_send"
+		const csrfToken = document.querySelector('meta[name="csrf-token"]').getAttribute('content');
+
+		fetch(feedback_send, {
+			method: 'POST',
+			headers: {
+				'Content-Type': 'application/json', // Set content type to application/json
+				'X-CSRF-TOKEN': csrfToken, // Include CSRF token in the request headers
+			},
+			body: JSON.stringify({message: message}),
+		})
+		.then(response => response.json())
+		.then(data => {
+			//UPDATE NEW TOKEN
+			document.querySelector('meta[name="csrf-token"]').setAttribute('content', data.csrf_token);
+
+			if(data.success){
+				load(document.querySelector("#feedback"), 'feedback_loader.php');
+				inputField.value = "";
+			}
+		})
+		.catch(error => console.error(error));
+	}
+
+	function SubmitVote(element, action) {
+		if (localStorage.getItem(element.dataset.id)) {
+			return;
+		}
+
+		const pureId = element.dataset.id.replace('.json', ''); // assuming all IDs end with '.json'
+		const csrfToken = document.querySelector('meta[name="csrf-token"]').getAttribute('content');
+		const submit_vote = "/api/submit_vote";
+
+		fetch(submit_vote, {
+			method: 'POST',
+			headers: {
+				'Content-Type': 'application/json', // Set content type to application/json
+				'X-CSRF-TOKEN': csrfToken, // Include CSRF token in the request headers
+			},
+			body: JSON.stringify({ id: pureId, action: action }), // Send the action and CSRF token in the request body
+		})
+		.then(response => {
+			if (!response.ok) {
+				throw new Error(`HTTP error! status: ${response.status}`);
+			}
+			return response.json();
+		})
+		.then(data => {
+
+			document.querySelector('meta[name="csrf-token"]').setAttribute('content', data.csrf_token);
+			if(data.success){
+
+				// Update the UI accordingly
+				if (action === "upvote") {
+					element.querySelector("span").textContent = data.content.up || 0; // Assuming 'data.up' contains the updated upvote count
+				}
+				if (action === "downvote") {
+					element.querySelector("span").textContent = data.content.down || 0; // Assuming 'data.down' contains the updated downvote count
+				}
+			}
+		})
+		.catch(error => {
+			console.error('Fetch error:', error);
+		});
+		localStorage.setItem(element.dataset.id, "true");
+
+		voteHover();
+	}
+
+	async function voteHover(){
+		let messages = document.querySelectorAll(".message");
+
+		messages.forEach((message)=>{
+			let voteButtons = message.querySelectorAll(".vote")
+
+			voteButtons.forEach((voteButton)=>{
+				if(localStorage.getItem(voteButton.dataset.id)){
+					voteButton.classList.remove("vote-hover");
+				}else{
+					voteButton.classList.add("vote-hover");
+				}
+			})
+		})
+	}
+	//#endregion
+</script>

--- private/pages/login.php ---
@@ -0,0 +1,190 @@
+<?php
+	// Secure session (optional, depends on the application's specific needs)
+	ini_set('session.cookie_httponly', 1);
+	ini_set('session.use_only_cookies', 1);
+	if(isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on') {
+		ini_set('session.cookie_secure', 1);
+	}
+	session_set_cookie_params([
+		'secure' => true,     // cookies are sent over secure connections only
+		'httponly' => true,   // cookies are accessible only through the HTTP protocol
+	]);
+
+	session_start();
+
+	require_once BOOTSTRAP_PATH;
+	require_once LIBRARY_PATH . 'csrf.php';
+	require_once LIBRARY_PATH . 'auth.php';
+	require_once LIBRARY_PATH . 'language_controller.php';
+
+
+	// Generate CSRF Token
+	if(!isset($_SESSION['csrf_token'])){
+		generate_csrf_token();
+	}
+	// Update Translation Language
+	if(!isset($_SESSION['translation'])){
+		setLanguage();
+	}
+	$translation = $_SESSION['translation'];
+
+	// Check if the user is already logged in
+	if (isset($_SESSION['username'])) {
+		header("Location: /interface");
+		exit;
+	}
+
+?>
+
+<!DOCTYPE html>
+<html lang="en" >
+	<head>
+		<meta charset="UTF-8">
+		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no" />
+
+		<!-- SAVE CSRF TOKEN ON THE CLIENT SIDE. -->
+		<?php if (isset($_SESSION['csrf_token'])) : ?>
+			<meta name="csrf-token" content="<?php echo $_SESSION['csrf_token']; error_log($_SESSION['csrf_token']);?>">
+		<?php endif; ?>
+		
+		<title>HAWKI</title>
+
+		<link rel="stylesheet" href="/public/style/style.css">
+		<link rel="stylesheet" href="/public/style/login_style.css">
+		<link rel="stylesheet" href="/public/style/settings_style.css">
+		
+		<script src="/public/js/scripts.js"></script>
+		
+		<!-- TO PREVENT FOUC WHEN RELOADING THE PAGE IN DARK MODE
+			THE SETTINGS AND IT'S START FUNCTIONS SHOULD BE INCLUDED IN THE HEADER BEFORE THE PAGE IS LOADED -->
+		<?php include PRIVATE_PATH . '/views/settings.php'; ?>
+		<script>
+			SwitchDarkMode(false);
+			UpdateSettingsLanguage(`<?php echo $_SESSION['language'] ?>`);
+		</script>
+
+	</head>
+	<body>
+		<div class="wrapper">
+			<div class= "sidebar">
+				
+				<div class="loginPanel">
+					<img id="HAWK_logo" src="/public/img/logo.svg" alt="">
+					<h3><?php echo $translation["welcomeBackTitle"]; ?></h3>
+					<?php
+						if (file_exists(ENV_FILE_PATH)){
+							$env = parse_ini_file(ENV_FILE_PATH);
+						}
+						$login_available = false;
+						if ((isset($env) ? $env["Authentication"] : getenv("Authentication")) == "OIDC") {
+							// Open ID Connect
+							$login_available = true;
+							echo
+							"<form action='oidc_login.php' class='column' method='post'>
+								<button>" . $translation['Login'] . "</button>
+							</form>";
+						}
+						if ((isset($env) ? $env["Authentication"] : getenv("Authentication")) == "LDAP") {
+							$login_available = true;
+							echo
+								'<form class="column" id="loginForm">
+									<label for="account">' . $translation["username"] . '</label>
+									<input type="text" name="account" id="account">
+									<label for="password">' . $translation["password"] . '</label>
+									<input type="password" name="password" id="password">
+								</form>
+								<div id="login-Button-panel">
+									<div id="login-message"></div>
+									<button id="loginButton" type="button" onclick="LoginLDAP()">' . $translation['Login'] .'</button>
+								</div>';
+						}
+						if ((isset($env) ? $env["Authentication"] : getenv("Authentication")) == "Shibboleth") {
+							$login_available = true;
+							echo
+								'<form class="column" method = "post" >
+									<button type="submit" name="submit">' . $translation['Login'] . '</button >
+								</form>';
+						}
+						if (!$login_available) {
+							echo 'No authentication method defined';
+							die;
+						}
+					?>
+				</div>
+
+				<div class="footerPanel">
+					<div class="settings-btn" onclick="toggleSettingsPanel(true)">
+						<svg  viewBox="0 0 24 24">
+							<path fill-rule="evenodd" clip-rule="evenodd" d="M12 8.00002C9.79085 8.00002 7.99999 9.79088 7.99999 12C7.99999 14.2092 9.79085 16 12 16C14.2091 16 16 14.2092 16 12C16 9.79088 14.2091 8.00002 12 8.00002ZM9.99999 12C9.99999 10.8955 10.8954 10 12 10C13.1046 10 14 10.8955 14 12C14 13.1046 13.1046 14 12 14C10.8954 14 9.99999 13.1046 9.99999 12Z"/>
+							<path fill-rule="evenodd" clip-rule="evenodd" d="M12 8.00002C9.79085 8.00002 7.99999 9.79088 7.99999 12C7.99999 14.2092 9.79085 16 12 16C14.2091 16 16 14.2092 16 12C16 9.79088 14.2091 8.00002 12 8.00002ZM9.99999 12C9.99999 10.8955 10.8954 10 12 10C13.1046 10 14 10.8955 14 12C14 13.1046 13.1046 14 12 14C10.8954 14 9.99999 13.1046 9.99999 12Z"/>
+							<path fill-rule="evenodd" clip-rule="evenodd" d="M10.7673 1.01709C10.9925 0.999829 11.2454 0.99993 11.4516 1.00001L12.5484 1.00001C12.7546 0.99993 13.0075 0.999829 13.2327 1.01709C13.4989 1.03749 13.8678 1.08936 14.2634 1.26937C14.7635 1.49689 15.1915 1.85736 15.5007 2.31147C15.7454 2.67075 15.8592 3.0255 15.9246 3.2843C15.9799 3.50334 16.0228 3.75249 16.0577 3.9557L16.1993 4.77635L16.2021 4.77788C16.2369 4.79712 16.2715 4.81659 16.306 4.8363L16.3086 4.83774L17.2455 4.49865C17.4356 4.42978 17.6693 4.34509 17.8835 4.28543C18.1371 4.2148 18.4954 4.13889 18.9216 4.17026C19.4614 4.20998 19.9803 4.39497 20.4235 4.70563C20.7734 4.95095 21.0029 5.23636 21.1546 5.4515C21.2829 5.63326 21.4103 5.84671 21.514 6.02029L22.0158 6.86003C22.1256 7.04345 22.2594 7.26713 22.3627 7.47527C22.4843 7.7203 22.6328 8.07474 22.6777 8.52067C22.7341 9.08222 22.6311 9.64831 22.3803 10.1539C22.1811 10.5554 21.9171 10.8347 21.7169 11.0212C21.5469 11.1795 21.3428 11.3417 21.1755 11.4746L20.5 12L21.1755 12.5254C21.3428 12.6584 21.5469 12.8205 21.7169 12.9789C21.9171 13.1653 22.1811 13.4446 22.3802 13.8461C22.631 14.3517 22.7341 14.9178 22.6776 15.4794C22.6328 15.9253 22.4842 16.2797 22.3626 16.5248C22.2593 16.7329 22.1255 16.9566 22.0158 17.14L21.5138 17.9799C21.4102 18.1535 21.2828 18.3668 21.1546 18.5485C21.0028 18.7637 20.7734 19.0491 20.4234 19.2944C19.9803 19.6051 19.4613 19.7901 18.9216 19.8298C18.4954 19.8612 18.1371 19.7852 17.8835 19.7146C17.6692 19.6549 17.4355 19.5703 17.2454 19.5014L16.3085 19.1623L16.306 19.1638C16.2715 19.1835 16.2369 19.2029 16.2021 19.2222L16.1993 19.2237L16.0577 20.0443C16.0228 20.2475 15.9799 20.4967 15.9246 20.7157C15.8592 20.9745 15.7454 21.3293 15.5007 21.6886C15.1915 22.1427 14.7635 22.5032 14.2634 22.7307C13.8678 22.9107 13.4989 22.9626 13.2327 22.983C13.0074 23.0002 12.7546 23.0001 12.5484 23H11.4516C11.2454 23.0001 10.9925 23.0002 10.7673 22.983C10.5011 22.9626 10.1322 22.9107 9.73655 22.7307C9.23648 22.5032 8.80849 22.1427 8.49926 21.6886C8.25461 21.3293 8.14077 20.9745 8.07542 20.7157C8.02011 20.4967 7.97723 20.2475 7.94225 20.0443L7.80068 19.2237L7.79791 19.2222C7.7631 19.2029 7.72845 19.1835 7.69396 19.1637L7.69142 19.1623L6.75458 19.5014C6.5645 19.5702 6.33078 19.6549 6.11651 19.7146C5.86288 19.7852 5.50463 19.8611 5.07841 19.8298C4.53866 19.7901 4.01971 19.6051 3.57654 19.2944C3.2266 19.0491 2.99714 18.7637 2.84539 18.5485C2.71718 18.3668 2.58974 18.1534 2.4861 17.9798L1.98418 17.14C1.87447 16.9566 1.74067 16.7329 1.63737 16.5248C1.51575 16.2797 1.36719 15.9253 1.32235 15.4794C1.26588 14.9178 1.36897 14.3517 1.61976 13.8461C1.81892 13.4446 2.08289 13.1653 2.28308 12.9789C2.45312 12.8205 2.65717 12.6584 2.82449 12.5254L3.47844 12.0054V11.9947L2.82445 11.4746C2.65712 11.3417 2.45308 11.1795 2.28304 11.0212C2.08285 10.8347 1.81888 10.5554 1.61972 10.1539C1.36893 9.64832 1.26584 9.08224 1.3223 8.52069C1.36714 8.07476 1.51571 7.72032 1.63732 7.47528C1.74062 7.26715 1.87443 7.04347 1.98414 6.86005L2.48605 6.02026C2.58969 5.84669 2.71714 5.63326 2.84534 5.45151C2.9971 5.23637 3.22655 4.95096 3.5765 4.70565C4.01966 4.39498 4.53862 4.20999 5.07837 4.17027C5.50458 4.1389 5.86284 4.21481 6.11646 4.28544C6.33072 4.34511 6.56444 4.4298 6.75451 4.49867L7.69141 4.83775L7.69394 4.8363C7.72844 4.8166 7.7631 4.79712 7.79791 4.77788L7.80068 4.77635L7.94225 3.95571C7.97723 3.7525 8.02011 3.50334 8.07542 3.2843C8.14077 3.0255 8.25461 2.67075 8.49926 2.31147C8.80849 1.85736 9.23648 1.49689 9.73655 1.26937C10.1322 1.08936 10.5011 1.03749 10.7673 1.01709ZM14.0938 4.3363C14.011 3.85634 13.9696 3.61637 13.8476 3.43717C13.7445 3.2858 13.6019 3.16564 13.4352 3.0898C13.2378 3.00002 12.9943 3.00002 12.5073 3.00002H11.4927C11.0057 3.00002 10.7621 3.00002 10.5648 3.0898C10.3981 3.16564 10.2555 3.2858 10.1524 3.43717C10.0304 3.61637 9.98895 3.85634 9.90615 4.3363L9.75012 5.24064C9.69445 5.56333 9.66662 5.72467 9.60765 5.84869C9.54975 5.97047 9.50241 6.03703 9.40636 6.13166C9.30853 6.22804 9.12753 6.3281 8.76554 6.52822C8.73884 6.54298 8.71227 6.55791 8.68582 6.57302C8.33956 6.77078 8.16643 6.86966 8.03785 6.90314C7.91158 6.93602 7.83293 6.94279 7.70289 6.93196C7.57049 6.92094 7.42216 6.86726 7.12551 6.7599L6.11194 6.39308C5.66271 6.2305 5.43809 6.14921 5.22515 6.16488C5.04524 6.17811 4.87225 6.23978 4.72453 6.34333C4.5497 6.46589 4.42715 6.67094 4.18206 7.08103L3.72269 7.84965C3.46394 8.2826 3.33456 8.49907 3.31227 8.72078C3.29345 8.90796 3.32781 9.09665 3.41141 9.26519C3.51042 9.4648 3.7078 9.62177 4.10256 9.9357L4.82745 10.5122C5.07927 10.7124 5.20518 10.8126 5.28411 10.9199C5.36944 11.036 5.40583 11.1114 5.44354 11.2504C5.47844 11.379 5.47844 11.586 5.47844 12C5.47844 12.414 5.47844 12.621 5.44354 12.7497C5.40582 12.8887 5.36944 12.9641 5.28413 13.0801C5.20518 13.1875 5.07927 13.2876 4.82743 13.4879L4.10261 14.0643C3.70785 14.3783 3.51047 14.5352 3.41145 14.7349C3.32785 14.9034 3.29349 15.0921 3.31231 15.2793C3.33461 15.501 3.46398 15.7174 3.72273 16.1504L4.1821 16.919C4.4272 17.3291 4.54974 17.5342 4.72457 17.6567C4.8723 17.7603 5.04528 17.8219 5.2252 17.8352C5.43813 17.8508 5.66275 17.7695 6.11199 17.607L7.12553 17.2402C7.42216 17.1328 7.5705 17.0791 7.7029 17.0681C7.83294 17.0573 7.91159 17.064 8.03786 17.0969C8.16644 17.1304 8.33956 17.2293 8.68582 17.427C8.71228 17.4421 8.73885 17.4571 8.76554 17.4718C9.12753 17.6719 9.30853 17.772 9.40635 17.8684C9.50241 17.963 9.54975 18.0296 9.60765 18.1514C9.66662 18.2754 9.69445 18.4367 9.75012 18.7594L9.90615 19.6637C9.98895 20.1437 10.0304 20.3837 10.1524 20.5629C10.2555 20.7142 10.3981 20.8344 10.5648 20.9102C10.7621 21 11.0057 21 11.4927 21H12.5073C12.9943 21 13.2378 21 13.4352 20.9102C13.6019 20.8344 13.7445 20.7142 13.8476 20.5629C13.9696 20.3837 14.011 20.1437 14.0938 19.6637L14.2499 18.7594C14.3055 18.4367 14.3334 18.2754 14.3923 18.1514C14.4502 18.0296 14.4976 17.963 14.5936 17.8684C14.6915 17.772 14.8725 17.6719 15.2344 17.4718C15.2611 17.4571 15.2877 17.4421 15.3141 17.427C15.6604 17.2293 15.8335 17.1304 15.9621 17.0969C16.0884 17.064 16.167 17.0573 16.2971 17.0681C16.4295 17.0791 16.5778 17.1328 16.8744 17.2402L17.888 17.607C18.3372 17.7696 18.5619 17.8509 18.7748 17.8352C18.9547 17.8219 19.1277 17.7603 19.2754 17.6567C19.4502 17.5342 19.5728 17.3291 19.8179 16.919L20.2773 16.1504C20.536 15.7175 20.6654 15.501 20.6877 15.2793C20.7065 15.0921 20.6721 14.9034 20.5885 14.7349C20.4895 14.5353 20.2921 14.3783 19.8974 14.0643L19.1726 13.4879C18.9207 13.2876 18.7948 13.1875 18.7159 13.0801C18.6306 12.9641 18.5942 12.8887 18.5564 12.7497C18.5215 12.6211 18.5215 12.414 18.5215 12C18.5215 11.586 18.5215 11.379 18.5564 11.2504C18.5942 11.1114 18.6306 11.036 18.7159 10.9199C18.7948 10.8126 18.9207 10.7124 19.1725 10.5122L19.8974 9.9357C20.2922 9.62176 20.4896 9.46479 20.5886 9.26517C20.6722 9.09664 20.7065 8.90795 20.6877 8.72076C20.6654 8.49906 20.5361 8.28259 20.2773 7.84964L19.8179 7.08102C19.5728 6.67093 19.4503 6.46588 19.2755 6.34332C19.1277 6.23977 18.9548 6.1781 18.7748 6.16486C18.5619 6.14919 18.3373 6.23048 17.888 6.39307L16.8745 6.75989C16.5778 6.86725 16.4295 6.92093 16.2971 6.93195C16.167 6.94278 16.0884 6.93601 15.9621 6.90313C15.8335 6.86965 15.6604 6.77077 15.3142 6.57302C15.2877 6.55791 15.2611 6.54298 15.2345 6.52822C14.8725 6.3281 14.6915 6.22804 14.5936 6.13166C14.4976 6.03703 14.4502 5.97047 14.3923 5.84869C14.3334 5.72467 14.3055 5.56332 14.2499 5.24064L14.0938 4.3363Z"/>
+						</svg>
+					</div>
+
+					<div class="impressumPanel">
+						<a href="/dataprotection" target="_blank"><?php echo $translation["dataProtection"]; ?></a>
+						<a href="/impressum" target="_blank"><?php echo $translation["imprint"]; ?></a>
+					</div>
+				</div>
+			</div>
+			<main>
+				<div class="infoPanel">
+					<div class="textPanel">
+						<div class="page">
+							<?php echo $translation['infoPanel_Content']; ?>
+						</div>
+					</div>
+					<form class="submitButtonPanel" target="_blank" action="https://elearning.hawk.de/de/ki-studium-und-lehre">
+						<button type="submit"><?php echo $translation["aiOverviewPage"]; ?></button>
+					</form>
+				</div>
+				<div class="backgroundImageContainer">
+					<video class="image_preview_container" src="/public/img/HAWKIBG.m4v" type="video/m4v" preload = "none" autoplay loop muted></video>
+				</div>
+			</main>
+		</div>
+	</body>
+</html>
+
+<script>
+	window.addEventListener('DOMContentLoaded', (event) => {
+		if(window.innerWidth < 480){
+			const bgVideo = document.querySelector(".image_preview_container");
+			bgVideo.remove();
+		}
+    });
+
+	function LoginLDAP() {
+		var formData = new FormData();
+		formData.append("account", document.getElementById("account").value);
+		formData.append("password", document.getElementById("password").value);
+		formData.append("csrf_token", document.querySelector('meta[name="csrf-token"]').getAttribute('content'));
+
+		const auth = `<?php LIBRARY_PATH . 'auth.php'; ?>`
+
+		fetch(auth, {
+			method: "POST",
+			body: formData
+			})
+		.then(response => {
+			if (!response.ok) {
+				throw new Error("Login request failed");
+			}
+			return response.json();
+			})
+		.then(data => {
+			//Update Header CSRF.
+			document.querySelector('meta[name="csrf-token"]').setAttribute('content', data.csrf_token);
+
+			if (data.success) {
+				window.location.href = 'interface';
+			} else {
+				// console.log('wrong credentials');
+				document.getElementById("login-message").textContent = data.message; // Display error message
+			}
+			})
+		.catch(error => {
+			console.error(error);
+		});
+	}
+</script>

--- private/pages/logout.php ---
@@ -0,0 +1,18 @@
+<?php
+    session_start();
+    // Unset all session variables
+    $_SESSION = array();
+    // If it's desired, regenerate session ID (good practice for login but optional on logout)
+    session_regenerate_id(true);
+
+    //Remove PHPSESSID
+    if (isset($_COOKIE['PHPSESSID'])){
+        setcookie ("PHPSESSID", "", time() - 3600);
+    }
+
+    // Finally, destroy the session.
+    session_destroy();
+    // Redirect to the login page
+    header('Location: login');
+    exit;
+?>

--- private/pages/oidc_login.php ---
@@ -1,12 +1,14 @@
 <?php
+define('BOOTSTRAP_PATH',  '../bootstrap.php');
+require_once BOOTSTRAP_PATH;
 
 // use library for dealing with OpenID connect
 require __DIR__ . '/vendor/autoload.php';
 
 use Jumbojett\OpenIDConnectClient;
 
-if (file_exists(".env")){
-    $env = parse_ini_file('.env');
+if (file_exists(ENV_FILE_PATH)){
+    $env = parse_ini_file(ENV_FILE_PATH);
 }
 
 // Create OpenID connect client
@@ -35,7 +37,7 @@
 
 $_SESSION['username'] = $oidc->requestUserInfo('email');
 
-header("Location: interface.php");
+header("Location: /interface");
 exit();
 
 ?>
\ No newline at end of file

--- private/pages/oidc_logout.php ---
@@ -1,8 +1,11 @@
 <?php
 session_start();
 session_destroy();
-if (file_exists(".env")){
-    $env = parse_ini_file('.env');
+
+define('BOOTSTRAP_PATH',  '../bootstrap.php');
+require_once BOOTSTRAP_PATH;
+if (file_exists(ENV_FILE_PATH)){
+    $env = parse_ini_file(ENV_FILE_PATH);
 }
 $logout_uri = isset($env) ? $env['OIDC_LOGOUT_URI'] : getenv('OIDC_LOGOUT_URI');
 header("Location: $logout_uri");

--- private/resources/feedback/feedback_db.json ---
@@ -0,0 +1,3 @@
+[
+
+]
\ No newline at end of file

--- private/resources/language/de_DE.json ---
@@ -0,0 +1,141 @@
+{
+    "AI_Icon": "KI",
+    "AboutHAWKI": "Über HAWKI",
+    "AboutHAWKI_ArianInfo": " | Wissenschaftlicher Mitarbeiter | HAWKI",
+    "AboutHAWKI_Info": "Das Angebot wurde im Interaction Design Lab der HAWK entwickelt, um allen Hochschulangehörigen die Möglichkeit zu geben, künstliche Intelligenz in die Arbeitsprozesse zu integrieren und einen Begegnungsraum zu haben, damit sich eventuell neue Arbeitsweisen ergeben und eine hochschulinterne Diskussion über den Einsatz von K.I. entstehen kann. Dieses Angebot möchte auch didaktisch unterstützen, ein Verständnis für die Wirkungsweise eines solchen Sprachmodells zu entwickeln und gibt daher in den verschiedenen Bereichen auch Hinweise auf gut funktionierende Prompts (Texteingaben). Wir freuen uns über konstruktives Feedback, um dieses Angebot entsprechend Ihren Bedürfnissen und Erkenntnissen weiterzuentwickeln.",
+    "AboutHAWKI_JonasInfo": " | Wissenschaftlicher Mitarbeiter | Hands On",
+    "AboutHAWKI_StefanInfo": " | Digital Environments | Interaction Design ",
+    "AboutHAWKI_VincentInfo": " | Wissenschaftlicher Mitarbeiter | Leitung Interaction Design Lab",
+    "BetaMessage": "Betaversion - Modell GPT4-Turbo",
+    "BrainStorming": "Ideenfindung",
+    "Caution": "Vorsicht",
+    "Caution_Info": " - Generiert gelegentlich gefährdende oder voreingenommene Informationen.",
+    "Chat": "Chat",
+    "Confirm_Btn": "Bestätigen",
+    "ContextComprehension": "Kontextverständnis",
+    "ContextComprehension_Info": " - Merkt sich, was vorab in der Konversation gesagt wurde.",
+    "Conversation": "Konversation",
+    "Conversation_Info": "Ein Chatbereich wie bei ChatGPT, für einen schnellen Einstieg in jede beliebige Aufgabe.",
+    "Copywriting": "CopyWriting",
+    "Creativity": "Kreativität",
+    "DataAnalysis": "Datenanalyse",
+    "DataSecurity": "Datenschutz",
+    "DesignThinking": "Design Thinking",
+    "EventManagement": "Eventmanagement",
+    "FeedBack": "Feedback",
+    "Feedback_Placeholder": "Hier können Sie Ihr Feedback hinterlassen",
+    "Finance": "Finanzen",
+    "Formatting": "Formatierung",
+    "Formatting_Info": " - Gibt generierte Ergebnisse in gewünschter Form aus.",
+    "Gamification": "Gamification",
+    "Impressum": "Impressum",
+    "Incomplete": "Unvollständig",
+    "Incomplete_Info": " - Generiert gelegentlich falsche Informationen.",
+    "InputField_Placeholder": "Hier kannst Du deine Anfrage stellen",
+    "InterviewQuestions": "Interviewfragen",
+    "Iteration": "Iteration",
+    "Iteration_Info": " - Erlaubt nachträgliche Korrekturen generierter Ergebnisse.",
+    "LearnSpace": "Lernraum ",
+    "LearnSpace_Info": "Die Lernräume sollen helfen, die verschiedenen Unterstützungsmöglichkeiten zu verstehen und zu lernen, was einen effektiven Prompt ausmacht.",
+    "LearnStrategy": "Lernstrategien",
+    "LegalConsultation": "Rechtsberatung",
+    "Limitation": "Limitierung",
+    "Limitation_Info": " - Das Sprachmodell greift ausschließlich auf Wissen bis zum Dezember 2023 zu.",
+    "Limitations": "Limitationen",
+    "LiteratureSearch": "Literaturrecherche",
+    "Login": "Anmelden",
+    "LoginFailedMSG": "Anmelden fehlgeschlagen",
+    "Marketing": "Marketing",
+    "Methodology": "Methodologie",
+    "Motivation": "Motivation",
+    "Organization": "Organisation",
+    "Possibility": "Möglichkeiten",
+    "Programming": "Programmierung",
+    "Prototyping": "Prototyping",
+    "Research": "Forschung",
+    "ResearchSupport": "Rechercheunterstützung",
+    "ResearchWork": "Wiss. Arbeiten",
+    "SignOut": "Abmelden",
+    "SocialMedia": "Social Media",
+    "StressManagement": "Stressmanagement",
+    "System": "System",
+    "SystemPromptInfo": "Diesen System-Prompt schicken wir im Hintergrund mit, um das Ergebnis zu verbessern.",
+    "System_Content": "You are a helpful assistant who works at the University of Applied Arts and Sciences in Lower Saxony.",
+    "Tables": "Tabellen",
+    "TimeManagement": "Zeitmanagement",
+    "Upgrade": "Upgrade auf GPT4",
+    "Upgrade_Content": "Die Hochschule stellt Ihnen jetzt GPT4 zur Verfügung. Komplexere Eingaben können nun besser verstanden und verarbeitet werden. Sie sollten nun präzisere Antworten erhalten. Die Wartezeit auf eine Antwort kann sich geringfügig verlängern.",
+    "UsageHint": "Nutzungshinweis",
+    "UsageHint_Content": "Bitte geben Sie keine personenbezogenen Daten ein. Wir verwenden die API von OpenAI. Das bedeutet, dass die von Ihnen eingegebenen Daten direkt an OpenAI gesendet werden. Es besteht die Möglichkeit, dass OpenAI diese Daten weiterverwendet.",
+    "VirtualOffice": "Virtuelles Büro",
+    "VirtualOffice_Info": "Gespräche mit fiktiven Expert*innen, um sich in fachfremden Bereichen einzuarbeiten und gezieltere Anfragen an echte Hochschul-Expert*innen zu stellen.",
+    "WritingHelp": "Schreibhilfe",
+    "aiOverviewPage": "KI Übersichtsseite",
+    "confirmButton": "Bestätigen",
+    "copiedToolTip": "Kopiert!",
+    "copyTooTip": "Kopieren",
+    "copywritingAssistanceRequest": "Ich benötige Unterstützung beim Copywriting. Ich arbeite an einem Projekt, bei dem es darum geht, eine Nachricht oder Idee klar und ansprechend zu kommunizieren. Könntest du mir bitte helfen, meine aktuelle Schreibweise zu bewerten und mir Ratschläge und Tipps zur Verbesserung meines Copywritings geben? Ich suche auch nach Strategien, um meine Zielgruppe besser zu verstehen und eine ansprechende Sprache zu verwenden, um meine Botschaft zu vermitteln.",
+    "copywritingExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of creativity.",
+    "dataAnalysisAssistanceRequest": "Ich habe kürzlich eine umfangreiche Datensammlung durchgeführt und suche nun nach Unterstützung bei der Analyse der Daten. Die Datensammlung umfasst [Beschreibung der Daten], und ich möchte [Ziel der Analyse]. Könntest du mir bitte dabei helfen, die Daten zu analysieren und mir Ratschläge zur Interpretation der Ergebnisse zu geben?",
+    "dataProtection": "Datenschutz",
+    "designThinkingAssistanceRequest": "Ich suche nach Unterstützung beim Design Thinking. Ich arbeite an einem Projekt, bei dem es darum geht, eine kreative Lösung für ein Problem zu finden. Könntest du mir bitte helfen, den Design Thinking Prozess besser zu verstehen und mir Ratschläge und Tipps zur Anwendung des Prozesses in meinem Projekt geben? Ich suche auch nach Strategien, um meine Ideen zu prototypisieren und zu testen, um sicherzustellen, dass meine Lösung für das Problem erfolgreich ist. Könntest du mir bitte auch dabei helfen, eine Feedbackschleife einzurichten, um meine Lösung iterativ zu verbessern?",
+    "designThinkingExpertiseMessage": "You are a helpful assistant working at a University in Germany and you are an expert in the field of creativity.",
+    "dialogueWithFinanceAdvisor": "Du unterhältst Dich jetzt mit Julia, einer fiktiven Finanzberaterin. Was möchtest Du über Finanzen wissen?",
+    "eventManagementAssistanceRequest": "Ich plane ein Event [Beschreibung des Events] und suche nach Unterstützung bei der Planung. Ich habe bereits einige Dinge organisiert, bin mir aber nicht sicher, ob ich an alles gedacht habe oder ob es noch Dinge gibt, die ich beachten sollte. Könntest du mir bitte helfen, meine Planung zu überprüfen und mir Ratschläge zur Verbesserung geben? Ich suche auch nach Empfehlungen für geeignete Locations, Catering-Optionen und andere wichtige Details, die ich möglicherweise übersehen habe.",
+    "eventManagementExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of organisation.",
+    "feedbackAssistanceRequest": "Ich arbeite gerade an einem wissenschaftlichen Projekt und suche nach Feedback. Ich bin mir nicht sicher, ob meine Arbeit die Anforderungen erfüllt oder ob ich meine Forschung noch verbessern kann. Könntest du dir bitte meine Arbeit ansehen und mir Ratschläge geben, wie ich meine Forschung verbessern und meine Argumentation stärken kann?",
+    "financeExpertiseMessage": "You are a helpful assistant working at a university in Germany. Your name is Julia Schneider and you are an expert in finance. You advise university staff, students and professors. If people want to speak directly to someone who works in the finance department at your university you refer them to the official university homepage.",
+    "financeUsageNoticeContent": "In diesem Bereich sprechen Sie mit fiktiven Personen. Die Aussagen in diesem Bereich können nicht auf ihren Wahrheitsgehalt überprüft werden und sollen nur als Anregung dienen.",
+    "gamificationAssistanceRequest": "Ich suche nach Unterstützung, um Gamification in mein Projekt zu integrieren. Ich möchte ein spielerisches Element in meine Anwendung einbauen, um Nutzenden zu motivieren und das Engagement zu erhöhen. Könntest du mir bitte helfen, eine Strategie für die Integration von Gamification in mein Projekt zu entwickeln? Ich suche auch nach Tipps zur Auswahl von geeigneten Spielmechaniken und -elementen, um meine Nutzer zu motivieren und ein ansprechendes Spielerlebnis zu schaffen. Könntest du mir auch dabei helfen, die Auswirkungen der Gamification auf mein Projekt zu messen und zu bewerten?",
+    "gamificationExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of creativity.",
+    "guideline_Title": "Leitfaden zum Umgang mit HAWKI",
+    "ideagenerationAssistanceRequest": "Ich suche nach kreativen Ideen für ein Projekt, an dem ich arbeite. Ich möchte meine Perspektive erweitern und neue Ideen und Ansätze für mein Projekt entwickeln. Könntest du mir bitte helfen, meine Denkweise zu erweitern und mir Ratschläge und Tipps zur Generierung von Ideen geben?",
+    "ideagenerationExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of creativity.",
+    "imprint": "Impressum",
+    "infoPanel_Content": "<h1 class=\"headerLine\">HAWKI Update #002</h1><h3>Wir haben HAWKI weiter für euch verbessert!</h3><p><b>Funktionalität:</b></p><p>Multi-Language mit übersetzten Texten für Englisch, Italienisch, Französisch und Spanisch.</p><p>Darstellung von mathematischen Formeln, LaTex und Verbesserung des Syntax Highlighting.</p><p><b>Quality of Life:</b></p><p>Dark Mode für unsere Nachteulen.</p><p>System Prompts sind jetzt transparent einsehbar.</p><p><b>Sicherheitsupdates:</b></p><p>Wir haben HAWKI in einigen Bereichen sicherer gemacht und die Code-Struktur aktualisiert.</p><p>Wir danken Thorger Jansen  (Entdeckung, Analyse, Koordination) vom <a class=\"accentText\" target=\"_blank\" href=\"https://www.sec-consult.com\"><b>SEC Consult Vulnerability Lab</b></a> für die verantwortungsvolle Meldung der identifizierten Probleme und die Zusammenarbeit mit uns bei deren Behebung.</p>",
+    "interviewAssistanceRequest": "Ich bereite mich auf ein Interview vor und suche nach Unterstützung bei der Erstellung von Fragen. Könntest du mir bitte helfen, Fragen zu formulieren, die es mir ermöglichen, die gewünschten Informationen zu sammeln? Ich möchte gerne offene Fragen verwenden. Könntest du mir auch helfen, Fragen zu formulieren, die auf die Bedürfnisse meines Interviewpartners zugeschnitten sind und ihm ermöglichen, seine Erfahrungen und Meinungen ausführlich zu teilen? Ich suche auch nach Tipps zur Durchführung eines erfolgreichen Interviews und zur Aufzeichnung und Organisation der gesammelten Informationen.",
+    "interviewExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of creativity.",
+    "language": "Sprache",
+    "lawDialogueIntroduction": "Du unterhältst Dich jetzt mit Luis, einem fiktiven Rechtsberater. Was möchtest Du über Rechtsberatung wissen?",
+    "lawExpertiseMessage": "You are a helpful assistant working at a university in Germany. Your name is Luis Martinez and you are an expert in legal advice. You advise university staff, students and professors. If people want to speak directly to someone who works in the law department at your university you refer them to the official university homepage.",
+    "lawUsageNoticeContent": "In diesem Bereich sprechen Sie mit fiktiven Personen. Die Aussagen in diesem Bereich können nicht auf ihren Wahrheitsgehalt überprüft werden und sollen nur als Anregung dienen.",
+    "learningAssistanceRequest": "Ich suche nach Unterstützung bei Lernstrategien. Ich habe Schwierigkeiten, effektiv zu lernen und meine Aufgaben zu erledigen. Ich bin mir nicht sicher, welche Lernstrategien am besten für mich geeignet sind oder wie ich meine Zeit besser organisieren kann, um meine Lernziele zu erreichen. Könntest du mir bitte helfen, meine derzeitige Lernsituation zu bewerten und mir Ratschläge und Tipps zur Verbesserung meiner Lernstrategien geben?",
+    "learningExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of organisation.",
+    "literatureResearchAssistanceRequest": "Ich arbeite gerade an einem Projekt und brauche Hilfe bei der Recherche relevanter Literatur. Mein Thema ist [Beschreibung des Themas], und ich suche nach wissenschaftlichen Artikeln und Büchern, die sich mit diesem Thema befassen. Ich bin mir nicht sicher, welche Quellen ich verwenden soll oder wie ich meine Suche effektiver gestalten kann. Könntest du mir bitte dabei helfen, relevante Quellen zu finden und mir Ratschläge zur effektiven Durchführung meiner Suche geben?",
+    "marketingDialogueIntroduction": "Du unterhältst Dich jetzt mit Felix, einem fiktiven Marketing-Mitarbeiter. Was möchtest Du über Marketing wissen?",
+    "marketingExpertiseMessage": "You are a helpful assistant working at a university in Germany. Your name is Felix Müller and you are an expert in marketing. You advise university staff, students and professors. If people want to speak directly to someone who works in the marketing department at your university, you refer them to the official university homepage.",
+    "marketingUsageNoticeContent": "In diesem Bereich sprechen Sie mit fiktiven Personen. Die Aussagen in diesem Bereich können nicht auf ihren Wahrheitsgehalt überprüft werden und sollen nur als Anregung dienen.",
+    "methodologyAssistanceRequest": "Ich arbeite gerade an einem wissenschaftlichen Projekt und suche nach Unterstützung bei der Methodologie. Ich habe mich entschieden, [Beschreibung der gewählten Methodologie] zu verwenden, um [Ziel der Forschung] zu erreichen, bin mir aber nicht sicher, ob ich die Methodologie korrekt anwende oder ob es andere Methoden gibt, die besser geeignet wären. Könntest du mir bitte helfen, meine Methodologie zu überprüfen und mir gegebenenfalls Ratschläge zur Verbesserung oder Alternative vorschlagen?",
+    "motivationAssistanceRequest": "Ich suche nach Unterstützung, um meine Motivation im Hochschulalltag zu verbessern. Ich fühle mich oft überfordert und unmotiviert, wenn ich versuche, mit meinem Studium und anderen Verpflichtungen Schritt zu halten. Könntest du mir bitte helfen, meine aktuelle Situation zu bewerten und mir Ratschläge und Tipps zur Verbesserung meiner Motivation geben? Ich suche auch nach Strategien, um meine Ziele besser zu definieren und meine Fortschritte im Auge zu behalten.",
+    "motivationExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of organisation.",
+    "organisationExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of organisation.",
+    "password": "Kennwort",
+    "programmingDialogueIntroduction": "Du unterhältst Dich jetzt mit Fatima, einer fiktiven Programmiererin. Was möchtest Du über Programmierung wissen?",
+    "programmingExpertiseMessage": "You are a helpful assistant working at a university in Germany. Your name is Fatima Kamara and you are an expert in programming. You advise university staff, students and professors. If people want to speak directly to someone who works in the programming department at your university, you refer them to the official university homepage.",
+    "programmingUsageNoticeContent": "In diesem Bereich sprechen Sie mit fiktiven Personen. Die Aussagen in diesem Bereich können nicht auf ihren Wahrheitsgehalt überprüft werden und sollen nur als Anregung dienen. Dies gilt besonders für den Bereich Programmierung.",
+    "promptSuggestion": "Promptvorschlag",
+    "prototypingAssistanceRequest": "Ich bin auf der Suche nach Unterstützung beim Prototyping in meinem Designprozess. Könntest du mir bitte helfen, ein effektives Prototyping durchzuführen, das mir dabei hilft, meine Designideen zu visualisieren und zu testen? Ich suche nach Ratschlägen und Anleitungen zur Auswahl der besten Materialien und Tools für mein Prototyping, und wie ich am besten die Bedürfnisse meiner Zielgruppe berücksichtigen kann. Könntest du mir auch helfen, mein Prototyping auf verschiedene Szenarien anzupassen, um sicherzustellen, dass es für alle möglichen Nutzererfahrungen relevant ist? Ich suche auch nach Strategien, um Feedback von meinen Prototypen zu sammeln und es in meinen Designprozess zu integrieren.",
+    "prototypingExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of creativity.",
+    "researchAssistanceRequest": "Ich arbeite gerade an einem wissenschaftlichen Projekt und suche nach Unterstützung bei der Recherche. Mein Thema ist [Beschreibung des Themas], und ich benötige weitere Informationen über [spezifische Fragen oder Themen]. Ich habe bereits einige Quellen gefunden, bin mir aber nicht sicher, ob ich alle relevanten Quellen gefunden habe oder ob ich weitere Ressourcen verwenden sollte. Könntest du mir bitte dabei helfen, zusätzliche Quellen zu finden und mir Ratschläge zur effektiven Durchführung meiner Suche geben?",
+    "scienceDialogueIntroduction": "Du unterhältst Dich jetzt mit Sophie, einer fiktiven Forscherin. Was möchtest Du über Forschung wissen?",
+    "scienceExpertiseMessage": "You are a helpful assistant working at a university in Germany. Your name is Sophie Martin and you are an expert in research. You advise university staff, students, and professors. If people want to speak directly to someone who works in the science department at your university, you refer them to the official university homepage.",
+    "scienceUsageNoticeContent": "In diesem Bereich sprechen Sie mit fiktiven Personen. Die Aussagen in diesem Bereich können nicht auf ihren Wahrheitsgehalt überprüft werden und sollen nur als Anregung dienen. Besonders im Bereich der Wissenschaft ist es wichtig, Informationen kritisch zu bewerten.",
+    "scientificWorkExpertiseMessage": "You are a helpful assistant who works at a university in Germany and you are an expert in scientific work.",
+    "settings": "Einstellungen",
+    "socialMediaDialogueIntroduction": "Du unterhältst Dich jetzt mit Erik, einem fiktiven Social-Media-Mitarbeiter. Was möchtest Du über Social Media wissen?",
+    "socialMediaExpertiseMessage": "You are a helpful assistant working at a university in Germany. Your name is Erik Hansen and you are an expert in social media. You advise university staff, students, and professors. If people want to speak directly to someone who works in the social media department at your university, you refer them to the official university homepage.",
+    "socialMediaUsageNoticeContent": "In diesem Bereich sprechen Sie mit fiktiven Personen. Die Aussagen in diesem Bereich können nicht auf ihren Wahrheitsgehalt überprüft werden und sollen nur als Anregung dienen. Dies gilt besonders im Kontext von Social Media, wo Informationen schnell und in großer Fülle zirkulieren.",
+    "stressManagementAssistanceRequest": "Ich suche nach Unterstützung beim Stressmanagement im Hochschulalltag. Ich fühle mich oft gestresst und überfordert, wenn ich versuche, mit meinen akademischen Verpflichtungen, meinem sozialen Leben und anderen Verpflichtungen Schritt zu halten. Könntest du mir bitte helfen, meine aktuelle Stresssituation zu bewerten und mir Ratschläge und Tipps zur Bewältigung von Stress im Hochschulalltag geben? Ich suche auch nach Strategien, um meine Zeit besser zu organisieren und meine Prioritäten zu setzen, um meine Stressbelastung zu reduzieren.",
+    "stressManagementExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of organisation.",
+    "successfulRegistration": "Ihre Anmeldung war erfolgreich.",
+    "tableCreationAssistanceRequest": "Ich benötige Unterstützung beim Erstellen von Tabellen. Ich habe Daten gesammelt, die ich in einer Tabelle darstellen möchte, aber ich bin mir nicht sicher, wie ich die Tabelle am besten formatieren und organisieren kann, um die Informationen klar und verständlich zu präsentieren. Könntest du mir bitte helfen, eine geeignete Tabelle zu entwerfen und mir Ratschläge zur Gestaltung und Formatierung der Tabelle geben? Ich suche auch nach Tipps, wie ich die Informationen in der Tabelle am besten präsentieren kann, um sie für die Lesenden leicht zugänglich zu machen.",
+    "tableExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of organisation.",
+    "theme": "Theme",
+    "timeManagementAssistanceRequest": "Ich suche nach Unterstützung beim Zeitmanagement. Ich habe Schwierigkeiten, meine Zeit effektiv zu nutzen und meine Aufgaben in angemessener Zeit zu erledigen. Ich bin mir nicht sicher, wie ich meine Zeit besser organisieren kann, um meine Ziele zu erreichen und Stress zu vermeiden. Könntest du mir bitte helfen, meine aktuelle Zeitnutzung zu bewerten und mir Ratschläge und Tipps zur Verbesserung meines Zeitmanagements geben? Ich suche auch nach Strategien, um meine Prioritäten zu setzen und meine Zeit besser zu planen, um meine Produktivität zu steigern und meine Ziele zu erreichen.",
+    "unableToSaveRegistration": "<b>Ihre Anmeldung konnte nicht gespeichert werden.<br>Bitte versuchen Sie es erneut.</b>",
+    "usageNoticeTitle": "Nutzungshinweis",
+    "usage_guideline": "<p>Willkommen zum Leitfaden für den Umgang mit HAWKI, das auf der OpenAI API basiert. Dieser Leitfaden soll allen Hochschulangehörigen - Studierenden, Lehrenden und Mitarbeitenden - eine klare Richtlinie bieten, wie mit dieser Technologie verantwortungsbewusst umgegangen werden soll. Bitte beachten Sie, dass dieser Leitfaden die Nutzungsbedingungen von OpenAI ergänzt und keinen Anspruch auf Vollständigkeit erhebt. Es liegt in der Verantwortung der Nutzerinnen und Nutzer, die Nutzungsbedingungen einzuhalten.</p><h3>Allgemeine Bestimmungen</h3><p><b>Was verboten ist:</b></p><ul><li>Eingabe personenbezogener Daten über sich selbst oder über andere.</li><li>Nutzung der Dienste für illegale, schädliche oder missbräuchliche Aktivitäten.</li><li>Verletzung, Missbrauch oder Verstoß gegen die Rechte anderer.</li><li>Modifikation, Kopie, Vermietung, Verkauf oder Verteilung unserer Dienste.</li><li>Versuch der Rückentwicklung, Dekompilierung oder des Herausfindens von Quellcode oder zugrundeliegenden Komponenten.</li><li>Automatisches oder programmgesteuertes Extrahieren von Daten oder Output.</li><li>Behauptung, dass der Output von Menschen erstellt wurde, wenn dies nicht der Fall ist.</li><li>Beeinträchtigung oder Störung der Dienste oder Umgehung von Schutzmaßnahmen.</li><li>Verwendung von Output zur Entwicklung konkurrierender Modelle.</li></ul><p><b>Was zu beachten ist:</b></p><p>Sie sind verantwortlich für den von Ihnen bereitgestellten Input und den daraus resultierenden Output. Sie müssen sicherstellen, dass Ihr Input keine Rechte verletzt und dass Sie über alle notwendigen Rechte, Lizenzen und Genehmigungen für die Bereitstellung des Inputs verfügen.</p><b>Genauigkeit:</b><p>Die Nutzung der Dienste kann zu ungenauem oder fehlerhaftem Output führen. Es ist wichtig, dass Sie den Output kritisch prüfen und nicht als alleinige Quelle der Wahrheit verwenden.Ihre Eingaben werden nicht von der HAWK, aber von OpenAI für 30 Tage gespeichert, um einen eventuellen Missbrauch festzustellen. Nach 30 Tagen werden die Daten gelöscht. Ihre Eingaben werden nicht verwendet, um das Produkt sicherer oder besser zu machen.</p><h3>Spezifische Bestimmungen</h3><p>Für den Einsatz generativer KI-Systeme gibt es eine <a class=\"accentText\" target=\"_blank\" href=\"https://wiki.hawk.de/pages/viewpage.action?spaceKey=HL&title=Leitlinie+generative+KI\"><b>vorläufige Leitlinie und eine Eigenständigkeitserklärung.</b></a></p><p><b>Für Studierende:</b></p><ul><li>Verwenden Sie HAWKI zur Unterstützung Ihres Lernprozesses, aber verlassen Sie sich nicht ausschließlich auf die generierten Antworten.</li><li>Teilen Sie keine persönlichen Daten oder Informationen über HAWKI. Auch nicht die personenbezogenen Daten anderer.</li><li>Sie übernehmen die Autorenschaft. Damit bürgen Sie für die Qualität der Antwort und übernehmen die Verantwortung für den Inhalt. Die Nutzung von KI und die Art ihres Beitrags sollte klargelegt werden.</li></ul>                <p><b>Für Lehrende:</b></p><ul><li>HAWKI darf nicht verwendet werden, um studentische Arbeiten zu korrigieren, wenn diese Arbeiten persönliche Daten enthalten, die extrahierbar sind.</li><li>Nutzen Sie HAWKI als ergänzendes Werkzeug zur Vorbereitung von Lehrmaterialien, aber stellen Sie sicher, dass alle Inhalte auf ihre Richtigkeit und Relevanz überprüft werden.</li></ul><p><b>Für Mitarbeitende:</b></p><ul><li>Es ist strengstens untersagt, Geheimhaltungsverträge oder intern bestimmte Dokumente in HAWKI einzugeben. Auch keine Dokumente, die personenbezogene Daten über sich selbst oder über andere enthalten.</li><li>Nutzen Sie HAWKI zur Effizienzsteigerung und Unterstützung Ihrer täglichen Aufgaben, jedoch unter Beachtung der Datenschutzrichtlinien und Sicherheitsvorschriften der Hochschule.   </li></ul><p>Dieser Leitfaden dient als Orientierungshilfe für den verantwortungsbewussten Umgang mit HAWKI. Es ist wichtig, dass alle Nutzer*innen die genannten Bestimmungen verstehen und befolgen, um einen sicheren und ethischen Einsatz dieser Technologie zu gewährleisten. Die Hochschule kann diesen Service nur anbieten, wenn Sie keine persönlichen Daten eingeben. Bei Fragen oder Unsicherheiten wenden Sie sich bitte an Prof. Stefan Wölwer, Arian Sadafi, Jonas Trippler oder Vincent Timm. Ungeachtet dieses Leitfadens gelten die <a class=\"accentText\" target=\"_blank\" href=\"https://openai.com/policies/business-terms\"><b>Nutzungsbedingungen von OpenAI</b>.</a></p>",
+    "username": "Benutzername",
+    "welcomeBackTitle": "Willkommen zurück!",
+    "writingAssistanceRequest": "Ich arbeite an einem wissenschaftlichen Projekt und benötige Hilfe beim Schreibstil und der Formatierung. Ich habe meine Arbeit bereits verfasst, bin mir aber nicht sicher, ob ich alle Formatierungsrichtlinien und Schreibkonventionen korrekt befolgt habe. Könntest du mir bitte helfen, meine Arbeit zu überprüfen und mir Ratschläge zur Verbesserung der Formatierung und des Schreibstils geben?"
+}
\ No newline at end of file

--- private/resources/language/en_US.json ---
@@ -0,0 +1,141 @@
+{
+    "AI_Icon": "AI",
+    "AboutHAWKI": "About HAWKI",
+    "AboutHAWKI_ArianInfo": " | Research Assistant | HAWKI",
+    "AboutHAWKI_Info": "This service was developed in the Interaction Design Lab of HAWK to give all university members the opportunity to integrate artificial intelligence into their work processes and to have a space for encounter so that new working methods might emerge and an internal university discussion on the use of AI can take place. This offer also aims to support didactically, to develop an understanding of how such a language model works and therefore gives hints on well-functioning prompts (text inputs) in various areas. We welcome constructive feedback to further develop this offer according to your needs and findings.",
+    "AboutHAWKI_JonasInfo": " | Research Assistant | Hands On",
+    "AboutHAWKI_StefanInfo": " | Digital Environments | Interaction Design ",
+    "AboutHAWKI_VincentInfo": " | Research Assistant | Head of Interaction Design Lab",
+    "BetaMessage": "Beta version - Model GPT4-Turbo",
+    "BrainStorming": "Idea Generation",
+    "Caution": "Caution",
+    "Caution_Info": " - Occasionally generates hazardous or biased information.",
+    "Chat": "Chat",
+    "Confirm_Btn": "Confirm",
+    "ContextComprehension": "Context Understanding",
+    "ContextComprehension_Info": " - Remembers what was said before in the conversation.",
+    "Conversation": "Conversation",
+    "Conversation_Info": "A chat area like ChatGPT, for a quick start on any task.",
+    "Copywriting": "Copywriting",
+    "Creativity": "Creativity",
+    "DataAnalysis": "Data Analysis",
+    "DataSecurity": "Data Protection",
+    "DesignThinking": "Design Thinking",
+    "EventManagement": "Event Management",
+    "FeedBack": "Feedback",
+    "Feedback_Placeholder": "Here you can leave your feedback",
+    "Finance": "Finance",
+    "Formatting": "Formatting",
+    "Formatting_Info": " - Outputs generated results in desired format.",
+    "Gamification": "Gamification",
+    "Impressum": "Legal Notice",
+    "Incomplete": "Incomplete",
+    "Incomplete_Info": " - Occasionally generates incorrect information.",
+    "InputField_Placeholder": "You can make your request here...",
+    "InterviewQuestions": "Interview Questions",
+    "Iteration": "Iteration",
+    "Iteration_Info": " - Allows subsequent corrections of generated results.",
+    "LearnSpace": "Learning Space",
+    "LearnSpace_Info": "The learning spaces are designed to help understand the various support options and learn what makes an effective prompt.",
+    "LearnStrategy": "Learning Strategies",
+    "LegalConsultation": "Legal Consultation",
+    "Limitation": "Limitation",
+    "Limitation_Info": " - The language model exclusively accesses knowledge up to December 2023.",
+    "Limitations": "Limitations",
+    "LiteratureSearch": "Literature Search",
+    "Login": "Login",
+    "LoginFailedMSG": "Login Failed!",
+    "Marketing": "Marketing",
+    "Methodology": "Methodology",
+    "Motivation": "Motivation",
+    "Organization": "Organization",
+    "Possibility": "Possibilities",
+    "Programming": "Programming",
+    "Prototyping": "Prototyping",
+    "Research": "Research",
+    "ResearchSupport": "Research Support",
+    "ResearchWork": "Scientific Work",
+    "SignOut": "Sign Out",
+    "SocialMedia": "Social Media",
+    "StressManagement": "Stress Management",
+    "System": "System",
+    "SystemPromptInfo": "We send this system prompt in the background to improve the result.",
+    "System_Content": "You are a helpful assistant who works at the University of Applied Arts and Sciences in Lower Saxony.",
+    "Tables": "Tables",
+    "TimeManagement": "Time Management",
+    "Upgrade": "Upgrade to GPT-4",
+    "Upgrade_Content": "The university now provides you with GPT-4. More complex inputs can now be understood and processed better. You should now receive more precise answers. The wait time for a response may slightly increase.",
+    "UsageHint": "Usage Note",
+    "UsageHint_Content": "Please do not enter any personal information. We use the API of OpenAI. This means that the data you enter is sent directly to OpenAI. There is a possibility that OpenAI may use this data further.",
+    "VirtualOffice": "Virtual Office",
+    "VirtualOffice_Info": "Conversations with fictional experts to get acquainted in unfamiliar areas and make more targeted requests to real university experts.",
+    "WritingHelp": "Writing Help",
+    "aiOverviewPage": "AI Overview Page",
+    "confirmButton": "Confirm",
+    "copiedToolTip": "Copied!",
+    "copyTooTip": "Copy",
+    "copywritingAssistanceRequest": "I need support with copywriting. I am working on a project that involves clearly and engagingly communicating a message or idea. Could you please help me assess my current way of writing and provide me with advice and tips to improve my copywriting? I am also looking for strategies to better understand my target audience and use compelling language to convey my message.",
+    "copywritingExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of creativity.",
+    "dataAnalysisAssistanceRequest": "I have recently conducted an extensive data collection and am now looking for support in analyzing the data. The data collection includes [description of the data], and I would like to [goal of the analysis]. Could you please assist me in analyzing the data and provide advice on interpreting the results?",
+    "dataProtection": "Data Protection",
+    "designThinkingAssistanceRequest": "I am seeking support with Design Thinking. I am working on a project that involves finding a creative solution to a problem. Could you please help me better understand the Design Thinking process and provide me with advice and tips on applying the process to my project? I am also looking for strategies to prototype and test my ideas to ensure that my solution to the problem is successful. Could you also help me set up a feedback loop to iteratively improve my solution?",
+    "designThinkingExpertiseMessage": "You are a helpful assistant working at a University in Germany and you are an expert in the field of creativity.",
+    "dialogueWithFinanceAdvisor": "You are now conversing with Julia, a fictional financial advisor. What would you like to know about finance?",
+    "eventManagementAssistanceRequest": "I am planning an event [description of the event] and am looking for support in planning. I have already organised some things but am not sure if I have thought of everything or if there are things I should consider. Could you please help me review my planning and provide advice for improvement? I am also looking for recommendations for suitable locations, catering options, and other important details I might have overlooked.",
+    "eventManagementExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of organisation.",
+    "feedbackAssistanceRequest": "I am currently working on a scientific project and am seeking feedback. I am not sure whether my work meets the requirements or whether I can still improve my research. Could you please take a look at my work and give me advice on how I can improve my research and strengthen my argumentation?",
+    "financeExpertiseMessage": "You are a helpful assistant working at a university in Germany. Your name is Julia Schneider and you are an expert in finance. You advise university staff, students, and professors. If people want to speak directly to someone who works in the finance department at your university, you refer them to the official university homepage.",
+    "financeUsageNoticeContent": "In this area, you interact with fictional characters. The statements in this area cannot be verified for factual accuracy and are intended only as inspiration.",
+    "gamificationAssistanceRequest": "I am looking for support to integrate gamification into my project. I want to include a gaming element in my application to motivate users and increase engagement. Could you please help me develop a strategy for integrating gamification into my project? I am also looking for tips on choosing suitable game mechanics and elements to motivate my users and create an engaging gaming experience. Could you also assist me in measuring and assessing the impact of gamification on my project?",
+    "gamificationExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of creativity.",
+    "guideline_Title": "Usage Guidelines for HAWKI",
+    "ideagenerationAssistanceRequest": "I am looking for creative ideas for a project I am working on. I want to broaden my perspective and develop new ideas and approaches for my project. Could you please help me expand my mindset and provide me with advice and tips for generating ideas?",
+    "ideagenerationExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of creativity.",
+    "imprint": "Imprint",
+    "infoPanel_Content": "<h1 class=\"headerLine\">HAWKI Update #002</h1><h3>We have further improved HAWKI for you!</h3><p><b>Functionality:</b></p><p>Multi-Language with translated texts for English, Italian, French, and Spanish.</p><p>Display of mathematical formulas, LaTex, and syntax highlighting improvement.</p><p><b>Quality of Life:</b></p><p>Dark Mode for our night owls.</p><p>System prompts are now transparently visible.</p><p><b>Security Updates:</b></p><p>We have made HAWKI more secure in some areas and updated the code structure.</p><p>We thank Thorger Jansen (Discovery, Analysis, Coordination) from the <a class=\"accentText\" target=\"_blank\" href=\"https://www.sec-consult.com\"><b>SEC Consult Vulnerability Lab</b></a> for responsibly reporting the identified issues and collaborating with us to address them.</p>",
+    "interviewAssistanceRequest": "I am preparing for an interview and seeking support in creating questions. Could you please help me formulate questions that will allow me to collect the desired information? I would like to use open-ended questions. Could you also help me formulate questions tailored to the needs of my interview partner, allowing them to share their experiences and opinions in detail? I am also looking for tips on conducting a successful interview and recording and organising the information collected.",
+    "interviewExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of creativity.",
+    "language": "Language",
+    "lawDialogueIntroduction": "You are now conversing with Luis, a fictional legal advisor. What would you like to know about legal consultation?",
+    "lawExpertiseMessage": "You are a helpful assistant working at a university in Germany. Your name is Luis Martinez and you are an expert in legal advice. You advise university staff, students, and professors. If people want to speak directly to someone who works in the law department at your university, you refer them to the official university homepage.",
+    "lawUsageNoticeContent": "In this area, you interact with fictional characters. The statements in this area cannot be verified for factual accuracy and are intended only as inspiration.",
+    "learningAssistanceRequest": "I am seeking support with learning strategies. I have difficulties learning effectively and completing my tasks. I am not sure which learning strategies are best suited for me or how I can better organize my time to achieve my learning goals. Could you please help me assess my current learning situation and provide me with advice and tips for improving my learning strategies?",
+    "learningExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of organisation.",
+    "literatureResearchAssistanceRequest": "I am currently working on a project and need help in researching relevant literature. My topic is [description of the topic], and I am looking for scientific articles and books dealing with this topic. I am not sure which sources I should use or how I can make my search more effective. Could you please help me find relevant sources and give me advice on conducting my search effectively?",
+    "marketingDialogueIntroduction": "You are now conversing with Felix, a fictional marketing employee. What would you like to know about marketing?",
+    "marketingExpertiseMessage": "You are a helpful assistant working at a university in Germany. Your name is Felix Müller and you are an expert in marketing. You advise university staff, students, and professors. If people want to speak directly to someone who works in the marketing department at your university, you refer them to the official university homepage.",
+    "marketingUsageNoticeContent": "In this area, you interact with fictional characters. The statements in this area cannot be verified for factual accuracy and are intended only as inspiration.",
+    "methodologyAssistanceRequest": "I am currently working on a scientific project and am seeking support with the methodology. I have decided to use [description of the chosen methodology] to achieve [research goal], but I am not sure if I am applying the methodology correctly or if there are other methods that would be more suitable. Could you please help me review my methodology and possibly suggest improvements or alternatives?",
+    "motivationAssistanceRequest": "I am looking for support to improve my motivation in university life. I often feel overwhelmed and unmotivated when trying to keep up with my studies and other obligations. Could you please help me assess my current situation and provide me with advice and tips for improving my motivation? I am also looking for strategies to better define my goals and keep track of my progress.",
+    "motivationExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of organisation.",
+    "organisationExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of organisation.",
+    "password": "Password",
+    "programmingDialogueIntroduction": "You are now conversing with Fatima, a fictional programmer. What would you like to know about programming?",
+    "programmingExpertiseMessage": "You are a helpful assistant working at a university in Germany. Your name is Fatima Kamara and you are an expert in programming. You advise university staff, students, and professors. If people want to speak directly to someone who works in the programming department at your university, you refer them to the official university homepage.",
+    "programmingUsageNoticeContent": "In this area, you interact with fictional characters. The statements in this area cannot be verified for factual accuracy and are intended only as inspiration. This is especially true for the area of programming.",
+    "promptSuggestion": "Prompt Suggestion",
+    "prototypingAssistanceRequest": "I am looking for support with prototyping in my design process. Could you please help me conduct effective prototyping that helps me visualize and test my design ideas? I am looking for advice and guidance on selecting the best materials and tools for my prototyping, and how I can best consider the needs of my target audience. Could you also help me adapt my prototyping to different scenarios to ensure it is relevant for all possible user experiences? I am also looking for strategies to collect feedback from my prototypes and integrate it into my design process.",
+    "prototypingExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of creativity.",
+    "researchAssistanceRequest": "I am currently working on a scientific project and am seeking support with research. My topic is [description of the topic], and I need more information on [specific questions or topics]. I have already found some sources, but I am not sure if I have found all relevant sources or if I should use additional resources. Could you please help me find additional sources and provide advice on conducting my search effectively?",
+    "scienceDialogueIntroduction": "You are now conversing with Sophie, a fictional researcher. What would you like to know about research?",
+    "scienceExpertiseMessage": "You are a helpful assistant working at a university in Germany. Your name is Sophie Martin and you are an expert in research. You advise university staff, students, and professors. If people want to speak directly to someone who works in the science department at your university, you refer them to the official university homepage.",
+    "scienceUsageNoticeContent": "In this area, you interact with fictional characters. The statements in this area cannot be verified for factual accuracy and are intended only as inspiration. Especially in the field of science, it is important to critically evaluate information.",
+    "scientificWorkExpertiseMessage": "",
+    "settings": "Settings",
+    "socialMediaDialogueIntroduction": "You are now conversing with Erik, a fictional social media employee. What would you like to know about social media?",
+    "socialMediaExpertiseMessage": "You are a helpful assistant working at a university in Germany. Your name is Erik Hansen and you are an expert in social media. You advise university staff, students, and professors. If people want to speak directly to someone who works in the social media department at your university, you refer them to the official university homepage.",
+    "socialMediaUsageNoticeContent": "In this area, you interact with fictional characters. The statements in this area cannot be verified for factual accuracy and are intended only as inspiration. This is especially true in the context of social media, where information circulates quickly and in large volumes.",
+    "stressManagementAssistanceRequest": "I am seeking support with stress management in university life. I often feel stressed and overwhelmed when trying to keep up with my academic obligations, my social life, and other obligations. Could you please help me assess my current stress situation and provide me with advice and tips for managing stress in university life? I am also looking for strategies to better organize my time and set my priorities to reduce my stress levels.",
+    "stressManagementExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of organisation.",
+    "successfulRegistration": "Your registration was successful.",
+    "tableCreationAssistanceRequest": "I need support with creating tables. I have collected data that I want to present in a table, but I am not sure how best to format and organize the table to present the information clearly and understandably. Could you please help me design a suitable table and provide me with advice on designing and formatting the table? I am also looking for tips on how best to present the information in the table to make it easily accessible for readers.",
+    "tableExpertiseMessage": "You are a helpful assistant working at a university in Germany and you are an expert in the field of organisation.",
+    "theme": "Theme",
+    "timeManagementAssistanceRequest": "I am looking for support with time management. I struggle to use my time effectively and complete my tasks in a timely manner. I am not sure how I can better organize my time to achieve my goals and avoid stress. Could you please help me assess my current time usage and provide me with advice and tips for improving my time management? I am also looking for strategies to set my priorities and plan my time better in order to increase my productivity and reach my goals.",
+    "unableToSaveRegistration": "<b>Your registration could not be saved.<br>Please try again.</b>",
+    "usageNoticeTitle": "Usage Notice",
+    "usage_guideline": "<p>Welcome to the guide for using HAWKI, which is based on the OpenAI API. This guide is intended for all university affiliates - students, teachers, and staff - to provide a clear guideline on how to handle this technology responsibly. Please note that this guide supplements the terms of use of OpenAI and does not claim to be exhaustive. It is the users' responsibility to comply with these terms.</p><h3>General Provisions</h3><p><b>What is prohibited:</b></p><ul><li>Entering personal data about oneself or others.</li><li>Using the services for illegal, harmful, or abusive activities.</li><li>Infringement, abuse, or violation of others' rights.</li><li>Modification, copying, renting, selling, or distributing our services.</li><li>Attempt at reverse engineering, decompiling, or discovering source code or underlying components.</li><li>Automatic or programmed extraction of data or output.</li><li>Claiming that the output was created by humans when it was not.</li><li>Interfering with or disrupting the services or circumventing protective measures.</li><li>Using the output to develop competing models.</li></ul><p><b>What to consider:</b></p><p>You are responsible for the input you provide and the resulting output. You must ensure that your input does not infringe any rights and that you have all necessary rights, licenses, and permissions to provide it.</p><b>Accuracy:</b><p>Using the services can lead to inaccurate or incorrect output. It is important that you critically examine the output and not use it as the sole source of truth. Your inputs are not stored by HAWK, but by OpenAI for 30 days to detect any misuse. After 30 days, the data is deleted. Your inputs are not used to improve the product's safety or quality.</p><h3>Specific Provisions</h3><p>There is a <a class=\"accentText\" target=\"_blank\" href=\"https://wiki.hawk.de/pages/viewpage.action?spaceKey=HL&title=Leitlinie+generative+KI\"><b>provisional guideline and an independence declaration</b></a> for using generative AI systems.</p><p><b>For students:</b></p><ul><li>Use HAWKI to support your learning process, but do not rely solely on the generated answers.</li><li>Do not share personal data or information through HAWKI. Not even others' personal data.</li><li>You take on authorship. This means you vouch for the quality of the answer and take responsibility for the content. The use of AI and the nature of its contribution should be clarified.</li></ul><p><b>For teachers:</b></p><ul><li>It is prohibited to use HAWKI to correct student papers if they contain personal data that can be extracted.</li><li>Use HAWKI as a supplementary tool to prepare teaching materials, but make sure all content is checked for accuracy and relevance.</li></ul><p><b>For staff:</b></p><ul><li>It is strictly prohibited to enter confidentiality agreements or internally specified documents into HAWKI. As well as documents containing personal data about oneself or others.</li><li>Use HAWKI to increase efficiency and support your daily tasks, while observing the university's privacy policies and security regulations.</li></ul><p>This guide serves as an orientation aid for the responsible handling of HAWKI. It is important that all users understand and follow these provisions to ensure safe and ethical use of this technology. The university can only offer this service if you do not enter personal data. For any questions or uncertainties, please contact Prof. Stefan Wölwer, Arian Sadafi, Jonas Trippler, or Vincent Timm. Regardless of this guide, the <a class=\"accentText\" target=\"_blank\" href=\"https://openai.com/policies/business-terms\"><b>OpenAI Terms of Use</b></a> apply.</p>",
+    "username": "Username",
+    "welcomeBackTitle": "Welcome back!",
+    "writingAssistanceRequest": "I am working on a scientific project and need help with writing style and formatting. I have already composed my work, but I am not sure if I have followed all formatting guidelines and writing conventions correctly. Could you please help me review my work and give me advice on improving the formatting and writing style?"
+}
\ No newline at end of file

--- private/resources/language/es_ES.json ---
@@ -0,0 +1,141 @@
+{
+    "AI_Icon": "IA",
+    "AboutHAWKI": "Acerca de HAWKI",
+    "AboutHAWKI_ArianInfo": " | sistente de Investigación | HAWKI",
+    "AboutHAWKI_Info": "La oferta fue desarrollada en el Interaction Design Lab de HAWK, para dar a todos los miembros de la universidad la oportunidad de integrar la inteligencia artificial en los procesos de trabajo y tener un espacio de encuentro para que puedan surgir nuevas formas de trabajo y discusión interna en la universidad sobre el uso de IA. Esta oferta también busca brindar apoyo didáctico para desarrollar una comprensión del funcionamiento de un modelo de lenguaje y, por lo tanto, también proporciona consejos sobre prompts (entradas de texto) bien funcionales en las distintas áreas. Esperamos su retroalimentación constructiva para desarrollar esta oferta de acuerdo con sus necesidades y conocimientos.",
+    "AboutHAWKI_JonasInfo": " | Asistente de Investigación | Práctico",
+    "AboutHAWKI_StefanInfo": " | Entornos Digitales | Diseño de Interacción ",
+    "AboutHAWKI_VincentInfo": " | Asistente de Investigación | Jefe del Laboratorio de Diseño de Interacción",
+    "BetaMessage": "Versión beta - Modelo GPT4-Turbo",
+    "BrainStorming": "Lluvia de Ideas",
+    "Caution": "Precaución",
+    "Caution_Info": " - Ocasionalmente genera información peligrosa o sesgada.",
+    "Chat": "Chat",
+    "Confirm_Btn": "Confirmar",
+    "ContextComprehension": "Comprensión del Contexto",
+    "ContextComprehension_Info": " - Recuerda lo que se ha dicho anteriormente en la conversación.",
+    "Conversation": "Conversación",
+    "Conversation_Info": "Un espacio de chat como ChatGPT, para una introducción rápida a cualquier tarea.",
+    "Copywriting": "Redacción",
+    "Creativity": "Creatividad",
+    "DataAnalysis": "Análisis de Datos",
+    "DataSecurity": "Seguridad de Datos",
+    "DesignThinking": "Pensamiento de Diseño",
+    "EventManagement": "Gestión de Eventos",
+    "FeedBack": "Retroalimentación",
+    "Feedback_Placeholder": "Aquí puede dejar su retroalimentación",
+    "Finance": "Finanzas",
+    "Formatting": "Formato",
+    "Formatting_Info": " - Emite resultados generados en el formato deseado.",
+    "Gamification": "Gamificación",
+    "Impressum": "Impressum",
+    "Incomplete": "Incompleto",
+    "Incomplete_Info": " - Ocasionalmente genera información falsa.",
+    "InputField_Placeholder": "Aquí puedes hacer tu solicitud",
+    "InterviewQuestions": "Preguntas para Entrevistas",
+    "Iteration": "Iteración",
+    "Iteration_Info": " - Permite correcciones a resultados generados anteriormente.",
+    "LearnSpace": "Espacio de Aprendizaje",
+    "LearnSpace_Info": "Los Espacios de Aprendizaje están diseñados para ayudar a entender las distintas opciones de apoyo disponibles y aprender qué hace que un prompt sea eficaz.",
+    "LearnStrategy": "Estrategias de Aprendizaje",
+    "LegalConsultation": "Consultoría Legal",
+    "Limitation": "Limitación",
+    "Limitation_Info": " - El modelo de lenguaje accede exclusivamente al conocimiento hasta diciembre de 2023.",
+    "Limitations": "Limitaciones",
+    "LiteratureSearch": "Búsqueda de Literatura",
+    "Login": "Inicio de sesión",
+    "LoginFailedMSG": "Error de inicio de sesión!",
+    "Marketing": "Marketing",
+    "Methodology": "Metodología",
+    "Motivation": "Motivación",
+    "Organization": "Organización",
+    "Possibility": "Posibilidades",
+    "Programming": "Programación",
+    "Prototyping": "Prototipado",
+    "Research": "Investigación",
+    "ResearchSupport": "Apoyo en Investigación",
+    "ResearchWork": "Trabajo de Investigación",
+    "SignOut": "Cerrar Sesión",
+    "SocialMedia": "Medios Sociales",
+    "StressManagement": "Manejo del Estrés",
+    "System": "Sistema",
+    "SystemPromptInfo": "Enviamos este prompt del sistema en segundo plano para mejorar el resultado.",
+    "System_Content": "Eres un asistente útil que trabaja en la Universidad de Artes Aplicadas y Ciencias en Baja Sajonia.",
+    "Tables": "Tablas",
+    "TimeManagement": "Gestión del Tiempo",
+    "Upgrade": "Actualizar a GPT4",
+    "Upgrade_Content": "La universidad ahora pone a su disposición GPT4. Las entradas complejas se pueden entender y procesar mejor ahora. Debería recibir respuestas más precisas. El tiempo de espera por una respuesta puede aumentar ligeramente.",
+    "UsageHint": "Aviso de Uso",
+    "UsageHint_Content": "Por favor, no introduzca datos personales. Utilizamos la API de OpenAI, lo que significa que los datos que introduce se enviarán directamente a OpenAI. Existe la posibilidad que OpenAI use estos datos para otros fines.",
+    "VirtualOffice": "Oficina Virtual",
+    "VirtualOffice_Info": "Conversaciones con expertos ficticios para familiarizarse con áreas fuera de su especialización y hacer preguntas más específicas a expertos reales de la universidad.",
+    "WritingHelp": "Ayuda con la Escritura",
+    "aiOverviewPage": "Página de Visión General de IA",
+    "confirmButton": "Confirmar",
+    "copiedToolTip": "Copiado!",
+    "copyTooTip": "Copiar",
+    "copywritingAssistanceRequest": "Necesito ayuda con la redacción. Estoy trabajando en un proyecto que involucra comunicar un mensaje o idea de manera clara y atractiva. ¿Podrías ayudarme a evaluar mi estilo de escritura actual y darme consejos y estrategias para mejorar mi redacción? También estoy buscando estrategias para entender mejor a mi audiencia y usar un lenguaje atractivo para transmitir mi mensaje.",
+    "copywritingExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania y eres experto en el campo de la creatividad.",
+    "dataAnalysisAssistanceRequest": "He recopilado recientemente un conjunto de datos grande y busco asistencia para analizar estos datos. La colección incluye [descripción de los datos], y quiero [objetivo de análisis]. ¿Podrías ayudarme a analizar estos datos y darme consejos sobre cómo interpretar los resultados?",
+    "dataProtection": "Protección de Datos",
+    "designThinkingAssistanceRequest": "Busco apoyo con el Design Thinking. Estoy trabajando en un proyecto que necesita encontrar una solución creativa a un problema. ¿Podrías ayudarme a entender mejor el proceso de Design Thinking y darme consejos y estrategias para aplicarlo en mi proyecto? También estoy buscando estrategias para prototipar y probar mis ideas, para asegurarme de que mi solución al problema tenga éxito. ¿Podrías ayudarme también a establecer un bucle de retroalimentación para mejorar mi solución de manera iterativa?",
+    "designThinkingExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania y eres experto en el campo de la creatividad.",
+    "dialogueWithFinanceAdvisor": "Ahora estás conversando con Julia, una asesora financiera ficticia. ¿Qué te gustaría saber sobre finanzas?",
+    "eventManagementAssistanceRequest": "Estoy planificando un evento [descripción del evento] y busco apoyo en la planificación. Ya he organizado algunas cosas, pero no estoy seguro de si he pensado en todo o si hay cosas que debería considerar. ¿Podrías ayudarme a revisar mi planificación y darme consejos para mejorarla? También estoy buscando recomendaciones para lugares apropiados, opciones de catering y otros detalles importantes que podría haber pasado por alto.",
+    "eventManagementExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania y eres experto en el campo de la organización.",
+    "feedbackAssistanceRequest": "Estoy trabajando en un proyecto científico y busco retroalimentación. No estoy seguro de si mi trabajo cumple con los requisitos o si aún puedo mejorar mi investigación. ¿Podrías revisar mi trabajo y darme consejos sobre cómo mejorar mi investigación y fortalecer mi argumentación?",
+    "financeExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania. Tu nombre es Julia Schneider y eres experta en finanzas. Asesoras al personal de la universidad, estudiantes y profesores. Si las personas desean hablar directamente con alguien que trabaja en el departamento de finanzas de su universidad, los remites a la página oficial de la universidad.",
+    "financeUsageNoticeContent": "En esta área, hablarás con personas ficticias. Las declaraciones en esta área no pueden ser verificadas en términos de su verdad y solo deben tomarse como sugerencias.",
+    "gamificationAssistanceRequest": "Busco apoyo para integrar la gamificación en mi proyecto. Quiero incorporar un elemento lúdico en mi aplicación para motivar a los usuarios y aumentar el compromiso. ¿Podrías ayudarme a desarrollar una estrategia para la integración de gamificación en mi proyecto? También estoy buscando consejos sobre cómo seleccionar mecánicas y elementos de juego adecuados para motivar a mis usuarios y crear una experiencia de juego atractiva. ¿Podrías también ayudarme a medir y evaluar los efectos de la gamificación en mi proyecto?",
+    "gamificationExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania y eres experto en el campo de la creatividad.",
+    "guideline_Title": "Guía para el manejo de HAWKI",
+    "ideagenerationAssistanceRequest": "Estoy buscando ideas creativas para un proyecto en el que estoy trabajando. Quiero expandir mi perspectiva y desarrollar nuevas ideas y enfoques para mi proyecto. ¿Podrías ayudarme a ampliar mi forma de pensar y darme consejos y estrategias para la generación de ideas?",
+    "ideagenerationExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania y eres experto en el campo de la creatividad.",
+    "imprint": "Imprint",
+    "infoPanel_Content": "<h1 class=\"headerLine\">Actualización de HAWKI #002</h1><h3>¡Hemos mejorado aún más HAWKI para ti!</h3><p><b>Funcionalidad:</b></p><p>Multilingüe con textos traducidos al inglés, italiano, francés y español.</p><p>Visualización de fórmulas matemáticas, LaTex y mejora de resaltado de sintaxis.</p><p><b>Calidad de vida:</b></p><p>Modo oscuro para nuestros noctámbulos.</p><p>Las indicaciones del sistema ahora son visibles de forma transparente.</p><p><b>Actualizaciones de seguridad:</b></p><p>Hemos hecho que HAWKI sea más seguro en algunas áreas y actualizado la estructura del código.</p><p>Agradecemos a Thorger Jansen (Descubrimiento, Análisis, Coordinación) del <a class=\"accentText\" target=\"_blank\" href=\"https://www.sec-consult.com\"><b>Laboratorio de Vulnerabilidad SEC Consult</b></a> por informar responsablemente sobre los problemas identificados y colaborar con nosotros para solucionarlos.</p>",
+    "interviewAssistanceRequest": "Me estoy preparando para una entrevista y busco apoyo para crear preguntas. ¿Podrías ayudarme a formular preguntas que me permitan recopilar la información deseada? Me gustaría usar preguntas abiertas. ¿Podrías también ayudarme a formular preguntas adaptadas a las necesidades de mi entrevistado, permitiéndole compartir en detalle sus experiencias y opiniones? También estoy buscando consejos sobre cómo llevar a cabo una entrevista exitosa y cómo grabar y organizar la información recopilada.",
+    "interviewExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania y eres experto en el campo de la creatividad.",
+    "language": "Idioma",
+    "lawDialogueIntroduction": "Ahora estás conversando con Luis, un asesor legal ficticio. ¿Qué te gustaría saber sobre asesoría legal?",
+    "lawExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania. Tu nombre es Luis Martinez y eres experto en asesoría legal. Asesoras al personal de la universidad, estudiantes y profesores. Si las personas desean hablar directamente con alguien que trabaja en el departamento de derecho de su universidad, los remites a la página oficial de la universidad.",
+    "lawUsageNoticeContent": "En esta área, hablarás con personas ficticias. Las declaraciones en esta área no pueden ser verificadas en términos de su veracidad y solo deben tomarse como sugerencias.",
+    "learningAssistanceRequest": "Busco apoyo en estrategias de aprendizaje. Tengo dificultades para aprender de manera efectiva y completar mis tareas. No estoy seguro de qué estrategias de aprendizaje son las más adecuadas para mí o cómo puedo organizar mejor mi tiempo para alcanzar mis objetivos de aprendizaje. ¿Podrías ayudarme a evaluar mi situación actual de aprendizaje y darme consejos y estrategias para mejorar mis estrategias de aprendizaje?",
+    "learningExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania y eres experto en el campo de la organización.",
+    "literatureResearchAssistanceRequest": "Estoy trabajando en un proyecto y necesito ayuda con la búsqueda de literatura relevante. Mi tema es [Descripción del tema], y estoy buscando artículos académicos y libros que traten este tema. No estoy seguro de qué fuentes usar o cómo hacer mi búsqueda más efectiva. ¿Podrías ayudarme a encontrar fuentes relevantes y darme consejos para llevar a cabo mi búsqueda de manera efectiva?",
+    "marketingDialogueIntroduction": "Ahora estás conversando con Felix, un ficticio empleado de marketing. ¿Qué te gustaría saber sobre marketing?",
+    "marketingExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania. Tu nombre es Felix Müller y eres experto en marketing. Asesoras al personal de la universidad, estudiantes y profesores. Si las personas desean hablar directamente con alguien que trabaja en el departamento de marketing de su universidad, los remites a la página oficial de la universidad.",
+    "marketingUsageNoticeContent": "En esta área, hablarás con personas ficticias. Las declaraciones en esta área no pueden ser verificadas en términos de su verdad y solo deben tomarse como sugerencias.",
+    "methodologyAssistanceRequest": "Estoy trabajando en un proyecto científico y busco apoyo con la metodología. He decidido usar [descripción de la metodología elegida] para lograr [objetivo de la investigación], pero no estoy seguro de si estoy aplicando correctamente la metodología o si hay otros métodos que serían más adecuados. ¿Podrías ayudarme a revisar mi metodología y ofrecerme consejos para mejorarla o sugerir alternativas?",
+    "motivationAssistanceRequest": "Busco apoyo para mejorar mi motivación en la vida universitaria. A menudo me siento abrumado y desmotivado cuando intento seguir el ritmo de mis estudios y otras obligaciones. ¿Podrías ayudarme a evaluar mi situación actual y darme consejos y estrategias para mejorar mi motivación? También estoy buscando estrategias para definir mejor mis objetivos y mantener un registro de mis progresos.",
+    "motivationExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania y eres experto en el campo de la organización.",
+    "organisationExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania y eres experto en el campo de la organización.",
+    "password": "Contraseña",
+    "programmingDialogueIntroduction": "Ahora estás hablando con Fatima, una programadora ficticia. ¿Qué te gustaría saber sobre programación?",
+    "programmingExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania. Tu nombre es Fatima Kamara y eres experta en programación. Asesoras al personal de la universidad, estudiantes y profesores. Si las personas desean hablar directamente con alguien que trabaja en el departamento de programación de su universidad, los remites a la página oficial de la universidad.",
+    "programmingUsageNoticeContent": "En este área, hablarás con personas ficticias. Las declaraciones en esta área no pueden ser verificadas en términos de su veracidad y solo deben tomarse como sugerencias. Esto es especialmente cierto en el área de programación.",
+    "promptSuggestion": "Sugerencia de Prompt",
+    "prototypingAssistanceRequest": "Estoy buscando apoyo para el prototipado en mi proceso de diseño. ¿Podrías ayudarme a llevar a cabo un prototipado efectivo que me permita visualizar y probar mis ideas de diseño? Busco consejos y orientación sobre la selección de los mejores materiales y herramientas para mi prototipado, y cómo considerar mejor las necesidades de mi público objetivo. ¿Podrías también ayudarme a adaptar mi prototipado a varios escenarios para asegurar que sea relevante para todas las posibles experiencias de usuario? También estoy buscando estrategias para recopilar retroalimentación de mis prototipos e integrarla en mi proceso de diseño.",
+    "prototypingExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania y eres experto en el campo de la creatividad.",
+    "researchAssistanceRequest": "Estoy trabajando en un proyecto científico y busco apoyo en la investigación. Mi tema es [Descripción del tema], y necesito más información sobre [preguntas o temas específicos]. Ya he encontrado algunas fuentes, pero no estoy seguro de si he encontrado todas las fuentes relevantes o si debería utilizar recursos adicionales. ¿Podrías ayudarme a encontrar fuentes adicionales y darme consejos para llevar a cabo mi búsqueda de manera efectiva?",
+    "scienceDialogueIntroduction": "Ahora estás hablando con Sophie, una investigadora ficticia. ¿Qué te gustaría saber sobre investigación?",
+    "scienceExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania. Tu nombre es Sophie Martin y eres experta en investigación. Asesoras al personal de la universidad, estudiantes y profesores. Si las personas desean hablar directamente con alguien que trabaja en el departamento de ciencias de su universidad, los remites a la página oficial de la universidad.",
+    "scienceUsageNoticeContent": "En esta área, hablarás con personas ficticias. Las declaraciones en esta área no pueden ser verificadas en términos de su veracidad y solo deben tomarse como sugerencias. Es especialmente importante en el área de ciencia evaluar críticamente la información.",
+    "scientificWorkExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania y eres experto en trabajo científico.",
+    "settings": "Ajustes",
+    "socialMediaDialogueIntroduction": "Ahora estás conversando con Erik, un empleado ficticio de medios sociales. ¿Qué te gustaría saber sobre medios sociales?",
+    "socialMediaExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania. Tu nombre es Erik Hansen y eres un experto en medios sociales. Asesoras al personal universitario, estudiantes y profesores. Si las personas desean hablar directamente con alguien que trabaja en el departamento de medios sociales de tu universidad, los remites a la página oficial de la universidad.",
+    "socialMediaUsageNoticeContent": "En esta área, hablarás con personas ficticias. Las declaraciones en esta área no pueden ser verificadas en términos de su veracidad y solo deben tomarse como sugerencias. Esto es especialmente cierto en el contexto de los medios sociales, donde la información circula rápidamente y en gran volumen.",
+    "stressManagementAssistanceRequest": "Estoy buscando apoyo en el manejo del estrés en la vida universitaria. A menudo me siento estresado y abrumado al intentar cumplir con mis obligaciones académicas, mi vida social y otras responsabilidades. ¿Podrías ayudarme a evaluar mi situación actual de estrés y darme consejos y estrategias para manejar el estrés en la vida universitaria? También estoy buscando estrategias para organizar mejor mi tiempo y establecer mis prioridades a fin de reducir mi carga de estrés.",
+    "stressManagementExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania y eres un experto en el campo de la organización.",
+    "successfulRegistration": "Su registro fue exitoso.",
+    "tableCreationAssistanceRequest": "Necesito apoyo para crear tablas. He recopilado datos que quiero representar en una tabla, pero no estoy seguro de cómo formatear y organizar mejor la tabla para presentar la información de forma clara y comprensible. ¿Podrías ayudarme a diseñar una tabla adecuada y darme consejos sobre cómo estructurar y formatear la tabla? También estoy buscando consejos sobre cómo presentar mejor la información en la tabla para que sea fácilmente accesible para los lectores.",
+    "tableExpertiseMessage": "Eres un asistente útil que trabaja en una universidad en Alemania y eres un experto en el campo de la organización.",
+    "theme": "Tema",
+    "timeManagementAssistanceRequest": "Estoy buscando apoyo en la gestión del tiempo. Tengo problemas para utilizar mi tiempo de manera efectiva y completar mis tareas a tiempo. No estoy seguro de cómo puedo organizar mejor mi tiempo para alcanzar mis objetivos y evitar el estrés. ¿Podrías ayudarme a evaluar mi uso actual del tiempo y ofrecerme consejos y estrategias para mejorar mi gestión del tiempo? También estoy buscando estrategias para establecer mis prioridades y planificar mejor mi tiempo a fin de aumentar mi productividad y alcanzar mis objetivos.",
+    "unableToSaveRegistration": "<b>No se pudo guardar su registro.<br>Por favor, inténtelo de nuevo.</b>",
+    "usageNoticeTitle": "Aviso de Uso",
+    "usage_guideline": "<p>Bienvenidos a la guía para el manejo de HAWKI, basada en la API de OpenAI. Esta guía está diseñada para todos los miembros de la universidad - estudiantes, docentes y personal - para proporcionar una línea clara de cómo manejar esta tecnología de forma responsable. Por favor, tenga en cuenta que esta guía complementa las condiciones de uso de OpenAI y no es exhaustiva. Es responsabilidad de los usuarios cumplir con estas condiciones.</p><h3>Disposiciones generales</h3><p><b>Lo que está prohibido:</b></p><ul><li>Introducir datos personales sobre uno mismo o sobre otros.</li><li>Usar los servicios para actividades ilegales, dañinas o abusivas.</li><li>Infracción, abuso o violación de los derechos de otros.</li><li>Modificación, copia, alquiler, venta o distribución de nuestros servicios.</li><li>Intento de ingeniería inversa, descompilación o descubrimiento del código fuente o componentes subyacentes.</li><li>Extracción automática o programada de datos o resultados.</li><li>Afirmar que el resultado fue creado por humanos cuando no es así.</li><li>Alteración o interrupción de los servicios o evasión de medidas de protección.</li><li>Uso de resultados para desarrollar modelos competidores.</li></ul><p><b>Lo que debe considerarse:</b></p><p>Usted es responsable de la entrada que proporciona y del resultado que genera. Debe asegurarse de que su entrada no infrinja derechos y de que posee todos los derechos, licencias y permisos necesarios para proporcionarla.</p><b>Precisión:</b><p>El uso de los servicios puede llevar a resultados inexactos o erróneos. Es importante que revise críticamente el resultado y no lo utilice como la única fuente de verdad. Sus entradas no son almacenadas por HAWK, sino por OpenAI por 30 días para detectar posibles abusos. Después de 30 días, los datos son eliminados. Sus entradas no se utilizan para mejorar la seguridad o calidad del producto.</p><h3>Disposiciones específicas</h3><p>Existen una <a class=\"accentText\" target=\"_blank\" href=\"https://wiki.hawk.de/pages/viewpage.action?spaceKey=HL&title=Leitlinie+generative+KI\"><b>guía provisional y una declaración de independencia</b></a> para el uso de sistemas de IA generativa.</p><p><b>Para estudiantes:</b></p><ul><li>Use HAWKI para apoyar su proceso de aprendizaje, pero no dependa exclusivamente de las respuestas generadas.</li><li>No comparta datos personales o información a través de HAWKI. Tampoco datos personales de otros.</li><li>Usted asume la autoría. Esto significa que garantiza la calidad de la respuesta y asume la responsabilidad del contenido. El uso de IA y la naturaleza de su contribución deben ser clarificados.</li></ul><p><b>Para docentes:</b></p><ul><li>Está prohibido usar HAWKI para corregir trabajos de estudiantes si estos contienen datos personales que pueden extraerse.</li><li>Utilice HAWKI como una herramienta complementaria para preparar materiales de enseñanza, pero asegúrese de verificar todo el contenido por su precisión y relevancia.</li></ul><p><b>Para el personal:</b></p><ul><li>Está estrictamente prohibido introducir contratos de confidencialidad o documentos internamente determinados en HAWKI. Asimismo, documentos que contengan datos personales sobre uno mismo o sobre otros.</li><li>Utilice HAWKI para aumentar la eficiencia y apoyar sus tareas diarias, siempre respetando las políticas de privacidad y las regulaciones de seguridad de la universidad.</li></ul><p>Esta guía sirve como una herramienta de orientación para el manejo responsable de HAWKI. Es crucial que todos los usuarios comprendan y sigan estas disposiciones para asegurar un uso seguro y ético de esta tecnología. La universidad solo puede ofrecer este servicio si no se introducen datos personales. Para cualquier pregunta o incertidumbre, por favor contacte a Prof. Stefan Wölwer, Arian Sadafi, Jonas Trippler o Vincent Timm. Independientemente de esta guía, se aplican las <a class=\"accentText\" target=\"_blank\" href=\"https://openai.com/policies/business-terms\"><b>condiciones de uso de OpenAI</b>.</a></p>",
+    "username": "Nombre de Usuario",
+    "welcomeBackTitle": "¡Bienvenido de nuevo!",
+    "writingAssistanceRequest": "Estoy trabajando en un proyecto científico y necesito ayuda con el estilo de escritura y la formateación. Ya he redactado mi trabajo, pero no estoy seguro de si he seguido todas las directrices de formateo y convenciones de escritura correctamente. ¿Podrías ayudarme a revisar mi trabajo y ofrecerme consejos para mejorar la formateación y el estilo de escritura?"
+}
\ No newline at end of file

--- private/resources/language/fr_FR.json ---
@@ -0,0 +1,141 @@
+{
+    "AI_Icon": "IA",
+    "AboutHAWKI": "À Propos de HAWKI",
+    "AboutHAWKI_ArianInfo": " | Assistant de Recherche | HAWKI",
+    "AboutHAWKI_Info": "L'offre a été développée au Laboratoire de Design d'Interaction de la HAWK pour offrir à tous les membres de l'université la possibilité d'intégrer l'intelligence artificielle dans leurs processus de travail et d'avoir un espace de rencontre pour éventuellement développer de nouvelles façons de travailler et susciter une discussion interne à l'université sur l'utilisation de l'IA. Cette offre vise également à soutenir didactiquement le développement d'une compréhension du fonctionnement d'un tel modèle de langage et fournit donc des indications sur les bons prompts (entrées de texte) fonctionnant bien dans les différents domaines. Nous sommes heureux de recevoir des retours constructifs pour faire évoluer cette offre en fonction de vos besoins et de vos découvertes.",
+    "AboutHAWKI_JonasInfo": " | Assistant de Recherche | Pratique",
+    "AboutHAWKI_StefanInfo": " | Environnements Numériques | Design d'Interaction ",
+    "AboutHAWKI_VincentInfo": " | Assistant de Recherche | Responsable du Laboratoire de Design d'Interaction",
+    "BetaMessage": "Version bêta - Modèle GPT4-Turbo",
+    "BrainStorming": "Remue-Méninges",
+    "Caution": "Prudence",
+    "Caution_Info": "- Génère parfois des informations dangereuses ou biaisées.",
+    "Chat": "Discussion",
+    "Confirm_Btn": "Confirmer",
+    "ContextComprehension": "Compréhension du Contexte",
+    "ContextComprehension_Info": "- Se souvient de ce qui a été dit précédemment dans la conversation.",
+    "Conversation": "Conversation",
+    "Conversation_Info": "Une zone de discussion comme celle de ChatGPT, pour un démarrage rapide de n'importe quelle tâche.",
+    "Copywriting": "Rédaction Publicitaire",
+    "Creativity": "Créativité",
+    "DataAnalysis": "Analyse de Données",
+    "DataSecurity": "Sécurité des Données",
+    "DesignThinking": "Pensée Design",
+    "EventManagement": "Gestion d'Événements",
+    "FeedBack": "Rétroaction",
+    "Feedback_Placeholder": "Vous pouvez laisser votre avis ici",
+    "Finance": "Finance",
+    "Formatting": "Formatage",
+    "Formatting_Info": "- Fournit des résultats générés sous la forme souhaitée.",
+    "Gamification": "Gamification",
+    "Impressum": "Mentions Légales",
+    "Incomplete": "Incomplet",
+    "Incomplete_Info": "- Génère parfois des informations erronées.",
+    "InputField_Placeholder": "Vous pouvez poser votre question ici",
+    "InterviewQuestions": "Questions d'Entretien",
+    "Iteration": "Itération",
+    "Iteration_Info": "- Permet des corrections ultérieures des résultats générés.",
+    "LearnSpace": "Espace d'Apprentissage",
+    "LearnSpace_Info": "Les salles d'apprentissage sont conçues pour aider à comprendre les différentes possibilités de soutien et à apprendre ce qui constitue une instruction efficace.",
+    "LearnStrategy": "Stratégies d'Apprentissage",
+    "LegalConsultation": "Consultation Juridique",
+    "Limitation": "Limitation",
+    "Limitation_Info": "- Le modèle de langue accède exclusivement aux connaissances jusqu'en décembre 2023.",
+    "Limitations": "Limitations",
+    "LiteratureSearch": "Recherche Documentaire",
+    "Login": "Connexion",
+    "LoginFailedMSG": "Échec de la connexion!",
+    "Marketing": "Marketing",
+    "Methodology": "Méthodologie",
+    "Motivation": "Motivation",
+    "Organization": "Organisation",
+    "Possibility": "Possibilités",
+    "Programming": "Programmation",
+    "Prototyping": "Prototypage",
+    "Research": "Recherche",
+    "ResearchSupport": "Support à la Recherche",
+    "ResearchWork": "Travaux de Recherche",
+    "SignOut": "Se Déconnecter",
+    "SocialMedia": "Médias Sociaux",
+    "StressManagement": "Gestion du Stress",
+    "System": "Système",
+    "SystemPromptInfo": "Nous envoyons cette invite système en arrière-plan pour améliorer le résultat.",
+    "System_Content": "Vous êtes un assistant utile travaillant à l'Université des Arts Appliqués et des Sciences de Basse-Saxe.",
+    "Tables": "Tableaux",
+    "TimeManagement": "Gestion du Temps",
+    "Upgrade": "Mise à Niveau vers GPT4",
+    "Upgrade_Content": "L'université met maintenant à votre disposition GPT4. Les entrées plus complexes peuvent désormais être mieux comprises et traitées. Vous devriez maintenant obtenir des réponses plus précises. Le délai d'attente pour une réponse peut légèrement s'allonger.",
+    "UsageHint": "Conseil d'Utilisation",
+    "UsageHint_Content": "Veuillez ne pas saisir de données personnelles. Nous utilisons l'API d'OpenAI. Cela signifie que les données que vous entrez seront envoyées directement à OpenAI. Il est possible qu'OpenAI réutilise ces données.",
+    "VirtualOffice": "Bureau Virtuel",
+    "VirtualOffice_Info": "Des conversations avec des experts fictifs pour se familiariser avec des domaines non spécialisés et poser des questions plus ciblées aux véritables experts universitaires.",
+    "WritingHelp": "Aide à l'Écriture",
+    "aiOverviewPage": "Page d'Aperçu de l'IA",
+    "confirmButton": "Confirmer",
+    "copiedToolTip": "Copié!",
+    "copyTooTip": "Copier",
+    "copywritingAssistanceRequest": "J'ai besoin d'aide en rédaction publicitaire. Je travaille sur un projet visant à communiquer clairement et de manière attrayante un message ou une idée. Pourriez-vous s'il vous plaît m'aider à évaluer ma rédaction actuelle et me donner des conseils et des astuces pour améliorer ma rédaction publicitaire ? Je cherche également des stratégies pour mieux comprendre mon public cible et utiliser un langage attrayant pour transmettre mon message.",
+    "copywritingExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne et vous êtes un expert dans le domaine de la créativité.",
+    "dataAnalysisAssistanceRequest": "J'ai récemment terminé la collecte de données pour mon projet de recherche et j'ai besoin d'aide pour analyser les données. Mes données comprennent des enquêtes et des mesures sur différents aspects de mon sujet de recherche. J'aimerais effectuer une analyse approfondie pour identifier les tendances, les corrélations et obtenir des informations significatives pour mes objectifs de recherche. Pouvez-vous m'aider avec ça ?",
+    "dataProtection": "Protection des Données",
+    "designThinkingAssistanceRequest": "Je cherche de l'aide pour le Design Thinking. Je travaille sur un projet qui consiste à trouver une solution créative à un problème. Pourriez-vous m'aider à mieux comprendre le processus de Design Thinking et me donner des conseils sur son application dans mon projet ? Je cherche également des stratégies pour prototyper et tester mes idées afin de m'assurer que ma solution au problème sera réussie. Pourriez-vous aussi m'aider à mettre en place une boucle de feedback pour améliorer itérativement ma solution ?",
+    "designThinkingExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne et vous êtes un expert dans le domaine de la créativité",
+    "dialogueWithFinanceAdvisor": "Vous discutez maintenant avec Julia, une consultante financière fictive. Que voulez-vous savoir sur les finances ?",
+    "eventManagementAssistanceRequest": "Je suis en train de planifier un événement [Description de l'événement] et je cherche de l'aide pour l'organisation. J'ai déjà pris quelques dispositions, mais je ne suis pas sûr d'avoir pensé à tout ou s'il y a d'autres aspects que je devrais prendre en compte. Pourriez-vous m'aider à vérifier mon plan et me donner des conseils pour l'améliorer ? Je cherche aussi des recommandations pour des lieux appropriés, des options de restauration et d'autres détails importants que j'aurais pu manquer.",
+    "eventManagementExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne et vous êtes un expert dans le domaine de l'organisation.",
+    "feedbackAssistanceRequest": "Je travaille actuellement sur un projet scientifique et je cherche des retours. Je ne suis pas sûr que mon travail réponde aux exigences ou s'il y a des améliorations possibles à ma recherche. Pourriez-vous examiner mon travail et me donner des conseils pour améliorer ma recherche et renforcer mon argumentation ?",
+    "financeExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne. Vous vous appelez Julia Schneider et vous êtes experte en finance. Vous conseillez le personnel de l'université, les étudiants et les professeurs. Si les gens veulent parler directement à quelqu'un qui travaille au département des finances de votre université, vous les renvoyez à la page d'accueil officielle de l'université.",
+    "financeUsageNoticeContent": "Dans cette section, vous discutez avec des personnes fictives. Les déclarations dans cette section ne peuvent pas être vérifiées pour leur exactitude et ne doivent servir que de suggestions.",
+    "gamificationAssistanceRequest": "Je cherche de l'aide pour intégrer la gamification dans mon projet. Je veux ajouter un élément ludique à mon application pour motiver les utilisateurs et augmenter leur engagement. Pourriez-vous m'aider à développer une stratégie pour intégrer la gamification dans mon projet ? Je cherche aussi des conseils pour choisir les mécanismes de jeu et les éléments appropriés pour motiver mes utilisateurs et créer une expérience de jeu attrayante. Pourriez-vous également m'aider à mesurer et évaluer les impacts de la gamification sur mon projet ?",
+    "gamificationExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne et vous êtes un expert dans le domaine de la créativité.",
+    "guideline_Title": "Guide d'utilisation de HAWKI",
+    "ideagenerationAssistanceRequest": "Je suis à la recherche d'idées créatives pour un projet sur lequel je travaille. Je veux élargir ma perspective et développer de nouvelles idées et approches pour mon projet. Pourriez-vous m'aider à élargir ma réflexion et me donner des conseils et des astuces pour générer des idées ?",
+    "ideagenerationExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne et vous êtes un expert dans le domaine de la créativité.",
+    "imprint": "Mentions Légales",
+    "infoPanel_Content": "<h1 class=\"headerLine\">Mise à jour de HAWKI #002</h1><h3>Nous avons encore amélioré HAWKI pour vous !</h3><p><b>Fonctionnalités :</b></p><p>Multi-langue avec des textes traduits pour l'anglais, l'italien, le français et l'espagnol.</p><p>Affichage de formules mathématiques, LaTex et amélioration de la mise en évidence de la syntaxe.</p><p><b>Qualité de vie :</b></p><p>Mode sombre pour nos couche-tard.</p><p>Les invites système sont désormais visibles de manière transparente.</p><p><b>Mises à jour de sécurité :</b></p><p>Nous avons rendu HAWKI plus sécurisé dans certains domaines et mis à jour la structure du code.</p><p>Nous remercions Thorger Jansen (Découverte, Analyse, Coordination) du <a class=\"accentText\" target=\"_blank\" href=\"https://www.sec-consult.com\"><b>Laboratoire de Vulnérabilité SEC Consult</b></a> pour avoir signalé de manière responsable les problèmes identifiés et avoir collaboré avec nous pour les résoudre.</p>",
+    "interviewAssistanceRequest": "Je me prépare à une entrevue et je cherche de l'aide pour élaborer des questions. Pourriez-vous m'aider à formuler des questions qui me permettront de recueillir les informations souhaitées ? Je préférerais utiliser des questions ouvertes. Pourriez-vous également m'aider à formuler des questions adaptées aux besoins de mon interlocuteur, lui permettant de partager ses expériences et ses opinions en détail ? Je cherche également des conseils pour mener une entrevue réussie et pour enregistrer et organiser les informations recueillies.",
+    "interviewExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne et vous êtes un expert dans le domaine de la créativité.",
+    "language": "Langue",
+    "lawDialogueIntroduction": "Vous discutez maintenant avec Luis, un conseiller juridique fictif. Que voulez-vous savoir sur les conseils juridiques ?",
+    "lawExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne. Vous vous appelez Luis Martinez et vous êtes un expert en conseils juridiques. Vous conseillez le personnel de l'université, les étudiants et les professeurs. Si les gens veulent parler directement à quelqu'un qui travaille au département juridique de votre université, vous les renvoyez à la page d'accueil officielle de l'université.",
+    "lawUsageNoticeContent": "Dans cette section, vous discutez avec des personnes fictives. Les déclarations dans cette section ne peuvent pas être vérifiées pour leur exactitude et ne doivent servir que de suggestions.",
+    "learningAssistanceRequest": "Je cherche de l'aide pour les stratégies d'apprentissage. J'ai du mal à apprendre efficacement et à accomplir mes tâches. Je ne suis pas sûr des stratégies d'apprentissage qui me conviennent le mieux ou comment mieux organiser mon temps pour atteindre mes objectifs d'apprentissage. Pourriez-vous évaluer ma situation d'apprentissage actuelle et me donner des conseils pour améliorer mes stratégies d'apprentissage ?",
+    "learningExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne et vous êtes un expert dans le domaine de l'organisation",
+    "literatureResearchAssistanceRequest": "Je travaille sur un projet et j'ai besoin d'aide pour la recherche de littérature pertinente. Mon sujet est [Description du sujet], et je cherche des articles scientifiques et des livres sur ce sujet. Je ne suis pas sûr des sources à utiliser ou comment rendre ma recherche plus efficace. Pourriez-vous m'aider à trouver des sources pertinentes et me donner des conseils pour mener efficacement ma recherche ?",
+    "marketingDialogueIntroduction": "Vous discutez maintenant avec Felix, un employé fictif du service marketing. Que voulez-vous savoir sur le marketing ?",
+    "marketingExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne. Vous vous appelez Felix Müller et vous êtes un expert en marketing. Vous conseillez le personnel de l'université, les étudiants et les professeurs. Si les gens veulent parler directement à quelqu'un qui travaille dans le département marketing de votre université, vous les renvoyez à la page d'accueil officielle de l'université.",
+    "marketingUsageNoticeContent": "Dans cette section, vous discutez avec des personnes fictives. Les déclarations dans cette section ne peuvent pas être vérifiées pour leur exactitude et ne doivent servir que de suggestions.",
+    "methodologyAssistanceRequest": "Je travaille sur un projet scientifique et j'ai besoin d'aide pour la méthodologie. J'ai décidé d'utiliser [Description de la méthodologie choisie] pour atteindre [Objectif de la recherche], mais je ne suis pas sûr de l'appliquer correctement ou s'il existe d'autres méthodes plus adaptées. Pourriez-vous vérifier ma méthodologie et me proposer des conseils pour l'améliorer ou des alternatives le cas échéant ?",
+    "motivationAssistanceRequest": "Je cherche de l'aide pour améliorer ma motivation dans ma vie universitaire. Je me sens souvent dépassé et démotivé lorsque j'essaie de suivre mes études et mes autres engagements. Pourriez-vous évaluer ma situation actuelle et me donner des conseils pour améliorer ma motivation ? Je cherche également des stratégies pour mieux définir mes objectifs et suivre mes progrès.",
+    "motivationExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne et vous êtes un expert dans le domaine de l'organisation",
+    "organisationExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne et vous êtes un expert dans le domaine de l'organisation.",
+    "password": "Mot de Passe",
+    "programmingDialogueIntroduction": "Vous discutez maintenant avec Fatima, une programmeuse fictive. Que voulez-vous savoir sur la programmation ?",
+    "programmingExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne. Vous vous appelez Fatima Kamara et vous êtes experte en programmation. Vous conseillez le personnel de l'université, les étudiants et les professeurs. Si les gens veulent parler directement à quelqu'un qui travaille dans le département de programmation de votre université, vous les renvoyez à la page d'accueil officielle de l'université.",
+    "programmingUsageNoticeContent": "Dans cette section, vous discutez avec des personnes fictives. Les déclarations dans cette section ne peuvent pas être vérifiées pour leur exactitude et ne doivent servir que de suggestions.",
+    "promptSuggestion": "Suggestion de Prompt",
+    "prototypingAssistanceRequest": "Je cherche de l'aide pour le prototypage dans mon processus de conception. Pourriez-vous m'aider à réaliser un prototypage efficace qui m'aide à visualiser et tester mes idées de conception ? Je cherche des conseils sur le choix des meilleurs matériaux et outils pour mon prototypage, et comment mieux prendre en compte les besoins de ma cible. Pourriez-vous m'aider à adapter mon prototypage à différents scénarios pour qu'il soit pertinent pour toutes les expériences utilisateur possibles ?",
+    "prototypingExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne et vous êtes un expert dans le domaine de la créativité.",
+    "researchAssistanceRequest": "Je travaille actuellement sur un projet scientifique et j'ai besoin d'aide pour la recherche. Mon sujet est [Description du sujet], et j'ai besoin de plus d'informations sur [Questions ou sujets spécifiques]. J'ai déjà trouvé quelques sources, mais je ne suis pas sûr d'avoir trouvé toutes les sources pertinentes ou si je devrais utiliser d'autres ressources. Pourriez-vous m'aider à trouver des sources supplémentaires et me donner des conseils pour mener efficacement ma recherche ?",
+    "scienceDialogueIntroduction": "Vous discutez maintenant avec Sophie, une chercheuse fictive. Que voulez-vous savoir sur la recherche ?",
+    "scienceExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne. Vous vous appelez Sophie Martin et vous êtes experte en recherche. Vous conseillez le personnel de l'université, les étudiants et les professeurs. Si les gens veulent parler directement à quelqu'un qui travaille dans le département scientifique de votre université, vous les renvoyez à la page d'accueil officielle de l'université.",
+    "scienceUsageNoticeContent": "Dans cette section, vous discutez avec des personnes fictives. Les déclarations dans cette section ne peuvent pas être vérifiées pour leur exactitude et ne doivent servir que de suggestions.",
+    "scientificWorkExpertiseMessage": "",
+    "settings": "Paramètres",
+    "socialMediaDialogueIntroduction": "Vous discutez maintenant avec Erik, un employé fictif des médias sociaux. Que voulez-vous savoir sur les médias sociaux ?",
+    "socialMediaExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne. Vous vous appelez Erik Hansen et vous êtes un expert en médias sociaux. Vous conseillez le personnel de l'université, les étudiants et les professeurs. Si les gens veulent parler directement à quelqu'un qui travaille dans le département des médias sociaux de votre université, vous les renvoyez à la page d'accueil officielle de l'université.",
+    "socialMediaUsageNoticeContent": "Dans cette section, vous discutez avec des personnes fictives. Les déclarations dans cette section ne peuvent pas être vérifiées pour leur exactitude et ne doivent servir que de suggestions.",
+    "stressManagementAssistanceRequest": "Je cherche de l'aide pour la gestion du stress dans ma vie universitaire. Je me sens souvent stressé et dépassé lorsque j'essaie de suivre mes obligations académiques, ma vie sociale et d'autres engagements. Pourriez-vous évaluer ma situation de stress actuelle et me donner des conseils pour faire face au stress à l'université ? Je cherche aussi des stratégies pour mieux organiser mon temps et définir mes priorités.",
+    "stressManagementExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne et vous êtes un expert dans le domaine de l'organisation.",
+    "successfulRegistration": "Votre inscription a été réussie.",
+    "tableCreationAssistanceRequest": "J'ai besoin d'aide pour créer des tableaux. J'ai collecté des données que je veux représenter dans un tableau, mais je ne suis pas sûr de la meilleure façon de le formater et de l'organiser pour présenter les informations de manière claire et compréhensible. Pourriez-vous m'aider à concevoir un tableau approprié et me donner des conseils sur la conception et la formatage du tableau ? Je cherche également des conseils sur la meilleure façon de présenter les informations dans le tableau pour les rendre facilement accessibles aux lecteurs.",
+    "tableExpertiseMessage": "Vous êtes un assistant utile travaillant dans une université en Allemagne et vous êtes un expert dans le domaine de l'organisation.",
+    "theme": "Thème",
+    "timeManagementAssistanceRequest": "Je cherche de l'aide pour la gestion du temps. J'ai du mal à utiliser mon temps efficacement et à accomplir mes tâches en temps voulu. Je ne suis pas sûr de comment mieux organiser mon temps pour atteindre mes objectifs et éviter le stress. Pourriez-vous évaluer mon utilisation actuelle du temps et me donner des conseils pour améliorer ma gestion du temps ? Je cherche aussi des stratégies pour définir mes priorités et mieux planifier mon temps pour augmenter ma productivité et atteindre mes objectifs.",
+    "unableToSaveRegistration": "<b>Votre inscription n'a pas pu être sauvegardée.<br>Veuillez réessayer.</b>",
+    "usageNoticeTitle": "Conseil d'Utilisation",
+    "usage_guideline": "<p>Bienvenue dans le guide d'utilisation de HAWKI, basé sur l'API OpenAI. Ce guide est destiné à tous les membres de l'université - étudiants, enseignants et personnel - afin de fournir une ligne directrice claire sur la manière de gérer cette technologie de manière responsable. Veuillez noter que ce guide complète les conditions d'utilisation d'OpenAI et n'est pas exhaustif. Il est de la responsabilité des utilisateurs de respecter ces conditions.</p><h3>Dispositions générales</h3><p><b>Ce qui est interdit :</b></p><ul><li>Saisir des données personnelles sur soi-même ou sur d'autres personnes.</li><li>Utiliser les services pour des activités illégales, nuisibles ou abusives.</li><li>Viol, abus ou violation des droits d'autres personnes.</li><li>Modification, copie, location, vente ou distribution de nos services.</li><li>Tentative de rétro-ingénierie, décompilation ou de découverte du code source ou des composants sous-jacents.</li><li>Extraction automatique ou programmée de données ou de sorties.</li><li>Pretendre que la sortie a été créée par des humains lorsque ce n'est pas le cas.</li><li>Altération ou perturbation des services ou contournement des mesures de protection.</li><li>Utilisation de la sortie pour développer des modèles concurrents.</li></ul><p><b>À noter :</b></p><p>Vous êtes responsable de l'entrée que vous fournissez et de la sortie résultante. Vous devez vous assurer que votre entrée ne viole aucun droit et que vous disposez de tous les droits, licences et autorisations nécessaires pour fournir l'entrée.</p><b>Exactitude :</b><p>L'utilisation des services peut entraîner une sortie inexacte ou incorrecte. Il est important de critiquer la sortie et de ne pas l'utiliser comme la seule source de vérité. Vos entrées ne sont pas stockées par HAWK, mais par OpenAI pendant 30 jours pour détecter d'éventuels abus. Après 30 jours, les données sont supprimées. Vos entrées ne sont pas utilisées pour améliorer la sécurité ou la qualité du produit.</p><h3>Dispositions spécifiques</h3><p>Il existe une <a class=\"accentText\" target=\"_blank\" href=\"https://wiki.hawk.de/pages/viewpage.action?spaceKey=HL&title=Leitlinie+generative+KI\"><b>directive provisoire et une déclaration d'indépendance</b></a> pour l'utilisation des systèmes de IA générative.</p><p><b>Pour les étudiants :</b></p><ul><li>Utilisez HAWKI pour soutenir votre processus d'apprentissage, mais ne vous fiez pas exclusivement aux réponses générées.</li><li>Ne partagez pas de données personnelles ou d'informations via HAWKI. Pas même celles d'autres personnes.</li><li>Vous prenez la responsabilité de l'auteur. Vous garantissez la qualité de la réponse et assumez la responsabilité du contenu. L'utilisation de l'IA et la nature de sa contribution doit être clarifiée.</li></ul><p><b>Pour les enseignants :</b></p><ul><li>Il est interdit d'utiliser HAWKI pour corriger les travaux étudiants contenant des données personnelles extractibles.</li><li>Utilisez HAWKI comme un outil complémentaire pour la préparation du matériel pédagogique, mais assurez-vous que tout le contenu est vérifié pour son exactitude et sa pertinence.</li></ul><p><b>Pour le personnel :</b></p><ul><li>Il est strictement interdit de saisir des accords de confidentialité ou des documents internes dans HAWKI. Ainsi que des documents contenant des données personnelles sur soi-même ou sur d'autres personnes.</li><li>Utilisez HAWKI pour augmenter l'efficacité et soutenir vos tâches quotidiennes, tout en respectant les politiques de confidentialité et les réglementations de sécurité de l'université.</li></ul><p>Ce guide vise à fournir une orientation pour une gestion responsable de HAWKI. Il est crucial que tous les utilisateurs comprennent et suivent ces dispositions pour assurer une utilisation sûre et éthique de cette technologie. L'université ne peut offrir ce service que si aucune donnée personnelle n'est saisie. Pour toute question ou incertitude, veuillez contacter Prof. Stefan Wölwer, Arian Sadafi, Jonas Trippler ou Vincent Timm. Indépendamment de ce guide, les <a class=\"accentText\" target=\"_blank\" href=\"https://openai.com/policies/business-terms\"><b>conditions d'utilisation d'OpenAI</b></a> s'appliquent.</p>",
+    "username": "Nom d'utilisateur",
+    "welcomeBackTitle": "Bienvenue de nouveau !",
+    "writingAssistanceRequest": "Je travaille sur un projet scientifique et j'ai besoin d'aide pour le style d'écriture et la mise en forme. J'ai déjà rédigé mon travail, mais je ne suis pas sûr d'avoir suivi toutes les directives de formatage et les conventions d'écriture correctement. Pourriez-vous m'aider à réviser mon travail et me donner des conseils pour améliorer la mise en forme et le style d'écriture ?"
+}
\ No newline at end of file

--- private/resources/language/it_IT.json ---
@@ -0,0 +1,141 @@
+{
+    "AI_Icon": "IA",
+    "AboutHAWKI": "Riguardo HAWKI",
+    "AboutHAWKI_ArianInfo": " | Assistente di Ricerca | HAWKI",
+    "AboutHAWKI_Info": "L'offerta è stata sviluppata nel Laboratorio di Design Interattivo della HAWK per dare a tutti i membri dell'università la possibilità di integrare l'intelligenza artificiale nei processi di lavoro e avere uno spazio di incontro in modo che possano emergere nuovi metodi di lavoro e possa nascere una discussione interna all'università sull'uso dell'IA. Questa offerta vuole anche supportare didatticamente, sviluppando una comprensione del funzionamento di tale modello linguistico e fornisce quindi in varie aree anche suggerimenti su prompt (input testuali) che funzionano bene. Accogliamo con favore un feedback costruttivo per sviluppare ulteriormente questa offerta in base alle vostre esigenze e conoscenze.",
+    "AboutHAWKI_JonasInfo": " | Assistente di Ricerca | Pratico",
+    "AboutHAWKI_StefanInfo": " | Ambienti Digitali | Design dell'Interazione ",
+    "AboutHAWKI_VincentInfo": " | Assistente di Ricerca | Responsabile del Laboratorio di Design dell'Interazione",
+    "BetaMessage": "Versione beta - Modello GPT4-Turbo",
+    "BrainStorming": "Brainstorming",
+    "Caution": "Attenzione",
+    "Caution_Info": " - Genera occasionalmente informazioni pericolose o prevenute.",
+    "Chat": "Chat",
+    "Confirm_Btn": "Conferma",
+    "ContextComprehension": "Comprensione del Contesto",
+    "ContextComprehension_Info": " - Ricorda ciò che è stato detto precedentemente nella conversazione.",
+    "Conversation": "Conversazione",
+    "Conversation_Info": "Una zona di chat come ChatGPT, per un rapido inizio in qualsiasi compito.",
+    "Copywriting": "Copywriting",
+    "Creativity": "Creatività",
+    "DataAnalysis": "Analisi dei Dati",
+    "DataSecurity": "Protezione dei Dati",
+    "DesignThinking": "Design Thinking",
+    "EventManagement": "Gestione degli Eventi",
+    "FeedBack": "Feedback",
+    "Feedback_Placeholder": "Qui puoi lasciare il tuo feedback",
+    "Finance": "Finanze",
+    "Formatting": "Formattazione",
+    "Formatting_Info": " - Mostra i risultati generati nel formato desiderato.",
+    "Gamification": "Gamificazione",
+    "Impressum": "Impronta",
+    "Incomplete": "Incompleto",
+    "Incomplete_Info": " - Genera occasionalmente informazioni errate.",
+    "InputField_Placeholder": "Qui puoi inserire la tua richiesta",
+    "InterviewQuestions": "Domande per l'Intervista",
+    "Iteration": "Iterazione",
+    "Iteration_Info": " - Consente correzioni successive dei risultati generati.",
+    "LearnSpace": "Spazio di Apprendimento",
+    "LearnSpace_Info": "Gli spazi di apprendimento sono pensati per aiutare a comprendere le varie possibilità di supporto e per imparare cosa rende un prompt efficace.",
+    "LearnStrategy": "Strategie di Apprendimento",
+    "LegalConsultation": "Consulenza Legale",
+    "Limitation": "Limitazione",
+    "Limitation_Info": " - Il modello linguistico accede esclusivamente alla conoscenza fino ad dicembre 2023.",
+    "Limitations": "Limitazioni",
+    "LiteratureSearch": "Ricerca Bibliografica",
+    "Login": "Accesso",
+    "LoginFailedMSG": "Accesso non riuscito!",
+    "Marketing": "Marketing",
+    "Methodology": "Metodologia",
+    "Motivation": "Motivazione",
+    "Organization": "Organizzazione",
+    "Possibility": "Possibilità",
+    "Programming": "Programmazione",
+    "Prototyping": "Prototipazione",
+    "Research": "Ricerca",
+    "ResearchSupport": "Supporto alla Ricerca",
+    "ResearchWork": "Lavori di Ricerca",
+    "SignOut": "Disconnettersi",
+    "SocialMedia": "Social Media",
+    "StressManagement": "Gestione dello Stress",
+    "System": "Sistema",
+    "SystemPromptInfo": "Inviamo questo prompt di sistema in background per migliorare il risultato.",
+    "System_Content": "Sei un assistente utile che lavora all'Università di Scienze Applicate in Bassa Sassonia.",
+    "Tables": "Tabelle",
+    "TimeManagement": "Gestione del Tempo",
+    "Upgrade": "Aggiornamento a GPT-4",
+    "Upgrade_Content": "L'università ora mette a disposizione GPT-4. Le input più complesse possono ora essere comprese e elaborate meglio. Dovresti ora ricevere risposte più precise. Il tempo di attesa per una risposta può aumentare leggermente.",
+    "UsageHint": "Avviso di Utilizzo",
+    "UsageHint_Content": "Si prega di non inserire dati personali. Usiamo l'API di OpenAI. Ciò significa che i dati inseriti vengono inviati direttamente a OpenAI. Esiste la possibilità che OpenAI possa utilizzare questi dati ulteriormente.",
+    "VirtualOffice": "Ufficio Virtuale",
+    "VirtualOffice_Info": "Conversazioni con esperti fittizi, per abituarsi in aree al di fuori della propria competenza e per fare richieste più mirate agli esperti reali dell'università.",
+    "WritingHelp": "Aiuto nella Scrittura",
+    "aiOverviewPage": "Pagina Panoramica sull'IA",
+    "confirmButton": "Conferma",
+    "copiedToolTip": "Copiato!",
+    "copyTooTip": "Copiare",
+    "copywritingAssistanceRequest": "Ho bisogno di supporto nel copywriting. Sto lavorando a un progetto che mira a comunicare un messaggio o un'idea in modo chiaro e attraente. Potresti valutare il mio attuale stile di scrittura e fornirmi consigli e suggerimenti per migliorare il mio copywriting? Sto anche cercando strategie per comprendere meglio il mio pubblico di destinazione e utilizzare un linguaggio coinvolgente per trasmettere il mio messaggio.",
+    "copywritingExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania e sei un esperto nel campo della creatività.",
+    "dataAnalysisAssistanceRequest": "Ho recentemente raccolto un ampio insieme di dati e ora cerco supporto per analizzare questi dati. La raccolta dati comprende [Descrizione dei dati], e vorrei [Obiettivo dell'analisi]. Potresti aiutarmi ad analizzare i dati e fornirmi consigli per l'interpretazione dei risultati?",
+    "dataProtection": "Protezione dei Dati",
+    "designThinkingAssistanceRequest": "Sto cercando supporto su Design Thinking. Sto lavorando a un progetto che mira a trovare una soluzione creativa a un problema. Potresti aiutarmi a comprendere meglio il processo di Design Thinking e fornirmi consigli e suggerimenti sull'applicazione di questo processo nel mio progetto? Sto anche cercando strategie per prototipare e testare le mie idee, per assicurarmi che la soluzione al problema sia efficace. Potresti aiutarmi anche a impostare un ciclo di feedback per migliorare iterativamente la mia soluzione?",
+    "designThinkingExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania e sei un esperto nel campo della creatività.",
+    "dialogueWithFinanceAdvisor": "Ora stai conversando con Julia, una consulente finanziaria fittizia. Cosa vorresti sapere sulle finanze?",
+    "eventManagementAssistanceRequest": "Sto pianificando un evento [Descrizione dell'evento] e cerco supporto nella pianificazione. Ho già organizzato alcune cose, ma non sono sicuro di aver pensato a tutto o se ci sono aspetti che dovrei considerare. Potresti aiutarmi a rivedere la mia pianificazione e fornirmi consigli per migliorarla? Sto anche cercando raccomandazioni per location adeguate, opzioni di catering e altri dettagli importanti che potrei aver trascurato.",
+    "eventManagementExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania e sei un esperto nel campo dell'organizzazione.",
+    "feedbackAssistanceRequest": "Sto lavorando a un progetto scientifico e cerco feedback. Non sono sicuro che il mio lavoro soddisfi i requisiti o se posso migliorare la mia ricerca. Potresti dare un'occhiata al mio lavoro e fornirmi consigli su come migliorare la mia ricerca e rafforzare il mio argomento?",
+    "financeExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania. Ti chiami Julia Schneider e sei un'esperta in finanza. Fornisci consulenza al personale universitario, agli studenti e ai professori. Se le persone vogliono parlare direttamente con qualcuno che lavora nel dipartimento finanziario della tua università li indirizzi alla homepage ufficiale dell'università.",
+    "financeUsageNoticeContent": "In quest'area si parla con persone fittizie. Le dichiarazioni in questa sezione non possono essere verificate per la loro veridicità e dovrebbero servire solo come stimolo.",
+    "gamificationAssistanceRequest": "Sto cercando supporto per integrare la gamification nel mio progetto. Voglio includere un elemento ludico nella mia applicazione per motivare gli utenti e aumentare il coinvolgimento. Potresti aiutarmi a sviluppare una strategia per l'integrazione della gamification nel mio progetto? Sto cercando consigli sulla scelta di meccaniche di gioco e elementi adatti per motivare gli utenti e creare un'esperienza di gioco coinvolgente. Potresti aiutarmi anche a misurare e valutare l'impatto della gamification sul mio progetto?",
+    "gamificationExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania e sei un esperto nel campo della creatività.",
+    "guideline_Title": "Guida all'uso di HAWKI",
+    "ideagenerationAssistanceRequest": "Sto cercando idee creative per un progetto a cui sto lavorando. Voglio ampliare la mia prospettiva e sviluppare nuove idee e approcci per il mio progetto. Potresti aiutarmi ad ampliare il mio pensiero e fornirmi consigli e suggerimenti per la generazione di idee?",
+    "ideagenerationExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania e sei un esperto nel campo della creatività.",
+    "imprint": "Colophon",
+    "infoPanel_Content": "<h1 class=\"headerLine\">Aggiornamento di HAWKI #002</h1><h3>Abbiamo ulteriormente migliorato HAWKI per te!</h3><p><b>Funzionalità:</b></p><p>Multi-lingua con testi tradotti per inglese, italiano, francese e spagnolo.</p><p>Visualizzazione di formule matematiche, LaTex e miglioramento dell'evidenziazione della sintassi.</p><p><b>Qualità della vita:</b></p><p>Modalità scura per i nostri nottambuli.</p><p>Le indicazioni di sistema sono ora visibili in modo trasparente.</p><p><b>Aggiornamenti di sicurezza:</b></p><p>Abbiamo reso HAWKI più sicuro in alcune aree e aggiornato la struttura del codice.</p><p>Ringraziamo Thorger Jansen (Scoperta, Analisi, Coordinamento) dal <a class=\"accentText\" target=\"_blank\" href=\"https://www.sec-consult.com\"><b>Laboratorio di Vulnerabilità SEC Consult</b></a> per la segnalazione responsabile dei problemi identificati e la collaborazione con noi per risolverli.</p>",
+    "interviewAssistanceRequest": "Mi sto preparando per un'intervista e cerco supporto nella formulazione delle domande. Potresti aiutarmi a formulare domande che mi permettano di raccogliere le informazioni desiderate? Vorrei utilizzare domande aperte. Potresti aiutarmi anche a formulare domande che siano adattate alle esigenze del mio intervistato, permettendogli di condividere in modo approfondito le sue esperienze e opinioni? Sto cercando anche consigli su come condurre un'intervista di successo e su come registrare e organizzare le informazioni raccolte.",
+    "interviewExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania e sei un esperto nel campo della creatività.",
+    "language": "Lingua",
+    "lawDialogueIntroduction": "Ora stai conversando con Luis, un consulente legale fittizio. Cosa vorresti sapere sulla consulenza legale?",
+    "lawExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania. Ti chiami Luis Martinez e sei un esperto in consulenza legale. Fornisci consulenza al personale universitario, agli studenti e ai professori. Se le persone vogliono parlare direttamente con qualcuno che lavora nel dipartimento legale della tua università li indirizzi alla homepage ufficiale dell'università.",
+    "lawUsageNoticeContent": "In quest'area si parla con persone fittizie. Le dichiarazioni in questa sezione non possono essere verificate per la loro veridicità e dovrebbero servire solo come stimolo.",
+    "learningAssistanceRequest": "Sto cercando supporto per le strategie di apprendimento. Ho difficoltà ad imparare in modo efficace e a completare i miei compiti. Non sono sicuro di quali strategie di apprendimento siano meglio adatte a me o come posso organizzare meglio il mio tempo per raggiungere i miei obiettivi di apprendimento. Potresti aiutarmi a valutare la mia situazione di apprendimento attuale e fornirmi consigli e suggerimenti per migliorare le mie strategie di apprendimento?",
+    "learningExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania e sei un esperto nel campo dell'organizzazione.",
+    "literatureResearchAssistanceRequest": "Sto lavorando a un progetto e ho bisogno di aiuto nella ricerca di letteratura pertinente. Il mio argomento è [Descrizione del tema], e sto cercando articoli e libri scientifici che trattano questo argomento. Non sono sicuro di quali fonti utilizzare o come rendere la mia ricerca più efficace. Potresti aiutarmi a trovare fonti pertinenti e fornirmi consigli per condurre efficacemente la mia ricerca?",
+    "marketingDialogueIntroduction": "Ora stai conversando con Felix, un dipendente del marketing fittizio. Cosa vorresti sapere sul marketing?",
+    "marketingExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania. Ti chiami Felix Müller e sei un esperto in marketing. Fornisci consulenza al personale universitario, agli studenti e ai professori. Se le persone vogliono parlare direttamente con qualcuno che lavora nel dipartimento di marketing della tua università li indirizzi alla homepage ufficiale dell'università.",
+    "marketingUsageNoticeContent": "In quest'area si parla con persone fittizie. Le dichiarazioni in questa sezione non possono essere verificate per la loro veridicità e dovrebbero servire solo come stimolo.",
+    "methodologyAssistanceRequest": "Sto lavorando a un progetto scientifico e cerco supporto per la metodologia. Ho deciso di utilizzare [Descrizione della metodologia scelta] per raggiungere [Obiettivo della ricerca], ma non sono sicuro di applicare correttamente la metodologia o se ci siano altri metodi più adatti. Potresti aiutarmi a rivedere la mia metodologia e, se necessario, suggerirmi miglioramenti o alternative?",
+    "motivationAssistanceRequest": "Sto cercando supporto per migliorare la mia motivazione nella vita universitaria. Spesso mi sento sopraffatto e demotivato quando cerco di tenere il passo con i miei studi e altre responsabilità. Potresti aiutarmi a valutare la mia situazione attuale e fornirmi consigli e suggerimenti per migliorare la mia motivazione? Sto anche cercando strategie per definire meglio i miei obiettivi e monitorare i miei progressi.",
+    "motivationExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania e sei un esperto nel campo dell'organizzazione.",
+    "organisationExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania e sei un esperto nel campo dell'organizzazione.",
+    "password": "Password",
+    "programmingDialogueIntroduction": "Ora stai conversando con Fatima, una programmatrice fittizia. Cosa vorresti sapere sulla programmazione?",
+    "programmingExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania. Ti chiami Fatima Kamara e sei un esperta in programmazione. Fornisci consulenza al personale universitario, agli studenti e ai professori. Se le persone vogliono parlare direttamente con qualcuno che lavora nel dipartimento di programmazione della tua università li indirizzi alla homepage ufficiale dell'università.",
+    "programmingUsageNoticeContent": "In quest'area si parla con persone fittizie. Le dichiarazioni in questa sezione non possono essere verificate per la loro veridicità e dovrebbero servire solo come stimolo, specialmente nel campo della programmazione.",
+    "promptSuggestion": "Suggerimento Prompt",
+    "prototypingAssistanceRequest": "Sto cercando supporto per il prototyping nel mio processo di design. Potresti aiutarmi a eseguire un prototyping efficace che mi aiuti a visualizzare e testare le mie idee di design? Sto cercando consigli e linee guida per scegliere i migliori materiali e strumenti per il mio prototyping, e come posso meglio considerare le esigenze del mio pubblico di destinazione. Potresti aiutarmi anche a adattare il mio prototyping a diversi scenari per assicurarmi che sia rilevante per tutte le possibili esperienze utente? Sto anche cercando strategie per raccogliere feedback dai miei prototipi e integrarlo nel mio processo di design.",
+    "prototypingExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania e sei un esperto nel campo della creatività.",
+    "researchAssistanceRequest": "Sto lavorando a un progetto di ricerca e cerco supporto nella ricerca. Il mio argomento è [Descrizione dell'argomento], e necessito di ulteriori informazioni su [domande specifiche o argomenti]. Ho già trovato alcune fonti, ma non sono sicuro di aver trovato tutte le fonti pertinenti o se dovrei utilizzare altre risorse. Potresti aiutarmi a trovare fonti aggiuntive e fornirmi consigli su come condurre efficacemente la mia ricerca?",
+    "scienceDialogueIntroduction": "Ora stai conversando con Sophie, una ricercatrice fittizia. Cosa vorresti sapere sulla ricerca?",
+    "scienceExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania. Ti chiami Sophie Martin e sei un'esperta in ricerca. Fornisci consulenza al personale universitario, agli studenti e ai professori. Se le persone vogliono parlare direttamente con qualcuno che lavora nel dipartimento scientifico della tua università li indirizzi alla homepage ufficiale dell'università.",
+    "scienceUsageNoticeContent": "In quest'area si parla con persone fittizie. Le dichiarazioni in questa sezione non possono essere verificate per la loro veridicità e dovrebbero servire solo come stimolo, specialmente in campo scientifico. È importante valutare criticamente le informazioni.",
+    "scientificWorkExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania e sei un esperto nel lavoro scientifico.",
+    "settings": "Impostazioni",
+    "socialMediaDialogueIntroduction": "Ora stai conversando con Erik, un dipendente del social media fittizio. Cosa vorresti sapere sui social media?",
+    "socialMediaExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania. Ti chiami Erik Hansen e sei un esperto in social media. Fornisci consulenza al personale universitario, agli studenti e ai professori. Se le persone vogliono parlare direttamente con qualcuno che lavora nel dipartimento dei social media della tua università li indirizzi alla homepage ufficiale dell'università.",
+    "socialMediaUsageNoticeContent": "In quest'area si parla con persone fittizie. Le dichiarazioni in questa sezione non possono essere verificate per la loro veridicità e dovrebbero servire solo come stimolo, specialmente nel contesto dei social media, dove le informazioni si diffondono rapidamente e in grande quantità.",
+    "stressManagementAssistanceRequest": "Sto cercando supporto per la gestione dello stress nella vita universitaria. Spesso mi sento stressato e sopraffatto quando cerco di tenere il passo con i miei impegni accademici, la vita sociale e altre responsabilità. Potresti aiutarmi a valutare la mia attuale situazione di stress e fornirmi consigli e suggerimenti su come gestire lo stress nella vita universitaria? Sto anche cercando strategie per organizzare meglio il mio tempo e stabilire le mie priorità per ridurre il carico di stress.",
+    "stressManagementExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania e sei un esperto nel campo dell'organizzazione.",
+    "successfulRegistration": "La registrazione è avvenuta con successo.",
+    "tableCreationAssistanceRequest": "Ho bisogno di aiuto nella creazione di tabelle. Ho raccolto dei dati che voglio rappresentare in una tabella, ma non sono sicuro di come formattare e organizzare al meglio la tabella per presentare le informazioni in modo chiaro e comprensibile. Potresti aiutarmi a progettare una tabella adeguata e fornirmi consigli sulla progettazione e formattazione della tabella? Sto anche cercando suggerimenti su come presentare al meglio le informazioni nella tabella per renderle facilmente accessibili ai lettori.",
+    "tableExpertiseMessage": "Sei un assistente utile che lavora presso un'università in Germania e sei un esperto nel campo dell'organizzazione.",
+    "theme": "Tema",
+    "timeManagementAssistanceRequest": "Sto cercando supporto per la gestione del tempo. Ho difficoltà a usare efficacemente il mio tempo e a completare i miei compiti in tempo adeguato. Non sono sicuro di come posso organizzare meglio il mio tempo per raggiungere i miei obiettivi e evitare lo stress. Potresti aiutarmi a valutare il mio attuale uso del tempo e fornirmi consigli e suggerimenti per migliorare la mia gestione del tempo? Sto anche cercando strategie per stabilire le mie priorità e pianificare meglio il mio tempo per aumentare la mia produttività e raggiungere i miei obiettivi.",
+    "unableToSaveRegistration": "<b>La registrazione non può essere salvata.<br>Si prega di riprovare.</b>",
+    "usageNoticeTitle": "Avviso di Utilizzo",
+    "usage_guideline": "<p>Benvenuti alla guida per l'uso di HAWKI, basata sull'API di OpenAI. Questa guida è destinata a tutti i membri dell'università - studenti, insegnanti e personale - per fornire una linea guida chiara su come gestire questa tecnologia in modo responsabile. Si prega di notare che questa guida integra i termini di utilizzo di OpenAI e non è esaustiva. È responsabilità degli utenti rispettare tali termini.</p><h3>Disposizioni generali</h3><p><b>Cosa è vietato:</b></p><ul><li>Inserire dati personali su se stessi o su altri.</li><li>Utilizzare i servizi per attività illegali, dannose o abusive.</li><li>Violazione, abuso o infrazione dei diritti altrui.</li><li>Modifica, copia, noleggio, vendita o distribuzione dei nostri servizi.</li><li>Tentativo di reverse engineering, decompilazione o scoperta del codice sorgente o dei componenti sottostanti.</li><li>Estrazione automatica o programmata di dati o output.</li><li>Affermare che l'output è stato creato da umani quando non è così.</li><li>Alterazione o interruzione dei servizi o elusione delle misure di protezione.</li><li>Uso dell'output per sviluppare modelli concorrenti.</li></ul><p><b>Cosa tenere presente:</b></p><p>Siete responsabili dell'input fornito e dell'output risultante. Dovete assicurarvi che il vostro input non violi alcun diritto e che disponiate di tutti i diritti, licenze e autorizzazioni necessari per fornirlo.</p><b>Accuratezza:</b><p>L'utilizzo dei servizi può portare a output inaccurati o errati. È importante che valutiate criticamente l'output e che non lo utilizziate come unica fonte di verità. I vostri input non sono memorizzati da HAWK, ma da OpenAI per 30 giorni al fine di rilevare eventuali abusi. Dopo 30 giorni, i dati vengono cancellati. I vostri input non sono utilizzati per migliorare la sicurezza o la qualità del prodotto.</p><h3>Disposizioni specifiche</h3><p>Ci sono una <a class=\"accentText\" target=\"_blank\" href=\"https://wiki.hawk.de/pages/viewpage.action?spaceKey=HL&title=Leitlinie+generative+KI\"><b>linea guida provvisoria e una dichiarazione di indipendenza</b></a> per l'utilizzo dei sistemi di IA generativa.</p><p><b>Per gli studenti:</b></p><ul><li>Utilizzate HAWKI per supportare il vostro processo di apprendimento, ma non affidatevi esclusivamente alle risposte generate.</li><li>Non condividete dati personali o informazioni tramite HAWKI. Nemmeno i dati personali di altri.</li><li>Assumete la paternità. Ciò significa che garantite la qualità della risposta e assumete la responsabilità del contenuto. L'uso dell'IA e la natura del suo contributo devono essere chiariti.</li></ul><p><b>Per gli insegnanti:</b></p><ul><li>È vietato utilizzare HAWKI per correggere i lavori degli studenti se contengono dati personali estraibili.</li><li>Utilizzate HAWKI come strumento complementare per la preparazione dei materiali didattici, ma assicuratevi che tutto il contenuto sia verificato per la sua accuratezza e rilevanza.</li></ul><p><b>Per il personale:</b></p><ul><li>È severamente proibito inserire accordi di riservatezza o documenti interni su HAWKI. Anche documenti che contengono dati personali su se stessi o su altri.</li><li>Utilizzate HAWKI per aumentare l'efficienza e supportare le vostre attività quotidiane, rispettando sempre le politiche di privacy e le normative di sicurezza dell'università.</li></ul><p>Questa guida serve come orientamento per un uso responsabile di HAWKI. È importante che tutti gli utenti comprendano e seguano queste disposizioni per garantire un utilizzo sicuro ed etico di questa tecnologia. L'università può offrire questo servizio solo se non vengono inseriti dati personali. Per qualsiasi domanda o incertezza, si prega di contattare il Prof. Stefan Wölwer, Arian Sadafi, Jonas Trippler o Vincent Timm. Indipendentemente da questa guida, si applicano le <a class=\"accentText\" target=\"_blank\" href=\"https://openai.com/policies/business-terms\"><b>condizioni d'uso di OpenAI</b>.</a></p>",
+    "username": "Nome Utente",
+    "welcomeBackTitle": "Bentornato!",
+    "writingAssistanceRequest": "Sto lavorando a un progetto scientifico e ho bisogno di aiuto con lo stile di scrittura e la formattazione. Ho già redatto il mio lavoro, ma non sono sicuro di aver seguito tutte le linee guida di formattazione e le convenzioni di scrittura correttamente. Potresti aiutarmi a rivedere il mio lavoro e fornirmi consigli su come migliorare la formattazione e lo stile di scrittura?"
+}
\ No newline at end of file

--- private/vendor/autoload.php ---
@@ -0,0 +1,25 @@
+<?php
+
+// autoload.php @generated by Composer
+
+if (PHP_VERSION_ID < 50600) {
+    if (!headers_sent()) {
+        header('HTTP/1.1 500 Internal Server Error');
+    }
+    $err = 'Composer 2.3.0 dropped support for autoloading on PHP <5.6 and you are running '.PHP_VERSION.', please upgrade PHP or use Composer 2.2 LTS via "composer self-update --2.2". Aborting.'.PHP_EOL;
+    if (!ini_get('display_errors')) {
+        if (PHP_SAPI === 'cli' || PHP_SAPI === 'phpdbg') {
+            fwrite(STDERR, $err);
+        } elseif (!headers_sent()) {
+            echo $err;
+        }
+    }
+    trigger_error(
+        $err,
+        E_USER_ERROR
+    );
+}
+
+require_once __DIR__ . '/composer/autoload_real.php';
+
+return ComposerAutoloaderInitf6fbbdce9293efa736f194e1c2a02ae3::getLoader();

--- private/vendor/composer/ClassLoader.php ---
@@ -0,0 +1,579 @@
+<?php
+
+/*
+ * This file is part of Composer.
+ *
+ * (c) Nils Adermann <naderman@naderman.de>
+ *     Jordi Boggiano <j.boggiano@seld.be>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+
+namespace Composer\Autoload;
+
+/**
+ * ClassLoader implements a PSR-0, PSR-4 and classmap class loader.
+ *
+ *     $loader = new \Composer\Autoload\ClassLoader();
+ *
+ *     // register classes with namespaces
+ *     $loader->add('Symfony\Component', __DIR__.'/component');
+ *     $loader->add('Symfony',           __DIR__.'/framework');
+ *
+ *     // activate the autoloader
+ *     $loader->register();
+ *
+ *     // to enable searching the include path (eg. for PEAR packages)
+ *     $loader->setUseIncludePath(true);
+ *
+ * In this example, if you try to use a class in the Symfony\Component
+ * namespace or one of its children (Symfony\Component\Console for instance),
+ * the autoloader will first look for the class under the component/
+ * directory, and it will then fallback to the framework/ directory if not
+ * found before giving up.
+ *
+ * This class is loosely based on the Symfony UniversalClassLoader.
+ *
+ * @author Fabien Potencier <fabien@symfony.com>
+ * @author Jordi Boggiano <j.boggiano@seld.be>
+ * @see    https://www.php-fig.org/psr/psr-0/
+ * @see    https://www.php-fig.org/psr/psr-4/
+ */
+class ClassLoader
+{
+    /** @var \Closure(string):void */
+    private static $includeFile;
+
+    /** @var string|null */
+    private $vendorDir;
+
+    // PSR-4
+    /**
+     * @var array<string, array<string, int>>
+     */
+    private $prefixLengthsPsr4 = array();
+    /**
+     * @var array<string, list<string>>
+     */
+    private $prefixDirsPsr4 = array();
+    /**
+     * @var list<string>
+     */
+    private $fallbackDirsPsr4 = array();
+
+    // PSR-0
+    /**
+     * List of PSR-0 prefixes
+     *
+     * Structured as array('F (first letter)' => array('Foo\Bar (full prefix)' => array('path', 'path2')))
+     *
+     * @var array<string, array<string, list<string>>>
+     */
+    private $prefixesPsr0 = array();
+    /**
+     * @var list<string>
+     */
+    private $fallbackDirsPsr0 = array();
+
+    /** @var bool */
+    private $useIncludePath = false;
+
+    /**
+     * @var array<string, string>
+     */
+    private $classMap = array();
+
+    /** @var bool */
+    private $classMapAuthoritative = false;
+
+    /**
+     * @var array<string, bool>
+     */
+    private $missingClasses = array();
+
+    /** @var string|null */
+    private $apcuPrefix;
+
+    /**
+     * @var array<string, self>
+     */
+    private static $registeredLoaders = array();
+
+    /**
+     * @param string|null $vendorDir
+     */
+    public function __construct($vendorDir = null)
+    {
+        $this->vendorDir = $vendorDir;
+        self::initializeIncludeClosure();
+    }
+
+    /**
+     * @return array<string, list<string>>
+     */
+    public function getPrefixes()
+    {
+        if (!empty($this->prefixesPsr0)) {
+            return call_user_func_array('array_merge', array_values($this->prefixesPsr0));
+        }
+
+        return array();
+    }
+
+    /**
+     * @return array<string, list<string>>
+     */
+    public function getPrefixesPsr4()
+    {
+        return $this->prefixDirsPsr4;
+    }
+
+    /**
+     * @return list<string>
+     */
+    public function getFallbackDirs()
+    {
+        return $this->fallbackDirsPsr0;
+    }
+
+    /**
+     * @return list<string>
+     */
+    public function getFallbackDirsPsr4()
+    {
+        return $this->fallbackDirsPsr4;
+    }
+
+    /**
+     * @return array<string, string> Array of classname => path
+     */
+    public function getClassMap()
+    {
+        return $this->classMap;
+    }
+
+    /**
+     * @param array<string, string> $classMap Class to filename map
+     *
+     * @return void
+     */
+    public function addClassMap(array $classMap)
+    {
+        if ($this->classMap) {
+            $this->classMap = array_merge($this->classMap, $classMap);
+        } else {
+            $this->classMap = $classMap;
+        }
+    }
+
+    /**
+     * Registers a set of PSR-0 directories for a given prefix, either
+     * appending or prepending to the ones previously set for this prefix.
+     *
+     * @param string              $prefix  The prefix
+     * @param list<string>|string $paths   The PSR-0 root directories
+     * @param bool                $prepend Whether to prepend the directories
+     *
+     * @return void
+     */
+    public function add($prefix, $paths, $prepend = false)
+    {
+        $paths = (array) $paths;
+        if (!$prefix) {
+            if ($prepend) {
+                $this->fallbackDirsPsr0 = array_merge(
+                    $paths,
+                    $this->fallbackDirsPsr0
+                );
+            } else {
+                $this->fallbackDirsPsr0 = array_merge(
+                    $this->fallbackDirsPsr0,
+                    $paths
+                );
+            }
+
+            return;
+        }
+
+        $first = $prefix[0];
+        if (!isset($this->prefixesPsr0[$first][$prefix])) {
+            $this->prefixesPsr0[$first][$prefix] = $paths;
+
+            return;
+        }
+        if ($prepend) {
+            $this->prefixesPsr0[$first][$prefix] = array_merge(
+                $paths,
+                $this->prefixesPsr0[$first][$prefix]
+            );
+        } else {
+            $this->prefixesPsr0[$first][$prefix] = array_merge(
+                $this->prefixesPsr0[$first][$prefix],
+                $paths
+            );
+        }
+    }
+
+    /**
+     * Registers a set of PSR-4 directories for a given namespace, either
+     * appending or prepending to the ones previously set for this namespace.
+     *
+     * @param string              $prefix  The prefix/namespace, with trailing '\\'
+     * @param list<string>|string $paths   The PSR-4 base directories
+     * @param bool                $prepend Whether to prepend the directories
+     *
+     * @throws \InvalidArgumentException
+     *
+     * @return void
+     */
+    public function addPsr4($prefix, $paths, $prepend = false)
+    {
+        $paths = (array) $paths;
+        if (!$prefix) {
+            // Register directories for the root namespace.
+            if ($prepend) {
+                $this->fallbackDirsPsr4 = array_merge(
+                    $paths,
+                    $this->fallbackDirsPsr4
+                );
+            } else {
+                $this->fallbackDirsPsr4 = array_merge(
+                    $this->fallbackDirsPsr4,
+                    $paths
+                );
+            }
+        } elseif (!isset($this->prefixDirsPsr4[$prefix])) {
+            // Register directories for a new namespace.
+            $length = strlen($prefix);
+            if ('\\' !== $prefix[$length - 1]) {
+                throw new \InvalidArgumentException("A non-empty PSR-4 prefix must end with a namespace separator.");
+            }
+            $this->prefixLengthsPsr4[$prefix[0]][$prefix] = $length;
+            $this->prefixDirsPsr4[$prefix] = $paths;
+        } elseif ($prepend) {
+            // Prepend directories for an already registered namespace.
+            $this->prefixDirsPsr4[$prefix] = array_merge(
+                $paths,
+                $this->prefixDirsPsr4[$prefix]
+            );
+        } else {
+            // Append directories for an already registered namespace.
+            $this->prefixDirsPsr4[$prefix] = array_merge(
+                $this->prefixDirsPsr4[$prefix],
+                $paths
+            );
+        }
+    }
+
+    /**
+     * Registers a set of PSR-0 directories for a given prefix,
+     * replacing any others previously set for this prefix.
+     *
+     * @param string              $prefix The prefix
+     * @param list<string>|string $paths  The PSR-0 base directories
+     *
+     * @return void
+     */
+    public function set($prefix, $paths)
+    {
+        if (!$prefix) {
+            $this->fallbackDirsPsr0 = (array) $paths;
+        } else {
+            $this->prefixesPsr0[$prefix[0]][$prefix] = (array) $paths;
+        }
+    }
+
+    /**
+     * Registers a set of PSR-4 directories for a given namespace,
+     * replacing any others previously set for this namespace.
+     *
+     * @param string              $prefix The prefix/namespace, with trailing '\\'
+     * @param list<string>|string $paths  The PSR-4 base directories
+     *
+     * @throws \InvalidArgumentException
+     *
+     * @return void
+     */
+    public function setPsr4($prefix, $paths)
+    {
+        if (!$prefix) {
+            $this->fallbackDirsPsr4 = (array) $paths;
+        } else {
+            $length = strlen($prefix);
+            if ('\\' !== $prefix[$length - 1]) {
+                throw new \InvalidArgumentException("A non-empty PSR-4 prefix must end with a namespace separator.");
+            }
+            $this->prefixLengthsPsr4[$prefix[0]][$prefix] = $length;
+            $this->prefixDirsPsr4[$prefix] = (array) $paths;
+        }
+    }
+
+    /**
+     * Turns on searching the include path for class files.
+     *
+     * @param bool $useIncludePath
+     *
+     * @return void
+     */
+    public function setUseIncludePath($useIncludePath)
+    {
+        $this->useIncludePath = $useIncludePath;
+    }
+
+    /**
+     * Can be used to check if the autoloader uses the include path to check
+     * for classes.
+     *
+     * @return bool
+     */
+    public function getUseIncludePath()
+    {
+        return $this->useIncludePath;
+    }
+
+    /**
+     * Turns off searching the prefix and fallback directories for classes
+     * that have not been registered with the class map.
+     *
+     * @param bool $classMapAuthoritative
+     *
+     * @return void
+     */
+    public function setClassMapAuthoritative($classMapAuthoritative)
+    {
+        $this->classMapAuthoritative = $classMapAuthoritative;
+    }
+
+    /**
+     * Should class lookup fail if not found in the current class map?
+     *
+     * @return bool
+     */
+    public function isClassMapAuthoritative()
+    {
+        return $this->classMapAuthoritative;
+    }
+
+    /**
+     * APCu prefix to use to cache found/not-found classes, if the extension is enabled.
+     *
+     * @param string|null $apcuPrefix
+     *
+     * @return void
+     */
+    public function setApcuPrefix($apcuPrefix)
+    {
+        $this->apcuPrefix = function_exists('apcu_fetch') && filter_var(ini_get('apc.enabled'), FILTER_VALIDATE_BOOLEAN) ? $apcuPrefix : null;
+    }
+
+    /**
+     * The APCu prefix in use, or null if APCu caching is not enabled.
+     *
+     * @return string|null
+     */
+    public function getApcuPrefix()
+    {
+        return $this->apcuPrefix;
+    }
+
+    /**
+     * Registers this instance as an autoloader.
+     *
+     * @param bool $prepend Whether to prepend the autoloader or not
+     *
+     * @return void
+     */
+    public function register($prepend = false)
+    {
+        spl_autoload_register(array($this, 'loadClass'), true, $prepend);
+
+        if (null === $this->vendorDir) {
+            return;
+        }
+
+        if ($prepend) {
+            self::$registeredLoaders = array($this->vendorDir => $this) + self::$registeredLoaders;
+        } else {
+            unset(self::$registeredLoaders[$this->vendorDir]);
+            self::$registeredLoaders[$this->vendorDir] = $this;
+        }
+    }
+
+    /**
+     * Unregisters this instance as an autoloader.
+     *
+     * @return void
+     */
+    public function unregister()
+    {
+        spl_autoload_unregister(array($this, 'loadClass'));
+
+        if (null !== $this->vendorDir) {
+            unset(self::$registeredLoaders[$this->vendorDir]);
+        }
+    }
+
+    /**
+     * Loads the given class or interface.
+     *
+     * @param  string    $class The name of the class
+     * @return true|null True if loaded, null otherwise
+     */
+    public function loadClass($class)
+    {
+        if ($file = $this->findFile($class)) {
+            $includeFile = self::$includeFile;
+            $includeFile($file);
+
+            return true;
+        }
+
+        return null;
+    }
+
+    /**
+     * Finds the path to the file where the class is defined.
+     *
+     * @param string $class The name of the class
+     *
+     * @return string|false The path if found, false otherwise
+     */
+    public function findFile($class)
+    {
+        // class map lookup
+        if (isset($this->classMap[$class])) {
+            return $this->classMap[$class];
+        }
+        if ($this->classMapAuthoritative || isset($this->missingClasses[$class])) {
+            return false;
+        }
+        if (null !== $this->apcuPrefix) {
+            $file = apcu_fetch($this->apcuPrefix.$class, $hit);
+            if ($hit) {
+                return $file;
+            }
+        }
+
+        $file = $this->findFileWithExtension($class, '.php');
+
+        // Search for Hack files if we are running on HHVM
+        if (false === $file && defined('HHVM_VERSION')) {
+            $file = $this->findFileWithExtension($class, '.hh');
+        }
+
+        if (null !== $this->apcuPrefix) {
+            apcu_add($this->apcuPrefix.$class, $file);
+        }
+
+        if (false === $file) {
+            // Remember that this class does not exist.
+            $this->missingClasses[$class] = true;
+        }
+
+        return $file;
+    }
+
+    /**
+     * Returns the currently registered loaders keyed by their corresponding vendor directories.
+     *
+     * @return array<string, self>
+     */
+    public static function getRegisteredLoaders()
+    {
+        return self::$registeredLoaders;
+    }
+
+    /**
+     * @param  string       $class
+     * @param  string       $ext
+     * @return string|false
+     */
+    private function findFileWithExtension($class, $ext)
+    {
+        // PSR-4 lookup
+        $logicalPathPsr4 = strtr($class, '\\', DIRECTORY_SEPARATOR) . $ext;
+
+        $first = $class[0];
+        if (isset($this->prefixLengthsPsr4[$first])) {
+            $subPath = $class;
+            while (false !== $lastPos = strrpos($subPath, '\\')) {
+                $subPath = substr($subPath, 0, $lastPos);
+                $search = $subPath . '\\';
+                if (isset($this->prefixDirsPsr4[$search])) {
+                    $pathEnd = DIRECTORY_SEPARATOR . substr($logicalPathPsr4, $lastPos + 1);
+                    foreach ($this->prefixDirsPsr4[$search] as $dir) {
+                        if (file_exists($file = $dir . $pathEnd)) {
+                            return $file;
+                        }
+                    }
+                }
+            }
+        }
+
+        // PSR-4 fallback dirs
+        foreach ($this->fallbackDirsPsr4 as $dir) {
+            if (file_exists($file = $dir . DIRECTORY_SEPARATOR . $logicalPathPsr4)) {
+                return $file;
+            }
+        }
+
+        // PSR-0 lookup
+        if (false !== $pos = strrpos($class, '\\')) {
+            // namespaced class name
+            $logicalPathPsr0 = substr($logicalPathPsr4, 0, $pos + 1)
+                . strtr(substr($logicalPathPsr4, $pos + 1), '_', DIRECTORY_SEPARATOR);
+        } else {
+            // PEAR-like class name
+            $logicalPathPsr0 = strtr($class, '_', DIRECTORY_SEPARATOR) . $ext;
+        }
+
+        if (isset($this->prefixesPsr0[$first])) {
+            foreach ($this->prefixesPsr0[$first] as $prefix => $dirs) {
+                if (0 === strpos($class, $prefix)) {
+                    foreach ($dirs as $dir) {
+                        if (file_exists($file = $dir . DIRECTORY_SEPARATOR . $logicalPathPsr0)) {
+                            return $file;
+                        }
+                    }
+                }
+            }
+        }
+
+        // PSR-0 fallback dirs
+        foreach ($this->fallbackDirsPsr0 as $dir) {
+            if (file_exists($file = $dir . DIRECTORY_SEPARATOR . $logicalPathPsr0)) {
+                return $file;
+            }
+        }
+
+        // PSR-0 include paths.
+        if ($this->useIncludePath && $file = stream_resolve_include_path($logicalPathPsr0)) {
+            return $file;
+        }
+
+        return false;
+    }
+
+    /**
+     * @return void
+     */
+    private static function initializeIncludeClosure()
+    {
+        if (self::$includeFile !== null) {
+            return;
+        }
+
+        /**
+         * Scope isolated include.
+         *
+         * Prevents access to $this/self from included files.
+         *
+         * @param  string $file
+         * @return void
+         */
+        self::$includeFile = \Closure::bind(static function($file) {
+            include $file;
+        }, null, null);
+    }
+}

--- private/vendor/composer/InstalledVersions.php ---
@@ -0,0 +1,359 @@
+<?php
+
+/*
+ * This file is part of Composer.
+ *
+ * (c) Nils Adermann <naderman@naderman.de>
+ *     Jordi Boggiano <j.boggiano@seld.be>
+ *
+ * For the full copyright and license information, please view the LICENSE
+ * file that was distributed with this source code.
+ */
+
+namespace Composer;
+
+use Composer\Autoload\ClassLoader;
+use Composer\Semver\VersionParser;
+
+/**
+ * This class is copied in every Composer installed project and available to all
+ *
+ * See also https://getcomposer.org/doc/07-runtime.md#installed-versions
+ *
+ * To require its presence, you can require `composer-runtime-api ^2.0`
+ *
+ * @final
+ */
+class InstalledVersions
+{
+    /**
+     * @var mixed[]|null
+     * @psalm-var array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>}|array{}|null
+     */
+    private static $installed;
+
+    /**
+     * @var bool|null
+     */
+    private static $canGetVendors;
+
+    /**
+     * @var array[]
+     * @psalm-var array<string, array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>}>
+     */
+    private static $installedByVendor = array();
+
+    /**
+     * Returns a list of all package names which are present, either by being installed, replaced or provided
+     *
+     * @return string[]
+     * @psalm-return list<string>
+     */
+    public static function getInstalledPackages()
+    {
+        $packages = array();
+        foreach (self::getInstalled() as $installed) {
+            $packages[] = array_keys($installed['versions']);
+        }
+
+        if (1 === \count($packages)) {
+            return $packages[0];
+        }
+
+        return array_keys(array_flip(\call_user_func_array('array_merge', $packages)));
+    }
+
+    /**
+     * Returns a list of all package names with a specific type e.g. 'library'
+     *
+     * @param  string   $type
+     * @return string[]
+     * @psalm-return list<string>
+     */
+    public static function getInstalledPackagesByType($type)
+    {
+        $packagesByType = array();
+
+        foreach (self::getInstalled() as $installed) {
+            foreach ($installed['versions'] as $name => $package) {
+                if (isset($package['type']) && $package['type'] === $type) {
+                    $packagesByType[] = $name;
+                }
+            }
+        }
+
+        return $packagesByType;
+    }
+
+    /**
+     * Checks whether the given package is installed
+     *
+     * This also returns true if the package name is provided or replaced by another package
+     *
+     * @param  string $packageName
+     * @param  bool   $includeDevRequirements
+     * @return bool
+     */
+    public static function isInstalled($packageName, $includeDevRequirements = true)
+    {
+        foreach (self::getInstalled() as $installed) {
+            if (isset($installed['versions'][$packageName])) {
+                return $includeDevRequirements || !isset($installed['versions'][$packageName]['dev_requirement']) || $installed['versions'][$packageName]['dev_requirement'] === false;
+            }
+        }
+
+        return false;
+    }
+
+    /**
+     * Checks whether the given package satisfies a version constraint
+     *
+     * e.g. If you want to know whether version 2.3+ of package foo/bar is installed, you would call:
+     *
+     *   Composer\InstalledVersions::satisfies(new VersionParser, 'foo/bar', '^2.3')
+     *
+     * @param  VersionParser $parser      Install composer/semver to have access to this class and functionality
+     * @param  string        $packageName
+     * @param  string|null   $constraint  A version constraint to check for, if you pass one you have to make sure composer/semver is required by your package
+     * @return bool
+     */
+    public static function satisfies(VersionParser $parser, $packageName, $constraint)
+    {
+        $constraint = $parser->parseConstraints((string) $constraint);
+        $provided = $parser->parseConstraints(self::getVersionRanges($packageName));
+
+        return $provided->matches($constraint);
+    }
+
+    /**
+     * Returns a version constraint representing all the range(s) which are installed for a given package
+     *
+     * It is easier to use this via isInstalled() with the $constraint argument if you need to check
+     * whether a given version of a package is installed, and not just whether it exists
+     *
+     * @param  string $packageName
+     * @return string Version constraint usable with composer/semver
+     */
+    public static function getVersionRanges($packageName)
+    {
+        foreach (self::getInstalled() as $installed) {
+            if (!isset($installed['versions'][$packageName])) {
+                continue;
+            }
+
+            $ranges = array();
+            if (isset($installed['versions'][$packageName]['pretty_version'])) {
+                $ranges[] = $installed['versions'][$packageName]['pretty_version'];
+            }
+            if (array_key_exists('aliases', $installed['versions'][$packageName])) {
+                $ranges = array_merge($ranges, $installed['versions'][$packageName]['aliases']);
+            }
+            if (array_key_exists('replaced', $installed['versions'][$packageName])) {
+                $ranges = array_merge($ranges, $installed['versions'][$packageName]['replaced']);
+            }
+            if (array_key_exists('provided', $installed['versions'][$packageName])) {
+                $ranges = array_merge($ranges, $installed['versions'][$packageName]['provided']);
+            }
+
+            return implode(' || ', $ranges);
+        }
+
+        throw new \OutOfBoundsException('Package "' . $packageName . '" is not installed');
+    }
+
+    /**
+     * @param  string      $packageName
+     * @return string|null If the package is being replaced or provided but is not really installed, null will be returned as version, use satisfies or getVersionRanges if you need to know if a given version is present
+     */
+    public static function getVersion($packageName)
+    {
+        foreach (self::getInstalled() as $installed) {
+            if (!isset($installed['versions'][$packageName])) {
+                continue;
+            }
+
+            if (!isset($installed['versions'][$packageName]['version'])) {
+                return null;
+            }
+
+            return $installed['versions'][$packageName]['version'];
+        }
+
+        throw new \OutOfBoundsException('Package "' . $packageName . '" is not installed');
+    }
+
+    /**
+     * @param  string      $packageName
+     * @return string|null If the package is being replaced or provided but is not really installed, null will be returned as version, use satisfies or getVersionRanges if you need to know if a given version is present
+     */
+    public static function getPrettyVersion($packageName)
+    {
+        foreach (self::getInstalled() as $installed) {
+            if (!isset($installed['versions'][$packageName])) {
+                continue;
+            }
+
+            if (!isset($installed['versions'][$packageName]['pretty_version'])) {
+                return null;
+            }
+
+            return $installed['versions'][$packageName]['pretty_version'];
+        }
+
+        throw new \OutOfBoundsException('Package "' . $packageName . '" is not installed');
+    }
+
+    /**
+     * @param  string      $packageName
+     * @return string|null If the package is being replaced or provided but is not really installed, null will be returned as reference
+     */
+    public static function getReference($packageName)
+    {
+        foreach (self::getInstalled() as $installed) {
+            if (!isset($installed['versions'][$packageName])) {
+                continue;
+            }
+
+            if (!isset($installed['versions'][$packageName]['reference'])) {
+                return null;
+            }
+
+            return $installed['versions'][$packageName]['reference'];
+        }
+
+        throw new \OutOfBoundsException('Package "' . $packageName . '" is not installed');
+    }
+
+    /**
+     * @param  string      $packageName
+     * @return string|null If the package is being replaced or provided but is not really installed, null will be returned as install path. Packages of type metapackages also have a null install path.
+     */
+    public static function getInstallPath($packageName)
+    {
+        foreach (self::getInstalled() as $installed) {
+            if (!isset($installed['versions'][$packageName])) {
+                continue;
+            }
+
+            return isset($installed['versions'][$packageName]['install_path']) ? $installed['versions'][$packageName]['install_path'] : null;
+        }
+
+        throw new \OutOfBoundsException('Package "' . $packageName . '" is not installed');
+    }
+
+    /**
+     * @return array
+     * @psalm-return array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}
+     */
+    public static function getRootPackage()
+    {
+        $installed = self::getInstalled();
+
+        return $installed[0]['root'];
+    }
+
+    /**
+     * Returns the raw installed.php data for custom implementations
+     *
+     * @deprecated Use getAllRawData() instead which returns all datasets for all autoloaders present in the process. getRawData only returns the first dataset loaded, which may not be what you expect.
+     * @return array[]
+     * @psalm-return array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>}
+     */
+    public static function getRawData()
+    {
+        @trigger_error('getRawData only returns the first dataset loaded, which may not be what you expect. Use getAllRawData() instead which returns all datasets for all autoloaders present in the process.', E_USER_DEPRECATED);
+
+        if (null === self::$installed) {
+            // only require the installed.php file if this file is loaded from its dumped location,
+            // and not from its source location in the composer/composer package, see https://github.com/composer/composer/issues/9937
+            if (substr(__DIR__, -8, 1) !== 'C') {
+                self::$installed = include __DIR__ . '/installed.php';
+            } else {
+                self::$installed = array();
+            }
+        }
+
+        return self::$installed;
+    }
+
+    /**
+     * Returns the raw data of all installed.php which are currently loaded for custom implementations
+     *
+     * @return array[]
+     * @psalm-return list<array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>}>
+     */
+    public static function getAllRawData()
+    {
+        return self::getInstalled();
+    }
+
+    /**
+     * Lets you reload the static array from another file
+     *
+     * This is only useful for complex integrations in which a project needs to use
+     * this class but then also needs to execute another project's autoloader in process,
+     * and wants to ensure both projects have access to their version of installed.php.
+     *
+     * A typical case would be PHPUnit, where it would need to make sure it reads all
+     * the data it needs from this class, then call reload() with
+     * `require $CWD/vendor/composer/installed.php` (or similar) as input to make sure
+     * the project in which it runs can then also use this class safely, without
+     * interference between PHPUnit's dependencies and the project's dependencies.
+     *
+     * @param  array[] $data A vendor/composer/installed.php data set
+     * @return void
+     *
+     * @psalm-param array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>} $data
+     */
+    public static function reload($data)
+    {
+        self::$installed = $data;
+        self::$installedByVendor = array();
+    }
+
+    /**
+     * @return array[]
+     * @psalm-return list<array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>}>
+     */
+    private static function getInstalled()
+    {
+        if (null === self::$canGetVendors) {
+            self::$canGetVendors = method_exists('Composer\Autoload\ClassLoader', 'getRegisteredLoaders');
+        }
+
+        $installed = array();
+
+        if (self::$canGetVendors) {
+            foreach (ClassLoader::getRegisteredLoaders() as $vendorDir => $loader) {
+                if (isset(self::$installedByVendor[$vendorDir])) {
+                    $installed[] = self::$installedByVendor[$vendorDir];
+                } elseif (is_file($vendorDir.'/composer/installed.php')) {
+                    /** @var array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>} $required */
+                    $required = require $vendorDir.'/composer/installed.php';
+                    $installed[] = self::$installedByVendor[$vendorDir] = $required;
+                    if (null === self::$installed && strtr($vendorDir.'/composer', '\\', '/') === strtr(__DIR__, '\\', '/')) {
+                        self::$installed = $installed[count($installed) - 1];
+                    }
+                }
+            }
+        }
+
+        if (null === self::$installed) {
+            // only require the installed.php file if this file is loaded from its dumped location,
+            // and not from its source location in the composer/composer package, see https://github.com/composer/composer/issues/9937
+            if (substr(__DIR__, -8, 1) !== 'C') {
+                /** @var array{root: array{name: string, pretty_version: string, version: string, reference: string|null, type: string, install_path: string, aliases: string[], dev: bool}, versions: array<string, array{pretty_version?: string, version?: string, reference?: string|null, type?: string, install_path?: string, aliases?: string[], dev_requirement: bool, replaced?: string[], provided?: string[]}>} $required */
+                $required = require __DIR__ . '/installed.php';
+                self::$installed = $required;
+            } else {
+                self::$installed = array();
+            }
+        }
+
+        if (self::$installed !== array()) {
+            $installed[] = self::$installed;
+        }
+
+        return $installed;
+    }
+}

--- private/vendor/composer/LICENSE ---
@@ -0,0 +1,21 @@
+
+Copyright (c) Nils Adermann, Jordi Boggiano
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is furnished
+to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in all
+copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
+THE SOFTWARE.
+

--- private/vendor/composer/autoload_classmap.php ---
@@ -0,0 +1,12 @@
+<?php
+
+// autoload_classmap.php @generated by Composer
+
+$vendorDir = dirname(__DIR__);
+$baseDir = dirname($vendorDir);
+
+return array(
+    'Composer\\InstalledVersions' => $vendorDir . '/composer/InstalledVersions.php',
+    'Jumbojett\\OpenIDConnectClient' => $vendorDir . '/jumbojett/openid-connect-php/src/OpenIDConnectClient.php',
+    'Jumbojett\\OpenIDConnectClientException' => $vendorDir . '/jumbojett/openid-connect-php/src/OpenIDConnectClient.php',
+);

--- private/vendor/composer/autoload_files.php ---
@@ -0,0 +1,10 @@
+<?php
+
+// autoload_files.php @generated by Composer
+
+$vendorDir = dirname(__DIR__);
+$baseDir = dirname($vendorDir);
+
+return array(
+    'decc78cc4436b1292c6c0d151b19445c' => $vendorDir . '/phpseclib/phpseclib/phpseclib/bootstrap.php',
+);

--- private/vendor/composer/autoload_namespaces.php ---
@@ -0,0 +1,9 @@
+<?php
+
+// autoload_namespaces.php @generated by Composer
+
+$vendorDir = dirname(__DIR__);
+$baseDir = dirname($vendorDir);
+
+return array(
+);

--- private/vendor/composer/autoload_psr4.php ---
@@ -0,0 +1,11 @@
+<?php
+
+// autoload_psr4.php @generated by Composer
+
+$vendorDir = dirname(__DIR__);
+$baseDir = dirname($vendorDir);
+
+return array(
+    'phpseclib3\\' => array($vendorDir . '/phpseclib/phpseclib/phpseclib'),
+    'ParagonIE\\ConstantTime\\' => array($vendorDir . '/paragonie/constant_time_encoding/src'),
+);

--- private/vendor/composer/autoload_real.php ---
@@ -0,0 +1,50 @@
+<?php
+
+// autoload_real.php @generated by Composer
+
+class ComposerAutoloaderInitf6fbbdce9293efa736f194e1c2a02ae3
+{
+    private static $loader;
+
+    public static function loadClassLoader($class)
+    {
+        if ('Composer\Autoload\ClassLoader' === $class) {
+            require __DIR__ . '/ClassLoader.php';
+        }
+    }
+
+    /**
+     * @return \Composer\Autoload\ClassLoader
+     */
+    public static function getLoader()
+    {
+        if (null !== self::$loader) {
+            return self::$loader;
+        }
+
+        require __DIR__ . '/platform_check.php';
+
+        spl_autoload_register(array('ComposerAutoloaderInitf6fbbdce9293efa736f194e1c2a02ae3', 'loadClassLoader'), true, true);
+        self::$loader = $loader = new \Composer\Autoload\ClassLoader(\dirname(__DIR__));
+        spl_autoload_unregister(array('ComposerAutoloaderInitf6fbbdce9293efa736f194e1c2a02ae3', 'loadClassLoader'));
+
+        require __DIR__ . '/autoload_static.php';
+        call_user_func(\Composer\Autoload\ComposerStaticInitf6fbbdce9293efa736f194e1c2a02ae3::getInitializer($loader));
+
+        $loader->register(true);
+
+        $filesToLoad = \Composer\Autoload\ComposerStaticInitf6fbbdce9293efa736f194e1c2a02ae3::$files;
+        $requireFile = \Closure::bind(static function ($fileIdentifier, $file) {
+            if (empty($GLOBALS['__composer_autoload_files'][$fileIdentifier])) {
+                $GLOBALS['__composer_autoload_files'][$fileIdentifier] = true;
+
+                require $file;
+            }
+        }, null, null);
+        foreach ($filesToLoad as $fileIdentifier => $file) {
+            $requireFile($fileIdentifier, $file);
+        }
+
+        return $loader;
+    }
+}

--- private/vendor/composer/autoload_static.php ---
@@ -0,0 +1,50 @@
+<?php
+
+// autoload_static.php @generated by Composer
+
+namespace Composer\Autoload;
+
+class ComposerStaticInitf6fbbdce9293efa736f194e1c2a02ae3
+{
+    public static $files = array (
+        'decc78cc4436b1292c6c0d151b19445c' => __DIR__ . '/..' . '/phpseclib/phpseclib/phpseclib/bootstrap.php',
+    );
+
+    public static $prefixLengthsPsr4 = array (
+        'p' => 
+        array (
+            'phpseclib3\\' => 11,
+        ),
+        'P' => 
+        array (
+            'ParagonIE\\ConstantTime\\' => 23,
+        ),
+    );
+
+    public static $prefixDirsPsr4 = array (
+        'phpseclib3\\' => 
+        array (
+            0 => __DIR__ . '/..' . '/phpseclib/phpseclib/phpseclib',
+        ),
+        'ParagonIE\\ConstantTime\\' => 
+        array (
+            0 => __DIR__ . '/..' . '/paragonie/constant_time_encoding/src',
+        ),
+    );
+
+    public static $classMap = array (
+        'Composer\\InstalledVersions' => __DIR__ . '/..' . '/composer/InstalledVersions.php',
+        'Jumbojett\\OpenIDConnectClient' => __DIR__ . '/..' . '/jumbojett/openid-connect-php/src/OpenIDConnectClient.php',
+        'Jumbojett\\OpenIDConnectClientException' => __DIR__ . '/..' . '/jumbojett/openid-connect-php/src/OpenIDConnectClient.php',
+    );
+
+    public static function getInitializer(ClassLoader $loader)
+    {
+        return \Closure::bind(function () use ($loader) {
+            $loader->prefixLengthsPsr4 = ComposerStaticInitf6fbbdce9293efa736f194e1c2a02ae3::$prefixLengthsPsr4;
+            $loader->prefixDirsPsr4 = ComposerStaticInitf6fbbdce9293efa736f194e1c2a02ae3::$prefixDirsPsr4;
+            $loader->classMap = ComposerStaticInitf6fbbdce9293efa736f194e1c2a02ae3::$classMap;
+
+        }, null, ClassLoader::class);
+    }
+}

--- private/vendor/composer/installed.json ---
@@ -0,0 +1,287 @@
+{
+    "packages": [
+        {
+            "name": "jumbojett/openid-connect-php",
+            "version": "v0.9.10",
+            "version_normalized": "0.9.10.0",
+            "source": {
+                "type": "git",
+                "url": "https://github.com/jumbojett/OpenID-Connect-PHP.git",
+                "reference": "45aac47b525f0483dd4db3324bb1f1cab4666061"
+            },
+            "dist": {
+                "type": "zip",
+                "url": "https://api.github.com/repos/jumbojett/OpenID-Connect-PHP/zipball/45aac47b525f0483dd4db3324bb1f1cab4666061",
+                "reference": "45aac47b525f0483dd4db3324bb1f1cab4666061",
+                "shasum": ""
+            },
+            "require": {
+                "ext-curl": "*",
+                "ext-json": "*",
+                "paragonie/random_compat": ">=2",
+                "php": ">=5.4",
+                "phpseclib/phpseclib": "~2.0 || ^3.0"
+            },
+            "require-dev": {
+                "roave/security-advisories": "dev-master",
+                "yoast/phpunit-polyfills": "^1.0"
+            },
+            "time": "2022-09-30T12:34:46+00:00",
+            "type": "library",
+            "installation-source": "dist",
+            "autoload": {
+                "classmap": [
+                    "src/"
+                ]
+            },
+            "notification-url": "https://packagist.org/downloads/",
+            "license": [
+                "Apache-2.0"
+            ],
+            "description": "Bare-bones OpenID Connect client",
+            "support": {
+                "issues": "https://github.com/jumbojett/OpenID-Connect-PHP/issues",
+                "source": "https://github.com/jumbojett/OpenID-Connect-PHP/tree/v0.9.10"
+            },
+            "install-path": "../jumbojett/openid-connect-php"
+        },
+        {
+            "name": "paragonie/constant_time_encoding",
+            "version": "v2.6.3",
+            "version_normalized": "2.6.3.0",
+            "source": {
+                "type": "git",
+                "url": "https://github.com/paragonie/constant_time_encoding.git",
+                "reference": "58c3f47f650c94ec05a151692652a868995d2938"
+            },
+            "dist": {
+                "type": "zip",
+                "url": "https://api.github.com/repos/paragonie/constant_time_encoding/zipball/58c3f47f650c94ec05a151692652a868995d2938",
+                "reference": "58c3f47f650c94ec05a151692652a868995d2938",
+                "shasum": ""
+            },
+            "require": {
+                "php": "^7|^8"
+            },
+            "require-dev": {
+                "phpunit/phpunit": "^6|^7|^8|^9",
+                "vimeo/psalm": "^1|^2|^3|^4"
+            },
+            "time": "2022-06-14T06:56:20+00:00",
+            "type": "library",
+            "installation-source": "dist",
+            "autoload": {
+                "psr-4": {
+                    "ParagonIE\\ConstantTime\\": "src/"
+                }
+            },
+            "notification-url": "https://packagist.org/downloads/",
+            "license": [
+                "MIT"
+            ],
+            "authors": [
+                {
+                    "name": "Paragon Initiative Enterprises",
+                    "email": "security@paragonie.com",
+                    "homepage": "https://paragonie.com",
+                    "role": "Maintainer"
+                },
+                {
+                    "name": "Steve 'Sc00bz' Thomas",
+                    "email": "steve@tobtu.com",
+                    "homepage": "https://www.tobtu.com",
+                    "role": "Original Developer"
+                }
+            ],
+            "description": "Constant-time Implementations of RFC 4648 Encoding (Base-64, Base-32, Base-16)",
+            "keywords": [
+                "base16",
+                "base32",
+                "base32_decode",
+                "base32_encode",
+                "base64",
+                "base64_decode",
+                "base64_encode",
+                "bin2hex",
+                "encoding",
+                "hex",
+                "hex2bin",
+                "rfc4648"
+            ],
+            "support": {
+                "email": "info@paragonie.com",
+                "issues": "https://github.com/paragonie/constant_time_encoding/issues",
+                "source": "https://github.com/paragonie/constant_time_encoding"
+            },
+            "install-path": "../paragonie/constant_time_encoding"
+        },
+        {
+            "name": "paragonie/random_compat",
+            "version": "v9.99.100",
+            "version_normalized": "9.99.100.0",
+            "source": {
+                "type": "git",
+                "url": "https://github.com/paragonie/random_compat.git",
+                "reference": "996434e5492cb4c3edcb9168db6fbb1359ef965a"
+            },
+            "dist": {
+                "type": "zip",
+                "url": "https://api.github.com/repos/paragonie/random_compat/zipball/996434e5492cb4c3edcb9168db6fbb1359ef965a",
+                "reference": "996434e5492cb4c3edcb9168db6fbb1359ef965a",
+                "shasum": ""
+            },
+            "require": {
+                "php": ">= 7"
+            },
+            "require-dev": {
+                "phpunit/phpunit": "4.*|5.*",
+                "vimeo/psalm": "^1"
+            },
+            "suggest": {
+                "ext-libsodium": "Provides a modern crypto API that can be used to generate random bytes."
+            },
+            "time": "2020-10-15T08:29:30+00:00",
+            "type": "library",
+            "installation-source": "dist",
+            "notification-url": "https://packagist.org/downloads/",
+            "license": [
+                "MIT"
+            ],
+            "authors": [
+                {
+                    "name": "Paragon Initiative Enterprises",
+                    "email": "security@paragonie.com",
+                    "homepage": "https://paragonie.com"
+                }
+            ],
+            "description": "PHP 5.x polyfill for random_bytes() and random_int() from PHP 7",
+            "keywords": [
+                "csprng",
+                "polyfill",
+                "pseudorandom",
+                "random"
+            ],
+            "support": {
+                "email": "info@paragonie.com",
+                "issues": "https://github.com/paragonie/random_compat/issues",
+                "source": "https://github.com/paragonie/random_compat"
+            },
+            "install-path": "../paragonie/random_compat"
+        },
+        {
+            "name": "phpseclib/phpseclib",
+            "version": "3.0.37",
+            "version_normalized": "3.0.37.0",
+            "source": {
+                "type": "git",
+                "url": "https://github.com/phpseclib/phpseclib.git",
+                "reference": "cfa2013d0f68c062055180dd4328cc8b9d1f30b8"
+            },
+            "dist": {
+                "type": "zip",
+                "url": "https://api.github.com/repos/phpseclib/phpseclib/zipball/cfa2013d0f68c062055180dd4328cc8b9d1f30b8",
+                "reference": "cfa2013d0f68c062055180dd4328cc8b9d1f30b8",
+                "shasum": ""
+            },
+            "require": {
+                "paragonie/constant_time_encoding": "^1|^2",
+                "paragonie/random_compat": "^1.4|^2.0|^9.99.99",
+                "php": ">=5.6.1"
+            },
+            "require-dev": {
+                "phpunit/phpunit": "*"
+            },
+            "suggest": {
+                "ext-dom": "Install the DOM extension to load XML formatted public keys.",
+                "ext-gmp": "Install the GMP (GNU Multiple Precision) extension in order to speed up arbitrary precision integer arithmetic operations.",
+                "ext-libsodium": "SSH2/SFTP can make use of some algorithms provided by the libsodium-php extension.",
+                "ext-mcrypt": "Install the Mcrypt extension in order to speed up a few other cryptographic operations.",
+                "ext-openssl": "Install the OpenSSL extension in order to speed up a wide variety of cryptographic operations."
+            },
+            "time": "2024-03-03T02:14:58+00:00",
+            "type": "library",
+            "installation-source": "dist",
+            "autoload": {
+                "files": [
+                    "phpseclib/bootstrap.php"
+                ],
+                "psr-4": {
+                    "phpseclib3\\": "phpseclib/"
+                }
+            },
+            "notification-url": "https://packagist.org/downloads/",
+            "license": [
+                "MIT"
+            ],
+            "authors": [
+                {
+                    "name": "Jim Wigginton",
+                    "email": "terrafrost@php.net",
+                    "role": "Lead Developer"
+                },
+                {
+                    "name": "Patrick Monnerat",
+                    "email": "pm@datasphere.ch",
+                    "role": "Developer"
+                },
+                {
+                    "name": "Andreas Fischer",
+                    "email": "bantu@phpbb.com",
+                    "role": "Developer"
+                },
+                {
+                    "name": "Hans-Jürgen Petrich",
+                    "email": "petrich@tronic-media.com",
+                    "role": "Developer"
+                },
+                {
+                    "name": "Graham Campbell",
+                    "email": "graham@alt-three.com",
+                    "role": "Developer"
+                }
+            ],
+            "description": "PHP Secure Communications Library - Pure-PHP implementations of RSA, AES, SSH2, SFTP, X.509 etc.",
+            "homepage": "http://phpseclib.sourceforge.net",
+            "keywords": [
+                "BigInteger",
+                "aes",
+                "asn.1",
+                "asn1",
+                "blowfish",
+                "crypto",
+                "cryptography",
+                "encryption",
+                "rsa",
+                "security",
+                "sftp",
+                "signature",
+                "signing",
+                "ssh",
+                "twofish",
+                "x.509",
+                "x509"
+            ],
+            "support": {
+                "issues": "https://github.com/phpseclib/phpseclib/issues",
+                "source": "https://github.com/phpseclib/phpseclib/tree/3.0.37"
+            },
+            "funding": [
+                {
+                    "url": "https://github.com/terrafrost",
+                    "type": "github"
+                },
+                {
+                    "url": "https://www.patreon.com/phpseclib",
+                    "type": "patreon"
+                },
+                {
+                    "url": "https://tidelift.com/funding/github/packagist/phpseclib/phpseclib",
+                    "type": "tidelift"
+                }
+            ],
+            "install-path": "../phpseclib/phpseclib"
+        }
+    ],
+    "dev": true,
+    "dev-package-names": []
+}

--- private/vendor/composer/installed.php ---
@@ -0,0 +1,59 @@
+<?php return array(
+    'root' => array(
+        'name' => '__root__',
+        'pretty_version' => '1.0.0+no-version-set',
+        'version' => '1.0.0.0',
+        'reference' => null,
+        'type' => 'library',
+        'install_path' => __DIR__ . '/../../',
+        'aliases' => array(),
+        'dev' => true,
+    ),
+    'versions' => array(
+        '__root__' => array(
+            'pretty_version' => '1.0.0+no-version-set',
+            'version' => '1.0.0.0',
+            'reference' => null,
+            'type' => 'library',
+            'install_path' => __DIR__ . '/../../',
+            'aliases' => array(),
+            'dev_requirement' => false,
+        ),
+        'jumbojett/openid-connect-php' => array(
+            'pretty_version' => 'v0.9.10',
+            'version' => '0.9.10.0',
+            'reference' => '45aac47b525f0483dd4db3324bb1f1cab4666061',
+            'type' => 'library',
+            'install_path' => __DIR__ . '/../jumbojett/openid-connect-php',
+            'aliases' => array(),
+            'dev_requirement' => false,
+        ),
+        'paragonie/constant_time_encoding' => array(
+            'pretty_version' => 'v2.6.3',
+            'version' => '2.6.3.0',
+            'reference' => '58c3f47f650c94ec05a151692652a868995d2938',
+            'type' => 'library',
+            'install_path' => __DIR__ . '/../paragonie/constant_time_encoding',
+            'aliases' => array(),
+            'dev_requirement' => false,
+        ),
+        'paragonie/random_compat' => array(
+            'pretty_version' => 'v9.99.100',
+            'version' => '9.99.100.0',
+            'reference' => '996434e5492cb4c3edcb9168db6fbb1359ef965a',
+            'type' => 'library',
+            'install_path' => __DIR__ . '/../paragonie/random_compat',
+            'aliases' => array(),
+            'dev_requirement' => false,
+        ),
+        'phpseclib/phpseclib' => array(
+            'pretty_version' => '3.0.37',
+            'version' => '3.0.37.0',
+            'reference' => 'cfa2013d0f68c062055180dd4328cc8b9d1f30b8',
+            'type' => 'library',
+            'install_path' => __DIR__ . '/../phpseclib/phpseclib',
+            'aliases' => array(),
+            'dev_requirement' => false,
+        ),
+    ),
+);

--- private/vendor/composer/platform_check.php ---
@@ -0,0 +1,26 @@
+<?php
+
+// platform_check.php @generated by Composer
+
+$issues = array();
+
+if (!(PHP_VERSION_ID >= 70000)) {
+    $issues[] = 'Your Composer dependencies require a PHP version ">= 7.0.0". You are running ' . PHP_VERSION . '.';
+}
+
+if ($issues) {
+    if (!headers_sent()) {
+        header('HTTP/1.1 500 Internal Server Error');
+    }
+    if (!ini_get('display_errors')) {
+        if (PHP_SAPI === 'cli' || PHP_SAPI === 'phpdbg') {
+            fwrite(STDERR, 'Composer detected issues in your platform:' . PHP_EOL.PHP_EOL . implode(PHP_EOL, $issues) . PHP_EOL.PHP_EOL);
+        } elseif (!headers_sent()) {
+            echo 'Composer detected issues in your platform:' . PHP_EOL.PHP_EOL . str_replace('You are running '.PHP_VERSION.'.', '', implode(PHP_EOL, $issues)) . PHP_EOL.PHP_EOL;
+        }
+    }
+    trigger_error(
+        'Composer detected issues in your platform: ' . implode(' ', $issues),
+        E_USER_ERROR
+    );
+}

--- private/vendor/jumbojett/openid-connect-php/.github/PULL_REQUEST_TEMPLATE.md ---
@@ -0,0 +1,2 @@
+**List of common tasks a pull request require complete**
+- [ ] Changelog entry is added or the pull request don't alter library's functionality

--- private/vendor/jumbojett/openid-connect-php/.github/workflows/build.yml ---
@@ -0,0 +1,38 @@
+---
+name: build
+
+on: [push, pull_request]
+
+env:
+    DEFAULT_COMPOSER_FLAGS: "--prefer-dist --no-interaction --no-progress --optimize-autoloader --ansi"
+
+jobs:
+    phpunit:
+        name: PHP ${{ matrix.php }} on ${{ matrix.os }}
+        runs-on: ${{ matrix.os }}
+        strategy:
+            fail-fast: false
+            matrix:
+                os: [ubuntu-latest]
+                php: ['5.5', '5.6', '7.0', '7.1', '7.2', '7.3', '7.4', '8.0', '8.1']
+
+        steps:
+            - name: Checkout
+              uses: actions/checkout@v2
+            - name: Install PHP
+              uses: shivammathur/setup-php@v2
+              with:
+                  php-version: ${{ matrix.php }}
+            - name: Get composer cache directory
+              id: composer-cache
+              run: echo "::set-output name=dir::$(composer config cache-files-dir)"
+            - name: Cache composer dependencies
+              uses: actions/cache@v1
+              with:
+                  path: ${{ steps.composer-cache.outputs.dir }}
+                  key: ${{ runner.os }}-composer-${{ hashFiles('**/composer.lock') }}
+                  restore-keys: ${{ runner.os }}-composer-
+            - name: Install dependencies
+              run: composer update $DEFAULT_COMPOSER_FLAGS
+            - name: Run unit tests
+              run: vendor/bin/phpunit --verbose --colors=always tests

--- private/vendor/jumbojett/openid-connect-php/.gitignore ---
@@ -0,0 +1,4 @@
+/.idea
+/vendor
+/composer.lock
+.phpunit.result.cache

--- private/vendor/jumbojett/openid-connect-php/CHANGELOG.md ---
@@ -0,0 +1,185 @@
+# Changelog
+All notable changes to this project will be documented in this file.
+
+The format is based on [Keep a Changelog](http://keepachangelog.com/)
+and this project adheres to [Semantic Versioning](http://semver.org/).
+
+## [0.9.10]
+
+## Fixed
+
+* `private_key_jwt` and `client_secret_jwt` need to explicitly be enabled #331
+
+
+## [0.9.9]
+
+### Added
+
+* Added support for back-channel logout. #302
+* Added support for `private_key_jwt` Client Authentication method #322
+* Added support for `client_secret_jwt` Client Authentication method #324
+* Added PS512 encryption support #342
+
+## Fixed
+
+* Harden self-signed JWK header usage. #323
+
+## [0.9.8]
+
+## Fixed
+
+* Do not use PKCE if IdP does not support it. #317
+
+## [0.9.7]
+
+### Added
+
+* Support for Self-Contained JWTs. #308
+* Support for RFC8693 Token Exchange Request. #275
+
+### Fixed
+
+* PHP 5.4 compatibility. #304
+* Use session_status(). #306
+
+## [0.9.6]
+
+### Added
+
+* Support for [phpseclib/phpseclib](https://phpseclib.com/) version **3**. #260
+* Support client_secret on token endpoint with PKCE. #293
+* Added new parameter to `requestTokens()` to pass custom HTTP headers #297
+
+### Changed
+
+* Allow serializing `OpenIDConnectClient` using `serialize()` #295
+
+## [0.9.5]
+
+### Changed
+
+* signOut() Method parameter $accessToken -> $idToken to prevent confusion about access and id tokens usage. #127
+* Fixed issue where missing nonce within the claims was causing an exception. #280
+
+## [0.9.4]
+
+### Added
+
+* Enabled `client_secret_basic` authentication on `refreshToken()` #215
+* Basic auth support for requestResourceOwnerToken #271
+
+## [0.9.3]
+
+### Added
+
+* getRedirectURL() will not log a warning for PHP 7.1+ #179
+* it is now possible to disable upgrading from HTTP to HTTPS for development purposes by calling `setHttpUpgradeInsecureRequests(false)` #241
+* bugfix in getSessionKey when _SESSION key does not exist #251
+* Added scope parameter to refresh token request #225
+* bugfix in `verifyJWTclaims` when $accessToken is empty and $claims->at_hash is not #276
+* bugfix with the `empty` function in PHP 5.4 #267
+
+## [0.9.2]
+
+### Added
+* Support for [PKCE](https://tools.ietf.org/html/rfc7636). Currently, the supported methods are 'plain' and 'S256'.
+
+## [0.9.1]
+
+### Added
+* Add support for MS Azure Active Directory B2C user flows
+
+### Changed
+* Fix at_hash verification #200
+* Getters for public parameters #204
+* Removed client ID query parameter when making a token request using Basic Auth
+* Use of `random_bytes()` for token generation instead of `uniqid()`; polyfill for PHP < 7.0 provided.
+
+### Removed
+* Removed explicit content-length header - caused issues with proxy servers
+
+
+## [0.9.0]
+
+### Added
+* php 7.4 deprecates array_key_exists on objects, use property_exists in getVerifiedClaims and requestUserInfo
+* Adding a header to indicate JSON as the return type for userinfo endpoint #151
+* ~Updated OpenIDConnectClient to conditionally verify nonce #146~
+* Add possibility to change enc_type parameter for http_build_query #155
+* Adding OAuth 2.0 Token Introspection #156
+* Add optional parameters clientId/clientSecret for introspection #157 & #158
+* Adding OAuth 2.0 Token Revocation #160
+* Adding issuer validator #145
+* Adding signing algorithm PS256 #180
+* Check http status of request user info #186
+* URL encode clientId and clientSecret when using basic authentication, according to https://tools.ietf.org/html/rfc6749#section-2.3.1 #192
+* Adjust PHPDoc to state that null is also allowed #193
+
+### Changed
+* Bugfix/code cleanup #152
+  * Cleanup PHPDoc #46e5b59
+  * Replace unnecessary double quotes with single quotes #2a76b57
+  * Use original function names instead of aliases #1f37892
+  * Remove unnecessary default values #5ab801e
+  * Explicit declare field $redirectURL #9187c0b
+  * Remove unused code #1e65384
+  * Fix indent #e9cdf56
+  * Cleanup conditional code flow for better readability #107f3fb
+ * Added strict type comparisons #167
+* Bugfix: required `openid` scope was omitted when additional scopes were registered using `addScope` method. This resulted in failing OpenID process.
+
+## [0.8.0]
+
+### Added
+* Fix `verifyJWTsignature()`: verify JWT to prevent php errors and warnings on invalid token
+
+### Changed
+* Decouple session manipulation, it's allow use of other session libraries #134
+* Broaden version requirements of the phpseclib/phpseclib package. #144
+
+## [0.7.0]
+
+### Added
+* Add "license" field to composer.json #138
+* Ensure key_alg is set when getting key #139
+* Add option to send additional registration parameters like post_logout_redirect_uris. #140
+
+### Changed
+* disabled autoload for Crypt_RSA + make refreshToken() method tolerant for errors #137
+
+### Removed
+*
+
+## [0.6.0]
+
+### Added
+* Added five minutes leeway due to clock skew between openidconnect server and client.
+* Fix save access_token from request in implicit flow authentication #129
+* `verifyJWTsignature()` method private -> public #126
+* Support for providers where provider/login URL is not the same as the issuer URL. #125
+* Support for providers that has a different login URL from the issuer URL, for instance Azure Active Directory. Here, the provider URL is on the format: https://login.windows.net/(tenant-id), while the issuer claim actually is on the format: https://sts.windows.net/(tenant-id).
+
+### Changed
+* refreshToken method update #124
+
+### Removed
+*
+
+## [0.5.0]
+## Added
+* Implement Azure AD B2C Implicit Workflow
+
+## [0.4.1]
+## Changed
+* Documentation updates for include path.
+
+## [0.4]
+### Added
+* Timeout is configurable via setTimeout method. This addresses issue #94.
+* Add the ability to authenticate using the Resource Owner flow (with or without the Client ID and ClientSecret). This addresses issue #98
+* Add support for HS256, HS512 and HS384 signatures
+* Removed unused calls to $this->getProviderConfigValue("token_endpoint_…
+
+### Changed
+
+### Removed

--- private/vendor/jumbojett/openid-connect-php/LICENSE ---
@@ -0,0 +1,201 @@
+                                 Apache License
+                           Version 2.0, January 2004
+                        http://www.apache.org/licenses/
+
+   TERMS AND CONDITIONS FOR USE, REPRODUCTION, AND DISTRIBUTION
+
+   1. Definitions.
+
+      "License" shall mean the terms and conditions for use, reproduction,
+      and distribution as defined by Sections 1 through 9 of this document.
+
+      "Licensor" shall mean the copyright owner or entity authorized by
+      the copyright owner that is granting the License.
+
+      "Legal Entity" shall mean the union of the acting entity and all
+      other entities that control, are controlled by, or are under common
+      control with that entity. For the purposes of this definition,
+      "control" means (i) the power, direct or indirect, to cause the
+      direction or management of such entity, whether by contract or
+      otherwise, or (ii) ownership of fifty percent (50%) or more of the
+      outstanding shares, or (iii) beneficial ownership of such entity.
+
+      "You" (or "Your") shall mean an individual or Legal Entity
+      exercising permissions granted by this License.
+
+      "Source" form shall mean the preferred form for making modifications,
+      including but not limited to software source code, documentation
+      source, and configuration files.
+
+      "Object" form shall mean any form resulting from mechanical
+      transformation or translation of a Source form, including but
+      not limited to compiled object code, generated documentation,
+      and conversions to other media types.
+
+      "Work" shall mean the work of authorship, whether in Source or
+      Object form, made available under the License, as indicated by a
+      copyright notice that is included in or attached to the work
+      (an example is provided in the Appendix below).
+
+      "Derivative Works" shall mean any work, whether in Source or Object
+      form, that is based on (or derived from) the Work and for which the
+      editorial revisions, annotations, elaborations, or other modifications
+      represent, as a whole, an original work of authorship. For the purposes
+      of this License, Derivative Works shall not include works that remain
+      separable from, or merely link (or bind by name) to the interfaces of,
+      the Work and Derivative Works thereof.
+
+      "Contribution" shall mean any work of authorship, including
+      the original version of the Work and any modifications or additions
+      to that Work or Derivative Works thereof, that is intentionally
+      submitted to Licensor for inclusion in the Work by the copyright owner
+      or by an individual or Legal Entity authorized to submit on behalf of
+      the copyright owner. For the purposes of this definition, "submitted"
+      means any form of electronic, verbal, or written communication sent
+      to the Licensor or its representatives, including but not limited to
+      communication on electronic mailing lists, source code control systems,
+      and issue tracking systems that are managed by, or on behalf of, the
+      Licensor for the purpose of discussing and improving the Work, but
+      excluding communication that is conspicuously marked or otherwise
+      designated in writing by the copyright owner as "Not a Contribution."
+
+      "Contributor" shall mean Licensor and any individual or Legal Entity
+      on behalf of whom a Contribution has been received by Licensor and
+      subsequently incorporated within the Work.
+
+   2. Grant of Copyright License. Subject to the terms and conditions of
+      this License, each Contributor hereby grants to You a perpetual,
+      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
+      copyright license to reproduce, prepare Derivative Works of,
+      publicly display, publicly perform, sublicense, and distribute the
+      Work and such Derivative Works in Source or Object form.
+
+   3. Grant of Patent License. Subject to the terms and conditions of
+      this License, each Contributor hereby grants to You a perpetual,
+      worldwide, non-exclusive, no-charge, royalty-free, irrevocable
+      (except as stated in this section) patent license to make, have made,
+      use, offer to sell, sell, import, and otherwise transfer the Work,
+      where such license applies only to those patent claims licensable
+      by such Contributor that are necessarily infringed by their
+      Contribution(s) alone or by combination of their Contribution(s)
+      with the Work to which such Contribution(s) was submitted. If You
+      institute patent litigation against any entity (including a
+      cross-claim or counterclaim in a lawsuit) alleging that the Work
+      or a Contribution incorporated within the Work constitutes direct
+      or contributory patent infringement, then any patent licenses
+      granted to You under this License for that Work shall terminate
+      as of the date such litigation is filed.
+
+   4. Redistribution. You may reproduce and distribute copies of the
+      Work or Derivative Works thereof in any medium, with or without
+      modifications, and in Source or Object form, provided that You
+      meet the following conditions:
+
+      (a) You must give any other recipients of the Work or
+          Derivative Works a copy of this License; and
+
+      (b) You must cause any modified files to carry prominent notices
+          stating that You changed the files; and
+
+      (c) You must retain, in the Source form of any Derivative Works
+          that You distribute, all copyright, patent, trademark, and
+          attribution notices from the Source form of the Work,
+          excluding those notices that do not pertain to any part of
+          the Derivative Works; and
+
+      (d) If the Work includes a "NOTICE" text file as part of its
+          distribution, then any Derivative Works that You distribute must
+          include a readable copy of the attribution notices contained
+          within such NOTICE file, excluding those notices that do not
+          pertain to any part of the Derivative Works, in at least one
+          of the following places: within a NOTICE text file distributed
+          as part of the Derivative Works; within the Source form or
+          documentation, if provided along with the Derivative Works; or,
+          within a display generated by the Derivative Works, if and
+          wherever such third-party notices normally appear. The contents
+          of the NOTICE file are for informational purposes only and
+          do not modify the License. You may add Your own attribution
+          notices within Derivative Works that You distribute, alongside
+          or as an addendum to the NOTICE text from the Work, provided
+          that such additional attribution notices cannot be construed
+          as modifying the License.
+
+      You may add Your own copyright statement to Your modifications and
+      may provide additional or different license terms and conditions
+      for use, reproduction, or distribution of Your modifications, or
+      for any such Derivative Works as a whole, provided Your use,
+      reproduction, and distribution of the Work otherwise complies with
+      the conditions stated in this License.
+
+   5. Submission of Contributions. Unless You explicitly state otherwise,
+      any Contribution intentionally submitted for inclusion in the Work
+      by You to the Licensor shall be under the terms and conditions of
+      this License, without any additional terms or conditions.
+      Notwithstanding the above, nothing herein shall supersede or modify
+      the terms of any separate license agreement you may have executed
+      with Licensor regarding such Contributions.
+
+   6. Trademarks. This License does not grant permission to use the trade
+      names, trademarks, service marks, or product names of the Licensor,
+      except as required for reasonable and customary use in describing the
+      origin of the Work and reproducing the content of the NOTICE file.
+
+   7. Disclaimer of Warranty. Unless required by applicable law or
+      agreed to in writing, Licensor provides the Work (and each
+      Contributor provides its Contributions) on an "AS IS" BASIS,
+      WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or
+      implied, including, without limitation, any warranties or conditions
+      of TITLE, NON-INFRINGEMENT, MERCHANTABILITY, or FITNESS FOR A
+      PARTICULAR PURPOSE. You are solely responsible for determining the
+      appropriateness of using or redistributing the Work and assume any
+      risks associated with Your exercise of permissions under this License.
+
+   8. Limitation of Liability. In no event and under no legal theory,
+      whether in tort (including negligence), contract, or otherwise,
+      unless required by applicable law (such as deliberate and grossly
+      negligent acts) or agreed to in writing, shall any Contributor be
+      liable to You for damages, including any direct, indirect, special,
+      incidental, or consequential damages of any character arising as a
+      result of this License or out of the use or inability to use the
+      Work (including but not limited to damages for loss of goodwill,
+      work stoppage, computer failure or malfunction, or any and all
+      other commercial damages or losses), even if such Contributor
+      has been advised of the possibility of such damages.
+
+   9. Accepting Warranty or Additional Liability. While redistributing
+      the Work or Derivative Works thereof, You may choose to offer,
+      and charge a fee for, acceptance of support, warranty, indemnity,
+      or other liability obligations and/or rights consistent with this
+      License. However, in accepting such obligations, You may act only
+      on Your own behalf and on Your sole responsibility, not on behalf
+      of any other Contributor, and only if You agree to indemnify,
+      defend, and hold each Contributor harmless for any liability
+      incurred by, or claims asserted against, such Contributor by reason
+      of your accepting any such warranty or additional liability.
+
+   END OF TERMS AND CONDITIONS
+
+   APPENDIX: How to apply the Apache License to your work.
+
+      To apply the Apache License to your work, attach the following
+      boilerplate notice, with the fields enclosed by brackets "[]"
+      replaced with your own identifying information. (Don't include
+      the brackets!)  The text should be enclosed in the appropriate
+      comment syntax for the file format. We also recommend that a
+      file or class name and description of purpose be included on the
+      same "printed page" as the copyright notice for easier
+      identification within third-party archives.
+
+   Copyright [yyyy] [name of copyright owner]
+
+   Licensed under the Apache License, Version 2.0 (the "License");
+   you may not use this file except in compliance with the License.
+   You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing, software
+   distributed under the License is distributed on an "AS IS" BASIS,
+   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+   See the License for the specific language governing permissions and
+   limitations under the License.

--- private/vendor/jumbojett/openid-connect-php/README.md ---
@@ -0,0 +1,238 @@
+PHP OpenID Connect Basic Client
+========================
+A simple library that allows an application to authenticate a user through the basic OpenID Connect flow.
+This library hopes to encourage OpenID Connect use by making it simple enough for a developer with little knowledge of
+the OpenID Connect protocol to set up authentication.
+
+A special thanks goes to Justin Richer and Amanda Anganes for their help and support of the protocol.
+
+# Requirements #
+ 1. PHP 5.4 or greater
+ 2. CURL extension
+ 3. JSON extension
+
+## Install ##
+1. Install library using composer
+```
+composer require jumbojett/openid-connect-php
+```
+
+2. Include composer autoloader
+```php
+require __DIR__ . '/vendor/autoload.php';
+```
+
+## Example 1: Basic Client ##
+
+```php
+use Jumbojett\OpenIDConnectClient;
+
+$oidc = new OpenIDConnectClient('https://id.provider.com',
+                                'ClientIDHere',
+                                'ClientSecretHere');
+$oidc->setCertPath('/path/to/my.cert');
+$oidc->authenticate();
+$name = $oidc->requestUserInfo('given_name');
+
+```
+
+[See openid spec for available user attributes][1]
+
+## Example 2: Dynamic Registration ##
+
+```php
+use Jumbojett\OpenIDConnectClient;
+
+$oidc = new OpenIDConnectClient("https://id.provider.com");
+
+$oidc->register();
+$client_id = $oidc->getClientID();
+$client_secret = $oidc->getClientSecret();
+
+// Be sure to add logic to store the client id and client secret
+```
+
+## Example 3: Network and Security ##
+```php
+// Configure a proxy
+$oidc->setHttpProxy("http://my.proxy.com:80/");
+
+// Configure a cert
+$oidc->setCertPath("/path/to/my.cert");
+```
+
+## Example 4: Request Client Credentials Token ##
+
+```php
+use Jumbojett\OpenIDConnectClient;
+
+$oidc = new OpenIDConnectClient('https://id.provider.com',
+                                'ClientIDHere',
+                                'ClientSecretHere');
+$oidc->providerConfigParam(array('token_endpoint'=>'https://id.provider.com/connect/token'));
+$oidc->addScope('my_scope');
+
+// this assumes success (to validate check if the access_token property is there and a valid JWT) :
+$clientCredentialsToken = $oidc->requestClientCredentialsToken()->access_token;
+
+```
+
+## Example 5: Request Resource Owners Token (with client auth) ##
+
+```php
+use Jumbojett\OpenIDConnectClient;
+
+$oidc = new OpenIDConnectClient('https://id.provider.com',
+                                'ClientIDHere',
+                                'ClientSecretHere');
+$oidc->providerConfigParam(array('token_endpoint'=>'https://id.provider.com/connect/token'));
+$oidc->addScope('my_scope');
+
+//Add username and password
+$oidc->addAuthParam(array('username'=>'<Username>'));
+$oidc->addAuthParam(array('password'=>'<Password>'));
+
+//Perform the auth and return the token (to validate check if the access_token property is there and a valid JWT) :
+$token = $oidc->requestResourceOwnerToken(TRUE)->access_token;
+
+```
+
+## Example 6: Basic client for implicit flow e.g. with Azure AD B2C (see http://openid.net/specs/openid-connect-core-1_0.html#ImplicitFlowAuth) ##
+
+```php
+use Jumbojett\OpenIDConnectClient;
+
+$oidc = new OpenIDConnectClient('https://id.provider.com',
+                                'ClientIDHere',
+                                'ClientSecretHere');
+$oidc->setResponseTypes(array('id_token'));
+$oidc->addScope(array('openid'));
+$oidc->setAllowImplicitFlow(true);
+$oidc->addAuthParam(array('response_mode' => 'form_post'));
+$oidc->setCertPath('/path/to/my.cert');
+$oidc->authenticate();
+$sub = $oidc->getVerifiedClaims('sub');
+
+```
+
+## Example 7: Introspection of an access token (see https://tools.ietf.org/html/rfc7662) ##
+
+```php
+use Jumbojett\OpenIDConnectClient;
+
+$oidc = new OpenIDConnectClient('https://id.provider.com',
+                                'ClientIDHere',
+                                'ClientSecretHere');
+$data = $oidc->introspectToken('an.access-token.as.given');
+if (!$data->active) {
+    // the token is no longer usable
+}
+
+```
+
+## Example 8: PKCE Client ##
+
+```php
+use Jumbojett\OpenIDConnectClient;
+
+$oidc = new OpenIDConnectClient('https://id.provider.com',
+                                'ClientIDHere',
+                                null);
+$oidc->setCodeChallengeMethod('S256');
+$oidc->authenticate();
+$name = $oidc->requestUserInfo('given_name');
+
+```
+
+## Example 9: Back-channel logout ##
+
+Back-channel authentication assumes you can end a session on the server side on behalf of the user (without relying
+on their browser). The request is a POST from the OP direct to your RP. In this way, the use of this library can
+ensure your RP performs 'single sign out' for the user even if they didn't have your RP open in a browser or other
+device, but still had an active session there.
+
+Either the sid or the sub may be accessible from the logout token sent from the OP. You can use either
+`getSidFromBackChannel()` or `getSubFromBackChannel()` to retrieve them if it is helpful to match them to a session
+in order to destroy it.
+
+The below ensures the use of this library to ensure validation of the back-channel logout token, but is afterward
+just a hypothetical way of finding such a session and destroying it. Adjust it to the needs of your RP.
+
+```php
+
+function handleLogout() {
+    // NOTE: assumes that $this->oidc is an instance of OpenIDConnectClient()
+    if ($this->oidc->verifyLogoutToken()) {
+        $sid = $this->oidc->getSidFromBackChannel();
+
+        if (isset($sid)) {
+            // Somehow find the session based on the $sid and
+            // destroy it. This depends on your RP's design,
+            // there is nothing in the OIDC spec to mandate how.
+            //
+            // In this example, we find a Redis key, which was
+            // previously stored using the sid we obtained from
+            // the access token after login.
+            //
+            // The value of the Redis key is that of the user's
+            // session ID specific to this hypothetical RP app.
+            //
+            // We then switch to that session and destroy it.
+            $this->redis->connect('127.0.0.1', 6379);
+            $session_id_to_destroy = $this->redis->get($sid);
+            if ($session_id_to_destroy) {
+                session_commit();
+                session_id($session_id_to_destroy); // switches to that session
+                session_start();
+                $_SESSION = array(); // effectively ends the session
+            }
+        }
+    }
+}
+
+```
+
+## Example 10: Enable Token Endpoint Auth Methods ##
+
+By default, only `client_secret_basic` is enabled on client side which was the only supported for a long time.
+Recently `client_secret_jwt` and `private_key_jwt` have been added, but they remain disabled until explicitly enabled.
+
+```php
+use Jumbojett\OpenIDConnectClient;
+
+$oidc = new OpenIDConnectClient('https://id.provider.com',
+                                'ClientIDHere',
+                                null);
+# enable 'client_secret_basic' and 'client_secret_jwt'                                
+$oidc->setTokenEndpointAuthMethodsSupported(['client_secret_basic', 'client_secret_jwt']);
+
+# for 'private_key_jwt' in addition also the generator function has to be set.
+$oidc->setTokenEndpointAuthMethodsSupported(['private_key_jwt']);
+$oidc->setPrivateKeyJwtGenerator(function(string $token_endpoint) {
+    # TODO: what ever is necessary
+})
+```
+
+
+## Development Environments ##
+In some cases you may need to disable SSL security on your development systems.
+Note: This is not recommended on production systems.
+
+```php
+$oidc->setVerifyHost(false);
+$oidc->setVerifyPeer(false);
+```
+
+Also, your local system might not support HTTPS, so you might disable upgrading to it:
+
+```php
+$oidc->setHttpUpgradeInsecureRequests(false);
+```
+
+### Todo ###
+- Dynamic registration does not support registration auth tokens and endpoints
+
+  [1]: http://openid.net/specs/openid-connect-basic-1_0-15.html#id_res
+  
+## Contributing ###
+ - All pull requests, once merged, should be added to the CHANGELOG.md file.

--- private/vendor/jumbojett/openid-connect-php/client_example.php ---
@@ -0,0 +1,56 @@
+<?php
+
+/**
+ *
+ * Copyright MITRE 2012
+ *
+ * OpenIDConnectClient for PHP5
+ * Author: Michael Jett <mjett@mitre.org>
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License"); you may
+ * not use this file except in compliance with the License. You may obtain
+ * a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
+ * License for the specific language governing permissions and limitations
+ * under the License.
+ *
+ */
+
+require __DIR__ . '/vendor/autoload.php';
+
+use Jumbojett\OpenIDConnectClient;
+
+$oidc = new OpenIDConnectClient(
+    'http://myproviderURL.com/',
+    'ClientIDHere',
+    'ClientSecretHere'
+);
+
+$oidc->authenticate();
+$name = $oidc->requestUserInfo('given_name');
+
+?>
+
+<html>
+<head>
+    <title>Example OpenID Connect Client Use</title>
+    <style>
+        body {
+            font-family: 'Lucida Grande', Verdana, Arial, sans-serif;
+        }
+    </style>
+</head>
+<body>
+
+    <div>
+        Hello <?php echo $name; ?>
+    </div>
+
+</body>
+</html>
+

--- private/vendor/jumbojett/openid-connect-php/composer.json ---
@@ -0,0 +1,24 @@
+{
+    "name": "jumbojett/openid-connect-php",
+    "description": "Bare-bones OpenID Connect client",
+    "license": "Apache-2.0",
+    "require": {
+        "php": ">=5.4",
+        "phpseclib/phpseclib" : "~2.0 || ^3.0",
+        "ext-json": "*",
+        "ext-curl": "*",
+        "paragonie/random_compat": ">=2"
+    },
+    "require-dev": {
+        "roave/security-advisories": "dev-master",
+        "yoast/phpunit-polyfills": "^1.0"
+    },
+    "archive" : {
+        "exclude" : [
+            ".*"
+        ]
+    },
+    "autoload" : {
+         "classmap": [ "src/"]
+    }
+}

--- private/vendor/jumbojett/openid-connect-php/phpunit.xml.dist ---
@@ -0,0 +1,28 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<phpunit
+        bootstrap="./vendor/autoload.php"
+        colors="true"
+        convertErrorsToExceptions="true"
+        convertNoticesToExceptions="true"
+        convertWarningsToExceptions="true"
+        verbose="true"
+        stopOnFailure="false"
+        processIsolation="false"
+        backupGlobals="false"
+        syntaxCheck="true"
+>
+    <testsuites>
+        <testsuite name="Tests">
+            <directory>./tests</directory>
+        </testsuite>
+    </testsuites>
+    <filter>
+        <whitelist addUncoveredFilesFromWhitelist="true">
+            <directory suffix=".php">./src</directory>
+            <exclude>
+                <directory>./vendor</directory>
+                <directory>./tests</directory>
+            </exclude>
+        </whitelist>
+    </filter>
+</phpunit>

--- private/vendor/jumbojett/openid-connect-php/src/OpenIDConnectClient.php ---
@@ -0,0 +1,2219 @@
+<?php
+/**
+ *
+ * Copyright MITRE 2020
+ *
+ * OpenIDConnectClient for PHP5
+ * Author: Michael Jett <mjett@mitre.org>
+ *
+ * Licensed under the Apache License, Version 2.0 (the "License"); you may
+ * not use this file except in compliance with the License. You may obtain
+ * a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
+ * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
+ * License for the specific language governing permissions and limitations
+ * under the License.
+ *
+ */
+
+namespace Jumbojett;
+
+/**
+ *
+ * JWT signature verification support by Jonathan Reed <jdreed@mit.edu>
+ * Licensed under the same license as the rest of this file.
+ *
+ * phpseclib is required to validate the signatures of some tokens.
+ * It can be downloaded from: http://phpseclib.sourceforge.net/
+ */
+
+if (!class_exists('\phpseclib3\Crypt\RSA') && !class_exists('\phpseclib\Crypt\RSA') && !class_exists('Crypt_RSA')) {
+    user_error('Unable to find phpseclib Crypt/RSA.php.  Ensure phpseclib is installed and in include_path before you include this file');
+}
+
+/**
+ * A wrapper around base64_decode which decodes Base64URL-encoded data,
+ * which is not the same alphabet as base64.
+ * @param string $base64url
+ * @return bool|string
+ */
+function base64url_decode($base64url) {
+    return base64_decode(b64url2b64($base64url));
+}
+
+/**
+ * Per RFC4648, "base64 encoding with URL-safe and filename-safe
+ * alphabet".  This just replaces characters 62 and 63.  None of the
+ * reference implementations seem to restore the padding if necessary,
+ * but we'll do it anyway.
+ * @param string $base64url
+ * @return string
+ */
+function b64url2b64($base64url) {
+    // "Shouldn't" be necessary, but why not
+    $padding = strlen($base64url) % 4;
+    if ($padding > 0) {
+        $base64url .= str_repeat('=', 4 - $padding);
+    }
+    return strtr($base64url, '-_', '+/');
+}
+
+
+/**
+ * OpenIDConnect Exception Class
+ */
+class OpenIDConnectClientException extends \Exception
+{
+
+}
+
+/**
+ * Require the CURL and JSON PHP extensions to be installed
+ */
+if (!function_exists('curl_init')) {
+    throw new OpenIDConnectClientException('OpenIDConnect needs the CURL PHP extension.');
+}
+if (!function_exists('json_decode')) {
+    throw new OpenIDConnectClientException('OpenIDConnect needs the JSON PHP extension.');
+}
+
+/**
+ *
+ * Please note this class stores nonces by default in $_SESSION['openid_connect_nonce']
+ *
+ */
+class OpenIDConnectClient
+{
+
+    /**
+     * @var string arbitrary id value
+     */
+    private $clientID;
+
+    /**
+     * @var string arbitrary name value
+     */
+    private $clientName;
+
+    /**
+     * @var string arbitrary secret value
+     */
+    private $clientSecret;
+
+    /**
+     * @var array holds the provider configuration
+     */
+    private $providerConfig = [];
+
+    /**
+     * @var string http proxy if necessary
+     */
+    private $httpProxy;
+
+    /**
+     * @var string full system path to the SSL certificate
+     */
+    private $certPath;
+
+    /**
+     * @var bool Verify SSL peer on transactions
+     */
+    private $verifyPeer = true;
+
+    /**
+     * @var bool Verify peer hostname on transactions
+     */
+    private $verifyHost = true;
+
+    /**
+     * @var string if we acquire an access token it will be stored here
+     */
+    protected $accessToken;
+
+    /**
+     * @var string if we acquire a refresh token it will be stored here
+     */
+    private $refreshToken;
+
+    /**
+     * @var string if we acquire an id token it will be stored here
+     */
+    protected $idToken;
+
+    /**
+     * @var string stores the token response
+     */
+    private $tokenResponse;
+
+    /**
+     * @var array holds scopes
+     */
+    private $scopes = [];
+
+    /**
+     * @var int|null Response code from the server
+     */
+    private $responseCode;
+
+    /**
+     * @var array holds response types
+     */
+    private $responseTypes = [];
+
+    /**
+     * @var array holds a cache of info returned from the user info endpoint
+     */
+    private $userInfo = [];
+
+    /**
+     * @var array holds authentication parameters
+     */
+    private $authParams = [];
+
+    /**
+     * @var array holds additional registration parameters for example post_logout_redirect_uris
+     */
+    private $registrationParams = [];
+
+    /**
+     * @var mixed holds well-known openid server properties
+     */
+    private $wellKnown = false;
+
+    /**
+     * @var mixed holds well-known opendid configuration parameters, like policy for MS Azure AD B2C User Flow  
+     * @see https://docs.microsoft.com/en-us/azure/active-directory-b2c/user-flow-overview 
+     */
+    private $wellKnownConfigParameters = [];
+
+    /**
+     * @var int timeout (seconds)
+     */
+    protected $timeOut = 60;
+
+    /**
+     * @var int leeway (seconds)
+     */
+    private $leeway = 300;
+
+    /**
+     * @var array holds response types
+     */
+    private $additionalJwks = [];
+
+    /**
+     * @var array holds verified jwt claims
+     */
+    protected $verifiedClaims = [];
+
+    /**
+     * @var callable|null validator function for issuer claim
+     */
+    private $issuerValidator;
+
+    /**
+     * @var callable|null generator function for private key jwt client authentication
+     */
+    private $privateKeyJwtGenerator;
+
+    /**
+     * @var bool Allow OAuth 2 implicit flow; see http://openid.net/specs/openid-connect-core-1_0.html#ImplicitFlowAuth
+     */
+    private $allowImplicitFlow = false;
+
+    /**
+     * @var string
+     */
+    private $redirectURL;
+
+    /**
+     * @var int defines which URL-encoding http_build_query() uses
+     */
+    protected $encType = PHP_QUERY_RFC1738;
+
+    /**
+     * @var bool Enable or disable upgrading to HTTPS by paying attention to HTTP header HTTP_UPGRADE_INSECURE_REQUESTS
+     */
+    protected $httpUpgradeInsecureRequests = true;
+
+    /**
+     * @var string holds code challenge method for PKCE mode
+     * @see https://tools.ietf.org/html/rfc7636
+     */
+    private $codeChallengeMethod = false;
+
+    /**
+     * @var array holds PKCE supported algorithms
+     */
+    private $pkceAlgs = ['S256' => 'sha256', 'plain' => false];
+
+    /**
+     * @var string if we acquire a sid in back-channel logout it will be stored here
+     */
+    private $backChannelSid;
+
+    /**
+     * @var string if we acquire a sub in back-channel logout it will be stored here
+     */
+    private $backChannelSubject;
+
+    /**
+     * @var array list of supported auth methods
+     */
+    private $token_endpoint_auth_methods_supported = ['client_secret_basic'];
+
+    /**
+     * @param $provider_url string optional
+     *
+     * @param $client_id string optional
+     * @param $client_secret string optional
+     * @param null $issuer
+     */
+    public function __construct($provider_url = null, $client_id = null, $client_secret = null, $issuer = null) {
+        $this->setProviderURL($provider_url);
+        if ($issuer === null) {
+            $this->setIssuer($provider_url);
+        } else {
+            $this->setIssuer($issuer);
+        }
+
+        $this->clientID = $client_id;
+        $this->clientSecret = $client_secret;
+    }
+
+    /**
+     * @param $provider_url
+     */
+    public function setProviderURL($provider_url) {
+        $this->providerConfig['providerUrl'] = $provider_url;
+    }
+
+    /**
+     * @param $issuer
+     */
+    public function setIssuer($issuer) {
+        $this->providerConfig['issuer'] = $issuer;
+    }
+
+    /**
+     * @param $response_types
+     */
+    public function setResponseTypes($response_types) {
+        $this->responseTypes = array_merge($this->responseTypes, (array)$response_types);
+    }
+
+    /**
+     * @return bool
+     * @throws OpenIDConnectClientException
+     */
+    public function authenticate() {
+
+        // Do a preemptive check to see if the provider has thrown an error from a previous redirect
+        if (isset($_REQUEST['error'])) {
+            $desc = isset($_REQUEST['error_description']) ? ' Description: ' . $_REQUEST['error_description'] : '';
+            throw new OpenIDConnectClientException('Error: ' . $_REQUEST['error'] .$desc);
+        }
+
+        // If we have an authorization code then proceed to request a token
+        if (isset($_REQUEST['code'])) {
+
+            $code = $_REQUEST['code'];
+            $token_json = $this->requestTokens($code);
+
+            // Throw an error if the server returns one
+            if (isset($token_json->error)) {
+                if (isset($token_json->error_description)) {
+                    throw new OpenIDConnectClientException($token_json->error_description);
+                }
+                throw new OpenIDConnectClientException('Got response: ' . $token_json->error);
+            }
+
+            // Do an OpenID Connect session check
+            if ($_REQUEST['state'] !== $this->getState()) {
+                throw new OpenIDConnectClientException('Unable to determine state');
+            }
+
+            // Cleanup state
+            $this->unsetState();
+
+            if (!property_exists($token_json, 'id_token')) {
+                throw new OpenIDConnectClientException('User did not authorize openid scope.');
+            }
+
+            $claims = $this->decodeJWT($token_json->id_token, 1);
+
+            // Verify the signature
+            if ($this->canVerifySignatures()) {
+                if (!$this->getProviderConfigValue('jwks_uri')) {
+                    throw new OpenIDConnectClientException ('Unable to verify signature due to no jwks_uri being defined');
+                }
+                if (!$this->verifyJWTsignature($token_json->id_token)) {
+                    throw new OpenIDConnectClientException ('Unable to verify signature');
+                }
+            } else {
+                user_error('Warning: JWT signature verification unavailable.');
+            }
+
+            // Save the id token
+            $this->idToken = $token_json->id_token;
+
+            // Save the access token
+            $this->accessToken = $token_json->access_token;
+
+            // If this is a valid claim
+            if ($this->verifyJWTclaims($claims, $token_json->access_token)) {
+
+                // Clean up the session a little
+                $this->unsetNonce();
+
+                // Save the full response
+                $this->tokenResponse = $token_json;
+
+                // Save the verified claims
+                $this->verifiedClaims = $claims;
+
+                // Save the refresh token, if we got one
+                if (isset($token_json->refresh_token)) {
+                    $this->refreshToken = $token_json->refresh_token;
+                }
+
+                // Success!
+                return true;
+            }
+
+            throw new OpenIDConnectClientException ('Unable to verify JWT claims');
+        }
+
+        if ($this->allowImplicitFlow && isset($_REQUEST['id_token'])) {
+            // if we have no code but an id_token use that
+            $id_token = $_REQUEST['id_token'];
+
+            $accessToken = null;
+            if (isset($_REQUEST['access_token'])) {
+                $accessToken = $_REQUEST['access_token'];
+            }
+
+            // Do an OpenID Connect session check
+            if ($_REQUEST['state'] !== $this->getState()) {
+                throw new OpenIDConnectClientException('Unable to determine state');
+            }
+
+            // Cleanup state
+            $this->unsetState();
+
+            $claims = $this->decodeJWT($id_token, 1);
+
+            // Verify the signature
+            if ($this->canVerifySignatures()) {
+                if (!$this->getProviderConfigValue('jwks_uri')) {
+                    throw new OpenIDConnectClientException ('Unable to verify signature due to no jwks_uri being defined');
+                }
+                if (!$this->verifyJWTsignature($id_token)) {
+                    throw new OpenIDConnectClientException ('Unable to verify signature');
+                }
+            } else {
+                user_error('Warning: JWT signature verification unavailable.');
+            }
+
+            // Save the id token
+            $this->idToken = $id_token;
+
+            // If this is a valid claim
+            if ($this->verifyJWTclaims($claims, $accessToken)) {
+
+                // Clean up the session a little
+                $this->unsetNonce();
+
+                // Save the verified claims
+                $this->verifiedClaims = $claims;
+
+                // Save the access token
+                if ($accessToken) {
+                    $this->accessToken = $accessToken;
+                }
+
+                // Success!
+                return true;
+
+            }
+
+            throw new OpenIDConnectClientException ('Unable to verify JWT claims');
+        }
+
+        $this->requestAuthorization();
+        return false;
+    }
+
+    /**
+     * It calls the end-session endpoint of the OpenID Connect provider to notify the OpenID
+     * Connect provider that the end-user has logged out of the relying party site
+     * (the client application).
+     *
+     * @param string $idToken ID token (obtained at login)
+     * @param string|null $redirect URL to which the RP is requesting that the End-User's User Agent
+     * be redirected after a logout has been performed. The value MUST have been previously
+     * registered with the OP. Value can be null.
+     *
+     * @throws OpenIDConnectClientException
+     */
+    public function signOut($idToken, $redirect) {
+        $signout_endpoint = $this->getProviderConfigValue('end_session_endpoint');
+
+        $signout_params = null;
+        if($redirect === null){
+            $signout_params = ['id_token_hint' => $idToken];
+        }
+        else {
+            $signout_params = [
+                'id_token_hint' => $idToken,
+                'post_logout_redirect_uri' => $redirect];
+        }
+
+        $signout_endpoint  .= (strpos($signout_endpoint, '?') === false ? '?' : '&') . http_build_query( $signout_params, '', '&', $this->encType);
+        $this->redirect($signout_endpoint);
+    }
+
+
+    /**
+     * Decode and then verify a logout token sent as part of
+     * back-channel logout flows.
+     *
+     * This function should be evaluated as a boolean check
+     * in your route that receives the POST request for back-channel
+     * logout executed from the OP.
+     *
+     * @return bool
+     * @throws OpenIDConnectClientException
+     */
+    public function verifyLogoutToken()
+    {
+        if (isset($_REQUEST['logout_token'])) {
+            $logout_token = $_REQUEST['logout_token'];
+
+            $claims = $this->decodeJWT($logout_token, 1);
+
+            // Verify the signature
+            if ($this->canVerifySignatures()) {
+                if (!$this->getProviderConfigValue('jwks_uri')) {
+                    throw new OpenIDConnectClientException('Back-channel logout: Unable to verify signature due to no jwks_uri being defined');
+                }
+                if (!$this->verifyJWTsignature($logout_token)) {
+                    throw new OpenIDConnectClientException('Back-channel logout: Unable to verify JWT signature');
+                }
+            }
+            else {
+                user_error('Warning: JWT signature verification unavailable');
+            }
+
+            // Verify Logout Token Claims
+            if ($this->verifyLogoutTokenClaims($claims)) {
+                $this->verifiedClaims = $claims;
+                return true;
+            }
+
+            return false;
+        }
+
+        throw new OpenIDConnectClientException('Back-channel logout: There was no logout_token in the request');
+    }
+
+    /**
+     * Verify each claim in the logout token according to the
+     * spec for back-channel logout.
+     *
+     * @param object $claims
+     * @return bool
+     * @throws OpenIDConnectClientException
+     */
+    public function verifyLogoutTokenClaims($claims)
+    {
+        // Verify that the Logout Token doesn't contain a nonce Claim.
+        if (isset($claims->nonce)) {
+            return false;
+        }
+
+        // Verify that the logout token contains a sub or sid, or both
+        if (!isset($claims->sid) && !isset($claims->sub)) {
+            return false;
+        }
+        // Set the sid, which could be used to map to a session in
+        // the RP, and therefore be used to help destroy the RP's
+        // session.
+        if (isset($claims->sid)) {
+            $this->backChannelSid = $claims->sid;
+        }
+
+        // Set the sub, which could be used to map to a session in
+        // the RP, and therefore be used to help destroy the RP's
+        // session.
+        if (isset($claims->sub)) {
+            $this->backChannelSubject = $claims->sub;
+        }
+
+        // Verify that the Logout Token contains an events Claim whose
+        // value is a JSON object containing the member name
+        // http://schemas.openid.net/event/backchannel-logout
+        if (isset($claims->events)) {
+            $events = (array) $claims->events;
+            if (!isset($events['http://schemas.openid.net/event/backchannel-logout']) ||
+                !is_object($events['http://schemas.openid.net/event/backchannel-logout'])) {
+                return false;
+            }
+        }
+
+        // Validate the iss
+        if (!$this->validateIssuer($claims->iss)) {
+            return false;
+        }
+        // Validate the aud
+        if ((!$claims->aud === $this->clientID) || (!in_array($this->clientID, $claims->aud, true))) {
+            return false;
+        }
+        // Validate the iat. At this point we can return true if it is ok
+        if (isset($claims->iat) && ((is_int($claims->iat)) && ($claims->iat <= time() + $this->leeway))) {
+            return true;
+        }
+
+        return false;
+    }
+
+    /**
+     * @param array $scope - example: openid, given_name, etc...
+     */
+    public function addScope($scope) {
+        $this->scopes = array_merge($this->scopes, (array)$scope);
+    }
+
+    /**
+     * @param array $param - example: prompt=login
+     */
+    public function addAuthParam($param) {
+        $this->authParams = array_merge($this->authParams, (array)$param);
+    }
+
+    /**
+     * @param array $param - example: post_logout_redirect_uris=[http://example.com/successful-logout]
+     */
+    public function addRegistrationParam($param) {
+        $this->registrationParams = array_merge($this->registrationParams, (array)$param);
+    }
+
+    /**
+     * @param array $token_endpoint_auth_methods_supported
+     */
+    public function setTokenEndpointAuthMethodsSupported($token_endpoint_auth_methods_supported)
+    {
+        $this->token_endpoint_auth_methods_supported = $token_endpoint_auth_methods_supported;
+    }
+
+    /**
+     * @param $jwk object - example: (object) ['kid' => ..., 'nbf' => ..., 'use' => 'sig', 'kty' => "RSA", 'e' => "", 'n' => ""]
+     */
+    protected function addAdditionalJwk($jwk) {
+        $this->additionalJwks[] = $jwk;
+    }
+
+    /**
+     * Get's anything that we need configuration wise including endpoints, and other values
+     *
+     * @param string $param
+     * @param string $default optional
+     * @throws OpenIDConnectClientException
+     * @return string|array
+     *
+     */
+    protected function getProviderConfigValue($param, $default = null) {
+
+        // If the configuration value is not available, attempt to fetch it from a well known config endpoint
+        // This is also known as auto "discovery"
+        if (!isset($this->providerConfig[$param])) {
+            $this->providerConfig[$param] = $this->getWellKnownConfigValue($param, $default);
+        }
+
+        return $this->providerConfig[$param];
+    }
+
+    /**
+     * Get's anything that we need configuration wise including endpoints, and other values
+     *
+     * @param string $param
+     * @param string $default optional
+     * @throws OpenIDConnectClientException
+     * @return string
+     *
+     */
+    private function getWellKnownConfigValue($param, $default = null) {
+
+        // If the configuration value is not available, attempt to fetch it from a well known config endpoint
+        // This is also known as auto "discovery"
+        if(!$this->wellKnown) {
+            $well_known_config_url = rtrim($this->getProviderURL(), '/') . '/.well-known/openid-configuration';
+            if (count($this->wellKnownConfigParameters) > 0){
+                $well_known_config_url .= '?' .  http_build_query($this->wellKnownConfigParameters) ;
+            }
+            $this->wellKnown = json_decode($this->fetchURL($well_known_config_url));
+        }
+
+        $value = false;
+        if(isset($this->wellKnown->{$param})){
+            $value = $this->wellKnown->{$param};
+        }
+
+        if ($value) {
+            return $value;
+        }
+
+        if (isset($default)) {
+            // Uses default value if provided
+            return $default;
+        }
+
+        throw new OpenIDConnectClientException("The provider {$param} could not be fetched. Make sure your provider has a well known configuration available.");
+    }
+
+    /**
+     * Set optionnal parameters for .well-known/openid-configuration 
+     *
+     * @param string $param
+     *
+     */
+    public function setWellKnownConfigParameters(array $params = []){
+        $this->wellKnownConfigParameters=$params;
+    }
+
+
+    /**
+     * @param string $url Sets redirect URL for auth flow
+     */
+    public function setRedirectURL($url) {
+        if (parse_url($url,PHP_URL_HOST) !== false) {
+            $this->redirectURL = $url;
+        }
+    }
+
+    /**
+     * Gets the URL of the current page we are on, encodes, and returns it
+     *
+     * @return string
+     */
+    public function getRedirectURL() {
+
+        // If the redirect URL has been set then return it.
+        if (property_exists($this, 'redirectURL') && $this->redirectURL) {
+            return $this->redirectURL;
+        }
+
+        // Other-wise return the URL of the current page
+
+        /**
+         * Thank you
+         * http://stackoverflow.com/questions/189113/how-do-i-get-current-page-full-url-in-php-on-a-windows-iis-server
+         */
+
+        /*
+         * Compatibility with multiple host headers.
+         * The problem with SSL over port 80 is resolved and non-SSL over port 443.
+         * Support of 'ProxyReverse' configurations.
+         */
+
+        if ($this->httpUpgradeInsecureRequests && isset($_SERVER['HTTP_UPGRADE_INSECURE_REQUESTS']) && ($_SERVER['HTTP_UPGRADE_INSECURE_REQUESTS'] === '1')) {
+            $protocol = 'https';
+        } elseif (isset($_SERVER['HTTP_X_FORWARDED_PROTO'])) {
+            $protocol = $_SERVER['HTTP_X_FORWARDED_PROTO'];
+        } elseif (isset($_SERVER['REQUEST_SCHEME'])) {
+            $protocol = $_SERVER['REQUEST_SCHEME'];
+        } elseif (isset($_SERVER['HTTPS']) && $_SERVER['HTTPS'] === 'on') {
+            $protocol = 'https';
+        } else {
+            $protocol = 'http';
+        }
+	    
+        if (isset($_SERVER['HTTP_X_FORWARDED_PORT'])) {
+            $port = intval($_SERVER['HTTP_X_FORWARDED_PORT']);
+        } elseif (isset($_SERVER['SERVER_PORT'])) {
+            $port = intval($_SERVER['SERVER_PORT']);
+        } elseif ($protocol === 'https') {
+            $port = 443;
+        } else {
+            $port = 80;
+        }
+
+        if (isset($_SERVER['HTTP_HOST'])) {
+            $host = explode(':', $_SERVER['HTTP_HOST'])[0];
+        } elseif (isset($_SERVER['SERVER_NAME'])) {
+            $host = $_SERVER['SERVER_NAME'];
+        } elseif (isset($_SERVER['SERVER_ADDR'])) {
+            $host = $_SERVER['SERVER_ADDR'];
+        } else {
+            return 'http:///';
+        }
+
+        $port = (443 === $port) || (80 === $port) ? '' : ':' . $port;
+	    
+        $explodedRequestUri = isset($_SERVER['REQUEST_URI']) ? explode('?', $_SERVER['REQUEST_URI']) : [];
+        return sprintf('%s://%s%s/%s', $protocol, $host, $port, trim(reset($explodedRequestUri), '/'));
+    }
+
+    /**
+     * Used for arbitrary value generation for nonces and state
+     *
+     * @return string
+     * @throws OpenIDConnectClientException
+     */
+    protected function generateRandString() {
+        // Error and Exception need to be catched in this order, see https://github.com/paragonie/random_compat/blob/master/README.md
+        // random_compat polyfill library should be removed if support for PHP versions < 7 is dropped
+        try {
+            return \bin2hex(\random_bytes(16));
+        } catch (Error $e) {
+            throw new OpenIDConnectClientException('Random token generation failed.');
+        } catch (Exception $e) {
+            throw new OpenIDConnectClientException('Random token generation failed.');
+        }
+    }
+
+    /**
+     * Start Here
+     * @return void
+     * @throws OpenIDConnectClientException
+     * @throws \Exception
+     */
+    private function requestAuthorization() {
+
+        $auth_endpoint = $this->getProviderConfigValue('authorization_endpoint');
+        $response_type = 'code';
+
+        // Generate and store a nonce in the session
+        // The nonce is an arbitrary value
+        $nonce = $this->setNonce($this->generateRandString());
+
+        // State essentially acts as a session key for OIDC
+        $state = $this->setState($this->generateRandString());
+
+        $auth_params = array_merge($this->authParams, [
+            'response_type' => $response_type,
+            'redirect_uri' => $this->getRedirectURL(),
+            'client_id' => $this->clientID,
+            'nonce' => $nonce,
+            'state' => $state,
+            'scope' => 'openid'
+        ]);
+
+        // If the client has been registered with additional scopes
+        if (count($this->scopes) > 0) {
+            $auth_params = array_merge($auth_params, ['scope' => implode(' ', array_merge($this->scopes, ['openid']))]);
+        }
+
+        // If the client has been registered with additional response types
+        if (count($this->responseTypes) > 0) {
+            $auth_params = array_merge($auth_params, ['response_type' => implode(' ', $this->responseTypes)]);
+        }
+
+        // If the client supports Proof Key for Code Exchange (PKCE)
+        $codeChallengeMethod = $this->getCodeChallengeMethod();
+        if (!empty($codeChallengeMethod) && in_array($codeChallengeMethod, $this->getProviderConfigValue('code_challenge_methods_supported', []), true)) {
+            $codeVerifier = bin2hex(random_bytes(64));
+            $this->setCodeVerifier($codeVerifier);
+            if (!empty($this->pkceAlgs[$codeChallengeMethod])) {
+                $codeChallenge = rtrim(strtr(base64_encode(hash($this->pkceAlgs[$codeChallengeMethod], $codeVerifier, true)), '+/', '-_'), '=');
+            } else {
+                $codeChallenge = $codeVerifier;
+            }
+            $auth_params = array_merge($auth_params, [
+                'code_challenge' => $codeChallenge,
+                'code_challenge_method' => $codeChallengeMethod
+            ]);
+        }
+
+        $auth_endpoint .= (strpos($auth_endpoint, '?') === false ? '?' : '&') . http_build_query($auth_params, '', '&', $this->encType);
+
+        $this->commitSession();
+        $this->redirect($auth_endpoint);
+    }
+
+    /**
+     * Requests a client credentials token
+     *
+     * @throws OpenIDConnectClientException
+     */
+    public function requestClientCredentialsToken() {
+        $token_endpoint = $this->getProviderConfigValue('token_endpoint');
+
+        $headers = [];
+
+        $grant_type = 'client_credentials';
+
+        $post_data = [
+            'grant_type'    => $grant_type,
+            'client_id'     => $this->clientID,
+            'client_secret' => $this->clientSecret,
+            'scope'         => implode(' ', $this->scopes)
+        ];
+
+        // Convert token params to string format
+        $post_params = http_build_query($post_data, '', '&', $this->encType);
+
+        return json_decode($this->fetchURL($token_endpoint, $post_params, $headers));
+    }
+
+    /**
+     * Requests a resource owner token
+     * (Defined in https://tools.ietf.org/html/rfc6749#section-4.3)
+     *
+     * @param boolean $bClientAuth Indicates that the Client ID and Secret be used for client authentication
+     * @return mixed
+     * @throws OpenIDConnectClientException
+     */
+    public function requestResourceOwnerToken($bClientAuth = FALSE) {
+        $token_endpoint = $this->getProviderConfigValue('token_endpoint');
+
+        $headers = [];
+
+        $grant_type = 'password';
+
+        $post_data = [
+            'grant_type'    => $grant_type,
+            'username'      => $this->authParams['username'],
+            'password'      => $this->authParams['password'],
+            'scope'         => implode(' ', $this->scopes)
+        ];
+
+        //For client authentication include the client values
+        if($bClientAuth) {
+            $token_endpoint_auth_methods_supported = $this->getProviderConfigValue('token_endpoint_auth_methods_supported', ['client_secret_basic']);
+            if ($this->supportsAuthMethod('client_secret_basic', $token_endpoint_auth_methods_supported)) {
+                $headers = ['Authorization: Basic ' . base64_encode(urlencode($this->clientID) . ':' . urlencode($this->clientSecret))];
+            } else {
+                $post_data['client_id']     = $this->clientID;
+                $post_data['client_secret'] = $this->clientSecret;
+            }
+        }
+
+        // Convert token params to string format
+        $post_params = http_build_query($post_data, '', '&', $this->encType);
+
+        return json_decode($this->fetchURL($token_endpoint, $post_params, $headers));
+    }
+
+
+    /**
+     * Requests ID and Access tokens
+     *
+     * @param string $code
+     * @param string[] $headers Extra HTTP headers to pass to the token endpoint
+     * @return mixed
+     * @throws OpenIDConnectClientException
+     */
+    protected function requestTokens($code, $headers = array()) {
+        $token_endpoint = $this->getProviderConfigValue('token_endpoint');
+        $token_endpoint_auth_methods_supported = $this->getProviderConfigValue('token_endpoint_auth_methods_supported', ['client_secret_basic']);
+
+        $grant_type = 'authorization_code';
+
+        $token_params = [
+            'grant_type' => $grant_type,
+            'code' => $code,
+            'redirect_uri' => $this->getRedirectURL(),
+            'client_id' => $this->clientID,
+            'client_secret' => $this->clientSecret
+        ];
+
+        $authorizationHeader = null;
+        # Consider Basic authentication if provider config is set this way
+        if ($this->supportsAuthMethod('client_secret_basic', $token_endpoint_auth_methods_supported)) {
+            $authorizationHeader = 'Authorization: Basic ' . base64_encode(urlencode($this->clientID) . ':' . urlencode($this->clientSecret));
+            unset($token_params['client_secret']);
+	        unset($token_params['client_id']);
+        }
+
+        // When there is a private key jwt generator and it is supported then use it as client authentication
+        if ($this->privateKeyJwtGenerator !== null && $this->supportsAuthMethod('private_key_jwt', $token_endpoint_auth_methods_supported)) {
+            $token_params['client_assertion_type'] = 'urn:ietf:params:oauth:client-assertion-type:jwt-bearer';
+            $token_params['client_assertion'] = $this->privateKeyJwtGenerator->__invoke($token_endpoint);
+        }
+
+        if ($this->supportsAuthMethod('client_secret_jwt', $token_endpoint_auth_methods_supported)) {
+            $client_assertion_type = $this->getProviderConfigValue('client_assertion_type');
+
+            if(isset($this->providerConfig['client_assertion'])){
+                $client_assertion = $this->getProviderConfigValue('client_assertion');
+            }
+            else{
+                $client_assertion = $this->getJWTClientAssertion($this->getProviderConfigValue('token_endpoint'));
+            }
+            
+            $token_params['client_assertion_type'] = $client_assertion_type;
+            $token_params['client_assertion'] = $client_assertion;
+            unset($token_params['client_secret']);
+    	}
+
+        $ccm = $this->getCodeChallengeMethod();
+        $cv = $this->getCodeVerifier();
+        if (!empty($ccm) && !empty($cv)) {
+            $cs = $this->getClientSecret();
+            if (empty($cs)) {
+                $authorizationHeader = null;
+                unset($token_params['client_secret']);
+            }
+            $token_params = array_merge($token_params, [
+                'client_id' => $this->clientID,
+                'code_verifier' => $this->getCodeVerifier()
+            ]);
+        }
+
+        // Convert token params to string format
+        $token_params = http_build_query($token_params, '', '&', $this->encType);
+
+        if (null !== $authorizationHeader) {
+            $headers[] = $authorizationHeader;
+        }
+
+        $this->tokenResponse = json_decode($this->fetchURL($token_endpoint, $token_params, $headers));
+
+        return $this->tokenResponse;
+    }
+
+    /**
+     * Request RFC8693 Token Exchange
+     * https://datatracker.ietf.org/doc/html/rfc8693
+     *
+     * @param string $subjectToken
+     * @param string $subjectTokenType
+     * @param string $audience
+     * @return mixed
+     * @throws OpenIDConnectClientException
+     */
+    public function requestTokenExchange($subjectToken, $subjectTokenType, $audience = '') {
+        $token_endpoint = $this->getProviderConfigValue('token_endpoint');
+        $token_endpoint_auth_methods_supported = $this->getProviderConfigValue('token_endpoint_auth_methods_supported', ['client_secret_basic']);
+        $headers = [];
+        $grant_type = 'urn:ietf:params:oauth:grant-type:token-exchange';
+
+        $post_data = array(
+            'grant_type'    => $grant_type,
+            'subject_token_type' => $subjectTokenType,
+            'subject_token' => $subjectToken,
+            'client_id' => $this->clientID,
+            'client_secret' => $this->clientSecret,
+            'scope'         => implode(' ', $this->scopes)
+        );
+
+        if (!empty($audience)) {
+            $post_data['audience'] = $audience;
+        }
+
+        # Consider Basic authentication if provider config is set this way
+        if ($this->supportsAuthMethod('client_secret_basic', $token_endpoint_auth_methods_supported)) {
+            $headers = ['Authorization: Basic ' . base64_encode(urlencode($this->clientID) . ':' . urlencode($this->clientSecret))];
+            unset($post_data['client_secret']);
+            unset($post_data['client_id']);
+        }
+
+        // Convert token params to string format
+        $post_params = http_build_query($post_data, null, '&', $this->encType);
+
+        return json_decode($this->fetchURL($token_endpoint, $post_params, $headers));
+    }
+
+
+    /**
+     * Requests Access token with refresh token
+     *
+     * @param string $refresh_token
+     * @return mixed
+     * @throws OpenIDConnectClientException
+     */
+    public function refreshToken($refresh_token) {
+        $token_endpoint = $this->getProviderConfigValue('token_endpoint');
+        $token_endpoint_auth_methods_supported = $this->getProviderConfigValue('token_endpoint_auth_methods_supported', ['client_secret_basic']);
+
+        $headers = [];
+
+        $grant_type = 'refresh_token';
+
+        $token_params = [
+            'grant_type' => $grant_type,
+            'refresh_token' => $refresh_token,
+            'client_id' => $this->clientID,
+            'client_secret' => $this->clientSecret,
+            'scope'         => implode(' ', $this->scopes),
+        ];
+
+        # Consider Basic authentication if provider config is set this way
+        if ($this->supportsAuthMethod('client_secret_basic', $token_endpoint_auth_methods_supported)) {
+            $headers = ['Authorization: Basic ' . base64_encode(urlencode($this->clientID) . ':' . urlencode($this->clientSecret))];
+            unset($token_params['client_secret']);
+            unset($token_params['client_id']);
+        }
+
+        if ($this->supportsAuthMethod('client_secret_jwt', $token_endpoint_auth_methods_supported)) {
+            $client_assertion_type = $this->getProviderConfigValue('client_assertion_type');
+            $client_assertion = $this->getJWTClientAssertion($this->getProviderConfigValue('token_endpoint'));
+            
+            $token_params["grant_type"] = "urn:ietf:params:oauth:grant-type:token-exchange";
+            $token_params["subject_token"] = $refresh_token;
+            $token_params["audience"] = $this->clientID;
+            $token_params["subject_token_type"] = "urn:ietf:params:oauth:token-type:refresh_token";
+			$token_params["requested_token_type"] = "urn:ietf:params:oauth:token-type:access_token";
+            $token_params['client_assertion_type']=$client_assertion_type;
+            $token_params['client_assertion'] = $client_assertion;
+            
+            unset($token_params['client_secret']);
+            unset($token_params['client_id']);
+        }
+        // Convert token params to string format
+        $token_params = http_build_query($token_params, '', '&', $this->encType);
+
+        $json = json_decode($this->fetchURL($token_endpoint, $token_params, $headers));
+
+        if (isset($json->access_token)) {
+            $this->accessToken = $json->access_token;
+        }
+
+        if (isset($json->refresh_token)) {
+            $this->refreshToken = $json->refresh_token;
+        }
+
+        return $json;
+    }
+
+    /**
+     * @param array $keys
+     * @param array $header
+     * @throws OpenIDConnectClientException
+     * @return object
+     */
+    private function getKeyForHeader($keys, $header) {
+        foreach ($keys as $key) {
+            if ($key->kty === 'RSA') {
+                if (!isset($header->kid) || $key->kid === $header->kid) {
+                    return $key;
+                }
+            } else {
+                if (isset($key->alg) && $key->alg === $header->alg && $key->kid === $header->kid) {
+                    return $key;
+                }
+            }
+        }
+        if ($this->additionalJwks) {
+            foreach ($this->additionalJwks as $key) {
+                if ($key->kty === 'RSA') {
+                    if (!isset($header->kid) || $key->kid === $header->kid) {
+                        return $key;
+                    }
+                } else {
+                    if (isset($key->alg) && $key->alg === $header->alg && $key->kid === $header->kid) {
+                        return $key;
+                    }
+                }
+            }
+        }
+        if (isset($header->kid)) {
+            throw new OpenIDConnectClientException('Unable to find a key for (algorithm, kid):' . $header->alg . ', ' . $header->kid . ')');
+        }
+
+        throw new OpenIDConnectClientException('Unable to find a key for RSA');
+    }
+
+
+    /**
+     * @param string $hashtype
+     * @param object $key
+     * @param $payload
+     * @param $signature
+     * @param $signatureType
+     * @return bool
+     * @throws OpenIDConnectClientException
+     */
+    private function verifyRSAJWTsignature($hashtype, $key, $payload, $signature, $signatureType) {
+        if (!class_exists('\phpseclib3\Crypt\RSA') && !class_exists('\phpseclib\Crypt\RSA') && !class_exists('Crypt_RSA')) {
+            throw new OpenIDConnectClientException('Crypt_RSA support unavailable.');
+        }
+        if (!(property_exists($key, 'n') && property_exists($key, 'e'))) {
+            throw new OpenIDConnectClientException('Malformed key object');
+        }
+
+        /* We already have base64url-encoded data, so re-encode it as
+           regular base64 and use the XML key format for simplicity.
+        */
+        $public_key_xml = "<RSAKeyValue>\r\n".
+            '  <Modulus>' . b64url2b64($key->n) . "</Modulus>\r\n" .
+            '  <Exponent>' . b64url2b64($key->e) . "</Exponent>\r\n" .
+            '</RSAKeyValue>';
+        if (class_exists('\phpseclib3\Crypt\RSA', false)) {
+            $key = \phpseclib3\Crypt\PublicKeyLoader::load($public_key_xml)
+                ->withHash($hashtype);
+            if ($signatureType === 'PSS') {
+                $key = $key->withMGFHash($hashtype)
+                    ->withPadding(\phpseclib3\Crypt\RSA::SIGNATURE_PSS);
+            } else {
+                $key = $key->withPadding(\phpseclib3\Crypt\RSA::SIGNATURE_PKCS1);
+            }
+            return $key->verify($payload, $signature);
+        } elseif (class_exists('Crypt_RSA', false)) {
+            $rsa = new Crypt_RSA();
+            $rsa->setHash($hashtype);
+            if ($signatureType === 'PSS') {
+                $rsa->setMGFHash($hashtype);
+            }
+            $rsa->loadKey($public_key_xml, Crypt_RSA::PUBLIC_FORMAT_XML);
+            $rsa->setSignatureMode($signatureType === 'PSS' ? Crypt_RSA::SIGNATURE_PSS : Crypt_RSA::SIGNATURE_PKCS1);
+            return $rsa->verify($payload, $signature);
+        } else {
+            $rsa = new \phpseclib\Crypt\RSA();
+            $rsa->setHash($hashtype);
+            if ($signatureType === 'PSS') {
+                $rsa->setMGFHash($hashtype);
+            }
+            $rsa->loadKey($public_key_xml, \phpseclib\Crypt\RSA::PUBLIC_FORMAT_XML);
+            $rsa->setSignatureMode($signatureType === 'PSS' ? \phpseclib\Crypt\RSA::SIGNATURE_PSS : \phpseclib\Crypt\RSA::SIGNATURE_PKCS1);
+            return $rsa->verify($payload, $signature);
+        }
+    }
+
+    /**
+     * @param string $hashtype
+     * @param object $key
+     * @param $payload
+     * @param $signature
+     * @return bool
+     * @throws OpenIDConnectClientException
+     */
+    private function verifyHMACJWTsignature($hashtype, $key, $payload, $signature)
+    {
+        if (!function_exists('hash_hmac')) {
+            throw new OpenIDConnectClientException('hash_hmac support unavailable.');
+        }
+
+        $expected=hash_hmac($hashtype, $payload, $key, true);
+
+        if (function_exists('hash_equals')) {
+            return hash_equals($signature, $expected);
+        }
+
+        return self::hashEquals($signature, $expected);
+    }
+
+    /**
+     * @param string $jwt encoded JWT
+     * @throws OpenIDConnectClientException
+     * @return bool
+     */
+    public function verifyJWTsignature($jwt) {
+        if (!\is_string($jwt)) {
+            throw new OpenIDConnectClientException('Error token is not a string');
+        }
+        $parts = explode('.', $jwt);
+        if (!isset($parts[0])) {
+            throw new OpenIDConnectClientException('Error missing part 0 in token');
+        }
+        $signature = base64url_decode(array_pop($parts));
+        if (false === $signature || '' === $signature) {
+            throw new OpenIDConnectClientException('Error decoding signature from token');
+        }
+        $header = json_decode(base64url_decode($parts[0]));
+        if (null === $header || !\is_object($header)) {
+            throw new OpenIDConnectClientException('Error decoding JSON from token header');
+        }
+        if (!isset($header->alg)) {
+            throw new OpenIDConnectClientException('Error missing signature type in token header');
+        }
+
+        $payload = implode('.', $parts);
+        switch ($header->alg) {
+            case 'RS256':
+            case 'PS256':
+            case 'PS512':
+            case 'RS384':
+            case 'RS512':
+                $hashtype = 'sha' . substr($header->alg, 2);
+                $signatureType = $header->alg === 'PS256' || $header->alg === 'PS512' ? 'PSS' : '';
+                if (isset($header->jwk)) {
+                    $jwk = $header->jwk;
+                    $this->verifyJWKHeader($jwk);
+                } else {
+                    $jwks = json_decode($this->fetchURL($this->getProviderConfigValue('jwks_uri')));
+                    if ($jwks === NULL) {
+                        throw new OpenIDConnectClientException('Error decoding JSON from jwks_uri');
+                    }
+                    $jwk = $this->getKeyForHeader($jwks->keys, $header);
+                }
+
+                $verified = $this->verifyRSAJWTsignature($hashtype,
+                    $jwk,
+                    $payload, $signature, $signatureType);
+                break;
+            case 'HS256':
+            case 'HS512':
+            case 'HS384':
+                $hashtype = 'SHA' . substr($header->alg, 2);
+                $verified = $this->verifyHMACJWTsignature($hashtype, $this->getClientSecret(), $payload, $signature);
+                break;
+            default:
+                throw new OpenIDConnectClientException('No support for signature type: ' . $header->alg);
+        }
+        return $verified;
+    }
+
+    /**
+     * @param string $iss
+     * @return bool
+     * @throws OpenIDConnectClientException
+     */
+    protected function validateIssuer($iss) {
+        if ($this->issuerValidator !== null) {
+            return $this->issuerValidator->__invoke($iss);
+        }
+
+        return ($iss === $this->getIssuer() || $iss === $this->getWellKnownIssuer() || $iss === $this->getWellKnownIssuer(true));
+    }
+
+    /**
+     * @param object $claims
+     * @param string|null $accessToken
+     * @return bool
+     */
+    protected function verifyJWTclaims($claims, $accessToken = null) {
+        if(isset($claims->at_hash) && isset($accessToken)) {
+            if(isset($this->getIdTokenHeader()->alg) && $this->getIdTokenHeader()->alg !== 'none') {
+                $bit = substr($this->getIdTokenHeader()->alg, 2, 3);
+            } else {
+                // TODO: Error case. throw exception???
+                $bit = '256';
+            }
+            $len = ((int)$bit)/16;
+            $expected_at_hash = $this->urlEncode(substr(hash('sha'.$bit, $accessToken, true), 0, $len));
+        }
+        return (($this->validateIssuer($claims->iss))
+            && (($claims->aud === $this->clientID) || in_array($this->clientID, $claims->aud, true))
+            && (!isset($claims->nonce) || $claims->nonce === $this->getNonce())
+            && ( !isset($claims->exp) || ((gettype($claims->exp) === 'integer') && ($claims->exp >= time() - $this->leeway)))
+            && ( !isset($claims->nbf) || ((gettype($claims->nbf) === 'integer') && ($claims->nbf <= time() + $this->leeway)))
+            && ( !isset($claims->at_hash) || !isset($accessToken) || $claims->at_hash === $expected_at_hash )
+        );
+    }
+
+    /**
+     * @param string $str
+     * @return string
+     */
+    protected function urlEncode($str) {
+        $enc = base64_encode($str);
+        $enc = rtrim($enc, '=');
+        $enc = strtr($enc, '+/', '-_');
+        return $enc;
+    }
+
+    /**
+     * @param string $jwt encoded JWT
+     * @param int $section the section we would like to decode
+     * @return object
+     */
+    protected function decodeJWT($jwt, $section = 0) {
+
+        $parts = explode('.', $jwt);
+        return json_decode(base64url_decode($parts[$section]));
+    }
+
+    /**
+     *
+     * @param string|null $attribute optional
+     *
+     * Attribute        Type        Description
+     * user_id          string      REQUIRED Identifier for the End-User at the Issuer.
+     * name             string      End-User's full name in displayable form including all name parts, ordered according to End-User's locale and preferences.
+     * given_name       string      Given name or first name of the End-User.
+     * family_name      string      Surname or last name of the End-User.
+     * middle_name      string      Middle name of the End-User.
+     * nickname         string      Casual name of the End-User that may or may not be the same as the given_name. For instance, a nickname value of Mike might be returned alongside a given_name value of Michael.
+     * profile          string      URL of End-User's profile page.
+     * picture          string      URL of the End-User's profile picture.
+     * website          string      URL of End-User's web page or blog.
+     * email            string      The End-User's preferred e-mail address.
+     * verified         boolean     True if the End-User's e-mail address has been verified; otherwise false.
+     * gender           string      The End-User's gender: Values defined by this specification are female and male. Other values MAY be used when neither of the defined values are applicable.
+     * birthday         string      The End-User's birthday, represented as a date string in MM/DD/YYYY format. The year MAY be 0000, indicating that it is omitted.
+     * zoneinfo         string      String from zoneinfo [zoneinfo] time zone database. For example, Europe/Paris or America/Los_Angeles.
+     * locale           string      The End-User's locale, represented as a BCP47 [RFC5646] language tag. This is typically an ISO 639-1 Alpha-2 [ISO639‑1] language code in lowercase and an ISO 3166-1 Alpha-2 [ISO3166‑1] country code in uppercase, separated by a dash. For example, en-US or fr-CA. As a compatibility note, some implementations have used an underscore as the separator rather than a dash, for example, en_US; Implementations MAY choose to accept this locale syntax as well.
+     * phone_number     string      The End-User's preferred telephone number. E.164 [E.164] is RECOMMENDED as the format of this Claim. For example, +1 (425) 555-1212 or +56 (2) 687 2400.
+     * address          JSON object The End-User's preferred address. The value of the address member is a JSON [RFC4627] structure containing some or all of the members defined in Section 2.4.2.1.
+     * updated_time     string      Time the End-User's information was last updated, represented as a RFC 3339 [RFC3339] datetime. For example, 2011-01-03T23:58:42+0000.
+     *
+     * @return mixed
+     *
+     * @throws OpenIDConnectClientException
+     */
+    public function requestUserInfo($attribute = null) {
+
+        $user_info_endpoint = $this->getProviderConfigValue('userinfo_endpoint');
+        $schema = 'openid';
+
+        $user_info_endpoint .= '?schema=' . $schema;
+
+        //The accessToken has to be sent in the Authorization header.
+        // Accept json to indicate response type
+        $headers = ["Authorization: Bearer {$this->accessToken}",
+            'Accept: application/json'];
+
+        $user_json = json_decode($this->fetchURL($user_info_endpoint,null,$headers));
+        if ($this->getResponseCode() <> 200) {
+            throw new OpenIDConnectClientException('The communication to retrieve user data has failed with status code '.$this->getResponseCode());
+        }
+        $this->userInfo = $user_json;
+
+        if($attribute === null) {
+            return $this->userInfo;
+        }
+
+        if (property_exists($this->userInfo, $attribute)) {
+            return $this->userInfo->$attribute;
+        }
+
+        return null;
+    }
+
+    /**
+     *
+     * @param string|null $attribute optional
+     *
+     * Attribute        Type    Description
+     * exp              int     Expires at
+     * nbf              int     Not before
+     * ver              string  Version
+     * iss              string  Issuer
+     * sub              string  Subject
+     * aud              string  Audience
+     * nonce            string  nonce
+     * iat              int     Issued At
+     * auth_time        int     Authenatication time
+     * oid              string  Object id
+     *
+     * @return mixed
+     *
+     */
+    public function getVerifiedClaims($attribute = null) {
+
+        if($attribute === null) {
+            return $this->verifiedClaims;
+        }
+
+        if (property_exists($this->verifiedClaims, $attribute)) {
+            return $this->verifiedClaims->$attribute;
+        }
+
+        return null;
+    }
+
+    /**
+     * @param string $url
+     * @param string | null $post_body string If this is set the post type will be POST
+     * @param array $headers Extra headers to be send with the request. Format as 'NameHeader: ValueHeader'
+     * @throws OpenIDConnectClientException
+     * @return mixed
+     */
+    protected function fetchURL($url, $post_body = null, $headers = []) {
+
+        // OK cool - then let's create a new cURL resource handle
+        $ch = curl_init();
+
+        // Determine whether this is a GET or POST
+        if ($post_body !== null) {
+            // curl_setopt($ch, CURLOPT_POST, 1);
+            // Alows to keep the POST method even after redirect
+            curl_setopt($ch, CURLOPT_CUSTOMREQUEST, 'POST');
+            curl_setopt($ch, CURLOPT_POSTFIELDS, $post_body);
+
+            // Default content type is form encoded
+            $content_type = 'application/x-www-form-urlencoded';
+
+            // Determine if this is a JSON payload and add the appropriate content type
+            if (is_object(json_decode($post_body))) {
+                $content_type = 'application/json';
+            }
+
+            // Add POST-specific headers
+            $headers[] = "Content-Type: {$content_type}";
+
+        }
+
+        // If we set some headers include them
+        if(count($headers) > 0) {
+            curl_setopt($ch, CURLOPT_HTTPHEADER, $headers);
+        }
+
+        // Set URL to download
+        curl_setopt($ch, CURLOPT_URL, $url);
+
+        if (isset($this->httpProxy)) {
+            curl_setopt($ch, CURLOPT_PROXY, $this->httpProxy);
+        }
+
+        // Include header in result? (0 = yes, 1 = no)
+        curl_setopt($ch, CURLOPT_HEADER, 0);
+
+        // Allows to follow redirect
+        curl_setopt($ch, CURLOPT_FOLLOWLOCATION, true);
+
+        /**
+         * Set cert
+         * Otherwise ignore SSL peer verification
+         */
+        if (isset($this->certPath)) {
+            curl_setopt($ch, CURLOPT_CAINFO, $this->certPath);
+        }
+
+        if($this->verifyHost) {
+            curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 2);
+        } else {
+            curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);
+        }
+
+        if($this->verifyPeer) {
+            curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, true);
+        } else {
+            curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);
+        }
+
+        // Should cURL return or print out the data? (true = return, false = print)
+        curl_setopt($ch, CURLOPT_RETURNTRANSFER, true);
+
+        // Timeout in seconds
+        curl_setopt($ch, CURLOPT_TIMEOUT, $this->timeOut);
+
+        // Download the given URL, and return output
+        $output = curl_exec($ch);
+
+        // HTTP Response code from server may be required from subclass
+        $info = curl_getinfo($ch);
+        $this->responseCode = $info['http_code'];
+
+        if ($output === false) {
+            throw new OpenIDConnectClientException('Curl error: (' . curl_errno($ch) . ') ' . curl_error($ch));
+        }
+
+        // Close the cURL resource, and free system resources
+        curl_close($ch);
+
+        return $output;
+    }
+
+    /**
+     * @param bool $appendSlash
+     * @return string
+     * @throws OpenIDConnectClientException
+     */
+    public function getWellKnownIssuer($appendSlash = false) {
+
+        return $this->getWellKnownConfigValue('issuer') . ($appendSlash ? '/' : '');
+    }
+
+    /**
+     * @return string
+     * @throws OpenIDConnectClientException
+     */
+    public function getIssuer() {
+
+        if (!isset($this->providerConfig['issuer'])) {
+            throw new OpenIDConnectClientException('The issuer has not been set');
+        }
+
+        return $this->providerConfig['issuer'];
+    }
+
+    /**
+     * @return mixed
+     * @throws OpenIDConnectClientException
+     */
+    public function getProviderURL() {
+        if (!isset($this->providerConfig['providerUrl'])) {
+            throw new OpenIDConnectClientException('The provider URL has not been set');
+        }
+
+        return $this->providerConfig['providerUrl'];
+    }
+
+    /**
+     * @param string $url
+     */
+    public function redirect($url) {
+        header('Location: ' . $url);
+        exit;
+    }
+
+    /**
+     * @param string $httpProxy
+     */
+    public function setHttpProxy($httpProxy) {
+        $this->httpProxy = $httpProxy;
+    }
+
+    /**
+     * @param string $certPath
+     */
+    public function setCertPath($certPath) {
+        $this->certPath = $certPath;
+    }
+
+    /**
+     * @return string|null
+     */
+    public function getCertPath() {
+        return $this->certPath;
+    }
+
+    /**
+     * @param bool $verifyPeer
+     */
+    public function setVerifyPeer($verifyPeer) {
+        $this->verifyPeer = $verifyPeer;
+    }
+
+    /**
+     * @param bool $verifyHost
+     */
+    public function setVerifyHost($verifyHost) {
+        $this->verifyHost = $verifyHost;
+    }
+
+
+    /**
+     * Controls whether http header HTTP_UPGRADE_INSECURE_REQUESTS should be considered
+     * defaults to true
+     * @param bool $httpUpgradeInsecureRequests
+     */
+    public function setHttpUpgradeInsecureRequests($httpUpgradeInsecureRequests) {
+        $this->httpUpgradeInsecureRequests = $httpUpgradeInsecureRequests;
+    }
+
+    /**
+     * @return bool
+     */
+    public function getVerifyHost() {
+        return $this->verifyHost;
+    }
+
+    /**
+     * @return bool
+     */
+    public function getVerifyPeer() {
+        return $this->verifyPeer;
+    }
+
+    /**
+     * @return bool 
+     */
+    public function getHttpUpgradeInsecureRequests()
+    {
+        return $this->httpUpgradeInsecureRequests;
+    }
+
+    /**
+     * Use this for custom issuer validation
+     * The given function should accept the issuer string from the JWT claim as the only argument
+     * and return true if the issuer is valid, otherwise return false
+     *
+     * @param callable $issuerValidator
+     */
+    public function setIssuerValidator($issuerValidator) {
+        $this->issuerValidator = $issuerValidator;
+    }
+
+    /**
+     * Use this for private_key_jwt client authentication
+     * The given function should accept the token_endpoint string as the only argument
+     * and return a jwt signed with your private key according to:
+     * https://openid.net/specs/openid-connect-core-1_0.html#ClientAuthentication
+     *
+     * @param callable $privateKeyJwtGenerator
+     */
+    public function setPrivateKeyJwtGenerator($privateKeyJwtGenerator) {
+        $this->privateKeyJwtGenerator = $privateKeyJwtGenerator;
+    }
+
+    /**
+     * @param bool $allowImplicitFlow
+     */
+    public function setAllowImplicitFlow($allowImplicitFlow) {
+        $this->allowImplicitFlow = $allowImplicitFlow;
+    }
+
+    /**
+     * @return bool
+     */
+    public function getAllowImplicitFlow() {
+        return $this->allowImplicitFlow;
+    }
+
+    /**
+     *
+     * Use this to alter a provider's endpoints and other attributes
+     *
+     * @param array $array
+     *        simple key => value
+     */
+    public function providerConfigParam($array) {
+        $this->providerConfig = array_merge($this->providerConfig, $array);
+    }
+
+    /**
+     * @param string $clientSecret
+     */
+    public function setClientSecret($clientSecret) {
+        $this->clientSecret = $clientSecret;
+    }
+
+    /**
+     * @param string $clientID
+     */
+    public function setClientID($clientID) {
+        $this->clientID = $clientID;
+    }
+
+
+    /**
+     * Dynamic registration
+     *
+     * @throws OpenIDConnectClientException
+     */
+    public function register() {
+
+        $registration_endpoint = $this->getProviderConfigValue('registration_endpoint');
+
+        $send_object = (object ) array_merge($this->registrationParams, [
+            'redirect_uris' => [$this->getRedirectURL()],
+            'client_name' => $this->getClientName()
+        ]);
+
+        $response = $this->fetchURL($registration_endpoint, json_encode($send_object));
+
+        $json_response = json_decode($response);
+
+        // Throw some errors if we encounter them
+        if ($json_response === false) {
+            throw new OpenIDConnectClientException('Error registering: JSON response received from the server was invalid.');
+        }
+
+        if (isset($json_response->{'error_description'})) {
+            throw new OpenIDConnectClientException($json_response->{'error_description'});
+        }
+
+        $this->setClientID($json_response->{'client_id'});
+
+        // The OpenID Connect Dynamic registration protocol makes the client secret optional
+        // and provides a registration access token and URI endpoint if it is not present
+        if (isset($json_response->{'client_secret'})) {
+            $this->setClientSecret($json_response->{'client_secret'});
+        } else {
+            throw new OpenIDConnectClientException('Error registering:
+                                                    Please contact the OpenID Connect provider and obtain a Client ID and Secret directly from them');
+        }
+
+    }
+
+    /**
+     * Introspect a given token - either access token or refresh token.
+     * @see https://tools.ietf.org/html/rfc7662
+     *
+     * @param string $token
+     * @param string $token_type_hint
+     * @param string|null $clientId
+     * @param string|null $clientSecret
+     * @return mixed
+     * @throws OpenIDConnectClientException
+     */
+    public function introspectToken($token, $token_type_hint = '', $clientId = null, $clientSecret = null) {
+        $introspection_endpoint = $this->getProviderConfigValue('introspection_endpoint');
+        $token_endpoint_auth_methods_supported = $this->getProviderConfigValue('token_endpoint_auth_methods_supported', ['client_secret_basic']);
+
+        $post_data = ['token' => $token];
+
+        if ($token_type_hint) {
+            $post_data['token_type_hint'] = $token_type_hint;
+        }
+        $clientId = $clientId !== null ? $clientId : $this->clientID;
+        $clientSecret = $clientSecret !== null ? $clientSecret : $this->clientSecret;
+
+        // Convert token params to string format
+        $headers = ['Authorization: Basic ' . base64_encode(urlencode($clientId) . ':' . urlencode($clientSecret)),
+            'Accept: application/json'];
+
+        if ($this->supportsAuthMethod('client_secret_jwt', $token_endpoint_auth_methods_supported)) {
+            $client_assertion_type = $this->getProviderConfigValue('client_assertion_type');
+            $client_assertion = $this->getJWTClientAssertion($this->getProviderConfigValue('introspection_endpoint'));
+            
+            $post_data['client_assertion_type']=$client_assertion_type;
+            $post_data['client_assertion'] = $client_assertion;
+            $headers = ['Accept: application/json'];
+        }
+
+        $post_params = http_build_query($post_data, '', '&');
+
+        return json_decode($this->fetchURL($introspection_endpoint, $post_params, $headers));
+    }
+
+    /**
+     * Revoke a given token - either access token or refresh token.
+     * @see https://tools.ietf.org/html/rfc7009
+     *
+     * @param string $token
+     * @param string $token_type_hint
+     * @param string|null $clientId
+     * @param string|null $clientSecret
+     * @return mixed
+     * @throws OpenIDConnectClientException
+     */
+    public function revokeToken($token, $token_type_hint = '', $clientId = null, $clientSecret = null) {
+        $revocation_endpoint = $this->getProviderConfigValue('revocation_endpoint');
+
+        $post_data = ['token' => $token];
+
+        if ($token_type_hint) {
+            $post_data['token_type_hint'] = $token_type_hint;
+        }
+        $clientId = $clientId !== null ? $clientId : $this->clientID;
+        $clientSecret = $clientSecret !== null ? $clientSecret : $this->clientSecret;
+
+        // Convert token params to string format
+        $post_params = http_build_query($post_data, '', '&');
+        $headers = ['Authorization: Basic ' . base64_encode(urlencode($clientId) . ':' . urlencode($clientSecret)),
+            'Accept: application/json'];
+
+        return json_decode($this->fetchURL($revocation_endpoint, $post_params, $headers));
+    }
+
+    /**
+     * @return string
+     */
+    public function getClientName() {
+        return $this->clientName;
+    }
+
+    /**
+     * @param string $clientName
+     */
+    public function setClientName($clientName) {
+        $this->clientName = $clientName;
+    }
+
+    /**
+     * @return string
+     */
+    public function getClientID() {
+        return $this->clientID;
+    }
+
+    /**
+     * @return string
+     */
+    public function getClientSecret() {
+        return $this->clientSecret;
+    }
+
+    /**
+     * @return bool
+     */
+    public function canVerifySignatures() {
+        return class_exists('\phpseclib3\Crypt\RSA') || class_exists('\phpseclib\Crypt\RSA') || class_exists('Crypt_RSA');
+    }
+
+    /**
+     * Set the access token.
+     *
+     * May be required for subclasses of this Client.
+     *
+     * @param string $accessToken
+     * @return void
+     */
+    public function setAccessToken($accessToken) {
+        $this->accessToken = $accessToken;
+    }
+
+    /**
+     * @return string
+     */
+    public function getAccessToken() {
+        return $this->accessToken;
+    }
+
+    /**
+     * @return string
+     */
+    public function getRefreshToken() {
+        return $this->refreshToken;
+    }
+
+    /**
+     * @return string
+     */
+    public function getIdToken() {
+        return $this->idToken;
+    }
+
+    /**
+     * @return object
+     */
+    public function getAccessTokenHeader() {
+        return $this->decodeJWT($this->accessToken);
+    }
+
+    /**
+     * @return object
+     */
+    public function getAccessTokenPayload() {
+        return $this->decodeJWT($this->accessToken, 1);
+    }
+
+    /**
+     * @return object
+     */
+    public function getIdTokenHeader() {
+        return $this->decodeJWT($this->idToken);
+    }
+
+    /**
+     * @return object
+     */
+    public function getIdTokenPayload() {
+        return $this->decodeJWT($this->idToken, 1);
+    }
+
+    /**
+     * @return string
+     */
+    public function getTokenResponse() {
+        return $this->tokenResponse;
+    }
+
+    /**
+     * Stores nonce
+     *
+     * @param string $nonce
+     * @return string
+     */
+    protected function setNonce($nonce) {
+        $this->setSessionKey('openid_connect_nonce', $nonce);
+        return $nonce;
+    }
+
+    /**
+     * Get stored nonce
+     *
+     * @return string
+     */
+    protected function getNonce() {
+        return $this->getSessionKey('openid_connect_nonce');
+    }
+
+    /**
+     * Cleanup nonce
+     *
+     * @return void
+     */
+    protected function unsetNonce() {
+        $this->unsetSessionKey('openid_connect_nonce');
+    }
+
+    /**
+     * Stores $state
+     *
+     * @param string $state
+     * @return string
+     */
+    protected function setState($state) {
+        $this->setSessionKey('openid_connect_state', $state);
+        return $state;
+    }
+
+    /**
+     * Get stored state
+     *
+     * @return string
+     */
+    protected function getState() {
+        return $this->getSessionKey('openid_connect_state');
+    }
+
+    /**
+     * Cleanup state
+     *
+     * @return void
+     */
+    protected function unsetState() {
+        $this->unsetSessionKey('openid_connect_state');
+    }
+
+    /**
+     * Stores $codeVerifier
+     *
+     * @param string $codeVerifier
+     * @return string
+     */
+    protected function setCodeVerifier($codeVerifier) {
+        $this->setSessionKey('openid_connect_code_verifier', $codeVerifier);
+        return $codeVerifier;
+    }
+
+    /**
+     * Get stored codeVerifier
+     *
+     * @return string
+     */
+    protected function getCodeVerifier() {
+        return $this->getSessionKey('openid_connect_code_verifier');
+    }
+
+    /**
+     * Cleanup state
+     *
+     * @return void
+     */
+    protected function unsetCodeVerifier() {
+        $this->unsetSessionKey('openid_connect_code_verifier');
+    }
+
+    /**
+     * Get the response code from last action/curl request.
+     *
+     * @return int
+     */
+    public function getResponseCode() {
+        return $this->responseCode;
+    }
+
+    /**
+     * Set timeout (seconds)
+     *
+     * @param int $timeout
+     */
+    public function setTimeout($timeout) {
+        $this->timeOut = $timeout;
+    }
+
+    /**
+     * @return int
+     */
+    public function getTimeout() {
+        return $this->timeOut;
+    }
+
+    /**
+     * Safely calculate length of binary string
+     * @param string $str
+     * @return int
+     */
+    private static function safeLength($str) {
+        if (function_exists('mb_strlen')) {
+            return mb_strlen($str, '8bit');
+        }
+        return strlen($str);
+    }
+
+    /**
+     * Where hash_equals is not available, this provides a timing-attack safe string comparison
+     * @param string $str1
+     * @param string $str2
+     * @return bool
+     */
+    private static function hashEquals($str1, $str2) {
+        $len1=static::safeLength($str1);
+        $len2=static::safeLength($str2);
+
+        //compare strings without any early abort...
+        $len = min($len1, $len2);
+        $status = 0;
+        for ($i = 0; $i < $len; $i++) {
+            $status |= (ord($str1[$i]) ^ ord($str2[$i]));
+        }
+        //if strings were different lengths, we fail
+        $status |= ($len1 ^ $len2);
+        return ($status === 0);
+    }
+
+    /**
+     * Use session to manage a nonce
+     */
+    protected function startSession() {
+        if (session_status() === PHP_SESSION_NONE) {
+            @session_start();
+        }
+    }
+
+    protected function commitSession() {
+        $this->startSession();
+
+        session_write_close();
+    }
+
+    protected function getSessionKey($key) {
+        $this->startSession();
+
+        if (array_key_exists($key, $_SESSION)) {
+            return $_SESSION[$key];
+        }
+        return false;
+    }
+
+    protected function setSessionKey($key, $value) {
+        $this->startSession();
+
+        $_SESSION[$key] = $value;
+    }
+
+    protected function unsetSessionKey($key) {
+        $this->startSession();
+
+        unset($_SESSION[$key]);
+    }
+
+    protected function getJWTClientAssertion($aud) {
+        $jti = hash('sha256',bin2hex(random_bytes(64)));
+
+        $now = time();
+
+		$header = json_encode(['typ' => 'JWT', 'alg' => 'HS256']);
+		$payload = json_encode([
+			'sub' => $this->getClientID(),
+			'iss' => $this->getClientID(),
+			'aud' => $aud,
+			'jti' => $jti,
+			'exp' => $now + 3600,
+			'iat' => $now,
+		]);
+		// Encode Header to Base64Url String
+		$base64UrlHeader = $this->urlEncode($header);
+		
+
+		// Encode Payload to Base64Url String
+		$base64UrlPayload = $this->urlEncode($payload);
+
+		// Create Signature Hash
+		$signature = hash_hmac(
+			'sha256',
+			$base64UrlHeader . "." . $base64UrlPayload,
+			$this->getClientSecret(),
+			true
+		);
+
+		// Encode Signature to Base64Url String
+		$base64UrlSignature = $this->urlEncode($signature);
+		
+		$jwt = $base64UrlHeader . "." . $base64UrlPayload . "." . $base64UrlSignature;
+
+		return $jwt;
+    }
+    
+    public function setUrlEncoding($curEncoding) {
+        switch ($curEncoding)
+        {
+            case PHP_QUERY_RFC1738:
+                $this->encType = PHP_QUERY_RFC1738;
+                break;
+
+            case PHP_QUERY_RFC3986:
+                $this->encType = PHP_QUERY_RFC3986;
+                break;
+
+        	default:
+                break;
+        }
+
+    }
+
+    /**
+     * @return array
+     */
+    public function getScopes() {
+        return $this->scopes;
+    }
+
+    /**
+     * @return array
+     */
+    public function getResponseTypes() {
+        return $this->responseTypes;
+    }
+
+    /**
+     * @return array
+     */
+    public function getAuthParams() {
+        return $this->authParams;
+    }
+
+    /**
+     * @return callable
+     */
+    public function getIssuerValidator() {
+        return $this->issuerValidator;
+    }
+
+
+    /**
+     * @return callable
+     */
+    public function getPrivateKeyJwtGenerator() {
+        return $this->privateKeyJwtGenerator;
+    }
+
+    /**
+     * @return int
+     */
+    public function getLeeway() {
+        return $this->leeway;
+    }
+
+    /**
+     * @return string
+     */
+    public function getCodeChallengeMethod() {
+        return $this->codeChallengeMethod;
+    }
+
+    /**
+     * @param string $codeChallengeMethod
+     */
+    public function setCodeChallengeMethod($codeChallengeMethod) {
+        $this->codeChallengeMethod = $codeChallengeMethod;
+    }
+
+    /**
+     * @throws OpenIDConnectClientException
+     */
+    protected function verifyJWKHeader($jwk)
+    {
+        throw new OpenIDConnectClientException('Self signed JWK header is not valid');
+    }
+
+    /*
+     * @return string
+     */
+    public function getSidFromBackChannel() {
+        return $this->backChannelSid;
+    }
+
+    /**
+     * @return string
+     */
+    public function getSubjectFromBackChannel() {
+        return $this->backChannelSubject;
+    }
+
+    /**
+     * @param string $auth_method
+     * @param array $token_endpoint_auth_methods_supported
+     * @return bool
+     */
+    public function supportsAuthMethod($auth_method, $token_endpoint_auth_methods_supported)
+    {
+        # client_secret_jwt has to explicitly be enabled
+        if (!in_array($auth_method, $this->token_endpoint_auth_methods_supported, true)) {
+            return false;
+        }
+
+        return in_array($auth_method, $token_endpoint_auth_methods_supported, true);
+    }
+}

--- private/vendor/jumbojett/openid-connect-php/tests/OpenIDConnectClientTest.php ---
@@ -0,0 +1,91 @@
+<?php
+
+use Jumbojett\OpenIDConnectClient;
+use Jumbojett\OpenIDConnectClientException;
+use PHPUnit\Framework\MockObject\MockObject;
+use Yoast\PHPUnitPolyfills\TestCases\TestCase;
+
+class OpenIDConnectClientTest extends TestCase
+{
+    /**
+     * @return void
+     */
+    public function testGetRedirectURL()
+    {
+        $client = new OpenIDConnectClient();
+
+        self::assertSame('http:///', $client->getRedirectURL());
+
+        $_SERVER['SERVER_NAME'] = 'domain.test';
+        $_SERVER['REQUEST_URI'] = '/path/index.php?foo=bar&baz#fragment';
+        self::assertSame('http://domain.test/path/index.php', $client->getRedirectURL());
+    }
+
+    public function testAuthenticateDoesNotThrowExceptionIfClaimsIsMissingNonce()
+    {
+        $fakeClaims = new \StdClass();
+        $fakeClaims->iss = 'fake-issuer';
+        $fakeClaims->aud = 'fake-client-id';
+        $fakeClaims->nonce = null;
+
+        $_REQUEST['id_token'] = 'abc.123.xyz';
+        $_REQUEST['state'] = false;
+        $_SESSION['openid_connect_state'] = false;
+
+        /** @var OpenIDConnectClient | MockObject $client */
+        $client = $this->getMockBuilder(OpenIDConnectClient::class)->setMethods(['decodeJWT', 'getProviderConfigValue', 'verifyJWTsignature'])->getMock();
+        $client->method('decodeJWT')->willReturn($fakeClaims);
+        $client->method('getProviderConfigValue')->with('jwks_uri')->willReturn(true);
+        $client->method('verifyJWTsignature')->willReturn(true);
+
+        $client->setClientID('fake-client-id');
+        $client->setIssuer('fake-issuer');
+        $client->setIssuerValidator(function() {
+            return true;
+        });
+        $client->setAllowImplicitFlow(true);
+        $client->setProviderURL('https://jwt.io/');
+
+        try {
+            $authenticated = $client->authenticate();
+            $this->assertTrue($authenticated);
+        } catch ( OpenIDConnectClientException $e ) {
+            if ( $e->getMessage() === 'Unable to verify JWT claims' ) {
+                self::fail( 'OpenIDConnectClientException was thrown when it should not have been.' );
+            }
+        }
+    }
+
+    public function testSerialize()
+    {
+        $client = new OpenIDConnectClient('https://example.com', 'foo', 'bar', 'baz');
+        $serialized = serialize($client);
+        $this->assertInstanceOf('Jumbojett\OpenIDConnectClient', unserialize($serialized));
+    }
+
+    /**
+     * @dataProvider provider
+     */
+    public function testAuthMethodSupport($expected, $authMethod, $clientAuthMethods, $idpAuthMethods)
+    {
+        $client = new OpenIDConnectClient();
+        if ($clientAuthMethods !== null) {
+            $client->setTokenEndpointAuthMethodsSupported($clientAuthMethods);
+        }
+        $this->assertEquals($expected, $client->supportsAuthMethod($authMethod, $idpAuthMethods));
+    }
+
+    public function provider()
+    {
+        return [
+            'client_secret_basic - default config' => [true, 'client_secret_basic', null, ['client_secret_basic']],
+
+            'client_secret_jwt - default config' => [false, 'client_secret_jwt', null, ['client_secret_basic', 'client_secret_jwt']],
+            'client_secret_jwt - explicitly enabled' => [true, 'client_secret_jwt', ['client_secret_jwt'], ['client_secret_basic', 'client_secret_jwt']],
+
+            'private_key_jwt - default config' => [false, 'private_key_jwt', null, ['client_secret_basic', 'client_secret_jwt', 'private_key_jwt']],
+            'private_key_jwt - explicitly enabled' => [true, 'private_key_jwt', ['private_key_jwt'], ['client_secret_basic', 'client_secret_jwt', 'private_key_jwt']],
+
+        ];
+    }
+}

--- private/vendor/jumbojett/openid-connect-php/tests/TokenVerificationTest.php ---
@@ -0,0 +1,34 @@
+<?php
+
+
+use Jumbojett\OpenIDConnectClient;
+use PHPUnit\Framework\MockObject\MockObject;
+use Yoast\PHPUnitPolyfills\TestCases\TestCase;
+
+class TokenVerificationTest extends TestCase
+{
+    /**
+     * @param $alg
+     * @param $jwt
+     * @throws \Jumbojett\OpenIDConnectClientException
+     * @dataProvider providesTokens
+     */
+    public function testTokenVerification($alg, $jwt)
+    {
+        /** @var OpenIDConnectClient | MockObject $client */
+        $client = $this->getMockBuilder(OpenIDConnectClient::class)->setMethods(['fetchUrl'])->getMock();
+        $client->method('fetchUrl')->willReturn(file_get_contents(__DIR__ . "/data/jwks-$alg.json"));
+        $client->setProviderURL('https://jwt.io/');
+        $client->providerConfigParam(['jwks_uri' => 'https://jwt.io/.well-known/jwks.json']);
+        $verified = $client->verifyJWTsignature($jwt);
+        self::assertTrue($verified);
+        $client->setAccessToken($jwt);
+    }
+
+    public function providesTokens()
+    {
+        return [
+            'PS256' => ['ps256', 'eyJhbGciOiJQUzI1NiIsImtpZCI6Imtvbm5lY3RkLXRva2Vucy1zaWduaW5nLWtleSIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJrcG9wLWh0dHBzOi8va29wYW5vLmRlbW8vbWVldC8iLCJleHAiOjE1NjgzNzE0NjEsImp0aSI6IkpkR0tDbEdOTXl2VXJpcmlRRUlWUXZCVmttT2FfQkRjIiwiaWF0IjoxNTY4MzcxMjIxLCJpc3MiOiJodHRwczovL2tvcGFuby5kZW1vIiwic3ViIjoiUHpUVWp3NHBlXzctWE5rWlBILXJxVHE0MTQ1Z3lDdlRvQmk4V1E5bFBrcW5rbEc1aktvRU5LM21Qb0I1WGY1ZTM5dFRMR2RKWXBMNEJubXFnelpaX0FAa29ubmVjdCIsImtjLmlzQWNjZXNzVG9rZW4iOnRydWUsImtjLmF1dGhvcml6ZWRTY29wZXMiOlsicHJvZmlsZSIsImVtYWlsIiwia29wYW5vL2t3bSIsImtvcGFuby9nYyIsImtvcGFuby9rdnMiLCJvcGVuaWQiXSwia2MuYXV0aG9yaXplZENsYWltcyI6eyJpZF90b2tlbiI6eyJuYW1lIjpudWxsfX0sImtjLmlkZW50aXR5Ijp7ImtjLmkuZG4iOiJKb25hcyBCcmVra2UiLCJrYy5pLmlkIjoiQUFBQUFLd2hxVkJBMCs1SXN4bjdwMU13UkNVQkFBQUFCZ0FBQUJzQUFBQk5VVDA5QUFBQUFBPT0iLCJrYy5pLnVuIjoidXNlcjEiLCJrYy5pLnVzIjoiTVEifSwia2MucHJvdmlkZXIiOiJpZGVudGlmaWVyLWtjIn0.hGRuXvul2kOiALHexwYp5MBEJVwz1YV3ehyM3AOuwCoK2w5sJxdciqqY_TfXCKyO6nAEbYLK3J0CBOjfup_IG0aCZcwzjto8khYlc4ezXkGnFsbJBNQdDGkpHtWnioWx-OJ3cXvY9F8aOvjaq0gw11ZDAcqQl0g7LTbJ9-J_yx0pmy3NGai2JB30Fh1OgSDzYfxWnE0RRgZG-x68e65RXfSBaEGW85OUh4wihxO2zdTGAHJ3Iq_-QAG4yRbXZtLx3ZspG7LNmqG-YE3huy3Rd8u3xrJNhmUOfEnz3x07q7VW0cj9NedX98BAbj3iNvksQsE0oG0J_f_Tu8Ai8VbWB72sJuXZWxANDKdz0BBYLzXhsjXkNByRq9x3zqDVsX-cVHei_XudxEOVRBjhkvW2MmIjcAHNKCKsdar865-gFG9McP4PCcBlY28tC0Cvnzyi83LBfpGRXdl6MJunnUsKQ1C79iCoVI1doK1erFN959Q-TGJfJA3Tr5LNpuGawB5rpe1nDGWvmYhg3uYfNl8uTTyvNgvvejcflEb2DURuXdqABuSiP7RkDWYtzx6mq49G0tRxelBbvyjQ2id2QjmRRdQ6dHEZ2NCJ51b8OFoDJBtxN1CD62TTxa3FUqCdZAPAUR3hHn_69vYq82MR514s-Gb67A6j2PbMPFATQP2UdK8']
+        ];
+    }
+}

--- private/vendor/jumbojett/openid-connect-php/tests/data/jwks-ps256.json ---
@@ -0,0 +1,12 @@
+{
+  "keys": [
+    {
+      "kty": "RSA",
+      "use": "sig",
+      "kid": "konnectd-tokens-signing-key",
+      "n": "10hb3pFUVcqJcS-d1pLCkFTyTqVD1GavlAai582CoRwFcyIQxCPJz0LJVgkUNwxSRkY0g0PcgFN_MmuuzpFXMkkiMIC9O_KwnuL34FrbijZvcGpnDn7kb9KAM883OVTr_w3wFeQIyh0ksSwVQ9CxVQ-ZeCXP73CCGk99uDb8SeF8_vncXJmaak99pK6HKJteSLkA-Ywxo9HOINZK2vW06UYcSkeoQnSI27Cd5-T6GVgqKH0Su4c5Ydou_w0tL_UkbZA4fIbMZC6dtWmBQf6tyYsCM9fbWNIVOj_7WlWcAOSTFNF2We2dxJrOzt6vDND3k1nCgg_EEM6cgBO3swUCktTFuQxo1sryYX5WXz9wnJb38b9mTXhOeF0bd9y_VQq8erSlcyRu8UGzX65tIf534hLL16KQaHbjROGSQvzqFrISmSBjBTjkPedTZSYOhiVJ95-em_Y6uLi-T7V4bs4dcg3oa0H_glXltoC9JxzS6gfMGGLgh-NpGEOdC_QosyzVVfzT70TurOGnsB1_VcAm_fK-T1Zv_ztpr5OZNfXWXC3Pfq_3sxP5HDKMk8luZ7LOWk7HVSYBdCFmOM1A3KmHNS2fEs-QHIr-XjYQ7QrXsRFP3dmoEPfiYlu03m8Xs3UMB70eGeGQx7OhZSuogxV_oCfApV5EJfuz97tVmOg8iMs",
+      "e": "AQAB"
+    }
+  ],
+  "kty": ""
+}

--- private/vendor/paragonie/constant_time_encoding/LICENSE.txt ---
@@ -0,0 +1,48 @@
+The MIT License (MIT)
+
+Copyright (c) 2016 - 2022 Paragon Initiative Enterprises
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in all
+copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+SOFTWARE.
+
+------------------------------------------------------------------------------
+This library was based on the work of Steve "Sc00bz" Thomas.
+------------------------------------------------------------------------------
+
+The MIT License (MIT)
+
+Copyright (c) 2014 Steve Thomas
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in all
+copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+SOFTWARE.
+

--- private/vendor/paragonie/constant_time_encoding/README.md ---
@@ -0,0 +1,84 @@
+# Constant-Time Encoding
+
+[![Build Status](https://github.com/paragonie/constant_time_encoding/actions/workflows/ci.yml/badge.svg)](https://github.com/paragonie/constant_time_encoding/actions)
+[![Latest Stable Version](https://poser.pugx.org/paragonie/constant_time_encoding/v/stable)](https://packagist.org/packages/paragonie/constant_time_encoding)
+[![Latest Unstable Version](https://poser.pugx.org/paragonie/constant_time_encoding/v/unstable)](https://packagist.org/packages/paragonie/constant_time_encoding)
+[![License](https://poser.pugx.org/paragonie/constant_time_encoding/license)](https://packagist.org/packages/paragonie/constant_time_encoding)
+[![Downloads](https://img.shields.io/packagist/dt/paragonie/constant_time_encoding.svg)](https://packagist.org/packages/paragonie/constant_time_encoding)
+
+Based on the [constant-time base64 implementation made by Steve "Sc00bz" Thomas](https://github.com/Sc00bz/ConstTimeEncoding),
+this library aims to offer character encoding functions that do not leak
+information about what you are encoding/decoding via processor cache 
+misses. Further reading on [cache-timing attacks](http://blog.ircmaxell.com/2014/11/its-all-about-time.html).
+
+Our fork offers the following enchancements:
+
+* `mbstring.func_overload` resistance
+* Unit tests
+* Composer- and Packagist-ready
+* Base16 encoding
+* Base32 encoding
+* Uses `pack()` and `unpack()` instead of `chr()` and `ord()`
+
+## PHP Version Requirements
+
+Version 2 of this library should work on **PHP 7** or newer. For PHP 5
+support, see [the v1.x branch](https://github.com/paragonie/constant_time_encoding/tree/v1.x).
+
+If you are adding this as a dependency to a project intended to work on both PHP 5 and PHP 7, please set the required version to `^1|^2` instead of just `^1` or `^2`.
+
+## How to Install
+
+```sh
+composer require paragonie/constant_time_encoding
+```
+
+## How to Use
+
+```php
+use ParagonIE\ConstantTime\Encoding;
+
+// possibly (if applicable): 
+// require 'vendor/autoload.php';
+
+$data = random_bytes(32);
+echo Encoding::base64Encode($data), "\n";
+echo Encoding::base32EncodeUpper($data), "\n";
+echo Encoding::base32Encode($data), "\n";
+echo Encoding::hexEncode($data), "\n";
+echo Encoding::hexEncodeUpper($data), "\n";
+```
+
+Example output:
+ 
+```
+1VilPkeVqirlPifk5scbzcTTbMT2clp+Zkyv9VFFasE=
+2VMKKPSHSWVCVZJ6E7SONRY3ZXCNG3GE6ZZFU7TGJSX7KUKFNLAQ====
+2vmkkpshswvcvzj6e7sonry3zxcng3ge6zzfu7tgjsx7kukfnlaq====
+d558a53e4795aa2ae53e27e4e6c71bcdc4d36cc4f6725a7e664caff551456ac1
+D558A53E4795AA2AE53E27E4E6C71BDCC4D36CC4F6725A7E664CAFF551456AC1
+```
+
+If you only need a particular variant, you can just reference the 
+required class like so:
+
+```php
+use ParagonIE\ConstantTime\Base64;
+use ParagonIE\ConstantTime\Base32;
+
+$data = random_bytes(32);
+echo Base64::encode($data), "\n";
+echo Base32::encode($data), "\n";
+```
+
+Example output:
+
+```
+1VilPkeVqirlPifk5scbzcTTbMT2clp+Zkyv9VFFasE=
+2vmkkpshswvcvzj6e7sonry3zxcng3ge6zzfu7tgjsx7kukfnlaq====
+```
+
+## Support Contracts
+
+If your company uses this library in their products or services, you may be
+interested in [purchasing a support contract from Paragon Initiative Enterprises](https://paragonie.com/enterprise).

--- private/vendor/paragonie/constant_time_encoding/composer.json ---
@@ -0,0 +1,56 @@
+{
+  "name": "paragonie/constant_time_encoding",
+  "description": "Constant-time Implementations of RFC 4648 Encoding (Base-64, Base-32, Base-16)",
+  "keywords": [
+    "base64",
+    "encoding",
+    "rfc4648",
+    "base32",
+    "base16",
+    "hex",
+    "bin2hex",
+    "hex2bin",
+    "base64_encode",
+    "base64_decode",
+    "base32_encode",
+    "base32_decode"
+  ],
+  "license": "MIT",
+  "type": "library",
+  "authors": [
+      {
+        "name":     "Paragon Initiative Enterprises",
+        "email":    "security@paragonie.com",
+        "homepage": "https://paragonie.com",
+        "role":     "Maintainer"
+      },
+      {
+        "name":     "Steve 'Sc00bz' Thomas",
+        "email":    "steve@tobtu.com",
+        "homepage": "https://www.tobtu.com",
+        "role":     "Original Developer"
+      }
+  ],
+  "support": {
+    "issues":   "https://github.com/paragonie/constant_time_encoding/issues",
+    "email":    "info@paragonie.com",
+    "source":   "https://github.com/paragonie/constant_time_encoding"
+  },
+  "require": {
+    "php": "^7|^8"
+  },
+  "require-dev": {
+    "phpunit/phpunit": "^6|^7|^8|^9",
+    "vimeo/psalm": "^1|^2|^3|^4"
+  },
+  "autoload": {
+    "psr-4": {
+      "ParagonIE\\ConstantTime\\": "src/"
+    }
+  },
+  "autoload-dev": {
+    "psr-4": {
+      "ParagonIE\\ConstantTime\\Tests\\": "tests/"
+    }
+  }
+}

--- private/vendor/paragonie/constant_time_encoding/src/Base32.php ---
@@ -0,0 +1,519 @@
+<?php
+declare(strict_types=1);
+namespace ParagonIE\ConstantTime;
+
+use InvalidArgumentException;
+use RangeException;
+use TypeError;
+
+/**
+ *  Copyright (c) 2016 - 2022 Paragon Initiative Enterprises.
+ *  Copyright (c) 2014 Steve "Sc00bz" Thomas (steve at tobtu dot com)
+ *
+ *  Permission is hereby granted, free of charge, to any person obtaining a copy
+ *  of this software and associated documentation files (the "Software"), to deal
+ *  in the Software without restriction, including without limitation the rights
+ *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ *  copies of the Software, and to permit persons to whom the Software is
+ *  furnished to do so, subject to the following conditions:
+ *
+ *  The above copyright notice and this permission notice shall be included in all
+ *  copies or substantial portions of the Software.
+ *
+ *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+ *  SOFTWARE.
+ */
+
+/**
+ * Class Base32
+ * [A-Z][2-7]
+ *
+ * @package ParagonIE\ConstantTime
+ */
+abstract class Base32 implements EncoderInterface
+{
+    /**
+     * Decode a Base32-encoded string into raw binary
+     *
+     * @param string $encodedString
+     * @param bool $strictPadding
+     * @return string
+     */
+    public static function decode(string $encodedString, bool $strictPadding = false): string
+    {
+        return static::doDecode($encodedString, false, $strictPadding);
+    }
+
+    /**
+     * Decode an uppercase Base32-encoded string into raw binary
+     *
+     * @param string $src
+     * @param bool $strictPadding
+     * @return string
+     */
+    public static function decodeUpper(string $src, bool $strictPadding = false): string
+    {
+        return static::doDecode($src, true, $strictPadding);
+    }
+
+    /**
+     * Encode into Base32 (RFC 4648)
+     *
+     * @param string $binString
+     * @return string
+     * @throws TypeError
+     */
+    public static function encode(string $binString): string
+    {
+        return static::doEncode($binString, false, true);
+    }
+    /**
+     * Encode into Base32 (RFC 4648)
+     *
+     * @param string $src
+     * @return string
+     * @throws TypeError
+     */
+    public static function encodeUnpadded(string $src): string
+    {
+        return static::doEncode($src, false, false);
+    }
+
+    /**
+     * Encode into uppercase Base32 (RFC 4648)
+     *
+     * @param string $src
+     * @return string
+     * @throws TypeError
+     */
+    public static function encodeUpper(string $src): string
+    {
+        return static::doEncode($src, true, true);
+    }
+
+    /**
+     * Encode into uppercase Base32 (RFC 4648)
+     *
+     * @param string $src
+     * @return string
+     * @throws TypeError
+     */
+    public static function encodeUpperUnpadded(string $src): string
+    {
+        return static::doEncode($src, true, false);
+    }
+
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 5-bit integers
+     * into 8-bit integers.
+     *
+     * @param int $src
+     * @return int
+     */
+    protected static function decode5Bits(int $src): int
+    {
+        $ret = -1;
+
+        // if ($src > 96 && $src < 123) $ret += $src - 97 + 1; // -64
+        $ret += (((0x60 - $src) & ($src - 0x7b)) >> 8) & ($src - 96);
+
+        // if ($src > 0x31 && $src < 0x38) $ret += $src - 24 + 1; // -23
+        $ret += (((0x31 - $src) & ($src - 0x38)) >> 8) & ($src - 23);
+
+        return $ret;
+    }
+
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 5-bit integers
+     * into 8-bit integers.
+     *
+     * Uppercase variant.
+     *
+     * @param int $src
+     * @return int
+     */
+    protected static function decode5BitsUpper(int $src): int
+    {
+        $ret = -1;
+
+        // if ($src > 64 && $src < 91) $ret += $src - 65 + 1; // -64
+        $ret += (((0x40 - $src) & ($src - 0x5b)) >> 8) & ($src - 64);
+
+        // if ($src > 0x31 && $src < 0x38) $ret += $src - 24 + 1; // -23
+        $ret += (((0x31 - $src) & ($src - 0x38)) >> 8) & ($src - 23);
+
+        return $ret;
+    }
+
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 8-bit integers
+     * into 5-bit integers.
+     *
+     * @param int $src
+     * @return string
+     */
+    protected static function encode5Bits(int $src): string
+    {
+        $diff = 0x61;
+
+        // if ($src > 25) $ret -= 72;
+        $diff -= ((25 - $src) >> 8) & 73;
+
+        return \pack('C', $src + $diff);
+    }
+
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 8-bit integers
+     * into 5-bit integers.
+     *
+     * Uppercase variant.
+     *
+     * @param int $src
+     * @return string
+     */
+    protected static function encode5BitsUpper(int $src): string
+    {
+        $diff = 0x41;
+
+        // if ($src > 25) $ret -= 40;
+        $diff -= ((25 - $src) >> 8) & 41;
+
+        return \pack('C', $src + $diff);
+    }
+
+    /**
+     * @param string $encodedString
+     * @param bool $upper
+     * @return string
+     */
+    public static function decodeNoPadding(string $encodedString, bool $upper = false): string
+    {
+        $srcLen = Binary::safeStrlen($encodedString);
+        if ($srcLen === 0) {
+            return '';
+        }
+        if (($srcLen & 7) === 0) {
+            for ($j = 0; $j < 7 && $j < $srcLen; ++$j) {
+                if ($encodedString[$srcLen - $j - 1] === '=') {
+                    throw new InvalidArgumentException(
+                        "decodeNoPadding() doesn't tolerate padding"
+                    );
+                }
+            }
+        }
+        return static::doDecode(
+            $encodedString,
+            $upper,
+            true
+        );
+    }
+
+    /**
+     * Base32 decoding
+     *
+     * @param string $src
+     * @param bool $upper
+     * @param bool $strictPadding
+     * @return string
+     *
+     * @throws TypeError
+     * @psalm-suppress RedundantCondition
+     */
+    protected static function doDecode(
+        string $src,
+        bool $upper = false,
+        bool $strictPadding = false
+    ): string {
+        // We do this to reduce code duplication:
+        $method = $upper
+            ? 'decode5BitsUpper'
+            : 'decode5Bits';
+
+        // Remove padding
+        $srcLen = Binary::safeStrlen($src);
+        if ($srcLen === 0) {
+            return '';
+        }
+        if ($strictPadding) {
+            if (($srcLen & 7) === 0) {
+                for ($j = 0; $j < 7; ++$j) {
+                    if ($src[$srcLen - 1] === '=') {
+                        $srcLen--;
+                    } else {
+                        break;
+                    }
+                }
+            }
+            if (($srcLen & 7) === 1) {
+                throw new RangeException(
+                    'Incorrect padding'
+                );
+            }
+        } else {
+            $src = \rtrim($src, '=');
+            $srcLen = Binary::safeStrlen($src);
+        }
+
+        $err = 0;
+        $dest = '';
+        // Main loop (no padding):
+        for ($i = 0; $i + 8 <= $srcLen; $i += 8) {
+            /** @var array<int, int> $chunk */
+            $chunk = \unpack('C*', Binary::safeSubstr($src, $i, 8));
+            /** @var int $c0 */
+            $c0 = static::$method($chunk[1]);
+            /** @var int $c1 */
+            $c1 = static::$method($chunk[2]);
+            /** @var int $c2 */
+            $c2 = static::$method($chunk[3]);
+            /** @var int $c3 */
+            $c3 = static::$method($chunk[4]);
+            /** @var int $c4 */
+            $c4 = static::$method($chunk[5]);
+            /** @var int $c5 */
+            $c5 = static::$method($chunk[6]);
+            /** @var int $c6 */
+            $c6 = static::$method($chunk[7]);
+            /** @var int $c7 */
+            $c7 = static::$method($chunk[8]);
+
+            $dest .= \pack(
+                'CCCCC',
+                (($c0 << 3) | ($c1 >> 2)             ) & 0xff,
+                (($c1 << 6) | ($c2 << 1) | ($c3 >> 4)) & 0xff,
+                (($c3 << 4) | ($c4 >> 1)             ) & 0xff,
+                (($c4 << 7) | ($c5 << 2) | ($c6 >> 3)) & 0xff,
+                (($c6 << 5) | ($c7     )             ) & 0xff
+            );
+            $err |= ($c0 | $c1 | $c2 | $c3 | $c4 | $c5 | $c6 | $c7) >> 8;
+        }
+        // The last chunk, which may have padding:
+        if ($i < $srcLen) {
+            /** @var array<int, int> $chunk */
+            $chunk = \unpack('C*', Binary::safeSubstr($src, $i, $srcLen - $i));
+            /** @var int $c0 */
+            $c0 = static::$method($chunk[1]);
+
+            if ($i + 6 < $srcLen) {
+                /** @var int $c1 */
+                $c1 = static::$method($chunk[2]);
+                /** @var int $c2 */
+                $c2 = static::$method($chunk[3]);
+                /** @var int $c3 */
+                $c3 = static::$method($chunk[4]);
+                /** @var int $c4 */
+                $c4 = static::$method($chunk[5]);
+                /** @var int $c5 */
+                $c5 = static::$method($chunk[6]);
+                /** @var int $c6 */
+                $c6 = static::$method($chunk[7]);
+
+                $dest .= \pack(
+                    'CCCC',
+                    (($c0 << 3) | ($c1 >> 2)             ) & 0xff,
+                    (($c1 << 6) | ($c2 << 1) | ($c3 >> 4)) & 0xff,
+                    (($c3 << 4) | ($c4 >> 1)             ) & 0xff,
+                    (($c4 << 7) | ($c5 << 2) | ($c6 >> 3)) & 0xff
+                );
+                $err |= ($c0 | $c1 | $c2 | $c3 | $c4 | $c5 | $c6) >> 8;
+                if ($strictPadding) {
+                    $err |= ($c6 << 5) & 0xff;
+                }
+            } elseif ($i + 5 < $srcLen) {
+                /** @var int $c1 */
+                $c1 = static::$method($chunk[2]);
+                /** @var int $c2 */
+                $c2 = static::$method($chunk[3]);
+                /** @var int $c3 */
+                $c3 = static::$method($chunk[4]);
+                /** @var int $c4 */
+                $c4 = static::$method($chunk[5]);
+                /** @var int $c5 */
+                $c5 = static::$method($chunk[6]);
+
+                $dest .= \pack(
+                    'CCCC',
+                    (($c0 << 3) | ($c1 >> 2)             ) & 0xff,
+                    (($c1 << 6) | ($c2 << 1) | ($c3 >> 4)) & 0xff,
+                    (($c3 << 4) | ($c4 >> 1)             ) & 0xff,
+                    (($c4 << 7) | ($c5 << 2)             ) & 0xff
+                );
+                $err |= ($c0 | $c1 | $c2 | $c3 | $c4 | $c5) >> 8;
+            } elseif ($i + 4 < $srcLen) {
+                /** @var int $c1 */
+                $c1 = static::$method($chunk[2]);
+                /** @var int $c2 */
+                $c2 = static::$method($chunk[3]);
+                /** @var int $c3 */
+                $c3 = static::$method($chunk[4]);
+                /** @var int $c4 */
+                $c4 = static::$method($chunk[5]);
+
+                $dest .= \pack(
+                    'CCC',
+                    (($c0 << 3) | ($c1 >> 2)             ) & 0xff,
+                    (($c1 << 6) | ($c2 << 1) | ($c3 >> 4)) & 0xff,
+                    (($c3 << 4) | ($c4 >> 1)             ) & 0xff
+                );
+                $err |= ($c0 | $c1 | $c2 | $c3 | $c4) >> 8;
+                if ($strictPadding) {
+                    $err |= ($c4 << 7) & 0xff;
+                }
+            } elseif ($i + 3 < $srcLen) {
+                /** @var int $c1 */
+                $c1 = static::$method($chunk[2]);
+                /** @var int $c2 */
+                $c2 = static::$method($chunk[3]);
+                /** @var int $c3 */
+                $c3 = static::$method($chunk[4]);
+
+                $dest .= \pack(
+                    'CC',
+                    (($c0 << 3) | ($c1 >> 2)             ) & 0xff,
+                    (($c1 << 6) | ($c2 << 1) | ($c3 >> 4)) & 0xff
+                );
+                $err |= ($c0 | $c1 | $c2 | $c3) >> 8;
+                if ($strictPadding) {
+                    $err |= ($c3 << 4) & 0xff;
+                }
+            } elseif ($i + 2 < $srcLen) {
+                /** @var int $c1 */
+                $c1 = static::$method($chunk[2]);
+                /** @var int $c2 */
+                $c2 = static::$method($chunk[3]);
+
+                $dest .= \pack(
+                    'CC',
+                    (($c0 << 3) | ($c1 >> 2)             ) & 0xff,
+                    (($c1 << 6) | ($c2 << 1)             ) & 0xff
+                );
+                $err |= ($c0 | $c1 | $c2) >> 8;
+                if ($strictPadding) {
+                    $err |= ($c2 << 6) & 0xff;
+                }
+            } elseif ($i + 1 < $srcLen) {
+                /** @var int $c1 */
+                $c1 = static::$method($chunk[2]);
+
+                $dest .= \pack(
+                    'C',
+                    (($c0 << 3) | ($c1 >> 2)             ) & 0xff
+                );
+                $err |= ($c0 | $c1) >> 8;
+                if ($strictPadding) {
+                    $err |= ($c1 << 6) & 0xff;
+                }
+            } else {
+                $dest .= \pack(
+                    'C',
+                    (($c0 << 3)                          ) & 0xff
+                );
+                $err |= ($c0) >> 8;
+            }
+        }
+        $check = ($err === 0);
+        if (!$check) {
+            throw new RangeException(
+                'Base32::doDecode() only expects characters in the correct base32 alphabet'
+            );
+        }
+        return $dest;
+    }
+
+    /**
+     * Base32 Encoding
+     *
+     * @param string $src
+     * @param bool $upper
+     * @param bool $pad
+     * @return string
+     * @throws TypeError
+     */
+    protected static function doEncode(string $src, bool $upper = false, $pad = true): string
+    {
+        // We do this to reduce code duplication:
+        $method = $upper
+            ? 'encode5BitsUpper'
+            : 'encode5Bits';
+        
+        $dest = '';
+        $srcLen = Binary::safeStrlen($src);
+
+        // Main loop (no padding):
+        for ($i = 0; $i + 5 <= $srcLen; $i += 5) {
+            /** @var array<int, int> $chunk */
+            $chunk = \unpack('C*', Binary::safeSubstr($src, $i, 5));
+            $b0 = $chunk[1];
+            $b1 = $chunk[2];
+            $b2 = $chunk[3];
+            $b3 = $chunk[4];
+            $b4 = $chunk[5];
+            $dest .=
+                static::$method(              ($b0 >> 3)  & 31) .
+                static::$method((($b0 << 2) | ($b1 >> 6)) & 31) .
+                static::$method((($b1 >> 1)             ) & 31) .
+                static::$method((($b1 << 4) | ($b2 >> 4)) & 31) .
+                static::$method((($b2 << 1) | ($b3 >> 7)) & 31) .
+                static::$method((($b3 >> 2)             ) & 31) .
+                static::$method((($b3 << 3) | ($b4 >> 5)) & 31) .
+                static::$method(  $b4                     & 31);
+        }
+        // The last chunk, which may have padding:
+        if ($i < $srcLen) {
+            /** @var array<int, int> $chunk */
+            $chunk = \unpack('C*', Binary::safeSubstr($src, $i, $srcLen - $i));
+            $b0 = $chunk[1];
+            if ($i + 3 < $srcLen) {
+                $b1 = $chunk[2];
+                $b2 = $chunk[3];
+                $b3 = $chunk[4];
+                $dest .=
+                    static::$method(              ($b0 >> 3)  & 31) .
+                    static::$method((($b0 << 2) | ($b1 >> 6)) & 31) .
+                    static::$method((($b1 >> 1)             ) & 31) .
+                    static::$method((($b1 << 4) | ($b2 >> 4)) & 31) .
+                    static::$method((($b2 << 1) | ($b3 >> 7)) & 31) .
+                    static::$method((($b3 >> 2)             ) & 31) .
+                    static::$method((($b3 << 3)             ) & 31);
+                if ($pad) {
+                    $dest .= '=';
+                }
+            } elseif ($i + 2 < $srcLen) {
+                $b1 = $chunk[2];
+                $b2 = $chunk[3];
+                $dest .=
+                    static::$method(              ($b0 >> 3)  & 31) .
+                    static::$method((($b0 << 2) | ($b1 >> 6)) & 31) .
+                    static::$method((($b1 >> 1)             ) & 31) .
+                    static::$method((($b1 << 4) | ($b2 >> 4)) & 31) .
+                    static::$method((($b2 << 1)             ) & 31);
+                if ($pad) {
+                    $dest .= '===';
+                }
+            } elseif ($i + 1 < $srcLen) {
+                $b1 = $chunk[2];
+                $dest .=
+                    static::$method(              ($b0 >> 3)  & 31) .
+                    static::$method((($b0 << 2) | ($b1 >> 6)) & 31) .
+                    static::$method((($b1 >> 1)             ) & 31) .
+                    static::$method((($b1 << 4)             ) & 31);
+                if ($pad) {
+                    $dest .= '====';
+                }
+            } else {
+                $dest .=
+                    static::$method(              ($b0 >> 3)  & 31) .
+                    static::$method( ($b0 << 2)               & 31);
+                if ($pad) {
+                    $dest .= '======';
+                }
+            }
+        }
+        return $dest;
+    }
+}

--- private/vendor/paragonie/constant_time_encoding/src/Base32Hex.php ---
@@ -0,0 +1,111 @@
+<?php
+declare(strict_types=1);
+namespace ParagonIE\ConstantTime;
+
+/**
+ *  Copyright (c) 2016 - 2022 Paragon Initiative Enterprises.
+ *  Copyright (c) 2014 Steve "Sc00bz" Thomas (steve at tobtu dot com)
+ *
+ *  Permission is hereby granted, free of charge, to any person obtaining a copy
+ *  of this software and associated documentation files (the "Software"), to deal
+ *  in the Software without restriction, including without limitation the rights
+ *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ *  copies of the Software, and to permit persons to whom the Software is
+ *  furnished to do so, subject to the following conditions:
+ *
+ *  The above copyright notice and this permission notice shall be included in all
+ *  copies or substantial portions of the Software.
+ *
+ *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+ *  SOFTWARE.
+ */
+
+/**
+ * Class Base32Hex
+ * [0-9][A-V]
+ *
+ * @package ParagonIE\ConstantTime
+ */
+abstract class Base32Hex extends Base32
+{
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 5-bit integers
+     * into 8-bit integers.
+     *
+     * @param int $src
+     * @return int
+     */
+    protected static function decode5Bits(int $src): int
+    {
+        $ret = -1;
+
+        // if ($src > 0x30 && $src < 0x3a) ret += $src - 0x2e + 1; // -47
+        $ret += (((0x2f - $src) & ($src - 0x3a)) >> 8) & ($src - 47);
+
+        // if ($src > 0x60 && $src < 0x77) ret += $src - 0x61 + 10 + 1; // -86
+        $ret += (((0x60 - $src) & ($src - 0x77)) >> 8) & ($src - 86);
+
+        return $ret;
+    }
+
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 5-bit integers
+     * into 8-bit integers.
+     *
+     * @param int $src
+     * @return int
+     */
+    protected static function decode5BitsUpper(int $src): int
+    {
+        $ret = -1;
+
+        // if ($src > 0x30 && $src < 0x3a) ret += $src - 0x2e + 1; // -47
+        $ret += (((0x2f - $src) & ($src - 0x3a)) >> 8) & ($src - 47);
+
+        // if ($src > 0x40 && $src < 0x57) ret += $src - 0x41 + 10 + 1; // -54
+        $ret += (((0x40 - $src) & ($src - 0x57)) >> 8) & ($src - 54);
+
+        return $ret;
+    }
+
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 8-bit integers
+     * into 5-bit integers.
+     *
+     * @param int $src
+     * @return string
+     */
+    protected static function encode5Bits(int $src): string
+    {
+        $src += 0x30;
+
+        // if ($src > 0x39) $src += 0x61 - 0x3a; // 39
+        $src += ((0x39 - $src) >> 8) & 39;
+
+        return \pack('C', $src);
+    }
+
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 8-bit integers
+     * into 5-bit integers.
+     *
+     * Uppercase variant.
+     *
+     * @param int $src
+     * @return string
+     */
+    protected static function encode5BitsUpper(int $src): string
+    {
+        $src += 0x30;
+
+        // if ($src > 0x39) $src += 0x41 - 0x3a; // 7
+        $src += ((0x39 - $src) >> 8) & 7;
+
+        return \pack('C', $src);
+    }
+}
\ No newline at end of file

--- private/vendor/paragonie/constant_time_encoding/src/Base64.php ---
@@ -0,0 +1,314 @@
+<?php
+declare(strict_types=1);
+namespace ParagonIE\ConstantTime;
+
+use InvalidArgumentException;
+use RangeException;
+use TypeError;
+
+/**
+ *  Copyright (c) 2016 - 2022 Paragon Initiative Enterprises.
+ *  Copyright (c) 2014 Steve "Sc00bz" Thomas (steve at tobtu dot com)
+ *
+ *  Permission is hereby granted, free of charge, to any person obtaining a copy
+ *  of this software and associated documentation files (the "Software"), to deal
+ *  in the Software without restriction, including without limitation the rights
+ *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ *  copies of the Software, and to permit persons to whom the Software is
+ *  furnished to do so, subject to the following conditions:
+ *
+ *  The above copyright notice and this permission notice shall be included in all
+ *  copies or substantial portions of the Software.
+ *
+ *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+ *  SOFTWARE.
+ */
+
+/**
+ * Class Base64
+ * [A-Z][a-z][0-9]+/
+ *
+ * @package ParagonIE\ConstantTime
+ */
+abstract class Base64 implements EncoderInterface
+{
+    /**
+     * Encode into Base64
+     *
+     * Base64 character set "[A-Z][a-z][0-9]+/"
+     *
+     * @param string $binString
+     * @return string
+     *
+     * @throws TypeError
+     */
+    public static function encode(string $binString): string
+    {
+        return static::doEncode($binString, true);
+    }
+
+    /**
+     * Encode into Base64, no = padding
+     *
+     * Base64 character set "[A-Z][a-z][0-9]+/"
+     *
+     * @param string $src
+     * @return string
+     *
+     * @throws TypeError
+     */
+    public static function encodeUnpadded(string $src): string
+    {
+        return static::doEncode($src, false);
+    }
+
+    /**
+     * @param string $src
+     * @param bool $pad   Include = padding?
+     * @return string
+     *
+     * @throws TypeError
+     */
+    protected static function doEncode(string $src, bool $pad = true): string
+    {
+        $dest = '';
+        $srcLen = Binary::safeStrlen($src);
+        // Main loop (no padding):
+        for ($i = 0; $i + 3 <= $srcLen; $i += 3) {
+            /** @var array<int, int> $chunk */
+            $chunk = \unpack('C*', Binary::safeSubstr($src, $i, 3));
+            $b0 = $chunk[1];
+            $b1 = $chunk[2];
+            $b2 = $chunk[3];
+
+            $dest .=
+                static::encode6Bits(               $b0 >> 2       ) .
+                static::encode6Bits((($b0 << 4) | ($b1 >> 4)) & 63) .
+                static::encode6Bits((($b1 << 2) | ($b2 >> 6)) & 63) .
+                static::encode6Bits(  $b2                     & 63);
+        }
+        // The last chunk, which may have padding:
+        if ($i < $srcLen) {
+            /** @var array<int, int> $chunk */
+            $chunk = \unpack('C*', Binary::safeSubstr($src, $i, $srcLen - $i));
+            $b0 = $chunk[1];
+            if ($i + 1 < $srcLen) {
+                $b1 = $chunk[2];
+                $dest .=
+                    static::encode6Bits($b0 >> 2) .
+                    static::encode6Bits((($b0 << 4) | ($b1 >> 4)) & 63) .
+                    static::encode6Bits(($b1 << 2) & 63);
+                if ($pad) {
+                    $dest .= '=';
+                }
+            } else {
+                $dest .=
+                    static::encode6Bits( $b0 >> 2) .
+                    static::encode6Bits(($b0 << 4) & 63);
+                if ($pad) {
+                    $dest .= '==';
+                }
+            }
+        }
+        return $dest;
+    }
+
+    /**
+     * decode from base64 into binary
+     *
+     * Base64 character set "./[A-Z][a-z][0-9]"
+     *
+     * @param string $encodedString
+     * @param bool $strictPadding
+     * @return string
+     *
+     * @throws RangeException
+     * @throws TypeError
+     * @psalm-suppress RedundantCondition
+     */
+    public static function decode(string $encodedString, bool $strictPadding = false): string
+    {
+        // Remove padding
+        $srcLen = Binary::safeStrlen($encodedString);
+        if ($srcLen === 0) {
+            return '';
+        }
+
+        if ($strictPadding) {
+            if (($srcLen & 3) === 0) {
+                if ($encodedString[$srcLen - 1] === '=') {
+                    $srcLen--;
+                    if ($encodedString[$srcLen - 1] === '=') {
+                        $srcLen--;
+                    }
+                }
+            }
+            if (($srcLen & 3) === 1) {
+                throw new RangeException(
+                    'Incorrect padding'
+                );
+            }
+            if ($encodedString[$srcLen - 1] === '=') {
+                throw new RangeException(
+                    'Incorrect padding'
+                );
+            }
+        } else {
+            $encodedString = \rtrim($encodedString, '=');
+            $srcLen = Binary::safeStrlen($encodedString);
+        }
+
+        $err = 0;
+        $dest = '';
+        // Main loop (no padding):
+        for ($i = 0; $i + 4 <= $srcLen; $i += 4) {
+            /** @var array<int, int> $chunk */
+            $chunk = \unpack('C*', Binary::safeSubstr($encodedString, $i, 4));
+            $c0 = static::decode6Bits($chunk[1]);
+            $c1 = static::decode6Bits($chunk[2]);
+            $c2 = static::decode6Bits($chunk[3]);
+            $c3 = static::decode6Bits($chunk[4]);
+
+            $dest .= \pack(
+                'CCC',
+                ((($c0 << 2) | ($c1 >> 4)) & 0xff),
+                ((($c1 << 4) | ($c2 >> 2)) & 0xff),
+                ((($c2 << 6) |  $c3      ) & 0xff)
+            );
+            $err |= ($c0 | $c1 | $c2 | $c3) >> 8;
+        }
+        // The last chunk, which may have padding:
+        if ($i < $srcLen) {
+            /** @var array<int, int> $chunk */
+            $chunk = \unpack('C*', Binary::safeSubstr($encodedString, $i, $srcLen - $i));
+            $c0 = static::decode6Bits($chunk[1]);
+
+            if ($i + 2 < $srcLen) {
+                $c1 = static::decode6Bits($chunk[2]);
+                $c2 = static::decode6Bits($chunk[3]);
+                $dest .= \pack(
+                    'CC',
+                    ((($c0 << 2) | ($c1 >> 4)) & 0xff),
+                    ((($c1 << 4) | ($c2 >> 2)) & 0xff)
+                );
+                $err |= ($c0 | $c1 | $c2) >> 8;
+                if ($strictPadding) {
+                    $err |= ($c2 << 6) & 0xff;
+                }
+            } elseif ($i + 1 < $srcLen) {
+                $c1 = static::decode6Bits($chunk[2]);
+                $dest .= \pack(
+                    'C',
+                    ((($c0 << 2) | ($c1 >> 4)) & 0xff)
+                );
+                $err |= ($c0 | $c1) >> 8;
+                if ($strictPadding) {
+                    $err |= ($c1 << 4) & 0xff;
+                }
+            } elseif ($strictPadding) {
+                $err |= 1;
+            }
+        }
+        $check = ($err === 0);
+        if (!$check) {
+            throw new RangeException(
+                'Base64::decode() only expects characters in the correct base64 alphabet'
+            );
+        }
+        return $dest;
+    }
+
+    /**
+     * @param string $encodedString
+     * @return string
+     */
+    public static function decodeNoPadding(string $encodedString): string
+    {
+        $srcLen = Binary::safeStrlen($encodedString);
+        if ($srcLen === 0) {
+            return '';
+        }
+        if (($srcLen & 3) === 0) {
+            if ($encodedString[$srcLen - 1] === '=') {
+                throw new InvalidArgumentException(
+                    "decodeNoPadding() doesn't tolerate padding"
+                );
+            }
+            if (($srcLen & 3) > 1) {
+                if ($encodedString[$srcLen - 2] === '=') {
+                    throw new InvalidArgumentException(
+                        "decodeNoPadding() doesn't tolerate padding"
+                    );
+                }
+            }
+        }
+        return static::decode(
+            $encodedString,
+            true
+        );
+    }
+
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 6-bit integers
+     * into 8-bit integers.
+     *
+     * Base64 character set:
+     * [A-Z]      [a-z]      [0-9]      +     /
+     * 0x41-0x5a, 0x61-0x7a, 0x30-0x39, 0x2b, 0x2f
+     *
+     * @param int $src
+     * @return int
+     */
+    protected static function decode6Bits(int $src): int
+    {
+        $ret = -1;
+
+        // if ($src > 0x40 && $src < 0x5b) $ret += $src - 0x41 + 1; // -64
+        $ret += (((0x40 - $src) & ($src - 0x5b)) >> 8) & ($src - 64);
+
+        // if ($src > 0x60 && $src < 0x7b) $ret += $src - 0x61 + 26 + 1; // -70
+        $ret += (((0x60 - $src) & ($src - 0x7b)) >> 8) & ($src - 70);
+
+        // if ($src > 0x2f && $src < 0x3a) $ret += $src - 0x30 + 52 + 1; // 5
+        $ret += (((0x2f - $src) & ($src - 0x3a)) >> 8) & ($src + 5);
+
+        // if ($src == 0x2b) $ret += 62 + 1;
+        $ret += (((0x2a - $src) & ($src - 0x2c)) >> 8) & 63;
+
+        // if ($src == 0x2f) ret += 63 + 1;
+        $ret += (((0x2e - $src) & ($src - 0x30)) >> 8) & 64;
+
+        return $ret;
+    }
+
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 8-bit integers
+     * into 6-bit integers.
+     *
+     * @param int $src
+     * @return string
+     */
+    protected static function encode6Bits(int $src): string
+    {
+        $diff = 0x41;
+
+        // if ($src > 25) $diff += 0x61 - 0x41 - 26; // 6
+        $diff += ((25 - $src) >> 8) & 6;
+
+        // if ($src > 51) $diff += 0x30 - 0x61 - 26; // -75
+        $diff -= ((51 - $src) >> 8) & 75;
+
+        // if ($src > 61) $diff += 0x2b - 0x30 - 10; // -15
+        $diff -= ((61 - $src) >> 8) & 15;
+
+        // if ($src > 62) $diff += 0x2f - 0x2b - 1; // 3
+        $diff += ((62 - $src) >> 8) & 3;
+
+        return \pack('C', $src + $diff);
+    }
+}

--- private/vendor/paragonie/constant_time_encoding/src/Base64DotSlash.php ---
@@ -0,0 +1,88 @@
+<?php
+declare(strict_types=1);
+namespace ParagonIE\ConstantTime;
+
+/**
+ *  Copyright (c) 2016 - 2022 Paragon Initiative Enterprises.
+ *  Copyright (c) 2014 Steve "Sc00bz" Thomas (steve at tobtu dot com)
+ *
+ *  Permission is hereby granted, free of charge, to any person obtaining a copy
+ *  of this software and associated documentation files (the "Software"), to deal
+ *  in the Software without restriction, including without limitation the rights
+ *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ *  copies of the Software, and to permit persons to whom the Software is
+ *  furnished to do so, subject to the following conditions:
+ *
+ *  The above copyright notice and this permission notice shall be included in all
+ *  copies or substantial portions of the Software.
+ *
+ *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+ *  SOFTWARE.
+ */
+
+/**
+ * Class Base64DotSlash
+ * ./[A-Z][a-z][0-9]
+ *
+ * @package ParagonIE\ConstantTime
+ */
+abstract class Base64DotSlash extends Base64
+{
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 6-bit integers
+     * into 8-bit integers.
+     *
+     * Base64 character set:
+     * ./         [A-Z]      [a-z]     [0-9]
+     * 0x2e-0x2f, 0x41-0x5a, 0x61-0x7a, 0x30-0x39
+     *
+     * @param int $src
+     * @return int
+     */
+    protected static function decode6Bits(int $src): int
+    {
+        $ret = -1;
+
+        // if ($src > 0x2d && $src < 0x30) ret += $src - 0x2e + 1; // -45
+        $ret += (((0x2d - $src) & ($src - 0x30)) >> 8) & ($src - 45);
+
+        // if ($src > 0x40 && $src < 0x5b) ret += $src - 0x41 + 2 + 1; // -62
+        $ret += (((0x40 - $src) & ($src - 0x5b)) >> 8) & ($src - 62);
+
+        // if ($src > 0x60 && $src < 0x7b) ret += $src - 0x61 + 28 + 1; // -68
+        $ret += (((0x60 - $src) & ($src - 0x7b)) >> 8) & ($src - 68);
+
+        // if ($src > 0x2f && $src < 0x3a) ret += $src - 0x30 + 54 + 1; // 7
+        $ret += (((0x2f - $src) & ($src - 0x3a)) >> 8) & ($src + 7);
+
+        return $ret;
+    }
+
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 8-bit integers
+     * into 6-bit integers.
+     *
+     * @param int $src
+     * @return string
+     */
+    protected static function encode6Bits(int $src): string
+    {
+        $src += 0x2e;
+
+        // if ($src > 0x2f) $src += 0x41 - 0x30; // 17
+        $src += ((0x2f - $src) >> 8) & 17;
+
+        // if ($src > 0x5a) $src += 0x61 - 0x5b; // 6
+        $src += ((0x5a - $src) >> 8) & 6;
+
+        // if ($src > 0x7a) $src += 0x30 - 0x7b; // -75
+        $src -= ((0x7a - $src) >> 8) & 75;
+
+        return \pack('C', $src);
+    }
+}

--- private/vendor/paragonie/constant_time_encoding/src/Base64DotSlashOrdered.php ---
@@ -0,0 +1,82 @@
+<?php
+declare(strict_types=1);
+namespace ParagonIE\ConstantTime;
+
+/**
+ *  Copyright (c) 2016 - 2022 Paragon Initiative Enterprises.
+ *  Copyright (c) 2014 Steve "Sc00bz" Thomas (steve at tobtu dot com)
+ *
+ *  Permission is hereby granted, free of charge, to any person obtaining a copy
+ *  of this software and associated documentation files (the "Software"), to deal
+ *  in the Software without restriction, including without limitation the rights
+ *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ *  copies of the Software, and to permit persons to whom the Software is
+ *  furnished to do so, subject to the following conditions:
+ *
+ *  The above copyright notice and this permission notice shall be included in all
+ *  copies or substantial portions of the Software.
+ *
+ *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+ *  SOFTWARE.
+ */
+
+/**
+ * Class Base64DotSlashOrdered
+ * ./[0-9][A-Z][a-z]
+ *
+ * @package ParagonIE\ConstantTime
+ */
+abstract class Base64DotSlashOrdered extends Base64
+{
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 6-bit integers
+     * into 8-bit integers.
+     *
+     * Base64 character set:
+     * [.-9]      [A-Z]      [a-z]
+     * 0x2e-0x39, 0x41-0x5a, 0x61-0x7a
+     *
+     * @param int $src
+     * @return int
+     */
+    protected static function decode6Bits(int $src): int
+    {
+        $ret = -1;
+
+        // if ($src > 0x2d && $src < 0x3a) ret += $src - 0x2e + 1; // -45
+        $ret += (((0x2d - $src) & ($src - 0x3a)) >> 8) & ($src - 45);
+
+        // if ($src > 0x40 && $src < 0x5b) ret += $src - 0x41 + 12 + 1; // -52
+        $ret += (((0x40 - $src) & ($src - 0x5b)) >> 8) & ($src - 52);
+
+        // if ($src > 0x60 && $src < 0x7b) ret += $src - 0x61 + 38 + 1; // -58
+        $ret += (((0x60 - $src) & ($src - 0x7b)) >> 8) & ($src - 58);
+
+        return $ret;
+    }
+
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 8-bit integers
+     * into 6-bit integers.
+     *
+     * @param int $src
+     * @return string
+     */
+    protected static function encode6Bits(int $src): string
+    {
+        $src += 0x2e;
+
+        // if ($src > 0x39) $src += 0x41 - 0x3a; // 7
+        $src += ((0x39 - $src) >> 8) & 7;
+
+        // if ($src > 0x5a) $src += 0x61 - 0x5b; // 6
+        $src += ((0x5a - $src) >> 8) & 6;
+
+        return \pack('C', $src);
+    }
+}

--- private/vendor/paragonie/constant_time_encoding/src/Base64UrlSafe.php ---
@@ -0,0 +1,95 @@
+<?php
+declare(strict_types=1);
+namespace ParagonIE\ConstantTime;
+
+/**
+ *  Copyright (c) 2016 - 2022 Paragon Initiative Enterprises.
+ *  Copyright (c) 2014 Steve "Sc00bz" Thomas (steve at tobtu dot com)
+ *
+ *  Permission is hereby granted, free of charge, to any person obtaining a copy
+ *  of this software and associated documentation files (the "Software"), to deal
+ *  in the Software without restriction, including without limitation the rights
+ *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ *  copies of the Software, and to permit persons to whom the Software is
+ *  furnished to do so, subject to the following conditions:
+ *
+ *  The above copyright notice and this permission notice shall be included in all
+ *  copies or substantial portions of the Software.
+ *
+ *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+ *  SOFTWARE.
+ */
+
+/**
+ * Class Base64UrlSafe
+ * [A-Z][a-z][0-9]\-_
+ *
+ * @package ParagonIE\ConstantTime
+ */
+abstract class Base64UrlSafe extends Base64
+{
+
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 6-bit integers
+     * into 8-bit integers.
+     *
+     * Base64 character set:
+     * [A-Z]      [a-z]      [0-9]      -     _
+     * 0x41-0x5a, 0x61-0x7a, 0x30-0x39, 0x2d, 0x5f
+     *
+     * @param int $src
+     * @return int
+     */
+    protected static function decode6Bits(int $src): int
+    {
+        $ret = -1;
+
+        // if ($src > 0x40 && $src < 0x5b) $ret += $src - 0x41 + 1; // -64
+        $ret += (((0x40 - $src) & ($src - 0x5b)) >> 8) & ($src - 64);
+
+        // if ($src > 0x60 && $src < 0x7b) $ret += $src - 0x61 + 26 + 1; // -70
+        $ret += (((0x60 - $src) & ($src - 0x7b)) >> 8) & ($src - 70);
+
+        // if ($src > 0x2f && $src < 0x3a) $ret += $src - 0x30 + 52 + 1; // 5
+        $ret += (((0x2f - $src) & ($src - 0x3a)) >> 8) & ($src + 5);
+
+        // if ($src == 0x2c) $ret += 62 + 1;
+        $ret += (((0x2c - $src) & ($src - 0x2e)) >> 8) & 63;
+
+        // if ($src == 0x5f) ret += 63 + 1;
+        $ret += (((0x5e - $src) & ($src - 0x60)) >> 8) & 64;
+
+        return $ret;
+    }
+
+    /**
+     * Uses bitwise operators instead of table-lookups to turn 8-bit integers
+     * into 6-bit integers.
+     *
+     * @param int $src
+     * @return string
+     */
+    protected static function encode6Bits(int $src): string
+    {
+        $diff = 0x41;
+
+        // if ($src > 25) $diff += 0x61 - 0x41 - 26; // 6
+        $diff += ((25 - $src) >> 8) & 6;
+
+        // if ($src > 51) $diff += 0x30 - 0x61 - 26; // -75
+        $diff -= ((51 - $src) >> 8) & 75;
+
+        // if ($src > 61) $diff += 0x2d - 0x30 - 10; // -13
+        $diff -= ((61 - $src) >> 8) & 13;
+
+        // if ($src > 62) $diff += 0x5f - 0x2b - 1; // 3
+        $diff += ((62 - $src) >> 8) & 49;
+
+        return \pack('C', $src + $diff);
+    }
+}

--- private/vendor/paragonie/constant_time_encoding/src/Binary.php ---
@@ -0,0 +1,90 @@
+<?php
+declare(strict_types=1);
+namespace ParagonIE\ConstantTime;
+
+use TypeError;
+
+/**
+ *  Copyright (c) 2016 - 2022 Paragon Initiative Enterprises.
+ *  Copyright (c) 2014 Steve "Sc00bz" Thomas (steve at tobtu dot com)
+ *
+ *  Permission is hereby granted, free of charge, to any person obtaining a copy
+ *  of this software and associated documentation files (the "Software"), to deal
+ *  in the Software without restriction, including without limitation the rights
+ *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ *  copies of the Software, and to permit persons to whom the Software is
+ *  furnished to do so, subject to the following conditions:
+ *
+ *  The above copyright notice and this permission notice shall be included in all
+ *  copies or substantial portions of the Software.
+ *
+ *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+ *  SOFTWARE.
+ */
+
+/**
+ * Class Binary
+ *
+ * Binary string operators that don't choke on
+ * mbstring.func_overload
+ *
+ * @package ParagonIE\ConstantTime
+ */
+abstract class Binary
+{
+    /**
+     * Safe string length
+     *
+     * @ref mbstring.func_overload
+     *
+     * @param string $str
+     * @return int
+     */
+    public static function safeStrlen(string $str): int
+    {
+        if (\function_exists('mb_strlen')) {
+            // mb_strlen in PHP 7.x can return false.
+            /** @psalm-suppress RedundantCast */
+            return (int) \mb_strlen($str, '8bit');
+        } else {
+            return \strlen($str);
+        }
+    }
+
+    /**
+     * Safe substring
+     *
+     * @ref mbstring.func_overload
+     *
+     * @staticvar boolean $exists
+     * @param string $str
+     * @param int $start
+     * @param ?int $length
+     * @return string
+     *
+     * @throws TypeError
+     */
+    public static function safeSubstr(
+        string $str,
+        int $start = 0,
+        $length = null
+    ): string {
+        if ($length === 0) {
+            return '';
+        }
+        if (\function_exists('mb_substr')) {
+            return \mb_substr($str, $start, $length, '8bit');
+        }
+        // Unlike mb_substr(), substr() doesn't accept NULL for length
+        if ($length !== null) {
+            return \substr($str, $start, $length);
+        } else {
+            return \substr($str, $start);
+        }
+    }
+}

--- private/vendor/paragonie/constant_time_encoding/src/EncoderInterface.php ---
@@ -0,0 +1,52 @@
+<?php
+declare(strict_types=1);
+namespace ParagonIE\ConstantTime;
+
+/**
+ *  Copyright (c) 2016 - 2022 Paragon Initiative Enterprises.
+ *  Copyright (c) 2014 Steve "Sc00bz" Thomas (steve at tobtu dot com)
+ *
+ *  Permission is hereby granted, free of charge, to any person obtaining a copy
+ *  of this software and associated documentation files (the "Software"), to deal
+ *  in the Software without restriction, including without limitation the rights
+ *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ *  copies of the Software, and to permit persons to whom the Software is
+ *  furnished to do so, subject to the following conditions:
+ *
+ *  The above copyright notice and this permission notice shall be included in all
+ *  copies or substantial portions of the Software.
+ *
+ *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+ *  SOFTWARE.
+ */
+
+/**
+ * Interface EncoderInterface
+ * @package ParagonIE\ConstantTime
+ */
+interface EncoderInterface
+{
+    /**
+     * Convert a binary string into a hexadecimal string without cache-timing
+     * leaks
+     *
+     * @param string $binString (raw binary)
+     * @return string
+     */
+    public static function encode(string $binString): string;
+
+    /**
+     * Convert a binary string into a hexadecimal string without cache-timing
+     * leaks
+     *
+     * @param string $encodedString
+     * @param bool $strictPadding Error on invalid padding
+     * @return string (raw binary)
+     */
+    public static function decode(string $encodedString, bool $strictPadding = false): string;
+}

--- private/vendor/paragonie/constant_time_encoding/src/Encoding.php ---
@@ -0,0 +1,262 @@
+<?php
+declare(strict_types=1);
+namespace ParagonIE\ConstantTime;
+
+use TypeError;
+
+/**
+ *  Copyright (c) 2016 - 2022 Paragon Initiative Enterprises.
+ *  Copyright (c) 2014 Steve "Sc00bz" Thomas (steve at tobtu dot com)
+ *
+ *  Permission is hereby granted, free of charge, to any person obtaining a copy
+ *  of this software and associated documentation files (the "Software"), to deal
+ *  in the Software without restriction, including without limitation the rights
+ *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ *  copies of the Software, and to permit persons to whom the Software is
+ *  furnished to do so, subject to the following conditions:
+ *
+ *  The above copyright notice and this permission notice shall be included in all
+ *  copies or substantial portions of the Software.
+ *
+ *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+ *  SOFTWARE.
+ */
+
+/**
+ * Class Encoding
+ * @package ParagonIE\ConstantTime
+ */
+abstract class Encoding
+{
+    /**
+     * RFC 4648 Base32 encoding
+     *
+     * @param string $str
+     * @return string
+     * @throws TypeError
+     */
+    public static function base32Encode(string $str): string
+    {
+        return Base32::encode($str);
+    }
+
+    /**
+     * RFC 4648 Base32 encoding
+     *
+     * @param string $str
+     * @return string
+     * @throws TypeError
+     */
+    public static function base32EncodeUpper(string $str): string
+    {
+        return Base32::encodeUpper($str);
+    }
+
+    /**
+     * RFC 4648 Base32 decoding
+     *
+     * @param string $str
+     * @return string
+     * @throws TypeError
+     */
+    public static function base32Decode(string $str): string
+    {
+        return Base32::decode($str);
+    }
+
+    /**
+     * RFC 4648 Base32 decoding
+     *
+     * @param string $str
+     * @return string
+     * @throws TypeError
+     */
+    public static function base32DecodeUpper(string $str): string
+    {
+        return Base32::decodeUpper($str);
+    }
+
+    /**
+     * RFC 4648 Base32 encoding
+     *
+     * @param string $str
+     * @return string
+     * @throws TypeError
+     */
+    public static function base32HexEncode(string $str): string
+    {
+        return Base32Hex::encode($str);
+    }
+
+    /**
+     * RFC 4648 Base32Hex encoding
+     *
+     * @param string $str
+     * @return string
+     * @throws TypeError
+     */
+    public static function base32HexEncodeUpper(string $str): string
+    {
+        return Base32Hex::encodeUpper($str);
+    }
+
+    /**
+     * RFC 4648 Base32Hex decoding
+     *
+     * @param string $str
+     * @return string
+     * @throws TypeError
+     */
+    public static function base32HexDecode(string $str): string
+    {
+        return Base32Hex::decode($str);
+    }
+
+    /**
+     * RFC 4648 Base32Hex decoding
+     *
+     * @param string $str
+     * @return string
+     * @throws TypeError
+     */
+    public static function base32HexDecodeUpper(string $str): string
+    {
+        return Base32Hex::decodeUpper($str);
+    }
+
+    /**
+     * RFC 4648 Base64 encoding
+     *
+     * @param string $str
+     * @return string
+     * @throws TypeError
+     */
+    public static function base64Encode(string $str): string
+    {
+        return Base64::encode($str);
+    }
+
+    /**
+     * RFC 4648 Base64 decoding
+     *
+     * @param string $str
+     * @return string
+     * @throws TypeError
+     */
+    public static function base64Decode(string $str): string
+    {
+        return Base64::decode($str);
+    }
+
+    /**
+     * Encode into Base64
+     *
+     * Base64 character set "./[A-Z][a-z][0-9]"
+     * @param string $str
+     * @return string
+     * @throws TypeError
+     */
+    public static function base64EncodeDotSlash(string $str): string
+    {
+        return Base64DotSlash::encode($str);
+    }
+
+    /**
+     * Decode from base64 to raw binary
+     *
+     * Base64 character set "./[A-Z][a-z][0-9]"
+     *
+     * @param string $str
+     * @return string
+     * @throws \RangeException
+     * @throws TypeError
+     */
+    public static function base64DecodeDotSlash(string $str): string
+    {
+        return Base64DotSlash::decode($str);
+    }
+
+    /**
+     * Encode into Base64
+     *
+     * Base64 character set "[.-9][A-Z][a-z]" or "./[0-9][A-Z][a-z]"
+     * @param string $str
+     * @return string
+     * @throws TypeError
+     */
+    public static function base64EncodeDotSlashOrdered(string $str): string
+    {
+        return Base64DotSlashOrdered::encode($str);
+    }
+
+    /**
+     * Decode from base64 to raw binary
+     *
+     * Base64 character set "[.-9][A-Z][a-z]" or "./[0-9][A-Z][a-z]"
+     *
+     * @param string $str
+     * @return string
+     * @throws \RangeException
+     * @throws TypeError
+     */
+    public static function base64DecodeDotSlashOrdered(string $str): string
+    {
+        return Base64DotSlashOrdered::decode($str);
+    }
+
+    /**
+     * Convert a binary string into a hexadecimal string without cache-timing
+     * leaks
+     *
+     * @param string $bin_string (raw binary)
+     * @return string
+     * @throws TypeError
+     */
+    public static function hexEncode(string $bin_string): string
+    {
+        return Hex::encode($bin_string);
+    }
+
+    /**
+     * Convert a hexadecimal string into a binary string without cache-timing
+     * leaks
+     *
+     * @param string $hex_string
+     * @return string (raw binary)
+     * @throws \RangeException
+     */
+    public static function hexDecode(string $hex_string): string
+    {
+        return Hex::decode($hex_string);
+    }
+
+    /**
+     * Convert a binary string into a hexadecimal string without cache-timing
+     * leaks
+     *
+     * @param string $bin_string (raw binary)
+     * @return string
+     * @throws TypeError
+     */
+    public static function hexEncodeUpper(string $bin_string): string
+    {
+        return Hex::encodeUpper($bin_string);
+    }
+
+    /**
+     * Convert a binary string into a hexadecimal string without cache-timing
+     * leaks
+     *
+     * @param string $bin_string (raw binary)
+     * @return string
+     */
+    public static function hexDecodeUpper(string $bin_string): string
+    {
+        return Hex::decode($bin_string);
+    }
+}

--- private/vendor/paragonie/constant_time_encoding/src/Hex.php ---
@@ -0,0 +1,146 @@
+<?php
+declare(strict_types=1);
+namespace ParagonIE\ConstantTime;
+
+use RangeException;
+use TypeError;
+
+/**
+ *  Copyright (c) 2016 - 2022 Paragon Initiative Enterprises.
+ *  Copyright (c) 2014 Steve "Sc00bz" Thomas (steve at tobtu dot com)
+ *
+ *  Permission is hereby granted, free of charge, to any person obtaining a copy
+ *  of this software and associated documentation files (the "Software"), to deal
+ *  in the Software without restriction, including without limitation the rights
+ *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ *  copies of the Software, and to permit persons to whom the Software is
+ *  furnished to do so, subject to the following conditions:
+ *
+ *  The above copyright notice and this permission notice shall be included in all
+ *  copies or substantial portions of the Software.
+ *
+ *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+ *  SOFTWARE.
+ */
+
+/**
+ * Class Hex
+ * @package ParagonIE\ConstantTime
+ */
+abstract class Hex implements EncoderInterface
+{
+    /**
+     * Convert a binary string into a hexadecimal string without cache-timing
+     * leaks
+     *
+     * @param string $binString (raw binary)
+     * @return string
+     * @throws TypeError
+     */
+    public static function encode(string $binString): string
+    {
+        $hex = '';
+        $len = Binary::safeStrlen($binString);
+        for ($i = 0; $i < $len; ++$i) {
+            /** @var array<int, int> $chunk */
+            $chunk = \unpack('C', $binString[$i]);
+            $c = $chunk[1] & 0xf;
+            $b = $chunk[1] >> 4;
+
+            $hex .= \pack(
+                'CC',
+                (87 + $b + ((($b - 10) >> 8) & ~38)),
+                (87 + $c + ((($c - 10) >> 8) & ~38))
+            );
+        }
+        return $hex;
+    }
+
+    /**
+     * Convert a binary string into a hexadecimal string without cache-timing
+     * leaks, returning uppercase letters (as per RFC 4648)
+     *
+     * @param string $binString (raw binary)
+     * @return string
+     * @throws TypeError
+     */
+    public static function encodeUpper(string $binString): string
+    {
+        $hex = '';
+        $len = Binary::safeStrlen($binString);
+
+        for ($i = 0; $i < $len; ++$i) {
+            /** @var array<int, int> $chunk */
+            $chunk = \unpack('C', $binString[$i]);
+            $c = $chunk[1] & 0xf;
+            $b = $chunk[1] >> 4;
+
+            $hex .= \pack(
+                'CC',
+                (55 + $b + ((($b - 10) >> 8) & ~6)),
+                (55 + $c + ((($c - 10) >> 8) & ~6))
+            );
+        }
+        return $hex;
+    }
+
+    /**
+     * Convert a hexadecimal string into a binary string without cache-timing
+     * leaks
+     *
+     * @param string $encodedString
+     * @param bool $strictPadding
+     * @return string (raw binary)
+     * @throws RangeException
+     */
+    public static function decode(
+        string $encodedString,
+        bool $strictPadding = false
+    ): string {
+        $hex_pos = 0;
+        $bin = '';
+        $c_acc = 0;
+        $hex_len = Binary::safeStrlen($encodedString);
+        $state = 0;
+        if (($hex_len & 1) !== 0) {
+            if ($strictPadding) {
+                throw new RangeException(
+                    'Expected an even number of hexadecimal characters'
+                );
+            } else {
+                $encodedString = '0' . $encodedString;
+                ++$hex_len;
+            }
+        }
+
+        /** @var array<int, int> $chunk */
+        $chunk = \unpack('C*', $encodedString);
+        while ($hex_pos < $hex_len) {
+            ++$hex_pos;
+            $c = $chunk[$hex_pos];
+            $c_num = $c ^ 48;
+            $c_num0 = ($c_num - 10) >> 8;
+            $c_alpha = ($c & ~32) - 55;
+            $c_alpha0 = (($c_alpha - 10) ^ ($c_alpha - 16)) >> 8;
+
+            if (($c_num0 | $c_alpha0) === 0) {
+                throw new RangeException(
+                    'Expected hexadecimal character'
+                );
+            }
+            $c_val = ($c_num0 & $c_num) | ($c_alpha & $c_alpha0);
+            if ($state === 0) {
+                $c_acc = $c_val * 16;
+            } else {
+                $bin .= \pack('C', $c_acc | $c_val);
+            }
+            $state ^= 1;
+        }
+        return $bin;
+    }
+}

--- private/vendor/paragonie/constant_time_encoding/src/RFC4648.php ---
@@ -0,0 +1,186 @@
+<?php
+declare(strict_types=1);
+namespace ParagonIE\ConstantTime;
+
+use TypeError;
+
+/**
+ *  Copyright (c) 2016 - 2022 Paragon Initiative Enterprises.
+ *  Copyright (c) 2014 Steve "Sc00bz" Thomas (steve at tobtu dot com)
+ *
+ *  Permission is hereby granted, free of charge, to any person obtaining a copy
+ *  of this software and associated documentation files (the "Software"), to deal
+ *  in the Software without restriction, including without limitation the rights
+ *  to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ *  copies of the Software, and to permit persons to whom the Software is
+ *  furnished to do so, subject to the following conditions:
+ *
+ *  The above copyright notice and this permission notice shall be included in all
+ *  copies or substantial portions of the Software.
+ *
+ *  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ *  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ *  FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ *  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ *  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ *  OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+ *  SOFTWARE.
+ */
+
+/**
+ * Class RFC4648
+ *
+ * This class conforms strictly to the RFC
+ *
+ * @package ParagonIE\ConstantTime
+ */
+abstract class RFC4648
+{
+    /**
+     * RFC 4648 Base64 encoding
+     *
+     * "foo" -> "Zm9v"
+     *
+     * @param string $str
+     * @return string
+     *
+     * @throws TypeError
+     */
+    public static function base64Encode(string $str): string
+    {
+        return Base64::encode($str);
+    }
+
+    /**
+     * RFC 4648 Base64 decoding
+     *
+     * "Zm9v" -> "foo"
+     *
+     * @param string $str
+     * @return string
+     *
+     * @throws TypeError
+     */
+    public static function base64Decode(string $str): string
+    {
+        return Base64::decode($str, true);
+    }
+
+    /**
+     * RFC 4648 Base64 (URL Safe) encoding
+     *
+     * "foo" -> "Zm9v"
+     *
+     * @param string $str
+     * @return string
+     *
+     * @throws TypeError
+     */
+    public static function base64UrlSafeEncode(string $str): string
+    {
+        return Base64UrlSafe::encode($str);
+    }
+
+    /**
+     * RFC 4648 Base64 (URL Safe) decoding
+     *
+     * "Zm9v" -> "foo"
+     *
+     * @param string $str
+     * @return string
+     *
+     * @throws TypeError
+     */
+    public static function base64UrlSafeDecode(string $str): string
+    {
+        return Base64UrlSafe::decode($str, true);
+    }
+
+    /**
+     * RFC 4648 Base32 encoding
+     *
+     * "foo" -> "MZXW6==="
+     *
+     * @param string $str
+     * @return string
+     *
+     * @throws TypeError
+     */
+    public static function base32Encode(string $str): string
+    {
+        return Base32::encodeUpper($str);
+    }
+
+    /**
+     * RFC 4648 Base32 encoding
+     *
+     * "MZXW6===" -> "foo"
+     *
+     * @param string $str
+     * @return string
+     *
+     * @throws TypeError
+     */
+    public static function base32Decode(string $str): string
+    {
+        return Base32::decodeUpper($str, true);
+    }
+
+    /**
+     * RFC 4648 Base32-Hex encoding
+     *
+     * "foo" -> "CPNMU==="
+     *
+     * @param string $str
+     * @return string
+     *
+     * @throws TypeError
+     */
+    public static function base32HexEncode(string $str): string
+    {
+        return Base32::encodeUpper($str);
+    }
+
+    /**
+     * RFC 4648 Base32-Hex decoding
+     *
+     * "CPNMU===" -> "foo"
+     *
+     * @param string $str
+     * @return string
+     *
+     * @throws TypeError
+     */
+    public static function base32HexDecode(string $str): string
+    {
+        return Base32::decodeUpper($str, true);
+    }
+
+    /**
+     * RFC 4648 Base16 decoding
+     *
+     * "foo" -> "666F6F"
+     *
+     * @param string $str
+     * @return string
+     *
+     * @throws TypeError
+     */
+    public static function base16Encode(string $str): string
+    {
+        return Hex::encodeUpper($str);
+    }
+
+    /**
+     * RFC 4648 Base16 decoding
+     *
+     * "666F6F" -> "foo"
+     *
+     * @param string $str
+     * @return string
+     */
+    public static function base16Decode(string $str): string
+    {
+        return Hex::decode($str, true);
+    }
+}
\ No newline at end of file

--- private/vendor/paragonie/random_compat/LICENSE ---
@@ -0,0 +1,22 @@
+The MIT License (MIT)
+
+Copyright (c) 2015 Paragon Initiative Enterprises
+
+Permission is hereby granted, free of charge, to any person obtaining a copy
+of this software and associated documentation files (the "Software"), to deal
+in the Software without restriction, including without limitation the rights
+to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+copies of the Software, and to permit persons to whom the Software is
+furnished to do so, subject to the following conditions:
+
+The above copyright notice and this permission notice shall be included in all
+copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+SOFTWARE.
+

--- private/vendor/paragonie/random_compat/build-phar.sh ---
@@ -0,0 +1,5 @@
+#!/usr/bin/env bash
+
+basedir=$( dirname $( readlink -f ${BASH_SOURCE[0]} ) )
+
+php -dphar.readonly=0 "$basedir/other/build_phar.php" $*
\ No newline at end of file

--- private/vendor/paragonie/random_compat/composer.json ---
@@ -0,0 +1,34 @@
+{
+  "name":         "paragonie/random_compat",
+  "description":  "PHP 5.x polyfill for random_bytes() and random_int() from PHP 7",
+  "keywords": [
+    "csprng",
+    "random",
+    "polyfill",
+    "pseudorandom"
+  ],
+  "license":      "MIT",
+  "type":         "library",
+  "authors": [
+    {
+      "name":     "Paragon Initiative Enterprises",
+      "email":    "security@paragonie.com",
+      "homepage": "https://paragonie.com"
+    }
+  ],
+  "support": {
+    "issues":     "https://github.com/paragonie/random_compat/issues",
+    "email":      "info@paragonie.com",
+    "source":     "https://github.com/paragonie/random_compat"
+  },
+  "require": {
+    "php": ">= 7"
+  },
+  "require-dev": {
+    "vimeo/psalm": "^1",
+    "phpunit/phpunit": "4.*|5.*"
+  },
+  "suggest": {
+    "ext-libsodium": "Provides a modern crypto API that can be used to generate random bytes."
+  }
+}

--- private/vendor/paragonie/random_compat/dist/random_compat.phar.pubkey ---
@@ -0,0 +1,5 @@
+-----BEGIN PUBLIC KEY-----
+MHYwEAYHKoZIzj0CAQYFK4EEACIDYgAEEd+wCqJDrx5B4OldM0dQE0ZMX+lx1ZWm
+pui0SUqD4G29L3NGsz9UhJ/0HjBdbnkhIK5xviT0X5vtjacF6ajgcCArbTB+ds+p
++h7Q084NuSuIpNb6YPfoUFgC/CL9kAoc
+-----END PUBLIC KEY-----

--- private/vendor/paragonie/random_compat/dist/random_compat.phar.pubkey.asc ---
@@ -0,0 +1,11 @@
+-----BEGIN PGP SIGNATURE-----
+Version: GnuPG v2.0.22 (MingW32)
+
+iQEcBAABAgAGBQJWtW1hAAoJEGuXocKCZATaJf0H+wbZGgskK1dcRTsuVJl9IWip
+QwGw/qIKI280SD6/ckoUMxKDCJiFuPR14zmqnS36k7N5UNPnpdTJTS8T11jttSpg
+1LCmgpbEIpgaTah+cELDqFCav99fS+bEiAL5lWDAHBTE/XPjGVCqeehyPYref4IW
+NDBIEsvnHPHPLsn6X5jq4+Yj5oUixgxaMPiR+bcO4Sh+RzOVB6i2D0upWfRXBFXA
+NNnsg9/zjvoC7ZW73y9uSH+dPJTt/Vgfeiv52/v41XliyzbUyLalf02GNPY+9goV
+JHG1ulEEBJOCiUD9cE1PUIJwHA/HqyhHIvV350YoEFiHl8iSwm7SiZu5kPjaq74=
+=B6+8
+-----END PGP SIGNATURE-----

--- private/vendor/paragonie/random_compat/lib/random.php ---
@@ -0,0 +1,32 @@
+<?php
+/**
+ * Random_* Compatibility Library
+ * for using the new PHP 7 random_* API in PHP 5 projects
+ *
+ * @version 2.99.99
+ * @released 2018-06-06
+ *
+ * The MIT License (MIT)
+ *
+ * Copyright (c) 2015 - 2018 Paragon Initiative Enterprises
+ *
+ * Permission is hereby granted, free of charge, to any person obtaining a copy
+ * of this software and associated documentation files (the "Software"), to deal
+ * in the Software without restriction, including without limitation the rights
+ * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
+ * copies of the Software, and to permit persons to whom the Software is
+ * furnished to do so, subject to the following conditions:
+ *
+ * The above copyright notice and this permission notice shall be included in
+ * all copies or substantial portions of the Software.
+ *
+ * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
+ * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
+ * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
+ * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
+ * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
+ * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
+ * SOFTWARE.
+ */
+
+// NOP

--- private/vendor/paragonie/random_compat/other/build_phar.php ---
@@ -0,0 +1,57 @@
+<?php
+$dist = dirname(__DIR__).'/dist';
+if (!is_dir($dist)) {
+    mkdir($dist, 0755);
+}
+if (file_exists($dist.'/random_compat.phar')) {
+    unlink($dist.'/random_compat.phar');
+}
+$phar = new Phar(
+    $dist.'/random_compat.phar',
+    FilesystemIterator::CURRENT_AS_FILEINFO | \FilesystemIterator::KEY_AS_FILENAME,
+    'random_compat.phar'
+);
+rename(
+    dirname(__DIR__).'/lib/random.php', 
+    dirname(__DIR__).'/lib/index.php'
+);
+$phar->buildFromDirectory(dirname(__DIR__).'/lib');
+rename(
+    dirname(__DIR__).'/lib/index.php', 
+    dirname(__DIR__).'/lib/random.php'
+);
+
+/**
+ * If we pass an (optional) path to a private key as a second argument, we will
+ * sign the Phar with OpenSSL.
+ * 
+ * If you leave this out, it will produce an unsigned .phar!
+ */
+if ($argc > 1) {
+    if (!@is_readable($argv[1])) {
+        echo 'Could not read the private key file:', $argv[1], "\n";
+        exit(255);
+    }
+    $pkeyFile = file_get_contents($argv[1]);
+    
+    $private = openssl_get_privatekey($pkeyFile);
+    if ($private !== false) {
+        $pkey = '';
+        openssl_pkey_export($private, $pkey);
+        $phar->setSignatureAlgorithm(Phar::OPENSSL, $pkey);
+        
+        /**
+         * Save the corresponding public key to the file
+         */
+        if (!@is_readable($dist.'/random_compat.phar.pubkey')) {
+            $details = openssl_pkey_get_details($private);
+            file_put_contents(
+                $dist.'/random_compat.phar.pubkey',
+                $details['key']
+            );
+        }
+    } else {
+        echo 'An error occurred reading the private key from OpenSSL.', "\n";
+        exit(255);
+    }
+}

--- private/vendor/paragonie/random_compat/psalm-autoload.php ---
@@ -0,0 +1,9 @@
+<?php
+
+require_once 'lib/byte_safe_strings.php';
+require_once 'lib/cast_to_int.php';
+require_once 'lib/error_polyfill.php';
+require_once 'other/ide_stubs/libsodium.php';
+require_once 'lib/random.php';
+
+$int = random_int(0, 65536);

--- private/vendor/paragonie/random_compat/psalm.xml ---
@@ -0,0 +1,19 @@
+<?xml version="1.0"?>
+<psalm
+    autoloader="psalm-autoload.php"
+    stopOnFirstError="false"
+    useDocblockTypes="true"
+>
+    <projectFiles>
+        <directory name="lib" />
+    </projectFiles>
+    <issueHandlers>
+        <RedundantConditionGivenDocblockType errorLevel="info" />
+        <UnresolvableInclude errorLevel="info" />
+        <DuplicateClass errorLevel="info" />
+        <InvalidOperand errorLevel="info" />
+        <UndefinedConstant errorLevel="info" />
+        <MissingReturnType errorLevel="info" />
+        <InvalidReturnType errorLevel="info" />
+    </issueHandlers>
+</psalm>

--- private/vendor/phpseclib/phpseclib/AUTHORS ---
@@ -0,0 +1,7 @@
+phpseclib Lead Developer:  TerraFrost (Jim Wigginton)
+
+phpseclib Developers:      monnerat (Patrick Monnerat)
+                           bantu (Andreas Fischer)
+                           petrich (Hans-Jürgen Petrich)
+                           GrahamCampbell (Graham Campbell)
+                           hc-jworman
\ No newline at end of file

--- private/vendor/phpseclib/phpseclib/BACKERS.md ---
@@ -0,0 +1,17 @@
+# Backers
+
+phpseclib ongoing development is made possible by [Tidelift](https://tidelift.com/subscription/pkg/packagist-phpseclib-phpseclib?utm_source=packagist-phpseclib-phpseclib&utm_medium=referral&utm_campaign=readme) and by contributions by users like you. Thank you.
+
+## Backers
+
+- Allan Simon
+- [ChargeOver](https://chargeover.com/)
+- Raghu Veer Dendukuri
+- Zane Hooper
+- [Setasign](https://www.setasign.com/)
+- [Charles Severance](https://github.com/csev)
+- [Rachel Fish](https://github.com/itsrachelfish)
+- Tharyrok
+- [cjhaas](https://github.com/cjhaas)
+- [istiak-tridip](https://github.com/istiak-tridip)
+- [Anna Filina](https://github.com/afilina)
\ No newline at end of file

--- private/vendor/phpseclib/phpseclib/LICENSE ---
@@ -0,0 +1,20 @@
+Copyright (c) 2011-2019 TerraFrost and other contributors
+
+Permission is hereby granted, free of charge, to any person obtaining
+a copy of this software and associated documentation files (the
+"Software"), to deal in the Software without restriction, including
+without limitation the rights to use, copy, modify, merge, publish,
+distribute, sublicense, and/or sell copies of the Software, and to
+permit persons to whom the Software is furnished to do so, subject to
+the following conditions:
+
+The above copyright notice and this permission notice shall be
+included in all copies or substantial portions of the Software.
+
+THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
+EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF
+MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
+NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE
+LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION
+OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION
+WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.
\ No newline at end of file

--- private/vendor/phpseclib/phpseclib/README.md ---
@@ -0,0 +1,97 @@
+# phpseclib - PHP Secure Communications Library
+
+[![CI Status](https://github.com/phpseclib/phpseclib/actions/workflows/ci.yml/badge.svg?branch=3.0&event=push "CI Status")](https://github.com/phpseclib/phpseclib)
+
+## Supporting phpseclib
+
+- [Become a backer or sponsor on Patreon](https://www.patreon.com/phpseclib)
+- [One-time donation via PayPal or crypto-currencies](http://sourceforge.net/donate/index.php?group_id=198487)
+- [Subscribe to Tidelift](https://tidelift.com/subscription/pkg/packagist-phpseclib-phpseclib?utm_source=packagist-phpseclib-phpseclib&utm_medium=referral&utm_campaign=readme)
+
+## Introduction
+
+MIT-licensed pure-PHP implementations of the following:
+
+SSH-2, SFTP, X.509, an arbitrary-precision integer arithmetic library, Ed25519 / Ed449 / Curve25519 / Curve449, ECDSA / ECDH (with support for 66 curves), RSA (PKCS#1 v2.2 compliant), DSA / DH, DES / 3DES / RC4 / Rijndael / AES / Blowfish / Twofish / Salsa20 / ChaCha20, GCM / Poly1305
+
+* [Browse Git](https://github.com/phpseclib/phpseclib)
+
+## Documentation
+
+* [Documentation / Manual](https://phpseclib.com/)
+* [API Documentation](https://api.phpseclib.com/3.0/) (generated by Doctum)
+
+## Branches
+
+### master
+
+* Development Branch
+* Unstable API
+* Do not use in production
+
+### 3.0
+
+* Long term support (LTS) release
+* Major expansion of cryptographic primitives
+* Minimum PHP version: 5.6.1
+* PSR-4 autoloading with namespace rooted at `\phpseclib3`
+* Install via Composer: `composer require phpseclib/phpseclib:~3.0`
+
+### 2.0
+
+* Long term support (LTS) release
+* Modernized version of 1.0
+* Minimum PHP version: 5.3.3
+* PSR-4 autoloading with namespace rooted at `\phpseclib`
+* Install via Composer: `composer require phpseclib/phpseclib:~2.0`
+
+### 1.0
+
+* Long term support (LTS) release
+* PHP4 compatible
+* Composer compatible (PSR-0 autoloading)
+* Install using Composer: `composer require phpseclib/phpseclib:~1.0`
+* [Download 1.0.23 as ZIP](http://sourceforge.net/projects/phpseclib/files/phpseclib1.0.23.zip/download)
+
+## Security contact information
+
+To report a security vulnerability, please use the [Tidelift security contact](https://tidelift.com/security). Tidelift will coordinate the fix and disclosure.
+
+## Support
+
+Need Support?
+
+* [Checkout Questions and Answers on Stack Overflow](http://stackoverflow.com/questions/tagged/phpseclib)
+* [Create a Support Ticket on GitHub](https://github.com/phpseclib/phpseclib/issues/new)
+* [Browse the Support Forum](http://www.frostjedi.com/phpbb/viewforum.php?f=46) (no longer in use)
+
+## Special Thanks
+
+Special Thanks to our $50+ sponsors!:
+
+- Allan Simon
+- [ChargeOver](https://chargeover.com/)
+
+## Contributing
+
+1. Fork the Project
+
+2. Ensure you have Composer installed (see [Composer Download Instructions](https://getcomposer.org/download/))
+
+3. Install Development Dependencies
+    ```sh
+    composer install
+    ```
+
+4. Create a Feature Branch
+
+5. Run continuous integration checks:
+   ```sh
+   composer global require php:^8.1 squizlabs/php_codesniffer friendsofphp/php-cs-fixer vimeo/psalm
+   phpcs --standard=build/php_codesniffer.xml
+   php-cs-fixer fix --config=build/php-cs-fixer.php --diff --dry-run --using-cache=no
+   psalm --config=build/psalm.xml --no-cache --long-progress --report-show-info=false --output-format=text
+   vendor/bin/phpunit --verbose --configuration tests/phpunit.xml
+   ```
+   
+6. Send us a Pull Request

--- private/vendor/phpseclib/phpseclib/composer.json ---
@@ -0,0 +1,84 @@
+{
+    "name": "phpseclib/phpseclib",
+    "type": "library",
+    "description": "PHP Secure Communications Library - Pure-PHP implementations of RSA, AES, SSH2, SFTP, X.509 etc.",
+    "keywords": [
+        "security",
+        "crypto",
+        "cryptography",
+        "encryption",
+        "signature",
+        "signing",
+        "rsa",
+        "aes",
+        "blowfish",
+        "twofish",
+        "ssh",
+        "sftp",
+        "x509",
+        "x.509",
+        "asn1",
+        "asn.1",
+        "BigInteger"
+        ],
+    "homepage": "http://phpseclib.sourceforge.net",
+    "license": "MIT",
+    "authors": [
+        {
+            "name": "Jim Wigginton",
+            "email": "terrafrost@php.net",
+            "role": "Lead Developer"
+        },
+        {
+            "name": "Patrick Monnerat",
+            "email": "pm@datasphere.ch",
+            "role": "Developer"
+        },
+        {
+            "name": "Andreas Fischer",
+            "email": "bantu@phpbb.com",
+            "role": "Developer"
+        },
+        {
+            "name": "Hans-Jürgen Petrich",
+            "email": "petrich@tronic-media.com",
+            "role": "Developer"
+        },
+        {
+            "name": "Graham Campbell",
+            "email": "graham@alt-three.com",
+            "role": "Developer"
+        }
+    ],
+    "require": {
+        "php": ">=5.6.1",
+        "paragonie/constant_time_encoding": "^1|^2",
+        "paragonie/random_compat": "^1.4|^2.0|^9.99.99"
+    },
+    "require-dev": {
+        "phpunit/phpunit": "*"
+    },
+    "suggest": {
+        "ext-libsodium": "SSH2/SFTP can make use of some algorithms provided by the libsodium-php extension.",
+        "ext-openssl": "Install the OpenSSL extension in order to speed up a wide variety of cryptographic operations.",
+        "ext-mcrypt": "Install the Mcrypt extension in order to speed up a few other cryptographic operations.",
+        "ext-gmp": "Install the GMP (GNU Multiple Precision) extension in order to speed up arbitrary precision integer arithmetic operations.",
+        "ext-dom": "Install the DOM extension to load XML formatted public keys."
+    },
+    "autoload": {
+        "files": [
+            "phpseclib/bootstrap.php"
+        ],
+        "psr-4": {
+            "phpseclib3\\": "phpseclib/"
+        }
+    },
+    "autoload-dev": {
+        "psr-4": {
+            "phpseclib3\\Tests\\": "tests/"
+        }
+    },
+    "config": {
+        "sort-packages": true
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Common/Functions/Strings.php ---
@@ -0,0 +1,505 @@
+<?php
+
+/**
+ * Common String Functions
+ *
+ * PHP version 5
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2016 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Common\Functions;
+
+use ParagonIE\ConstantTime\Base64;
+use ParagonIE\ConstantTime\Base64UrlSafe;
+use ParagonIE\ConstantTime\Hex;
+use phpseclib3\Math\BigInteger;
+use phpseclib3\Math\Common\FiniteField;
+
+/**
+ * Common String Functions
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class Strings
+{
+    /**
+     * String Shift
+     *
+     * Inspired by array_shift
+     *
+     * @param string $string
+     * @param int $index
+     * @return string
+     */
+    public static function shift(&$string, $index = 1)
+    {
+        $substr = substr($string, 0, $index);
+        $string = substr($string, $index);
+        return $substr;
+    }
+
+    /**
+     * String Pop
+     *
+     * Inspired by array_pop
+     *
+     * @param string $string
+     * @param int $index
+     * @return string
+     */
+    public static function pop(&$string, $index = 1)
+    {
+        $substr = substr($string, -$index);
+        $string = substr($string, 0, -$index);
+        return $substr;
+    }
+
+    /**
+     * Parse SSH2-style string
+     *
+     * Returns either an array or a boolean if $data is malformed.
+     *
+     * Valid characters for $format are as follows:
+     *
+     * C = byte
+     * b = boolean (true/false)
+     * N = uint32
+     * Q = uint64
+     * s = string
+     * i = mpint
+     * L = name-list
+     *
+     * uint64 is not supported.
+     *
+     * @param string $format
+     * @param string $data
+     * @return mixed
+     */
+    public static function unpackSSH2($format, &$data)
+    {
+        $format = self::formatPack($format);
+        $result = [];
+        for ($i = 0; $i < strlen($format); $i++) {
+            switch ($format[$i]) {
+                case 'C':
+                case 'b':
+                    if (!strlen($data)) {
+                        throw new \LengthException('At least one byte needs to be present for successful C / b decodes');
+                    }
+                    break;
+                case 'N':
+                case 'i':
+                case 's':
+                case 'L':
+                    if (strlen($data) < 4) {
+                        throw new \LengthException('At least four byte needs to be present for successful N / i / s / L decodes');
+                    }
+                    break;
+                case 'Q':
+                    if (strlen($data) < 8) {
+                        throw new \LengthException('At least eight byte needs to be present for successful N / i / s / L decodes');
+                    }
+                    break;
+
+                default:
+                    throw new \InvalidArgumentException('$format contains an invalid character');
+            }
+            switch ($format[$i]) {
+                case 'C':
+                    $result[] = ord(self::shift($data));
+                    continue 2;
+                case 'b':
+                    $result[] = ord(self::shift($data)) != 0;
+                    continue 2;
+                case 'N':
+                    list(, $temp) = unpack('N', self::shift($data, 4));
+                    $result[] = $temp;
+                    continue 2;
+                case 'Q':
+                    // pack() added support for Q in PHP 5.6.3 and PHP 5.6 is phpseclib 3's minimum version
+                    // so in theory we could support this BUT, "64-bit format codes are not available for
+                    // 32-bit versions" and phpseclib works on 32-bit installs. on 32-bit installs
+                    // 64-bit floats can be used to get larger numbers then 32-bit signed ints would allow
+                    // for. sure, you're not gonna get the full precision of 64-bit numbers but just because
+                    // you need > 32-bit precision doesn't mean you need the full 64-bit precision
+                    extract(unpack('Nupper/Nlower', self::shift($data, 8)));
+                    $temp = $upper ? 4294967296 * $upper : 0;
+                    $temp += $lower < 0 ? ($lower & 0x7FFFFFFFF) + 0x80000000 : $lower;
+                    // $temp = hexdec(bin2hex(self::shift($data, 8)));
+                    $result[] = $temp;
+                    continue 2;
+            }
+            list(, $length) = unpack('N', self::shift($data, 4));
+            if (strlen($data) < $length) {
+                throw new \LengthException("$length bytes needed; " . strlen($data) . ' bytes available');
+            }
+            $temp = self::shift($data, $length);
+            switch ($format[$i]) {
+                case 'i':
+                    $result[] = new BigInteger($temp, -256);
+                    break;
+                case 's':
+                    $result[] = $temp;
+                    break;
+                case 'L':
+                    $result[] = explode(',', $temp);
+            }
+        }
+
+        return $result;
+    }
+
+    /**
+     * Create SSH2-style string
+     *
+     * @param string $format
+     * @param string|int|float|array|bool ...$elements
+     * @return string
+     */
+    public static function packSSH2($format, ...$elements)
+    {
+        $format = self::formatPack($format);
+        if (strlen($format) != count($elements)) {
+            throw new \InvalidArgumentException('There must be as many arguments as there are characters in the $format string');
+        }
+        $result = '';
+        for ($i = 0; $i < strlen($format); $i++) {
+            $element = $elements[$i];
+            switch ($format[$i]) {
+                case 'C':
+                    if (!is_int($element)) {
+                        throw new \InvalidArgumentException('Bytes must be represented as an integer between 0 and 255, inclusive.');
+                    }
+                    $result .= pack('C', $element);
+                    break;
+                case 'b':
+                    if (!is_bool($element)) {
+                        throw new \InvalidArgumentException('A boolean parameter was expected.');
+                    }
+                    $result .= $element ? "\1" : "\0";
+                    break;
+                case 'Q':
+                    if (!is_int($element) && !is_float($element)) {
+                        throw new \InvalidArgumentException('An integer was expected.');
+                    }
+                    // 4294967296 == 1 << 32
+                    $result .= pack('NN', $element / 4294967296, $element);
+                    break;
+                case 'N':
+                    if (is_float($element)) {
+                        $element = (int) $element;
+                    }
+                    if (!is_int($element)) {
+                        throw new \InvalidArgumentException('An integer was expected.');
+                    }
+                    $result .= pack('N', $element);
+                    break;
+                case 's':
+                    if (!self::is_stringable($element)) {
+                        throw new \InvalidArgumentException('A string was expected.');
+                    }
+                    $result .= pack('Na*', strlen($element), $element);
+                    break;
+                case 'i':
+                    if (!$element instanceof BigInteger && !$element instanceof FiniteField\Integer) {
+                        throw new \InvalidArgumentException('A phpseclib3\Math\BigInteger or phpseclib3\Math\Common\FiniteField\Integer object was expected.');
+                    }
+                    $element = $element->toBytes(true);
+                    $result .= pack('Na*', strlen($element), $element);
+                    break;
+                case 'L':
+                    if (!is_array($element)) {
+                        throw new \InvalidArgumentException('An array was expected.');
+                    }
+                    $element = implode(',', $element);
+                    $result .= pack('Na*', strlen($element), $element);
+                    break;
+                default:
+                    throw new \InvalidArgumentException('$format contains an invalid character');
+            }
+        }
+        return $result;
+    }
+
+    /**
+     * Expand a pack string
+     *
+     * Converts C5 to CCCCC, for example.
+     *
+     * @param string $format
+     * @return string
+     */
+    private static function formatPack($format)
+    {
+        $parts = preg_split('#(\d+)#', $format, -1, PREG_SPLIT_DELIM_CAPTURE);
+        $format = '';
+        for ($i = 1; $i < count($parts); $i += 2) {
+            $format .= substr($parts[$i - 1], 0, -1) . str_repeat(substr($parts[$i - 1], -1), $parts[$i]);
+        }
+        $format .= $parts[$i - 1];
+
+        return $format;
+    }
+
+    /**
+     * Convert binary data into bits
+     *
+     * bin2hex / hex2bin refer to base-256 encoded data as binary, whilst
+     * decbin / bindec refer to base-2 encoded data as binary. For the purposes
+     * of this function, bin refers to base-256 encoded data whilst bits refers
+     * to base-2 encoded data
+     *
+     * @param string $x
+     * @return string
+     */
+    public static function bits2bin($x)
+    {
+        /*
+        // the pure-PHP approach is faster than the GMP approach
+        if (function_exists('gmp_export')) {
+             return strlen($x) ? gmp_export(gmp_init($x, 2)) : gmp_init(0);
+        }
+        */
+
+        if (preg_match('#[^01]#', $x)) {
+            throw new \RuntimeException('The only valid characters are 0 and 1');
+        }
+
+        if (!defined('PHP_INT_MIN')) {
+            define('PHP_INT_MIN', ~PHP_INT_MAX);
+        }
+
+        $length = strlen($x);
+        if (!$length) {
+            return '';
+        }
+        $block_size = PHP_INT_SIZE << 3;
+        $pad = $block_size - ($length % $block_size);
+        if ($pad != $block_size) {
+            $x = str_repeat('0', $pad) . $x;
+        }
+
+        $parts = str_split($x, $block_size);
+        $str = '';
+        foreach ($parts as $part) {
+            $xor = $part[0] == '1' ? PHP_INT_MIN : 0;
+            $part[0] = '0';
+            $str .= pack(
+                PHP_INT_SIZE == 4 ? 'N' : 'J',
+                $xor ^ eval('return 0b' . $part . ';')
+            );
+        }
+        return ltrim($str, "\0");
+    }
+
+    /**
+     * Convert bits to binary data
+     *
+     * @param string $x
+     * @return string
+     */
+    public static function bin2bits($x, $trim = true)
+    {
+        /*
+        // the pure-PHP approach is slower than the GMP approach BUT
+        // i want to the pure-PHP version to be easily unit tested as well
+        if (function_exists('gmp_import')) {
+            return gmp_strval(gmp_import($x), 2);
+        }
+        */
+
+        $len = strlen($x);
+        $mod = $len % PHP_INT_SIZE;
+        if ($mod) {
+            $x = str_pad($x, $len + PHP_INT_SIZE - $mod, "\0", STR_PAD_LEFT);
+        }
+
+        $bits = '';
+        if (PHP_INT_SIZE == 4) {
+            $digits = unpack('N*', $x);
+            foreach ($digits as $digit) {
+                $bits .= sprintf('%032b', $digit);
+            }
+        } else {
+            $digits = unpack('J*', $x);
+            foreach ($digits as $digit) {
+                $bits .= sprintf('%064b', $digit);
+            }
+        }
+
+        return $trim ? ltrim($bits, '0') : $bits;
+    }
+
+    /**
+     * Switch Endianness Bit Order
+     *
+     * @param string $x
+     * @return string
+     */
+    public static function switchEndianness($x)
+    {
+        $r = '';
+        for ($i = strlen($x) - 1; $i >= 0; $i--) {
+            $b = ord($x[$i]);
+            if (PHP_INT_SIZE === 8) {
+                // 3 operations
+                // from http://graphics.stanford.edu/~seander/bithacks.html#ReverseByteWith64BitsDiv
+                $r .= chr((($b * 0x0202020202) & 0x010884422010) % 1023);
+            } else {
+                // 7 operations
+                // from http://graphics.stanford.edu/~seander/bithacks.html#ReverseByteWith32Bits
+                $p1 = ($b * 0x0802) & 0x22110;
+                $p2 = ($b * 0x8020) & 0x88440;
+                $r .= chr(
+                    (($p1 | $p2) * 0x10101) >> 16
+                );
+            }
+        }
+        return $r;
+    }
+
+    /**
+     * Increment the current string
+     *
+     * @param string $var
+     * @return string
+     */
+    public static function increment_str(&$var)
+    {
+        if (function_exists('sodium_increment')) {
+            $var = strrev($var);
+            sodium_increment($var);
+            $var = strrev($var);
+            return $var;
+        }
+
+        for ($i = 4; $i <= strlen($var); $i += 4) {
+            $temp = substr($var, -$i, 4);
+            switch ($temp) {
+                case "\xFF\xFF\xFF\xFF":
+                    $var = substr_replace($var, "\x00\x00\x00\x00", -$i, 4);
+                    break;
+                case "\x7F\xFF\xFF\xFF":
+                    $var = substr_replace($var, "\x80\x00\x00\x00", -$i, 4);
+                    return $var;
+                default:
+                    $temp = unpack('Nnum', $temp);
+                    $var = substr_replace($var, pack('N', $temp['num'] + 1), -$i, 4);
+                    return $var;
+            }
+        }
+
+        $remainder = strlen($var) % 4;
+
+        if ($remainder == 0) {
+            return $var;
+        }
+
+        $temp = unpack('Nnum', str_pad(substr($var, 0, $remainder), 4, "\0", STR_PAD_LEFT));
+        $temp = substr(pack('N', $temp['num'] + 1), -$remainder);
+        $var = substr_replace($var, $temp, 0, $remainder);
+
+        return $var;
+    }
+
+    /**
+     * Find whether the type of a variable is string (or could be converted to one)
+     *
+     * @param mixed $var
+     * @return bool
+     * @psalm-assert-if-true string|\Stringable $var
+     */
+    public static function is_stringable($var)
+    {
+        return is_string($var) || (is_object($var) && method_exists($var, '__toString'));
+    }
+
+    /**
+     * Constant Time Base64-decoding
+     *
+     * ParagoneIE\ConstantTime doesn't use libsodium if it's available so we'll do so
+     * ourselves. see https://github.com/paragonie/constant_time_encoding/issues/39
+     *
+     * @param string $data
+     * @return string
+     */
+    public static function base64_decode($data)
+    {
+        return function_exists('sodium_base642bin') ?
+            sodium_base642bin($data, SODIUM_BASE64_VARIANT_ORIGINAL_NO_PADDING, '=') :
+            Base64::decode($data);
+    }
+
+    /**
+     * Constant Time Base64-decoding (URL safe)
+     *
+     * @param string $data
+     * @return string
+     */
+    public static function base64url_decode($data)
+    {
+        // return self::base64_decode(str_replace(['-', '_'], ['+', '/'], $data));
+
+        return function_exists('sodium_base642bin') ?
+            sodium_base642bin($data, SODIUM_BASE64_VARIANT_URLSAFE_NO_PADDING, '=') :
+            Base64UrlSafe::decode($data);
+    }
+
+    /**
+     * Constant Time Base64-encoding
+     *
+     * @param string $data
+     * @return string
+     */
+    public static function base64_encode($data)
+    {
+        return function_exists('sodium_bin2base64') ?
+            sodium_bin2base64($data, SODIUM_BASE64_VARIANT_ORIGINAL) :
+            Base64::encode($data);
+    }
+
+    /**
+     * Constant Time Base64-encoding (URL safe)
+     *
+     * @param string $data
+     * @return string
+     */
+    public static function base64url_encode($data)
+    {
+        // return str_replace(['+', '/'], ['-', '_'], self::base64_encode($data));
+
+        return function_exists('sodium_bin2base64') ?
+            sodium_bin2base64($data, SODIUM_BASE64_VARIANT_URLSAFE) :
+            Base64UrlSafe::encode($data);
+    }
+
+    /**
+     * Constant Time Hex Decoder
+     *
+     * @param string $data
+     * @return string
+     */
+    public static function hex2bin($data)
+    {
+        return function_exists('sodium_hex2bin') ?
+            sodium_hex2bin($data) :
+            Hex::decode($data);
+    }
+
+    /**
+     * Constant Time Hex Encoder
+     *
+     * @param string $data
+     * @return string
+     */
+    public static function bin2hex($data)
+    {
+        return function_exists('sodium_bin2hex') ?
+            sodium_bin2hex($data) :
+            Hex::encode($data);
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/AES.php ---
@@ -0,0 +1,116 @@
+<?php
+
+/**
+ * Pure-PHP implementation of AES.
+ *
+ * Uses mcrypt, if available/possible, and an internal implementation, otherwise.
+ *
+ * PHP version 5
+ *
+ * NOTE: Since AES.php is (for compatibility and phpseclib-historical reasons) virtually
+ * just a wrapper to Rijndael.php you may consider using Rijndael.php instead of
+ * to save one include_once().
+ *
+ * If {@link self::setKeyLength() setKeyLength()} isn't called, it'll be calculated from
+ * {@link self::setKey() setKey()}.  ie. if the key is 128-bits, the key length will be 128-bits.  If it's 136-bits
+ * it'll be null-padded to 192-bits and 192 bits will be the key length until {@link self::setKey() setKey()}
+ * is called, again, at which point, it'll be recalculated.
+ *
+ * Since \phpseclib3\Crypt\AES extends \phpseclib3\Crypt\Rijndael, some functions are available to be called that, in the context of AES, don't
+ * make a whole lot of sense.  {@link self::setBlockLength() setBlockLength()}, for instance.  Calling that function,
+ * however possible, won't do anything (AES has a fixed block length whereas Rijndael has a variable one).
+ *
+ * Here's a short example of how to use this library:
+ * <code>
+ * <?php
+ *    include 'vendor/autoload.php';
+ *
+ *    $aes = new \phpseclib3\Crypt\AES('ctr');
+ *
+ *    $aes->setKey('abcdefghijklmnop');
+ *
+ *    $size = 10 * 1024;
+ *    $plaintext = '';
+ *    for ($i = 0; $i < $size; $i++) {
+ *        $plaintext.= 'a';
+ *    }
+ *
+ *    echo $aes->decrypt($aes->encrypt($plaintext));
+ * ?>
+ * </code>
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2008 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt;
+
+/**
+ * Pure-PHP implementation of AES.
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+class AES extends Rijndael
+{
+    /**
+     * Dummy function
+     *
+     * Since \phpseclib3\Crypt\AES extends \phpseclib3\Crypt\Rijndael, this function is, technically, available, but it doesn't do anything.
+     *
+     * @see \phpseclib3\Crypt\Rijndael::setBlockLength()
+     * @param int $length
+     * @throws \BadMethodCallException anytime it's called
+     */
+    public function setBlockLength($length)
+    {
+        throw new \BadMethodCallException('The block length cannot be set for AES.');
+    }
+
+    /**
+     * Sets the key length
+     *
+     * Valid key lengths are 128, 192, and 256.  Set the link to bool(false) to disable a fixed key length
+     *
+     * @see \phpseclib3\Crypt\Rijndael:setKeyLength()
+     * @param int $length
+     * @throws \LengthException if the key length isn't supported
+     */
+    public function setKeyLength($length)
+    {
+        switch ($length) {
+            case 128:
+            case 192:
+            case 256:
+                break;
+            default:
+                throw new \LengthException('Key of size ' . $length . ' not supported by this algorithm. Only keys of sizes 128, 192 or 256 supported');
+        }
+        parent::setKeyLength($length);
+    }
+
+    /**
+     * Sets the key.
+     *
+     * Rijndael supports five different key lengths, AES only supports three.
+     *
+     * @see \phpseclib3\Crypt\Rijndael:setKey()
+     * @see setKeyLength()
+     * @param string $key
+     * @throws \LengthException if the key length isn't supported
+     */
+    public function setKey($key)
+    {
+        switch (strlen($key)) {
+            case 16:
+            case 24:
+            case 32:
+                break;
+            default:
+                throw new \LengthException('Key of size ' . strlen($key) . ' not supported by this algorithm. Only keys of sizes 16, 24 or 32 supported');
+        }
+
+        parent::setKey($key);
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Blowfish.php ---
@@ -0,0 +1,918 @@
+<?php
+
+/**
+ * Pure-PHP implementation of Blowfish.
+ *
+ * Uses mcrypt, if available, and an internal implementation, otherwise.
+ *
+ * PHP version 5
+ *
+ * Useful resources are as follows:
+ *
+ *  - {@link http://en.wikipedia.org/wiki/Blowfish_(cipher) Wikipedia description of Blowfish}
+ *
+ * # An overview of bcrypt vs Blowfish
+ *
+ * OpenSSH private keys use a customized version of bcrypt. Specifically, instead of
+ * encrypting OrpheanBeholderScryDoubt 64 times OpenSSH's bcrypt variant encrypts
+ * OxychromaticBlowfishSwatDynamite 64 times. so we can't use crypt().
+ *
+ * bcrypt is basically Blowfish but instead of performing the key expansion once it performs
+ * the expansion 129 times for each round, with the first key expansion interleaving the salt
+ * and password. This renders OpenSSL unusable and forces us to use a pure-PHP implementation
+ * of blowfish.
+ *
+ * # phpseclib's four different _encryptBlock() implementations
+ *
+ * When using Blowfish as an encryption algorithm, _encryptBlock() is called 9 + 512 +
+ * (the number of blocks in the plaintext) times.
+ *
+ * Each of the first 9 calls to _encryptBlock() modify the P-array. Each of the next 512
+ * calls modify the S-boxes. The remaining _encryptBlock() calls operate on the plaintext to
+ * produce the ciphertext. In the pure-PHP implementation of Blowfish these remaining
+ * _encryptBlock() calls are highly optimized through the use of eval(). Among other things,
+ * P-array lookups are eliminated by hard-coding the key-dependent P-array values, and thus we
+ * have explained 2 of the 4 different _encryptBlock() implementations.
+ *
+ * With bcrypt things are a bit different. _encryptBlock() is called 1,079,296 times,
+ * assuming 16 rounds (which is what OpenSSH's bcrypt defaults to). The eval()-optimized
+ * _encryptBlock() isn't as beneficial because the P-array values are not constant. Well, they
+ * are constant, but only for, at most, 777 _encryptBlock() calls, which is equivalent to ~6KB
+ * of data. The average length of back to back _encryptBlock() calls with a fixed P-array is
+ * 514.12, which is ~4KB of data. Creating an eval()-optimized _encryptBlock() has an upfront
+ * cost, which is CPU dependent and is probably not going to be worth it for just ~4KB of
+ * data. Conseqeuently, bcrypt does not benefit from the eval()-optimized _encryptBlock().
+ *
+ * The regular _encryptBlock() does unpack() and pack() on every call, as well, and that can
+ * begin to add up after one million function calls.
+ *
+ * In theory, one might think that it might be beneficial to rewrite all block ciphers so
+ * that, instead of passing strings to _encryptBlock(), you convert the string to an array of
+ * integers and then pass successive subarrays of that array to _encryptBlock. This, however,
+ * kills PHP's memory use. Like let's say you have a 1MB long string. After doing
+ * $in = str_repeat('a', 1024 * 1024); PHP's memory utilization jumps up by ~1MB. After doing
+ * $blocks = str_split($in, 4); it jumps up by an additional ~16MB. After
+ * $blocks = array_map(fn($x) => unpack('N*', $x), $blocks); it jumps up by an additional
+ * ~90MB, yielding a 106x increase in memory usage. Consequently, it bcrypt calls a different
+ * _encryptBlock() then the regular Blowfish does. That said, the Blowfish _encryptBlock() is
+ * basically just a thin wrapper around the bcrypt _encryptBlock(), so there's that.
+ *
+ * This explains 3 of the 4 _encryptBlock() implementations. the last _encryptBlock()
+ * implementation can best be understood by doing Ctrl + F and searching for where
+ * self::$use_reg_intval is defined.
+ *
+ * # phpseclib's three different _setupKey() implementations
+ *
+ * Every bcrypt round is the equivalent of encrypting 512KB of data. Since OpenSSH uses 16
+ * rounds by default that's ~8MB of data that's essentially being encrypted whenever
+ * you use bcrypt. That's a lot of data, however, bcrypt operates within tighter constraints
+ * than regular Blowfish, so we can use that to our advantage. In particular, whereas Blowfish
+ * supports variable length keys, in bcrypt, the initial "key" is the sha512 hash of the
+ * password. sha512 hashes are 512 bits or 64 bytes long and thus the bcrypt keys are of a
+ * fixed length whereas Blowfish keys are not of a fixed length.
+ *
+ * bcrypt actually has two different key expansion steps. The first one (expandstate) is
+ * constantly XOR'ing every _encryptBlock() parameter against the salt prior _encryptBlock()'s
+ * being called. The second one (expand0state) is more similar to Blowfish's _setupKey()
+ * but it can still use the fixed length key optimization discussed above and can do away with
+ * the pack() / unpack() calls.
+ *
+ * I suppose _setupKey() could be made to be a thin wrapper around expandstate() but idk it's
+ * just a lot of work for very marginal benefits as _setupKey() is only called once for
+ * regular Blowfish vs the 128 times it's called --per round-- with bcrypt.
+ *
+ * # blowfish + bcrypt in the same class
+ *
+ * Altho there's a lot of Blowfish code that bcrypt doesn't re-use, bcrypt does re-use the
+ * initial S-boxes, the initial P-array and the int-only _encryptBlock() implementation.
+ *
+ * # Credit
+ *
+ * phpseclib's bcrypt implementation is based losely off of OpenSSH's implementation:
+ *
+ * https://github.com/openssh/openssh-portable/blob/master/openbsd-compat/bcrypt_pbkdf.c
+ *
+ * Here's a short example of how to use this library:
+ * <code>
+ * <?php
+ *    include 'vendor/autoload.php';
+ *
+ *    $blowfish = new \phpseclib3\Crypt\Blowfish('ctr');
+ *
+ *    $blowfish->setKey('12345678901234567890123456789012');
+ *
+ *    $plaintext = str_repeat('a', 1024);
+ *
+ *    echo $blowfish->decrypt($blowfish->encrypt($plaintext));
+ * ?>
+ * </code>
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @author    Hans-Juergen Petrich <petrich@tronic-media.com>
+ * @copyright 2007 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt;
+
+use phpseclib3\Crypt\Common\BlockCipher;
+
+/**
+ * Pure-PHP implementation of Blowfish.
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ * @author  Hans-Juergen Petrich <petrich@tronic-media.com>
+ */
+class Blowfish extends BlockCipher
+{
+    /**
+     * Block Length of the cipher
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::block_size
+     * @var int
+     */
+    protected $block_size = 8;
+
+    /**
+     * The mcrypt specific name of the cipher
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::cipher_name_mcrypt
+     * @var string
+     */
+    protected $cipher_name_mcrypt = 'blowfish';
+
+    /**
+     * Optimizing value while CFB-encrypting
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::cfb_init_len
+     * @var int
+     */
+    protected $cfb_init_len = 500;
+
+    /**
+     * The fixed subkeys boxes ($sbox0 - $sbox3) with 256 entries each
+     *
+     * S-Box 0
+     *
+     * @var    array
+     */
+    private static $sbox0 = [
+        0xd1310ba6, 0x98dfb5ac, 0x2ffd72db, 0xd01adfb7, 0xb8e1afed, 0x6a267e96, 0xba7c9045, 0xf12c7f99,
+        0x24a19947, 0xb3916cf7, 0x0801f2e2, 0x858efc16, 0x636920d8, 0x71574e69, 0xa458fea3, 0xf4933d7e,
+        0x0d95748f, 0x728eb658, 0x718bcd58, 0x82154aee, 0x7b54a41d, 0xc25a59b5, 0x9c30d539, 0x2af26013,
+        0xc5d1b023, 0x286085f0, 0xca417918, 0xb8db38ef, 0x8e79dcb0, 0x603a180e, 0x6c9e0e8b, 0xb01e8a3e,
+        0xd71577c1, 0xbd314b27, 0x78af2fda, 0x55605c60, 0xe65525f3, 0xaa55ab94, 0x57489862, 0x63e81440,
+        0x55ca396a, 0x2aab10b6, 0xb4cc5c34, 0x1141e8ce, 0xa15486af, 0x7c72e993, 0xb3ee1411, 0x636fbc2a,
+        0x2ba9c55d, 0x741831f6, 0xce5c3e16, 0x9b87931e, 0xafd6ba33, 0x6c24cf5c, 0x7a325381, 0x28958677,
+        0x3b8f4898, 0x6b4bb9af, 0xc4bfe81b, 0x66282193, 0x61d809cc, 0xfb21a991, 0x487cac60, 0x5dec8032,
+        0xef845d5d, 0xe98575b1, 0xdc262302, 0xeb651b88, 0x23893e81, 0xd396acc5, 0x0f6d6ff3, 0x83f44239,
+        0x2e0b4482, 0xa4842004, 0x69c8f04a, 0x9e1f9b5e, 0x21c66842, 0xf6e96c9a, 0x670c9c61, 0xabd388f0,
+        0x6a51a0d2, 0xd8542f68, 0x960fa728, 0xab5133a3, 0x6eef0b6c, 0x137a3be4, 0xba3bf050, 0x7efb2a98,
+        0xa1f1651d, 0x39af0176, 0x66ca593e, 0x82430e88, 0x8cee8619, 0x456f9fb4, 0x7d84a5c3, 0x3b8b5ebe,
+        0xe06f75d8, 0x85c12073, 0x401a449f, 0x56c16aa6, 0x4ed3aa62, 0x363f7706, 0x1bfedf72, 0x429b023d,
+        0x37d0d724, 0xd00a1248, 0xdb0fead3, 0x49f1c09b, 0x075372c9, 0x80991b7b, 0x25d479d8, 0xf6e8def7,
+        0xe3fe501a, 0xb6794c3b, 0x976ce0bd, 0x04c006ba, 0xc1a94fb6, 0x409f60c4, 0x5e5c9ec2, 0x196a2463,
+        0x68fb6faf, 0x3e6c53b5, 0x1339b2eb, 0x3b52ec6f, 0x6dfc511f, 0x9b30952c, 0xcc814544, 0xaf5ebd09,
+        0xbee3d004, 0xde334afd, 0x660f2807, 0x192e4bb3, 0xc0cba857, 0x45c8740f, 0xd20b5f39, 0xb9d3fbdb,
+        0x5579c0bd, 0x1a60320a, 0xd6a100c6, 0x402c7279, 0x679f25fe, 0xfb1fa3cc, 0x8ea5e9f8, 0xdb3222f8,
+        0x3c7516df, 0xfd616b15, 0x2f501ec8, 0xad0552ab, 0x323db5fa, 0xfd238760, 0x53317b48, 0x3e00df82,
+        0x9e5c57bb, 0xca6f8ca0, 0x1a87562e, 0xdf1769db, 0xd542a8f6, 0x287effc3, 0xac6732c6, 0x8c4f5573,
+        0x695b27b0, 0xbbca58c8, 0xe1ffa35d, 0xb8f011a0, 0x10fa3d98, 0xfd2183b8, 0x4afcb56c, 0x2dd1d35b,
+        0x9a53e479, 0xb6f84565, 0xd28e49bc, 0x4bfb9790, 0xe1ddf2da, 0xa4cb7e33, 0x62fb1341, 0xcee4c6e8,
+        0xef20cada, 0x36774c01, 0xd07e9efe, 0x2bf11fb4, 0x95dbda4d, 0xae909198, 0xeaad8e71, 0x6b93d5a0,
+        0xd08ed1d0, 0xafc725e0, 0x8e3c5b2f, 0x8e7594b7, 0x8ff6e2fb, 0xf2122b64, 0x8888b812, 0x900df01c,
+        0x4fad5ea0, 0x688fc31c, 0xd1cff191, 0xb3a8c1ad, 0x2f2f2218, 0xbe0e1777, 0xea752dfe, 0x8b021fa1,
+        0xe5a0cc0f, 0xb56f74e8, 0x18acf3d6, 0xce89e299, 0xb4a84fe0, 0xfd13e0b7, 0x7cc43b81, 0xd2ada8d9,
+        0x165fa266, 0x80957705, 0x93cc7314, 0x211a1477, 0xe6ad2065, 0x77b5fa86, 0xc75442f5, 0xfb9d35cf,
+        0xebcdaf0c, 0x7b3e89a0, 0xd6411bd3, 0xae1e7e49, 0x00250e2d, 0x2071b35e, 0x226800bb, 0x57b8e0af,
+        0x2464369b, 0xf009b91e, 0x5563911d, 0x59dfa6aa, 0x78c14389, 0xd95a537f, 0x207d5ba2, 0x02e5b9c5,
+        0x83260376, 0x6295cfa9, 0x11c81968, 0x4e734a41, 0xb3472dca, 0x7b14a94a, 0x1b510052, 0x9a532915,
+        0xd60f573f, 0xbc9bc6e4, 0x2b60a476, 0x81e67400, 0x08ba6fb5, 0x571be91f, 0xf296ec6b, 0x2a0dd915,
+        0xb6636521, 0xe7b9f9b6, 0xff34052e, 0xc5855664, 0x53b02d5d, 0xa99f8fa1, 0x08ba4799, 0x6e85076a
+    ];
+
+    /**
+     * S-Box 1
+     *
+     * @var    array
+     */
+    private static $sbox1 = [
+        0x4b7a70e9, 0xb5b32944, 0xdb75092e, 0xc4192623, 0xad6ea6b0, 0x49a7df7d, 0x9cee60b8, 0x8fedb266,
+        0xecaa8c71, 0x699a17ff, 0x5664526c, 0xc2b19ee1, 0x193602a5, 0x75094c29, 0xa0591340, 0xe4183a3e,
+        0x3f54989a, 0x5b429d65, 0x6b8fe4d6, 0x99f73fd6, 0xa1d29c07, 0xefe830f5, 0x4d2d38e6, 0xf0255dc1,
+        0x4cdd2086, 0x8470eb26, 0x6382e9c6, 0x021ecc5e, 0x09686b3f, 0x3ebaefc9, 0x3c971814, 0x6b6a70a1,
+        0x687f3584, 0x52a0e286, 0xb79c5305, 0xaa500737, 0x3e07841c, 0x7fdeae5c, 0x8e7d44ec, 0x5716f2b8,
+        0xb03ada37, 0xf0500c0d, 0xf01c1f04, 0x0200b3ff, 0xae0cf51a, 0x3cb574b2, 0x25837a58, 0xdc0921bd,
+        0xd19113f9, 0x7ca92ff6, 0x94324773, 0x22f54701, 0x3ae5e581, 0x37c2dadc, 0xc8b57634, 0x9af3dda7,
+        0xa9446146, 0x0fd0030e, 0xecc8c73e, 0xa4751e41, 0xe238cd99, 0x3bea0e2f, 0x3280bba1, 0x183eb331,
+        0x4e548b38, 0x4f6db908, 0x6f420d03, 0xf60a04bf, 0x2cb81290, 0x24977c79, 0x5679b072, 0xbcaf89af,
+        0xde9a771f, 0xd9930810, 0xb38bae12, 0xdccf3f2e, 0x5512721f, 0x2e6b7124, 0x501adde6, 0x9f84cd87,
+        0x7a584718, 0x7408da17, 0xbc9f9abc, 0xe94b7d8c, 0xec7aec3a, 0xdb851dfa, 0x63094366, 0xc464c3d2,
+        0xef1c1847, 0x3215d908, 0xdd433b37, 0x24c2ba16, 0x12a14d43, 0x2a65c451, 0x50940002, 0x133ae4dd,
+        0x71dff89e, 0x10314e55, 0x81ac77d6, 0x5f11199b, 0x043556f1, 0xd7a3c76b, 0x3c11183b, 0x5924a509,
+        0xf28fe6ed, 0x97f1fbfa, 0x9ebabf2c, 0x1e153c6e, 0x86e34570, 0xeae96fb1, 0x860e5e0a, 0x5a3e2ab3,
+        0x771fe71c, 0x4e3d06fa, 0x2965dcb9, 0x99e71d0f, 0x803e89d6, 0x5266c825, 0x2e4cc978, 0x9c10b36a,
+        0xc6150eba, 0x94e2ea78, 0xa5fc3c53, 0x1e0a2df4, 0xf2f74ea7, 0x361d2b3d, 0x1939260f, 0x19c27960,
+        0x5223a708, 0xf71312b6, 0xebadfe6e, 0xeac31f66, 0xe3bc4595, 0xa67bc883, 0xb17f37d1, 0x018cff28,
+        0xc332ddef, 0xbe6c5aa5, 0x65582185, 0x68ab9802, 0xeecea50f, 0xdb2f953b, 0x2aef7dad, 0x5b6e2f84,
+        0x1521b628, 0x29076170, 0xecdd4775, 0x619f1510, 0x13cca830, 0xeb61bd96, 0x0334fe1e, 0xaa0363cf,
+        0xb5735c90, 0x4c70a239, 0xd59e9e0b, 0xcbaade14, 0xeecc86bc, 0x60622ca7, 0x9cab5cab, 0xb2f3846e,
+        0x648b1eaf, 0x19bdf0ca, 0xa02369b9, 0x655abb50, 0x40685a32, 0x3c2ab4b3, 0x319ee9d5, 0xc021b8f7,
+        0x9b540b19, 0x875fa099, 0x95f7997e, 0x623d7da8, 0xf837889a, 0x97e32d77, 0x11ed935f, 0x16681281,
+        0x0e358829, 0xc7e61fd6, 0x96dedfa1, 0x7858ba99, 0x57f584a5, 0x1b227263, 0x9b83c3ff, 0x1ac24696,
+        0xcdb30aeb, 0x532e3054, 0x8fd948e4, 0x6dbc3128, 0x58ebf2ef, 0x34c6ffea, 0xfe28ed61, 0xee7c3c73,
+        0x5d4a14d9, 0xe864b7e3, 0x42105d14, 0x203e13e0, 0x45eee2b6, 0xa3aaabea, 0xdb6c4f15, 0xfacb4fd0,
+        0xc742f442, 0xef6abbb5, 0x654f3b1d, 0x41cd2105, 0xd81e799e, 0x86854dc7, 0xe44b476a, 0x3d816250,
+        0xcf62a1f2, 0x5b8d2646, 0xfc8883a0, 0xc1c7b6a3, 0x7f1524c3, 0x69cb7492, 0x47848a0b, 0x5692b285,
+        0x095bbf00, 0xad19489d, 0x1462b174, 0x23820e00, 0x58428d2a, 0x0c55f5ea, 0x1dadf43e, 0x233f7061,
+        0x3372f092, 0x8d937e41, 0xd65fecf1, 0x6c223bdb, 0x7cde3759, 0xcbee7460, 0x4085f2a7, 0xce77326e,
+        0xa6078084, 0x19f8509e, 0xe8efd855, 0x61d99735, 0xa969a7aa, 0xc50c06c2, 0x5a04abfc, 0x800bcadc,
+        0x9e447a2e, 0xc3453484, 0xfdd56705, 0x0e1e9ec9, 0xdb73dbd3, 0x105588cd, 0x675fda79, 0xe3674340,
+        0xc5c43465, 0x713e38d8, 0x3d28f89e, 0xf16dff20, 0x153e21e7, 0x8fb03d4a, 0xe6e39f2b, 0xdb83adf7
+    ];
+
+    /**
+     * S-Box 2
+     *
+     * @var    array
+     */
+    private static $sbox2 = [
+        0xe93d5a68, 0x948140f7, 0xf64c261c, 0x94692934, 0x411520f7, 0x7602d4f7, 0xbcf46b2e, 0xd4a20068,
+        0xd4082471, 0x3320f46a, 0x43b7d4b7, 0x500061af, 0x1e39f62e, 0x97244546, 0x14214f74, 0xbf8b8840,
+        0x4d95fc1d, 0x96b591af, 0x70f4ddd3, 0x66a02f45, 0xbfbc09ec, 0x03bd9785, 0x7fac6dd0, 0x31cb8504,
+        0x96eb27b3, 0x55fd3941, 0xda2547e6, 0xabca0a9a, 0x28507825, 0x530429f4, 0x0a2c86da, 0xe9b66dfb,
+        0x68dc1462, 0xd7486900, 0x680ec0a4, 0x27a18dee, 0x4f3ffea2, 0xe887ad8c, 0xb58ce006, 0x7af4d6b6,
+        0xaace1e7c, 0xd3375fec, 0xce78a399, 0x406b2a42, 0x20fe9e35, 0xd9f385b9, 0xee39d7ab, 0x3b124e8b,
+        0x1dc9faf7, 0x4b6d1856, 0x26a36631, 0xeae397b2, 0x3a6efa74, 0xdd5b4332, 0x6841e7f7, 0xca7820fb,
+        0xfb0af54e, 0xd8feb397, 0x454056ac, 0xba489527, 0x55533a3a, 0x20838d87, 0xfe6ba9b7, 0xd096954b,
+        0x55a867bc, 0xa1159a58, 0xcca92963, 0x99e1db33, 0xa62a4a56, 0x3f3125f9, 0x5ef47e1c, 0x9029317c,
+        0xfdf8e802, 0x04272f70, 0x80bb155c, 0x05282ce3, 0x95c11548, 0xe4c66d22, 0x48c1133f, 0xc70f86dc,
+        0x07f9c9ee, 0x41041f0f, 0x404779a4, 0x5d886e17, 0x325f51eb, 0xd59bc0d1, 0xf2bcc18f, 0x41113564,
+        0x257b7834, 0x602a9c60, 0xdff8e8a3, 0x1f636c1b, 0x0e12b4c2, 0x02e1329e, 0xaf664fd1, 0xcad18115,
+        0x6b2395e0, 0x333e92e1, 0x3b240b62, 0xeebeb922, 0x85b2a20e, 0xe6ba0d99, 0xde720c8c, 0x2da2f728,
+        0xd0127845, 0x95b794fd, 0x647d0862, 0xe7ccf5f0, 0x5449a36f, 0x877d48fa, 0xc39dfd27, 0xf33e8d1e,
+        0x0a476341, 0x992eff74, 0x3a6f6eab, 0xf4f8fd37, 0xa812dc60, 0xa1ebddf8, 0x991be14c, 0xdb6e6b0d,
+        0xc67b5510, 0x6d672c37, 0x2765d43b, 0xdcd0e804, 0xf1290dc7, 0xcc00ffa3, 0xb5390f92, 0x690fed0b,
+        0x667b9ffb, 0xcedb7d9c, 0xa091cf0b, 0xd9155ea3, 0xbb132f88, 0x515bad24, 0x7b9479bf, 0x763bd6eb,
+        0x37392eb3, 0xcc115979, 0x8026e297, 0xf42e312d, 0x6842ada7, 0xc66a2b3b, 0x12754ccc, 0x782ef11c,
+        0x6a124237, 0xb79251e7, 0x06a1bbe6, 0x4bfb6350, 0x1a6b1018, 0x11caedfa, 0x3d25bdd8, 0xe2e1c3c9,
+        0x44421659, 0x0a121386, 0xd90cec6e, 0xd5abea2a, 0x64af674e, 0xda86a85f, 0xbebfe988, 0x64e4c3fe,
+        0x9dbc8057, 0xf0f7c086, 0x60787bf8, 0x6003604d, 0xd1fd8346, 0xf6381fb0, 0x7745ae04, 0xd736fccc,
+        0x83426b33, 0xf01eab71, 0xb0804187, 0x3c005e5f, 0x77a057be, 0xbde8ae24, 0x55464299, 0xbf582e61,
+        0x4e58f48f, 0xf2ddfda2, 0xf474ef38, 0x8789bdc2, 0x5366f9c3, 0xc8b38e74, 0xb475f255, 0x46fcd9b9,
+        0x7aeb2661, 0x8b1ddf84, 0x846a0e79, 0x915f95e2, 0x466e598e, 0x20b45770, 0x8cd55591, 0xc902de4c,
+        0xb90bace1, 0xbb8205d0, 0x11a86248, 0x7574a99e, 0xb77f19b6, 0xe0a9dc09, 0x662d09a1, 0xc4324633,
+        0xe85a1f02, 0x09f0be8c, 0x4a99a025, 0x1d6efe10, 0x1ab93d1d, 0x0ba5a4df, 0xa186f20f, 0x2868f169,
+        0xdcb7da83, 0x573906fe, 0xa1e2ce9b, 0x4fcd7f52, 0x50115e01, 0xa70683fa, 0xa002b5c4, 0x0de6d027,
+        0x9af88c27, 0x773f8641, 0xc3604c06, 0x61a806b5, 0xf0177a28, 0xc0f586e0, 0x006058aa, 0x30dc7d62,
+        0x11e69ed7, 0x2338ea63, 0x53c2dd94, 0xc2c21634, 0xbbcbee56, 0x90bcb6de, 0xebfc7da1, 0xce591d76,
+        0x6f05e409, 0x4b7c0188, 0x39720a3d, 0x7c927c24, 0x86e3725f, 0x724d9db9, 0x1ac15bb4, 0xd39eb8fc,
+        0xed545578, 0x08fca5b5, 0xd83d7cd3, 0x4dad0fc4, 0x1e50ef5e, 0xb161e6f8, 0xa28514d9, 0x6c51133c,
+        0x6fd5c7e7, 0x56e14ec4, 0x362abfce, 0xddc6c837, 0xd79a3234, 0x92638212, 0x670efa8e, 0x406000e0
+    ];
+
+    /**
+     * S-Box 3
+     *
+     * @var    array
+     */
+    private static $sbox3 = [
+        0x3a39ce37, 0xd3faf5cf, 0xabc27737, 0x5ac52d1b, 0x5cb0679e, 0x4fa33742, 0xd3822740, 0x99bc9bbe,
+        0xd5118e9d, 0xbf0f7315, 0xd62d1c7e, 0xc700c47b, 0xb78c1b6b, 0x21a19045, 0xb26eb1be, 0x6a366eb4,
+        0x5748ab2f, 0xbc946e79, 0xc6a376d2, 0x6549c2c8, 0x530ff8ee, 0x468dde7d, 0xd5730a1d, 0x4cd04dc6,
+        0x2939bbdb, 0xa9ba4650, 0xac9526e8, 0xbe5ee304, 0xa1fad5f0, 0x6a2d519a, 0x63ef8ce2, 0x9a86ee22,
+        0xc089c2b8, 0x43242ef6, 0xa51e03aa, 0x9cf2d0a4, 0x83c061ba, 0x9be96a4d, 0x8fe51550, 0xba645bd6,
+        0x2826a2f9, 0xa73a3ae1, 0x4ba99586, 0xef5562e9, 0xc72fefd3, 0xf752f7da, 0x3f046f69, 0x77fa0a59,
+        0x80e4a915, 0x87b08601, 0x9b09e6ad, 0x3b3ee593, 0xe990fd5a, 0x9e34d797, 0x2cf0b7d9, 0x022b8b51,
+        0x96d5ac3a, 0x017da67d, 0xd1cf3ed6, 0x7c7d2d28, 0x1f9f25cf, 0xadf2b89b, 0x5ad6b472, 0x5a88f54c,
+        0xe029ac71, 0xe019a5e6, 0x47b0acfd, 0xed93fa9b, 0xe8d3c48d, 0x283b57cc, 0xf8d56629, 0x79132e28,
+        0x785f0191, 0xed756055, 0xf7960e44, 0xe3d35e8c, 0x15056dd4, 0x88f46dba, 0x03a16125, 0x0564f0bd,
+        0xc3eb9e15, 0x3c9057a2, 0x97271aec, 0xa93a072a, 0x1b3f6d9b, 0x1e6321f5, 0xf59c66fb, 0x26dcf319,
+        0x7533d928, 0xb155fdf5, 0x03563482, 0x8aba3cbb, 0x28517711, 0xc20ad9f8, 0xabcc5167, 0xccad925f,
+        0x4de81751, 0x3830dc8e, 0x379d5862, 0x9320f991, 0xea7a90c2, 0xfb3e7bce, 0x5121ce64, 0x774fbe32,
+        0xa8b6e37e, 0xc3293d46, 0x48de5369, 0x6413e680, 0xa2ae0810, 0xdd6db224, 0x69852dfd, 0x09072166,
+        0xb39a460a, 0x6445c0dd, 0x586cdecf, 0x1c20c8ae, 0x5bbef7dd, 0x1b588d40, 0xccd2017f, 0x6bb4e3bb,
+        0xdda26a7e, 0x3a59ff45, 0x3e350a44, 0xbcb4cdd5, 0x72eacea8, 0xfa6484bb, 0x8d6612ae, 0xbf3c6f47,
+        0xd29be463, 0x542f5d9e, 0xaec2771b, 0xf64e6370, 0x740e0d8d, 0xe75b1357, 0xf8721671, 0xaf537d5d,
+        0x4040cb08, 0x4eb4e2cc, 0x34d2466a, 0x0115af84, 0xe1b00428, 0x95983a1d, 0x06b89fb4, 0xce6ea048,
+        0x6f3f3b82, 0x3520ab82, 0x011a1d4b, 0x277227f8, 0x611560b1, 0xe7933fdc, 0xbb3a792b, 0x344525bd,
+        0xa08839e1, 0x51ce794b, 0x2f32c9b7, 0xa01fbac9, 0xe01cc87e, 0xbcc7d1f6, 0xcf0111c3, 0xa1e8aac7,
+        0x1a908749, 0xd44fbd9a, 0xd0dadecb, 0xd50ada38, 0x0339c32a, 0xc6913667, 0x8df9317c, 0xe0b12b4f,
+        0xf79e59b7, 0x43f5bb3a, 0xf2d519ff, 0x27d9459c, 0xbf97222c, 0x15e6fc2a, 0x0f91fc71, 0x9b941525,
+        0xfae59361, 0xceb69ceb, 0xc2a86459, 0x12baa8d1, 0xb6c1075e, 0xe3056a0c, 0x10d25065, 0xcb03a442,
+        0xe0ec6e0e, 0x1698db3b, 0x4c98a0be, 0x3278e964, 0x9f1f9532, 0xe0d392df, 0xd3a0342b, 0x8971f21e,
+        0x1b0a7441, 0x4ba3348c, 0xc5be7120, 0xc37632d8, 0xdf359f8d, 0x9b992f2e, 0xe60b6f47, 0x0fe3f11d,
+        0xe54cda54, 0x1edad891, 0xce6279cf, 0xcd3e7e6f, 0x1618b166, 0xfd2c1d05, 0x848fd2c5, 0xf6fb2299,
+        0xf523f357, 0xa6327623, 0x93a83531, 0x56cccd02, 0xacf08162, 0x5a75ebb5, 0x6e163697, 0x88d273cc,
+        0xde966292, 0x81b949d0, 0x4c50901b, 0x71c65614, 0xe6c6c7bd, 0x327a140a, 0x45e1d006, 0xc3f27b9a,
+        0xc9aa53fd, 0x62a80f00, 0xbb25bfe2, 0x35bdd2f6, 0x71126905, 0xb2040222, 0xb6cbcf7c, 0xcd769c2b,
+        0x53113ec0, 0x1640e3d3, 0x38abbd60, 0x2547adf0, 0xba38209c, 0xf746ce76, 0x77afa1c5, 0x20756060,
+        0x85cbfe4e, 0x8ae88dd8, 0x7aaaf9b0, 0x4cf9aa7e, 0x1948c25c, 0x02fb8a8c, 0x01c36ae4, 0xd6ebe1f9,
+        0x90d4f869, 0xa65cdea0, 0x3f09252d, 0xc208e69f, 0xb74e6132, 0xce77e25b, 0x578fdfe3, 0x3ac372e6
+    ];
+
+    /**
+     * P-Array consists of 18 32-bit subkeys
+     *
+     * @var array
+     */
+    private static $parray = [
+        0x243f6a88, 0x85a308d3, 0x13198a2e, 0x03707344, 0xa4093822, 0x299f31d0,
+        0x082efa98, 0xec4e6c89, 0x452821e6, 0x38d01377, 0xbe5466cf, 0x34e90c6c,
+        0xc0ac29b7, 0xc97c50dd, 0x3f84d5b5, 0xb5470917, 0x9216d5d9, 0x8979fb1b
+    ];
+
+    /**
+     * The BCTX-working Array
+     *
+     * Holds the expanded key [p] and the key-depended s-boxes [sb]
+     *
+     * @var array
+     */
+    private $bctx;
+
+    /**
+     * Holds the last used key
+     *
+     * @var array
+     */
+    private $kl;
+
+    /**
+     * The Key Length (in bytes)
+     * {@internal The max value is 256 / 8 = 32, the min value is 128 / 8 = 16.  Exists in conjunction with $Nk
+     *    because the encryption / decryption / key schedule creation requires this number and not $key_length.  We could
+     *    derive this from $key_length or vice versa, but that'd mean we'd have to do multiple shift operations, so in lieu
+     *    of that, we'll just precompute it once.}
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::setKeyLength()
+     * @var int
+     */
+    protected $key_length = 16;
+
+    /**
+     * Default Constructor.
+     *
+     * @param string $mode
+     * @throws \InvalidArgumentException if an invalid / unsupported mode is provided
+     */
+    public function __construct($mode)
+    {
+        parent::__construct($mode);
+
+        if ($this->mode == self::MODE_STREAM) {
+            throw new \InvalidArgumentException('Block ciphers cannot be ran in stream mode');
+        }
+    }
+
+    /**
+     * Sets the key length.
+     *
+     * Key lengths can be between 32 and 448 bits.
+     *
+     * @param int $length
+     */
+    public function setKeyLength($length)
+    {
+        if ($length < 32 || $length > 448) {
+                throw new \LengthException('Key size of ' . $length . ' bits is not supported by this algorithm. Only keys of sizes between 32 and 448 bits are supported');
+        }
+
+        $this->key_length = $length >> 3;
+
+        parent::setKeyLength($length);
+    }
+
+    /**
+     * Test for engine validity
+     *
+     * This is mainly just a wrapper to set things up for \phpseclib3\Crypt\Common\SymmetricKey::isValidEngine()
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::isValidEngine()
+     * @param int $engine
+     * @return bool
+     */
+    protected function isValidEngineHelper($engine)
+    {
+        if ($engine == self::ENGINE_OPENSSL) {
+            if ($this->key_length < 16) {
+                return false;
+            }
+            // quoting https://www.openssl.org/news/openssl-3.0-notes.html, OpenSSL 3.0.1
+            // "Moved all variations of the EVP ciphers CAST5, BF, IDEA, SEED, RC2, RC4, RC5, and DES to the legacy provider"
+            // in theory openssl_get_cipher_methods() should catch this but, on GitHub Actions, at least, it does not
+            if (defined('OPENSSL_VERSION_TEXT') && version_compare(preg_replace('#OpenSSL (\d+\.\d+\.\d+) .*#', '$1', OPENSSL_VERSION_TEXT), '3.0.1', '>=')) {
+                return false;
+            }
+            $this->cipher_name_openssl_ecb = 'bf-ecb';
+            $this->cipher_name_openssl = 'bf-' . $this->openssl_translate_mode();
+        }
+
+        return parent::isValidEngineHelper($engine);
+    }
+
+    /**
+     * Setup the key (expansion)
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::_setupKey()
+     */
+    protected function setupKey()
+    {
+        if (isset($this->kl['key']) && $this->key === $this->kl['key']) {
+            // already expanded
+            return;
+        }
+        $this->kl = ['key' => $this->key];
+
+        /* key-expanding p[] and S-Box building sb[] */
+        $this->bctx = [
+            'p'  => [],
+            'sb' => [
+                self::$sbox0,
+                self::$sbox1,
+                self::$sbox2,
+                self::$sbox3
+            ]
+        ];
+
+        // unpack binary string in unsigned chars
+        $key  = array_values(unpack('C*', $this->key));
+        $keyl = count($key);
+        // with bcrypt $keyl will always be 16 (because the key is the sha512 of the key you provide)
+        for ($j = 0, $i = 0; $i < 18; ++$i) {
+            // xor P1 with the first 32-bits of the key, xor P2 with the second 32-bits ...
+            for ($data = 0, $k = 0; $k < 4; ++$k) {
+                $data = ($data << 8) | $key[$j];
+                if (++$j >= $keyl) {
+                    $j = 0;
+                }
+            }
+            $this->bctx['p'][] = self::$parray[$i] ^ intval($data);
+        }
+
+        // encrypt the zero-string, replace P1 and P2 with the encrypted data,
+        // encrypt P3 and P4 with the new P1 and P2, do it with all P-array and subkeys
+        $data = "\0\0\0\0\0\0\0\0";
+        for ($i = 0; $i < 18; $i += 2) {
+            list($l, $r) = array_values(unpack('N*', $data = $this->encryptBlock($data)));
+            $this->bctx['p'][$i    ] = $l;
+            $this->bctx['p'][$i + 1] = $r;
+        }
+        for ($i = 0; $i < 4; ++$i) {
+            for ($j = 0; $j < 256; $j += 2) {
+                list($l, $r) = array_values(unpack('N*', $data = $this->encryptBlock($data)));
+                $this->bctx['sb'][$i][$j    ] = $l;
+                $this->bctx['sb'][$i][$j + 1] = $r;
+            }
+        }
+    }
+
+    /**
+     * Initialize Static Variables
+     */
+    protected static function initialize_static_variables()
+    {
+        if (is_float(self::$sbox2[0])) {
+            self::$sbox0 = array_map('intval', self::$sbox0);
+            self::$sbox1 = array_map('intval', self::$sbox1);
+            self::$sbox2 = array_map('intval', self::$sbox2);
+            self::$sbox3 = array_map('intval', self::$sbox3);
+            self::$parray = array_map('intval', self::$parray);
+        }
+
+        parent::initialize_static_variables();
+    }
+
+    /**
+     * bcrypt
+     *
+     * @param string $sha2pass
+     * @param string $sha2salt
+     * @access private
+     * @return string
+     */
+    private static function bcrypt_hash($sha2pass, $sha2salt)
+    {
+        $p = self::$parray;
+        $sbox0 = self::$sbox0;
+        $sbox1 = self::$sbox1;
+        $sbox2 = self::$sbox2;
+        $sbox3 = self::$sbox3;
+
+        $cdata = array_values(unpack('N*', 'OxychromaticBlowfishSwatDynamite'));
+        $sha2pass = array_values(unpack('N*', $sha2pass));
+        $sha2salt = array_values(unpack('N*', $sha2salt));
+
+        self::expandstate($sha2salt, $sha2pass, $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        for ($i = 0; $i < 64; $i++) {
+            self::expand0state($sha2salt, $sbox0, $sbox1, $sbox2, $sbox3, $p);
+            self::expand0state($sha2pass, $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        }
+
+        for ($i = 0; $i < 64; $i++) {
+            for ($j = 0; $j < 8; $j += 2) { // count($cdata) == 8
+                list($cdata[$j], $cdata[$j + 1]) = self::encryptBlockHelperFast($cdata[$j], $cdata[$j + 1], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+            }
+        }
+
+        return pack('L*', ...$cdata);
+    }
+
+    /**
+     * Performs OpenSSH-style bcrypt
+     *
+     * @param string $pass
+     * @param string $salt
+     * @param int $keylen
+     * @param int $rounds
+     * @access public
+     * @return string
+     */
+    public static function bcrypt_pbkdf($pass, $salt, $keylen, $rounds)
+    {
+        self::initialize_static_variables();
+
+        if (PHP_INT_SIZE == 4) {
+            throw new \RuntimeException('bcrypt is far too slow to be practical on 32-bit versions of PHP');
+        }
+
+        $sha2pass = hash('sha512', $pass, true);
+        $results = [];
+        $count = 1;
+        while (32 * count($results) < $keylen) {
+            $countsalt = $salt . pack('N', $count++);
+            $sha2salt = hash('sha512', $countsalt, true);
+            $out = $tmpout = self::bcrypt_hash($sha2pass, $sha2salt);
+            for ($i = 1; $i < $rounds; $i++) {
+                $sha2salt = hash('sha512', $tmpout, true);
+                $tmpout = self::bcrypt_hash($sha2pass, $sha2salt);
+                $out ^= $tmpout;
+            }
+            $results[] = $out;
+        }
+        $output = '';
+        for ($i = 0; $i < 32; $i++) {
+            foreach ($results as $result) {
+                $output .= $result[$i];
+            }
+        }
+        return substr($output, 0, $keylen);
+    }
+
+    /**
+     * Key expansion without salt
+     *
+     * @access private
+     * @param int[] $key
+     * @param int[] $sbox0
+     * @param int[] $sbox1
+     * @param int[] $sbox2
+     * @param int[] $sbox3
+     * @param int[] $p
+     * @see self::_bcrypt_hash()
+     */
+    private static function expand0state(array $key, array &$sbox0, array &$sbox1, array &$sbox2, array &$sbox3, array &$p)
+    {
+        // expand0state is basically the same thing as this:
+        //return self::expandstate(array_fill(0, 16, 0), $key);
+        // but this separate function eliminates a bunch of XORs and array lookups
+
+        $p = [
+            $p[0] ^ $key[0],
+            $p[1] ^ $key[1],
+            $p[2] ^ $key[2],
+            $p[3] ^ $key[3],
+            $p[4] ^ $key[4],
+            $p[5] ^ $key[5],
+            $p[6] ^ $key[6],
+            $p[7] ^ $key[7],
+            $p[8] ^ $key[8],
+            $p[9] ^ $key[9],
+            $p[10] ^ $key[10],
+            $p[11] ^ $key[11],
+            $p[12] ^ $key[12],
+            $p[13] ^ $key[13],
+            $p[14] ^ $key[14],
+            $p[15] ^ $key[15],
+            $p[16] ^ $key[0],
+            $p[17] ^ $key[1]
+        ];
+
+        // @codingStandardsIgnoreStart
+        list( $p[0],  $p[1]) = self::encryptBlockHelperFast(     0,      0, $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list( $p[2],  $p[3]) = self::encryptBlockHelperFast($p[ 0], $p[ 1], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list( $p[4],  $p[5]) = self::encryptBlockHelperFast($p[ 2], $p[ 3], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list( $p[6],  $p[7]) = self::encryptBlockHelperFast($p[ 4], $p[ 5], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list( $p[8],  $p[9]) = self::encryptBlockHelperFast($p[ 6], $p[ 7], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list($p[10], $p[11]) = self::encryptBlockHelperFast($p[ 8], $p[ 9], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list($p[12], $p[13]) = self::encryptBlockHelperFast($p[10], $p[11], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list($p[14], $p[15]) = self::encryptBlockHelperFast($p[12], $p[13], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list($p[16], $p[17]) = self::encryptBlockHelperFast($p[14], $p[15], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        // @codingStandardsIgnoreEnd
+
+        list($sbox0[0], $sbox0[1]) = self::encryptBlockHelperFast($p[16], $p[17], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        for ($i = 2; $i < 256; $i += 2) {
+            list($sbox0[$i], $sbox0[$i + 1]) = self::encryptBlockHelperFast($sbox0[$i - 2], $sbox0[$i - 1], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        }
+
+        list($sbox1[0], $sbox1[1]) = self::encryptBlockHelperFast($sbox0[254], $sbox0[255], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        for ($i = 2; $i < 256; $i += 2) {
+            list($sbox1[$i], $sbox1[$i + 1]) = self::encryptBlockHelperFast($sbox1[$i - 2], $sbox1[$i - 1], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        }
+
+        list($sbox2[0], $sbox2[1]) = self::encryptBlockHelperFast($sbox1[254], $sbox1[255], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        for ($i = 2; $i < 256; $i += 2) {
+            list($sbox2[$i], $sbox2[$i + 1]) = self::encryptBlockHelperFast($sbox2[$i - 2], $sbox2[$i - 1], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        }
+
+        list($sbox3[0], $sbox3[1]) = self::encryptBlockHelperFast($sbox2[254], $sbox2[255], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        for ($i = 2; $i < 256; $i += 2) {
+            list($sbox3[$i], $sbox3[$i + 1]) = self::encryptBlockHelperFast($sbox3[$i - 2], $sbox3[$i - 1], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        }
+    }
+
+    /**
+     * Key expansion with salt
+     *
+     * @access private
+     * @param int[] $data
+     * @param int[] $key
+     * @param int[] $sbox0
+     * @param int[] $sbox1
+     * @param int[] $sbox2
+     * @param int[] $sbox3
+     * @param int[] $p
+     * @see self::_bcrypt_hash()
+     */
+    private static function expandstate(array $data, array $key, array &$sbox0, array &$sbox1, array &$sbox2, array &$sbox3, array &$p)
+    {
+        $p = [
+            $p[0] ^ $key[0],
+            $p[1] ^ $key[1],
+            $p[2] ^ $key[2],
+            $p[3] ^ $key[3],
+            $p[4] ^ $key[4],
+            $p[5] ^ $key[5],
+            $p[6] ^ $key[6],
+            $p[7] ^ $key[7],
+            $p[8] ^ $key[8],
+            $p[9] ^ $key[9],
+            $p[10] ^ $key[10],
+            $p[11] ^ $key[11],
+            $p[12] ^ $key[12],
+            $p[13] ^ $key[13],
+            $p[14] ^ $key[14],
+            $p[15] ^ $key[15],
+            $p[16] ^ $key[0],
+            $p[17] ^ $key[1]
+        ];
+
+        // @codingStandardsIgnoreStart
+        list( $p[0],  $p[1]) = self::encryptBlockHelperFast($data[ 0]         , $data[ 1]         , $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list( $p[2],  $p[3]) = self::encryptBlockHelperFast($data[ 2] ^ $p[ 0], $data[ 3] ^ $p[ 1], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list( $p[4],  $p[5]) = self::encryptBlockHelperFast($data[ 4] ^ $p[ 2], $data[ 5] ^ $p[ 3], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list( $p[6],  $p[7]) = self::encryptBlockHelperFast($data[ 6] ^ $p[ 4], $data[ 7] ^ $p[ 5], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list( $p[8],  $p[9]) = self::encryptBlockHelperFast($data[ 8] ^ $p[ 6], $data[ 9] ^ $p[ 7], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list($p[10], $p[11]) = self::encryptBlockHelperFast($data[10] ^ $p[ 8], $data[11] ^ $p[ 9], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list($p[12], $p[13]) = self::encryptBlockHelperFast($data[12] ^ $p[10], $data[13] ^ $p[11], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list($p[14], $p[15]) = self::encryptBlockHelperFast($data[14] ^ $p[12], $data[15] ^ $p[13], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        list($p[16], $p[17]) = self::encryptBlockHelperFast($data[ 0] ^ $p[14], $data[ 1] ^ $p[15], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        // @codingStandardsIgnoreEnd
+
+        list($sbox0[0], $sbox0[1]) = self::encryptBlockHelperFast($data[2] ^ $p[16], $data[3] ^ $p[17], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        for ($i = 2, $j = 4; $i < 256; $i += 2, $j = ($j + 2) % 16) { // instead of 16 maybe count($data) would be better?
+            list($sbox0[$i], $sbox0[$i + 1]) = self::encryptBlockHelperFast($data[$j] ^ $sbox0[$i - 2], $data[$j + 1] ^ $sbox0[$i - 1], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        }
+
+        list($sbox1[0], $sbox1[1]) = self::encryptBlockHelperFast($data[2] ^ $sbox0[254], $data[3] ^ $sbox0[255], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        for ($i = 2, $j = 4; $i < 256; $i += 2, $j = ($j + 2) % 16) {
+            list($sbox1[$i], $sbox1[$i + 1]) = self::encryptBlockHelperFast($data[$j] ^ $sbox1[$i - 2], $data[$j + 1] ^ $sbox1[$i - 1], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        }
+
+        list($sbox2[0], $sbox2[1]) = self::encryptBlockHelperFast($data[2] ^ $sbox1[254], $data[3] ^ $sbox1[255], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        for ($i = 2, $j = 4; $i < 256; $i += 2, $j = ($j + 2) % 16) {
+            list($sbox2[$i], $sbox2[$i + 1]) = self::encryptBlockHelperFast($data[$j] ^ $sbox2[$i - 2], $data[$j + 1] ^ $sbox2[$i - 1], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        }
+
+        list($sbox3[0], $sbox3[1]) = self::encryptBlockHelperFast($data[2] ^ $sbox2[254], $data[3] ^ $sbox2[255], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        for ($i = 2, $j = 4; $i < 256; $i += 2, $j = ($j + 2) % 16) {
+            list($sbox3[$i], $sbox3[$i + 1]) = self::encryptBlockHelperFast($data[$j] ^ $sbox3[$i - 2], $data[$j + 1] ^ $sbox3[$i - 1], $sbox0, $sbox1, $sbox2, $sbox3, $p);
+        }
+    }
+
+    /**
+     * Encrypts a block
+     *
+     * @param string $in
+     * @return string
+     */
+    protected function encryptBlock($in)
+    {
+        $p = $this->bctx['p'];
+        // extract($this->bctx['sb'], EXTR_PREFIX_ALL, 'sb'); // slower
+        $sb_0 = $this->bctx['sb'][0];
+        $sb_1 = $this->bctx['sb'][1];
+        $sb_2 = $this->bctx['sb'][2];
+        $sb_3 = $this->bctx['sb'][3];
+
+        $in = unpack('N*', $in);
+        $l = $in[1];
+        $r = $in[2];
+
+        list($r, $l) = PHP_INT_SIZE == 4 ?
+            self::encryptBlockHelperSlow($l, $r, $sb_0, $sb_1, $sb_2, $sb_3, $p) :
+            self::encryptBlockHelperFast($l, $r, $sb_0, $sb_1, $sb_2, $sb_3, $p);
+
+        return pack("N*", $r, $l);
+    }
+
+    /**
+     * Fast helper function for block encryption
+     *
+     * @access private
+     * @param int $x0
+     * @param int $x1
+     * @param int[] $sbox0
+     * @param int[] $sbox1
+     * @param int[] $sbox2
+     * @param int[] $sbox3
+     * @param int[] $p
+     * @return int[]
+     */
+    private static function encryptBlockHelperFast($x0, $x1, array $sbox0, array $sbox1, array $sbox2, array $sbox3, array $p)
+    {
+        $x0 ^= $p[0];
+        $x1 ^= ((($sbox0[($x0 & 0xFF000000) >> 24] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[1];
+        $x0 ^= ((($sbox0[($x1 & 0xFF000000) >> 24] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[2];
+        $x1 ^= ((($sbox0[($x0 & 0xFF000000) >> 24] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[3];
+        $x0 ^= ((($sbox0[($x1 & 0xFF000000) >> 24] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[4];
+        $x1 ^= ((($sbox0[($x0 & 0xFF000000) >> 24] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[5];
+        $x0 ^= ((($sbox0[($x1 & 0xFF000000) >> 24] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[6];
+        $x1 ^= ((($sbox0[($x0 & 0xFF000000) >> 24] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[7];
+        $x0 ^= ((($sbox0[($x1 & 0xFF000000) >> 24] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[8];
+        $x1 ^= ((($sbox0[($x0 & 0xFF000000) >> 24] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[9];
+        $x0 ^= ((($sbox0[($x1 & 0xFF000000) >> 24] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[10];
+        $x1 ^= ((($sbox0[($x0 & 0xFF000000) >> 24] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[11];
+        $x0 ^= ((($sbox0[($x1 & 0xFF000000) >> 24] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[12];
+        $x1 ^= ((($sbox0[($x0 & 0xFF000000) >> 24] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[13];
+        $x0 ^= ((($sbox0[($x1 & 0xFF000000) >> 24] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[14];
+        $x1 ^= ((($sbox0[($x0 & 0xFF000000) >> 24] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[15];
+        $x0 ^= ((($sbox0[($x1 & 0xFF000000) >> 24] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[16];
+
+        return [$x1 & 0xFFFFFFFF ^ $p[17], $x0 & 0xFFFFFFFF];
+    }
+
+    /**
+     * Slow helper function for block encryption
+     *
+     * @access private
+     * @param int $x0
+     * @param int $x1
+     * @param int[] $sbox0
+     * @param int[] $sbox1
+     * @param int[] $sbox2
+     * @param int[] $sbox3
+     * @param int[] $p
+     * @return int[]
+     */
+    private static function encryptBlockHelperSlow($x0, $x1, array $sbox0, array $sbox1, array $sbox2, array $sbox3, array $p)
+    {
+        // -16777216 == intval(0xFF000000) on 32-bit PHP installs
+        $x0 ^= $p[0];
+        $x1 ^= self::safe_intval((self::safe_intval($sbox0[(($x0 & -16777216) >> 24) & 0xFF] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[1];
+        $x0 ^= self::safe_intval((self::safe_intval($sbox0[(($x1 & -16777216) >> 24) & 0xFF] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[2];
+        $x1 ^= self::safe_intval((self::safe_intval($sbox0[(($x0 & -16777216) >> 24) & 0xFF] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[3];
+        $x0 ^= self::safe_intval((self::safe_intval($sbox0[(($x1 & -16777216) >> 24) & 0xFF] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[4];
+        $x1 ^= self::safe_intval((self::safe_intval($sbox0[(($x0 & -16777216) >> 24) & 0xFF] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[5];
+        $x0 ^= self::safe_intval((self::safe_intval($sbox0[(($x1 & -16777216) >> 24) & 0xFF] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[6];
+        $x1 ^= self::safe_intval((self::safe_intval($sbox0[(($x0 & -16777216) >> 24) & 0xFF] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[7];
+        $x0 ^= self::safe_intval((self::safe_intval($sbox0[(($x1 & -16777216) >> 24) & 0xFF] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[8];
+        $x1 ^= self::safe_intval((self::safe_intval($sbox0[(($x0 & -16777216) >> 24) & 0xFF] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[9];
+        $x0 ^= self::safe_intval((self::safe_intval($sbox0[(($x1 & -16777216) >> 24) & 0xFF] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[10];
+        $x1 ^= self::safe_intval((self::safe_intval($sbox0[(($x0 & -16777216) >> 24) & 0xFF] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[11];
+        $x0 ^= self::safe_intval((self::safe_intval($sbox0[(($x1 & -16777216) >> 24) & 0xFF] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[12];
+        $x1 ^= self::safe_intval((self::safe_intval($sbox0[(($x0 & -16777216) >> 24) & 0xFF] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[13];
+        $x0 ^= self::safe_intval((self::safe_intval($sbox0[(($x1 & -16777216) >> 24) & 0xFF] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[14];
+        $x1 ^= self::safe_intval((self::safe_intval($sbox0[(($x0 & -16777216) >> 24) & 0xFF] + $sbox1[($x0 & 0xFF0000) >> 16]) ^ $sbox2[($x0 & 0xFF00) >> 8]) + $sbox3[$x0 & 0xFF]) ^ $p[15];
+        $x0 ^= self::safe_intval((self::safe_intval($sbox0[(($x1 & -16777216) >> 24) & 0xFF] + $sbox1[($x1 & 0xFF0000) >> 16]) ^ $sbox2[($x1 & 0xFF00) >> 8]) + $sbox3[$x1 & 0xFF]) ^ $p[16];
+
+        return [$x1 ^ $p[17], $x0];
+    }
+
+    /**
+     * Decrypts a block
+     *
+     * @param string $in
+     * @return string
+     */
+    protected function decryptBlock($in)
+    {
+        $p = $this->bctx['p'];
+        $sb_0 = $this->bctx['sb'][0];
+        $sb_1 = $this->bctx['sb'][1];
+        $sb_2 = $this->bctx['sb'][2];
+        $sb_3 = $this->bctx['sb'][3];
+
+        $in = unpack('N*', $in);
+        $l = $in[1];
+        $r = $in[2];
+
+        for ($i = 17; $i > 2; $i -= 2) {
+            $l ^= $p[$i];
+            $r ^= self::safe_intval((self::safe_intval($sb_0[$l >> 24 & 0xff] + $sb_1[$l >> 16 & 0xff]) ^
+                  $sb_2[$l >>  8 & 0xff]) +
+                  $sb_3[$l       & 0xff]);
+
+            $r ^= $p[$i - 1];
+            $l ^= self::safe_intval((self::safe_intval($sb_0[$r >> 24 & 0xff] + $sb_1[$r >> 16 & 0xff]) ^
+                  $sb_2[$r >>  8 & 0xff]) +
+                  $sb_3[$r       & 0xff]);
+        }
+        return pack('N*', $r ^ $p[0], $l ^ $p[1]);
+    }
+
+    /**
+     * Setup the performance-optimized function for de/encrypt()
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::_setupInlineCrypt()
+     */
+    protected function setupInlineCrypt()
+    {
+        $p = $this->bctx['p'];
+        $init_crypt = '
+            static $sb_0, $sb_1, $sb_2, $sb_3;
+            if (!$sb_0) {
+                $sb_0 = $this->bctx["sb"][0];
+                $sb_1 = $this->bctx["sb"][1];
+                $sb_2 = $this->bctx["sb"][2];
+                $sb_3 = $this->bctx["sb"][3];
+            }
+        ';
+
+        $safeint = self::safe_intval_inline();
+
+        // Generating encrypt code:
+        $encrypt_block = '
+            $in = unpack("N*", $in);
+            $l = $in[1];
+            $r = $in[2];
+        ';
+        for ($i = 0; $i < 16; $i += 2) {
+            $encrypt_block .= '
+                $l^= ' . $p[$i] . ';
+                $r^= ' . sprintf($safeint, '(' . sprintf($safeint, '$sb_0[$l >> 24 & 0xff] + $sb_1[$l >> 16 & 0xff]') . ' ^
+                      $sb_2[$l >>  8 & 0xff]) +
+                      $sb_3[$l       & 0xff]') . ';
+
+                $r^= ' . $p[$i + 1] . ';
+                $l^= ' . sprintf($safeint, '(' . sprintf($safeint, '$sb_0[$r >> 24 & 0xff] + $sb_1[$r >> 16 & 0xff]') . '  ^
+                      $sb_2[$r >>  8 & 0xff]) +
+                      $sb_3[$r       & 0xff]') . ';
+            ';
+        }
+        $encrypt_block .= '
+            $in = pack("N*",
+                $r ^ ' . $p[17] . ',
+                $l ^ ' . $p[16] . '
+            );
+        ';
+         // Generating decrypt code:
+        $decrypt_block = '
+            $in = unpack("N*", $in);
+            $l = $in[1];
+            $r = $in[2];
+        ';
+
+        for ($i = 17; $i > 2; $i -= 2) {
+            $decrypt_block .= '
+                $l^= ' . $p[$i] . ';
+                $r^= ' . sprintf($safeint, '(' . sprintf($safeint, '$sb_0[$l >> 24 & 0xff] + $sb_1[$l >> 16 & 0xff]') . ' ^
+                      $sb_2[$l >>  8 & 0xff]) +
+                      $sb_3[$l       & 0xff]') . ';
+
+                $r^= ' . $p[$i - 1] . ';
+                $l^= ' . sprintf($safeint, '(' . sprintf($safeint, '$sb_0[$r >> 24 & 0xff] + $sb_1[$r >> 16 & 0xff]') . ' ^
+                      $sb_2[$r >>  8 & 0xff]) +
+                      $sb_3[$r       & 0xff]') . ';
+            ';
+        }
+
+        $decrypt_block .= '
+            $in = pack("N*",
+                $r ^ ' . $p[0] . ',
+                $l ^ ' . $p[1] . '
+            );
+        ';
+
+        $this->inline_crypt = $this->createInlineCryptFunction(
+            [
+               'init_crypt'    => $init_crypt,
+               'init_encrypt'  => '',
+               'init_decrypt'  => '',
+               'encrypt_block' => $encrypt_block,
+               'decrypt_block' => $decrypt_block
+            ]
+        );
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/ChaCha20.php ---
@@ -0,0 +1,799 @@
+<?php
+
+/**
+ * Pure-PHP implementation of ChaCha20.
+ *
+ * PHP version 5
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2019 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt;
+
+use phpseclib3\Exception\BadDecryptionException;
+use phpseclib3\Exception\InsufficientSetupException;
+
+/**
+ * Pure-PHP implementation of ChaCha20.
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+class ChaCha20 extends Salsa20
+{
+    /**
+     * The OpenSSL specific name of the cipher
+     *
+     * @var string
+     */
+    protected $cipher_name_openssl = 'chacha20';
+
+    /**
+     * Test for engine validity
+     *
+     * This is mainly just a wrapper to set things up for \phpseclib3\Crypt\Common\SymmetricKey::isValidEngine()
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::__construct()
+     * @param int $engine
+     * @return bool
+     */
+    protected function isValidEngineHelper($engine)
+    {
+        switch ($engine) {
+            case self::ENGINE_LIBSODIUM:
+                // PHP 7.2.0 (30 Nov 2017) added support for libsodium
+
+                // we could probably make it so that if $this->counter == 0 then the first block would be done with either OpenSSL
+                // or PHP and then subsequent blocks would then be done with libsodium but idk - it's not a high priority atm
+
+                // we could also make it so that if $this->counter == 0 and $this->continuousBuffer then do the first string
+                // with libsodium and subsequent strings with openssl or pure-PHP but again not a high priority
+                return function_exists('sodium_crypto_aead_chacha20poly1305_ietf_encrypt') &&
+                       $this->key_length == 32 &&
+                       (($this->usePoly1305 && !isset($this->poly1305Key) && $this->counter == 0) || $this->counter == 1) &&
+                       !$this->continuousBuffer;
+            case self::ENGINE_OPENSSL:
+                // OpenSSL 1.1.0 (released 25 Aug 2016) added support for chacha20.
+                // PHP didn't support OpenSSL 1.1.0 until 7.0.19 (11 May 2017)
+
+                // if you attempt to provide openssl with a 128 bit key (as opposed to a 256 bit key) openssl will null
+                // pad the key to 256 bits and still use the expansion constant for 256-bit keys. the fact that
+                // openssl treats the IV as both the counter and nonce, however, let's us use openssl in continuous mode
+                // whereas libsodium does not
+                if ($this->key_length != 32) {
+                    return false;
+                }
+        }
+
+        return parent::isValidEngineHelper($engine);
+    }
+
+    /**
+     * Encrypts a message.
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::decrypt()
+     * @see self::crypt()
+     * @param string $plaintext
+     * @return string $ciphertext
+     */
+    public function encrypt($plaintext)
+    {
+        $this->setup();
+
+        if ($this->engine == self::ENGINE_LIBSODIUM) {
+            return $this->encrypt_with_libsodium($plaintext);
+        }
+
+        return parent::encrypt($plaintext);
+    }
+
+    /**
+     * Decrypts a message.
+     *
+     * $this->decrypt($this->encrypt($plaintext)) == $this->encrypt($this->encrypt($plaintext)).
+     * At least if the continuous buffer is disabled.
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::encrypt()
+     * @see self::crypt()
+     * @param string $ciphertext
+     * @return string $plaintext
+     */
+    public function decrypt($ciphertext)
+    {
+        $this->setup();
+
+        if ($this->engine == self::ENGINE_LIBSODIUM) {
+            return $this->decrypt_with_libsodium($ciphertext);
+        }
+
+        return parent::decrypt($ciphertext);
+    }
+
+    /**
+     * Encrypts a message with libsodium
+     *
+     * @see self::encrypt()
+     * @param string $plaintext
+     * @return string $text
+     */
+    private function encrypt_with_libsodium($plaintext)
+    {
+        $params = [$plaintext, $this->aad, $this->nonce, $this->key];
+        $ciphertext = strlen($this->nonce) == 8 ?
+            sodium_crypto_aead_chacha20poly1305_encrypt(...$params) :
+            sodium_crypto_aead_chacha20poly1305_ietf_encrypt(...$params);
+        if (!$this->usePoly1305) {
+            return substr($ciphertext, 0, strlen($plaintext));
+        }
+
+        $newciphertext = substr($ciphertext, 0, strlen($plaintext));
+
+        $this->newtag = $this->usingGeneratedPoly1305Key && strlen($this->nonce) == 12 ?
+            substr($ciphertext, strlen($plaintext)) :
+            $this->poly1305($newciphertext);
+
+        return $newciphertext;
+    }
+
+    /**
+     * Decrypts a message with libsodium
+     *
+     * @see self::decrypt()
+     * @param string $ciphertext
+     * @return string $text
+     */
+    private function decrypt_with_libsodium($ciphertext)
+    {
+        $params = [$ciphertext, $this->aad, $this->nonce, $this->key];
+
+        if (isset($this->poly1305Key)) {
+            if ($this->oldtag === false) {
+                throw new InsufficientSetupException('Authentication Tag has not been set');
+            }
+            if ($this->usingGeneratedPoly1305Key && strlen($this->nonce) == 12) {
+                $plaintext = sodium_crypto_aead_chacha20poly1305_ietf_decrypt(...$params);
+                $this->oldtag = false;
+                if ($plaintext === false) {
+                    throw new BadDecryptionException('Derived authentication tag and supplied authentication tag do not match');
+                }
+                return $plaintext;
+            }
+            $newtag = $this->poly1305($ciphertext);
+            if ($this->oldtag != substr($newtag, 0, strlen($this->oldtag))) {
+                $this->oldtag = false;
+                throw new BadDecryptionException('Derived authentication tag and supplied authentication tag do not match');
+            }
+            $this->oldtag = false;
+        }
+
+        $plaintext = strlen($this->nonce) == 8 ?
+            sodium_crypto_aead_chacha20poly1305_encrypt(...$params) :
+            sodium_crypto_aead_chacha20poly1305_ietf_encrypt(...$params);
+
+        return substr($plaintext, 0, strlen($ciphertext));
+    }
+
+    /**
+     * Sets the nonce.
+     *
+     * @param string $nonce
+     */
+    public function setNonce($nonce)
+    {
+        if (!is_string($nonce)) {
+            throw new \UnexpectedValueException('The nonce should be a string');
+        }
+
+        /*
+          from https://tools.ietf.org/html/rfc7539#page-7
+
+          "Note also that the original ChaCha had a 64-bit nonce and 64-bit
+           block count.  We have modified this here to be more consistent with
+           recommendations in Section 3.2 of [RFC5116]."
+         */
+        switch (strlen($nonce)) {
+            case 8:  // 64 bits
+            case 12: // 96 bits
+                break;
+            default:
+                throw new \LengthException('Nonce of size ' . strlen($nonce) . ' not supported by this algorithm. Only 64-bit nonces or 96-bit nonces are supported');
+        }
+
+        $this->nonce = $nonce;
+        $this->changed = true;
+        $this->setEngine();
+    }
+
+    /**
+     * Setup the self::ENGINE_INTERNAL $engine
+     *
+     * (re)init, if necessary, the internal cipher $engine
+     *
+     * _setup() will be called each time if $changed === true
+     * typically this happens when using one or more of following public methods:
+     *
+     * - setKey()
+     *
+     * - setNonce()
+     *
+     * - First run of encrypt() / decrypt() with no init-settings
+     *
+     * @see self::setKey()
+     * @see self::setNonce()
+     * @see self::disableContinuousBuffer()
+     */
+    protected function setup()
+    {
+        if (!$this->changed) {
+            return;
+        }
+
+        $this->enbuffer = $this->debuffer = ['ciphertext' => '', 'counter' => $this->counter];
+
+        $this->changed = $this->nonIVChanged = false;
+
+        if ($this->nonce === false) {
+            throw new InsufficientSetupException('No nonce has been defined');
+        }
+
+        if ($this->key === false) {
+            throw new InsufficientSetupException('No key has been defined');
+        }
+
+        if ($this->usePoly1305 && !isset($this->poly1305Key)) {
+            $this->usingGeneratedPoly1305Key = true;
+            if ($this->engine == self::ENGINE_LIBSODIUM) {
+                return;
+            }
+            $this->createPoly1305Key();
+        }
+
+        $key = $this->key;
+        if (strlen($key) == 16) {
+            $constant = 'expand 16-byte k';
+            $key .= $key;
+        } else {
+            $constant = 'expand 32-byte k';
+        }
+
+        $this->p1 = $constant . $key;
+        $this->p2 = $this->nonce;
+        if (strlen($this->nonce) == 8) {
+            $this->p2 = "\0\0\0\0" . $this->p2;
+        }
+    }
+
+    /**
+     * The quarterround function
+     *
+     * @param int $a
+     * @param int $b
+     * @param int $c
+     * @param int $d
+     */
+    protected static function quarterRound(&$a, &$b, &$c, &$d)
+    {
+        // in https://datatracker.ietf.org/doc/html/rfc7539#section-2.1 the addition,
+        // xor'ing and rotation are all on the same line so i'm keeping it on the same
+        // line here as well
+        // @codingStandardsIgnoreStart
+        $a+= $b; $d = self::leftRotate(intval($d) ^ intval($a), 16);
+        $c+= $d; $b = self::leftRotate(intval($b) ^ intval($c), 12);
+        $a+= $b; $d = self::leftRotate(intval($d) ^ intval($a), 8);
+        $c+= $d; $b = self::leftRotate(intval($b) ^ intval($c), 7);
+        // @codingStandardsIgnoreEnd
+    }
+
+    /**
+     * The doubleround function
+     *
+     * @param int $x0 (by reference)
+     * @param int $x1 (by reference)
+     * @param int $x2 (by reference)
+     * @param int $x3 (by reference)
+     * @param int $x4 (by reference)
+     * @param int $x5 (by reference)
+     * @param int $x6 (by reference)
+     * @param int $x7 (by reference)
+     * @param int $x8 (by reference)
+     * @param int $x9 (by reference)
+     * @param int $x10 (by reference)
+     * @param int $x11 (by reference)
+     * @param int $x12 (by reference)
+     * @param int $x13 (by reference)
+     * @param int $x14 (by reference)
+     * @param int $x15 (by reference)
+     */
+    protected static function doubleRound(&$x0, &$x1, &$x2, &$x3, &$x4, &$x5, &$x6, &$x7, &$x8, &$x9, &$x10, &$x11, &$x12, &$x13, &$x14, &$x15)
+    {
+        // columnRound
+        static::quarterRound($x0, $x4, $x8, $x12);
+        static::quarterRound($x1, $x5, $x9, $x13);
+        static::quarterRound($x2, $x6, $x10, $x14);
+        static::quarterRound($x3, $x7, $x11, $x15);
+        // rowRound
+        static::quarterRound($x0, $x5, $x10, $x15);
+        static::quarterRound($x1, $x6, $x11, $x12);
+        static::quarterRound($x2, $x7, $x8, $x13);
+        static::quarterRound($x3, $x4, $x9, $x14);
+    }
+
+    /**
+     * The Salsa20 hash function function
+     *
+     * On my laptop this loop unrolled / function dereferenced version of parent::salsa20 encrypts 1mb of text in
+     * 0.65s vs the 0.85s that it takes with the parent method.
+     *
+     * If we were free to assume that the host OS would always be 64-bits then the if condition in leftRotate could
+     * be eliminated and we could knock this done to 0.60s.
+     *
+     * For comparison purposes, RC4 takes 0.16s and AES in CTR mode with the Eval engine takes 0.48s.
+     * AES in CTR mode with the PHP engine takes 1.19s. Salsa20 / ChaCha20 do not benefit as much from the Eval
+     * approach due to the fact that there are a lot less variables to de-reference, fewer loops to unroll, etc
+     *
+     * @param string $x
+     */
+    protected static function salsa20($x)
+    {
+        list(, $x0, $x1, $x2, $x3, $x4, $x5, $x6, $x7, $x8, $x9, $x10, $x11, $x12, $x13, $x14, $x15) = unpack('V*', $x);
+        $z0 = $x0;
+        $z1 = $x1;
+        $z2 = $x2;
+        $z3 = $x3;
+        $z4 = $x4;
+        $z5 = $x5;
+        $z6 = $x6;
+        $z7 = $x7;
+        $z8 = $x8;
+        $z9 = $x9;
+        $z10 = $x10;
+        $z11 = $x11;
+        $z12 = $x12;
+        $z13 = $x13;
+        $z14 = $x14;
+        $z15 = $x15;
+
+        // @codingStandardsIgnoreStart
+        // columnRound
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 16);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 12);
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 8);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 7);
+
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 16);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 12);
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 8);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 7);
+
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 16);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 12);
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 8);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 7);
+
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 16);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 12);
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 8);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 7);
+
+        // rowRound
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 16);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 12);
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 8);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 7);
+
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 16);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 12);
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 8);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 7);
+
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 16);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 12);
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 8);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 7);
+
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 16);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 12);
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 8);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 7);
+
+        // columnRound
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 16);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 12);
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 8);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 7);
+
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 16);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 12);
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 8);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 7);
+
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 16);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 12);
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 8);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 7);
+
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 16);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 12);
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 8);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 7);
+
+        // rowRound
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 16);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 12);
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 8);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 7);
+
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 16);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 12);
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 8);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 7);
+
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 16);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 12);
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 8);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 7);
+
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 16);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 12);
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 8);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 7);
+
+        // columnRound
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 16);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 12);
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 8);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 7);
+
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 16);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 12);
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 8);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 7);
+
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 16);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 12);
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 8);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 7);
+
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 16);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 12);
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 8);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 7);
+
+        // rowRound
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 16);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 12);
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 8);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 7);
+
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 16);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 12);
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 8);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 7);
+
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 16);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 12);
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 8);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 7);
+
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 16);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 12);
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 8);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 7);
+
+        // columnRound
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 16);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 12);
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 8);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 7);
+
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 16);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 12);
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 8);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 7);
+
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 16);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 12);
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 8);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 7);
+
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 16);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 12);
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 8);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 7);
+
+        // rowRound
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 16);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 12);
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 8);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 7);
+
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 16);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 12);
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 8);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 7);
+
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 16);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 12);
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 8);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 7);
+
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 16);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 12);
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 8);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 7);
+
+        // columnRound
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 16);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 12);
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 8);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 7);
+
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 16);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 12);
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 8);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 7);
+
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 16);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 12);
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 8);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 7);
+
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 16);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 12);
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 8);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 7);
+
+        // rowRound
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 16);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 12);
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 8);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 7);
+
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 16);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 12);
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 8);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 7);
+
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 16);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 12);
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 8);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 7);
+
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 16);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 12);
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 8);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 7);
+
+        // columnRound
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 16);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 12);
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 8);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 7);
+
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 16);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 12);
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 8);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 7);
+
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 16);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 12);
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 8);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 7);
+
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 16);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 12);
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 8);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 7);
+
+        // rowRound
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 16);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 12);
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 8);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 7);
+
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 16);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 12);
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 8);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 7);
+
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 16);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 12);
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 8);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 7);
+
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 16);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 12);
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 8);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 7);
+
+        // columnRound
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 16);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 12);
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 8);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 7);
+
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 16);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 12);
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 8);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 7);
+
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 16);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 12);
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 8);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 7);
+
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 16);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 12);
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 8);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 7);
+
+        // rowRound
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 16);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 12);
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 8);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 7);
+
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 16);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 12);
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 8);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 7);
+
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 16);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 12);
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 8);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 7);
+
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 16);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 12);
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 8);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 7);
+
+        // columnRound
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 16);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 12);
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 8);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 7);
+
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 16);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 12);
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 8);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 7);
+
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 16);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 12);
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 8);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 7);
+
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 16);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 12);
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 8);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 7);
+
+        // rowRound
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 16);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 12);
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 8);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 7);
+
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 16);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 12);
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 8);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 7);
+
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 16);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 12);
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 8);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 7);
+
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 16);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 12);
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 8);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 7);
+
+        // columnRound
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 16);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 12);
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 8);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 7);
+
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 16);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 12);
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 8);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 7);
+
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 16);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 12);
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 8);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 7);
+
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 16);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 12);
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 8);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 7);
+
+        // rowRound
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 16);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 12);
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 8);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 7);
+
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 16);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 12);
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 8);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 7);
+
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 16);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 12);
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 8);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 7);
+
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 16);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 12);
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 8);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 7);
+
+        // columnRound
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 16);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 12);
+        $x0+= $x4; $x12 = self::leftRotate(intval($x12) ^ intval($x0), 8);
+        $x8+= $x12; $x4 = self::leftRotate(intval($x4) ^ intval($x8), 7);
+
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 16);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 12);
+        $x1+= $x5; $x13 = self::leftRotate(intval($x13) ^ intval($x1), 8);
+        $x9+= $x13; $x5 = self::leftRotate(intval($x5) ^ intval($x9), 7);
+
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 16);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 12);
+        $x2+= $x6; $x14 = self::leftRotate(intval($x14) ^ intval($x2), 8);
+        $x10+= $x14; $x6 = self::leftRotate(intval($x6) ^ intval($x10), 7);
+
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 16);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 12);
+        $x3+= $x7; $x15 = self::leftRotate(intval($x15) ^ intval($x3), 8);
+        $x11+= $x15; $x7 = self::leftRotate(intval($x7) ^ intval($x11), 7);
+
+        // rowRound
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 16);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 12);
+        $x0+= $x5; $x15 = self::leftRotate(intval($x15) ^ intval($x0), 8);
+        $x10+= $x15; $x5 = self::leftRotate(intval($x5) ^ intval($x10), 7);
+
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 16);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 12);
+        $x1+= $x6; $x12 = self::leftRotate(intval($x12) ^ intval($x1), 8);
+        $x11+= $x12; $x6 = self::leftRotate(intval($x6) ^ intval($x11), 7);
+
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 16);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 12);
+        $x2+= $x7; $x13 = self::leftRotate(intval($x13) ^ intval($x2), 8);
+        $x8+= $x13; $x7 = self::leftRotate(intval($x7) ^ intval($x8), 7);
+
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 16);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 12);
+        $x3+= $x4; $x14 = self::leftRotate(intval($x14) ^ intval($x3), 8);
+        $x9+= $x14; $x4 = self::leftRotate(intval($x4) ^ intval($x9), 7);
+        // @codingStandardsIgnoreEnd
+
+        $x0 += $z0;
+        $x1 += $z1;
+        $x2 += $z2;
+        $x3 += $z3;
+        $x4 += $z4;
+        $x5 += $z5;
+        $x6 += $z6;
+        $x7 += $z7;
+        $x8 += $z8;
+        $x9 += $z9;
+        $x10 += $z10;
+        $x11 += $z11;
+        $x12 += $z12;
+        $x13 += $z13;
+        $x14 += $z14;
+        $x15 += $z15;
+
+        return pack('V*', $x0, $x1, $x2, $x3, $x4, $x5, $x6, $x7, $x8, $x9, $x10, $x11, $x12, $x13, $x14, $x15);
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Common/AsymmetricKey.php ---
@@ -0,0 +1,581 @@
+<?php
+
+/**
+ * Base Class for all asymmetric key ciphers
+ *
+ * PHP version 5
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2016 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\Common;
+
+use phpseclib3\Crypt\DSA;
+use phpseclib3\Crypt\Hash;
+use phpseclib3\Crypt\RSA;
+use phpseclib3\Exception\NoKeyLoadedException;
+use phpseclib3\Exception\UnsupportedFormatException;
+use phpseclib3\Math\BigInteger;
+
+/**
+ * Base Class for all asymmetric cipher classes
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class AsymmetricKey
+{
+    /**
+     * Precomputed Zero
+     *
+     * @var \phpseclib3\Math\BigInteger
+     */
+    protected static $zero;
+
+    /**
+     * Precomputed One
+     *
+     * @var \phpseclib3\Math\BigInteger
+     */
+    protected static $one;
+
+    /**
+     * Format of the loaded key
+     *
+     * @var string
+     */
+    protected $format;
+
+    /**
+     * Hash function
+     *
+     * @var \phpseclib3\Crypt\Hash
+     */
+    protected $hash;
+
+    /**
+     * HMAC function
+     *
+     * @var \phpseclib3\Crypt\Hash
+     */
+    private $hmac;
+
+    /**
+     * Supported plugins (lower case)
+     *
+     * @see self::initialize_static_variables()
+     * @var array
+     */
+    private static $plugins = [];
+
+    /**
+     * Invisible plugins
+     *
+     * @see self::initialize_static_variables()
+     * @var array
+     */
+    private static $invisiblePlugins = [];
+
+    /**
+     * Available Engines
+     *
+     * @var boolean[]
+     */
+    protected static $engines = [];
+
+    /**
+     * Key Comment
+     *
+     * @var null|string
+     */
+    private $comment;
+
+    /**
+     * @param string $type
+     * @return array|string
+     */
+    abstract public function toString($type, array $options = []);
+
+    /**
+     * The constructor
+     */
+    protected function __construct()
+    {
+        self::initialize_static_variables();
+
+        $this->hash = new Hash('sha256');
+        $this->hmac = new Hash('sha256');
+    }
+
+    /**
+     * Initialize static variables
+     */
+    protected static function initialize_static_variables()
+    {
+        if (!isset(self::$zero)) {
+            self::$zero = new BigInteger(0);
+            self::$one = new BigInteger(1);
+        }
+
+        self::loadPlugins('Keys');
+        if (static::ALGORITHM != 'RSA' && static::ALGORITHM != 'DH') {
+            self::loadPlugins('Signature');
+        }
+    }
+
+    /**
+     * Load the key
+     *
+     * @param string $key
+     * @param string $password optional
+     * @return \phpseclib3\Crypt\Common\PublicKey|\phpseclib3\Crypt\Common\PrivateKey
+     */
+    public static function load($key, $password = false)
+    {
+        self::initialize_static_variables();
+
+        $class = new \ReflectionClass(static::class);
+        if ($class->isFinal()) {
+            throw new \RuntimeException('load() should not be called from final classes (' . static::class . ')');
+        }
+
+        $components = false;
+        foreach (self::$plugins[static::ALGORITHM]['Keys'] as $format) {
+            if (isset(self::$invisiblePlugins[static::ALGORITHM]) && in_array($format, self::$invisiblePlugins[static::ALGORITHM])) {
+                continue;
+            }
+            try {
+                $components = $format::load($key, $password);
+            } catch (\Exception $e) {
+                $components = false;
+            }
+            if ($components !== false) {
+                break;
+            }
+        }
+
+        if ($components === false) {
+            throw new NoKeyLoadedException('Unable to read key');
+        }
+
+        $components['format'] = $format;
+        $components['secret'] = isset($components['secret']) ? $components['secret'] : '';
+        $comment = isset($components['comment']) ? $components['comment'] : null;
+        $new = static::onLoad($components);
+        $new->format = $format;
+        $new->comment = $comment;
+        return $new instanceof PrivateKey ?
+            $new->withPassword($password) :
+            $new;
+    }
+
+    /**
+     * Loads a private key
+     *
+     * @return PrivateKey
+     * @param string|array $key
+     * @param string $password optional
+     */
+    public static function loadPrivateKey($key, $password = '')
+    {
+        $key = self::load($key, $password);
+        if (!$key instanceof PrivateKey) {
+            throw new NoKeyLoadedException('The key that was loaded was not a private key');
+        }
+        return $key;
+    }
+
+    /**
+     * Loads a public key
+     *
+     * @return PublicKey
+     * @param string|array $key
+     */
+    public static function loadPublicKey($key)
+    {
+        $key = self::load($key);
+        if (!$key instanceof PublicKey) {
+            throw new NoKeyLoadedException('The key that was loaded was not a public key');
+        }
+        return $key;
+    }
+
+    /**
+     * Loads parameters
+     *
+     * @return AsymmetricKey
+     * @param string|array $key
+     */
+    public static function loadParameters($key)
+    {
+        $key = self::load($key);
+        if (!$key instanceof PrivateKey && !$key instanceof PublicKey) {
+            throw new NoKeyLoadedException('The key that was loaded was not a parameter');
+        }
+        return $key;
+    }
+
+    /**
+     * Load the key, assuming a specific format
+     *
+     * @param string $type
+     * @param string $key
+     * @param string $password optional
+     * @return static
+     */
+    public static function loadFormat($type, $key, $password = false)
+    {
+        self::initialize_static_variables();
+
+        $components = false;
+        $format = strtolower($type);
+        if (isset(self::$plugins[static::ALGORITHM]['Keys'][$format])) {
+            $format = self::$plugins[static::ALGORITHM]['Keys'][$format];
+            $components = $format::load($key, $password);
+        }
+
+        if ($components === false) {
+            throw new NoKeyLoadedException('Unable to read key');
+        }
+
+        $components['format'] = $format;
+        $components['secret'] = isset($components['secret']) ? $components['secret'] : '';
+
+        $new = static::onLoad($components);
+        $new->format = $format;
+        return $new instanceof PrivateKey ?
+            $new->withPassword($password) :
+            $new;
+    }
+
+    /**
+     * Loads a private key
+     *
+     * @return PrivateKey
+     * @param string $type
+     * @param string $key
+     * @param string $password optional
+     */
+    public static function loadPrivateKeyFormat($type, $key, $password = false)
+    {
+        $key = self::loadFormat($type, $key, $password);
+        if (!$key instanceof PrivateKey) {
+            throw new NoKeyLoadedException('The key that was loaded was not a private key');
+        }
+        return $key;
+    }
+
+    /**
+     * Loads a public key
+     *
+     * @return PublicKey
+     * @param string $type
+     * @param string $key
+     */
+    public static function loadPublicKeyFormat($type, $key)
+    {
+        $key = self::loadFormat($type, $key);
+        if (!$key instanceof PublicKey) {
+            throw new NoKeyLoadedException('The key that was loaded was not a public key');
+        }
+        return $key;
+    }
+
+    /**
+     * Loads parameters
+     *
+     * @return AsymmetricKey
+     * @param string $type
+     * @param string|array $key
+     */
+    public static function loadParametersFormat($type, $key)
+    {
+        $key = self::loadFormat($type, $key);
+        if (!$key instanceof PrivateKey && !$key instanceof PublicKey) {
+            throw new NoKeyLoadedException('The key that was loaded was not a parameter');
+        }
+        return $key;
+    }
+
+    /**
+     * Validate Plugin
+     *
+     * @param string $format
+     * @param string $type
+     * @param string $method optional
+     * @return mixed
+     */
+    protected static function validatePlugin($format, $type, $method = null)
+    {
+        $type = strtolower($type);
+        if (!isset(self::$plugins[static::ALGORITHM][$format][$type])) {
+            throw new UnsupportedFormatException("$type is not a supported format");
+        }
+        $type = self::$plugins[static::ALGORITHM][$format][$type];
+        if (isset($method) && !method_exists($type, $method)) {
+            throw new UnsupportedFormatException("$type does not implement $method");
+        }
+
+        return $type;
+    }
+
+    /**
+     * Load Plugins
+     *
+     * @param string $format
+     */
+    private static function loadPlugins($format)
+    {
+        if (!isset(self::$plugins[static::ALGORITHM][$format])) {
+            self::$plugins[static::ALGORITHM][$format] = [];
+            foreach (new \DirectoryIterator(__DIR__ . '/../' . static::ALGORITHM . '/Formats/' . $format . '/') as $file) {
+                if ($file->getExtension() != 'php') {
+                    continue;
+                }
+                $name = $file->getBasename('.php');
+                if ($name[0] == '.') {
+                    continue;
+                }
+                $type = 'phpseclib3\Crypt\\' . static::ALGORITHM . '\\Formats\\' . $format . '\\' . $name;
+                $reflect = new \ReflectionClass($type);
+                if ($reflect->isTrait()) {
+                    continue;
+                }
+                self::$plugins[static::ALGORITHM][$format][strtolower($name)] = $type;
+                if ($reflect->hasConstant('IS_INVISIBLE')) {
+                    self::$invisiblePlugins[static::ALGORITHM][] = $type;
+                }
+            }
+        }
+    }
+
+    /**
+     * Returns a list of supported formats.
+     *
+     * @return array
+     */
+    public static function getSupportedKeyFormats()
+    {
+        self::initialize_static_variables();
+
+        return self::$plugins[static::ALGORITHM]['Keys'];
+    }
+
+    /**
+     * Add a fileformat plugin
+     *
+     * The plugin needs to either already be loaded or be auto-loadable.
+     * Loading a plugin whose shortname overwrite an existing shortname will overwrite the old plugin.
+     *
+     * @see self::load()
+     * @param string $fullname
+     * @return bool
+     */
+    public static function addFileFormat($fullname)
+    {
+        self::initialize_static_variables();
+
+        if (class_exists($fullname)) {
+            $meta = new \ReflectionClass($fullname);
+            $shortname = $meta->getShortName();
+            self::$plugins[static::ALGORITHM]['Keys'][strtolower($shortname)] = $fullname;
+            if ($meta->hasConstant('IS_INVISIBLE')) {
+                self::$invisiblePlugins[static::ALGORITHM][] = strtolower($shortname);
+            }
+        }
+    }
+
+    /**
+     * Returns the format of the loaded key.
+     *
+     * If the key that was loaded wasn't in a valid or if the key was auto-generated
+     * with RSA::createKey() then this will throw an exception.
+     *
+     * @see self::load()
+     * @return mixed
+     */
+    public function getLoadedFormat()
+    {
+        if (empty($this->format)) {
+            throw new NoKeyLoadedException('This key was created with createKey - it was not loaded with load. Therefore there is no "loaded format"');
+        }
+
+        $meta = new \ReflectionClass($this->format);
+        return $meta->getShortName();
+    }
+
+    /**
+     * Returns the key's comment
+     *
+     * Not all key formats support comments. If you want to set a comment use toString()
+     *
+     * @return null|string
+     */
+    public function getComment()
+    {
+        return $this->comment;
+    }
+
+    /**
+     * Tests engine validity
+     *
+     */
+    public static function useBestEngine()
+    {
+        static::$engines = [
+            'PHP' => true,
+            'OpenSSL' => extension_loaded('openssl'),
+            // this test can be satisfied by either of the following:
+            // http://php.net/manual/en/book.sodium.php
+            // https://github.com/paragonie/sodium_compat
+            'libsodium' => function_exists('sodium_crypto_sign_keypair')
+        ];
+
+        return static::$engines;
+    }
+
+    /**
+     * Flag to use internal engine only (useful for unit testing)
+     *
+     */
+    public static function useInternalEngine()
+    {
+        static::$engines = [
+            'PHP' => true,
+            'OpenSSL' => false,
+            'libsodium' => false
+        ];
+    }
+
+    /**
+     * __toString() magic method
+     *
+     * @return string
+     */
+    public function __toString()
+    {
+        return $this->toString('PKCS8');
+    }
+
+    /**
+     * Determines which hashing function should be used
+     *
+     * @param string $hash
+     */
+    public function withHash($hash)
+    {
+        $new = clone $this;
+
+        $new->hash = new Hash($hash);
+        $new->hmac = new Hash($hash);
+
+        return $new;
+    }
+
+    /**
+     * Returns the hash algorithm currently being used
+     *
+     */
+    public function getHash()
+    {
+        return clone $this->hash;
+    }
+
+    /**
+     * Compute the pseudorandom k for signature generation,
+     * using the process specified for deterministic DSA.
+     *
+     * @param string $h1
+     * @return string
+     */
+    protected function computek($h1)
+    {
+        $v = str_repeat("\1", strlen($h1));
+
+        $k = str_repeat("\0", strlen($h1));
+
+        $x = $this->int2octets($this->x);
+        $h1 = $this->bits2octets($h1);
+
+        $this->hmac->setKey($k);
+        $k = $this->hmac->hash($v . "\0" . $x . $h1);
+        $this->hmac->setKey($k);
+        $v = $this->hmac->hash($v);
+        $k = $this->hmac->hash($v . "\1" . $x . $h1);
+        $this->hmac->setKey($k);
+        $v = $this->hmac->hash($v);
+
+        $qlen = $this->q->getLengthInBytes();
+
+        while (true) {
+            $t = '';
+            while (strlen($t) < $qlen) {
+                $v = $this->hmac->hash($v);
+                $t = $t . $v;
+            }
+            $k = $this->bits2int($t);
+
+            if (!$k->equals(self::$zero) && $k->compare($this->q) < 0) {
+                break;
+            }
+            $k = $this->hmac->hash($v . "\0");
+            $this->hmac->setKey($k);
+            $v = $this->hmac->hash($v);
+        }
+
+        return $k;
+    }
+
+    /**
+     * Integer to Octet String
+     *
+     * @param \phpseclib3\Math\BigInteger $v
+     * @return string
+     */
+    private function int2octets($v)
+    {
+        $out = $v->toBytes();
+        $rolen = $this->q->getLengthInBytes();
+        if (strlen($out) < $rolen) {
+            return str_pad($out, $rolen, "\0", STR_PAD_LEFT);
+        } elseif (strlen($out) > $rolen) {
+            return substr($out, -$rolen);
+        } else {
+            return $out;
+        }
+    }
+
+    /**
+     * Bit String to Integer
+     *
+     * @param string $in
+     * @return \phpseclib3\Math\BigInteger
+     */
+    protected function bits2int($in)
+    {
+        $v = new BigInteger($in, 256);
+        $vlen = strlen($in) << 3;
+        $qlen = $this->q->getLength();
+        if ($vlen > $qlen) {
+            return $v->bitwise_rightShift($vlen - $qlen);
+        }
+        return $v;
+    }
+
+    /**
+     * Bit String to Octet String
+     *
+     * @param string $in
+     * @return string
+     */
+    private function bits2octets($in)
+    {
+        $z1 = $this->bits2int($in);
+        $z2 = $z1->subtract($this->q);
+        return $z2->compare(self::$zero) < 0 ?
+            $this->int2octets($z1) :
+            $this->int2octets($z2);
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Common/BlockCipher.php ---
@@ -0,0 +1,24 @@
+<?php
+
+/**
+ * Base Class for all block ciphers
+ *
+ * PHP version 5
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @author    Hans-Juergen Petrich <petrich@tronic-media.com>
+ * @copyright 2007 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\Common;
+
+/**
+ * Base Class for all block cipher classes
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class BlockCipher extends SymmetricKey
+{
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Common/Formats/Keys/JWK.php ---
@@ -0,0 +1,69 @@
+<?php
+
+/**
+ * JSON Web Key (RFC7517) Handler
+ *
+ * PHP version 5
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\Common\Formats\Keys;
+
+use phpseclib3\Common\Functions\Strings;
+
+/**
+ * JSON Web Key Formatted Key Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class JWK
+{
+    /**
+     * Break a public or private key down into its constituent components
+     *
+     * @param string $key
+     * @param string $password
+     * @return array
+     */
+    public static function load($key, $password = '')
+    {
+        if (!Strings::is_stringable($key)) {
+            throw new \UnexpectedValueException('Key should be a string - not a ' . gettype($key));
+        }
+
+        $key = preg_replace('#\s#', '', $key); // remove whitespace
+
+        if (PHP_VERSION_ID >= 73000) {
+            $key = json_decode($key, null, 512, JSON_THROW_ON_ERROR);
+        } else {
+            $key = json_decode($key);
+            if (!$key) {
+                throw new \RuntimeException('Unable to decode JSON');
+            }
+        }
+
+        if (isset($key->kty)) {
+            return $key;
+        }
+
+        if (count($key->keys) != 1) {
+            throw new \RuntimeException('Although the JWK key format supports multiple keys phpseclib does not');
+        }
+
+        return $key->keys[0];
+    }
+
+    /**
+     * Wrap a key appropriately
+     *
+     * @return string
+     */
+    protected static function wrapKey(array $key, array $options)
+    {
+        return json_encode(['keys' => [$key + $options]]);
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Common/Formats/Keys/OpenSSH.php ---
@@ -0,0 +1,220 @@
+<?php
+
+/**
+ * OpenSSH Key Handler
+ *
+ * PHP version 5
+ *
+ * Place in $HOME/.ssh/authorized_keys
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\Common\Formats\Keys;
+
+use phpseclib3\Common\Functions\Strings;
+use phpseclib3\Crypt\AES;
+use phpseclib3\Crypt\Random;
+
+/**
+ * OpenSSH Formatted RSA Key Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class OpenSSH
+{
+    /**
+     * Default comment
+     *
+     * @var string
+     */
+    protected static $comment = 'phpseclib-generated-key';
+
+    /**
+     * Binary key flag
+     *
+     * @var bool
+     */
+    protected static $binary = false;
+
+    /**
+     * Sets the default comment
+     *
+     * @param string $comment
+     */
+    public static function setComment($comment)
+    {
+        self::$comment = str_replace(["\r", "\n"], '', $comment);
+    }
+
+    /**
+     * Break a public or private key down into its constituent components
+     *
+     * $type can be either ssh-dss or ssh-rsa
+     *
+     * @param string $key
+     * @param string $password
+     * @return array
+     */
+    public static function load($key, $password = '')
+    {
+        if (!Strings::is_stringable($key)) {
+            throw new \UnexpectedValueException('Key should be a string - not a ' . gettype($key));
+        }
+
+        // key format is described here:
+        // https://cvsweb.openbsd.org/cgi-bin/cvsweb/src/usr.bin/ssh/PROTOCOL.key?annotate=HEAD
+
+        if (strpos($key, 'BEGIN OPENSSH PRIVATE KEY') !== false) {
+            $key = preg_replace('#(?:^-.*?-[\r\n]*$)|\s#ms', '', $key);
+            $key = Strings::base64_decode($key);
+            $magic = Strings::shift($key, 15);
+            if ($magic != "openssh-key-v1\0") {
+                throw new \RuntimeException('Expected openssh-key-v1');
+            }
+            list($ciphername, $kdfname, $kdfoptions, $numKeys) = Strings::unpackSSH2('sssN', $key);
+            if ($numKeys != 1) {
+                // if we wanted to support multiple keys we could update PublicKeyLoader to preview what the # of keys
+                // would be; it'd then call Common\Keys\OpenSSH.php::load() and get the paddedKey. it'd then pass
+                // that to the appropriate key loading parser $numKey times or something
+                throw new \RuntimeException('Although the OpenSSH private key format supports multiple keys phpseclib does not');
+            }
+            switch ($ciphername) {
+                case 'none':
+                    break;
+                case 'aes256-ctr':
+                    if ($kdfname != 'bcrypt') {
+                        throw new \RuntimeException('Only the bcrypt kdf is supported (' . $kdfname . ' encountered)');
+                    }
+                    list($salt, $rounds) = Strings::unpackSSH2('sN', $kdfoptions);
+                    $crypto = new AES('ctr');
+                    //$crypto->setKeyLength(256);
+                    //$crypto->disablePadding();
+                    $crypto->setPassword($password, 'bcrypt', $salt, $rounds, 32);
+                    break;
+                default:
+                    throw new \RuntimeException('The only supported cipherse are: none, aes256-ctr (' . $ciphername . ' is being used)');
+            }
+
+            list($publicKey, $paddedKey) = Strings::unpackSSH2('ss', $key);
+            list($type) = Strings::unpackSSH2('s', $publicKey);
+            if (isset($crypto)) {
+                $paddedKey = $crypto->decrypt($paddedKey);
+            }
+            list($checkint1, $checkint2) = Strings::unpackSSH2('NN', $paddedKey);
+            // any leftover bytes in $paddedKey are for padding? but they should be sequential bytes. eg. 1, 2, 3, etc.
+            if ($checkint1 != $checkint2) {
+                throw new \RuntimeException('The two checkints do not match');
+            }
+            self::checkType($type);
+
+            return compact('type', 'publicKey', 'paddedKey');
+        }
+
+        $parts = explode(' ', $key, 3);
+
+        if (!isset($parts[1])) {
+            $key = base64_decode($parts[0]);
+            $comment = false;
+        } else {
+            $asciiType = $parts[0];
+            self::checkType($parts[0]);
+            $key = base64_decode($parts[1]);
+            $comment = isset($parts[2]) ? $parts[2] : false;
+        }
+        if ($key === false) {
+            throw new \UnexpectedValueException('Key should be a string - not a ' . gettype($key));
+        }
+
+        list($type) = Strings::unpackSSH2('s', $key);
+        self::checkType($type);
+        if (isset($asciiType) && $asciiType != $type) {
+            throw new \RuntimeException('Two different types of keys are claimed: ' . $asciiType . ' and ' . $type);
+        }
+        if (strlen($key) <= 4) {
+            throw new \UnexpectedValueException('Key appears to be malformed');
+        }
+
+        $publicKey = $key;
+
+        return compact('type', 'publicKey', 'comment');
+    }
+
+    /**
+     * Toggle between binary and printable keys
+     *
+     * Printable keys are what are generated by default. These are the ones that go in
+     * $HOME/.ssh/authorized_key.
+     *
+     * @param bool $enabled
+     */
+    public static function setBinaryOutput($enabled)
+    {
+        self::$binary = $enabled;
+    }
+
+    /**
+     * Checks to see if the type is valid
+     *
+     * @param string $candidate
+     */
+    private static function checkType($candidate)
+    {
+        if (!in_array($candidate, static::$types)) {
+            throw new \RuntimeException("The key type ($candidate) is not equal to: " . implode(',', static::$types));
+        }
+    }
+
+    /**
+     * Wrap a private key appropriately
+     *
+     * @param string $publicKey
+     * @param string $privateKey
+     * @param string $password
+     * @param array $options
+     * @return string
+     */
+    protected static function wrapPrivateKey($publicKey, $privateKey, $password, $options)
+    {
+        list(, $checkint) = unpack('N', Random::string(4));
+
+        $comment = isset($options['comment']) ? $options['comment'] : self::$comment;
+        $paddedKey = Strings::packSSH2('NN', $checkint, $checkint) .
+                     $privateKey .
+                     Strings::packSSH2('s', $comment);
+
+        $usesEncryption = !empty($password) && is_string($password);
+
+        /*
+           from http://tools.ietf.org/html/rfc4253#section-6 :
+
+           Note that the length of the concatenation of 'packet_length',
+           'padding_length', 'payload', and 'random padding' MUST be a multiple
+           of the cipher block size or 8, whichever is larger.
+         */
+        $blockSize = $usesEncryption ? 16 : 8;
+        $paddingLength = (($blockSize - 1) * strlen($paddedKey)) % $blockSize;
+        for ($i = 1; $i <= $paddingLength; $i++) {
+            $paddedKey .= chr($i);
+        }
+        if (!$usesEncryption) {
+            $key = Strings::packSSH2('sssNss', 'none', 'none', '', 1, $publicKey, $paddedKey);
+        } else {
+            $rounds = isset($options['rounds']) ? $options['rounds'] : 16;
+            $salt = Random::string(16);
+            $kdfoptions = Strings::packSSH2('sN', $salt, $rounds);
+            $crypto = new AES('ctr');
+            $crypto->setPassword($password, 'bcrypt', $salt, $rounds, 32);
+            $paddedKey = $crypto->encrypt($paddedKey);
+            $key = Strings::packSSH2('sssNss', 'aes256-ctr', 'bcrypt', $kdfoptions, 1, $publicKey, $paddedKey);
+        }
+        $key = "openssh-key-v1\0$key";
+
+        return "-----BEGIN OPENSSH PRIVATE KEY-----\n" .
+               chunk_split(Strings::base64_encode($key), 70, "\n") .
+               "-----END OPENSSH PRIVATE KEY-----\n";
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Common/Formats/Keys/PKCS.php ---
@@ -0,0 +1,72 @@
+<?php
+
+/**
+ * PKCS Formatted Key Handler
+ *
+ * PHP version 5
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\Common\Formats\Keys;
+
+/**
+ * PKCS1 Formatted Key Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class PKCS
+{
+    /**
+     * Auto-detect the format
+     */
+    const MODE_ANY = 0;
+    /**
+     * Require base64-encoded PEM's be supplied
+     */
+    const MODE_PEM = 1;
+    /**
+     * Require raw DER's be supplied
+     */
+    const MODE_DER = 2;
+    /**#@-*/
+
+    /**
+     * Is the key a base-64 encoded PEM, DER or should it be auto-detected?
+     *
+     * @var int
+     */
+    protected static $format = self::MODE_ANY;
+
+    /**
+     * Require base64-encoded PEM's be supplied
+     *
+     */
+    public static function requirePEM()
+    {
+        self::$format = self::MODE_PEM;
+    }
+
+    /**
+     * Require raw DER's be supplied
+     *
+     */
+    public static function requireDER()
+    {
+        self::$format = self::MODE_DER;
+    }
+
+    /**
+     * Accept any format and auto detect the format
+     *
+     * This is the default setting
+     *
+     */
+    public static function requireAny()
+    {
+        self::$format = self::MODE_ANY;
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Common/Formats/Keys/PKCS1.php ---
@@ -0,0 +1,209 @@
+<?php
+
+/**
+ * PKCS1 Formatted Key Handler
+ *
+ * PHP version 5
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\Common\Formats\Keys;
+
+use phpseclib3\Common\Functions\Strings;
+use phpseclib3\Crypt\AES;
+use phpseclib3\Crypt\DES;
+use phpseclib3\Crypt\Random;
+use phpseclib3\Crypt\TripleDES;
+use phpseclib3\Exception\UnsupportedAlgorithmException;
+use phpseclib3\File\ASN1;
+
+/**
+ * PKCS1 Formatted Key Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class PKCS1 extends PKCS
+{
+    /**
+     * Default encryption algorithm
+     *
+     * @var string
+     */
+    private static $defaultEncryptionAlgorithm = 'AES-128-CBC';
+
+    /**
+     * Sets the default encryption algorithm
+     *
+     * @param string $algo
+     */
+    public static function setEncryptionAlgorithm($algo)
+    {
+        self::$defaultEncryptionAlgorithm = $algo;
+    }
+
+    /**
+     * Returns the mode constant corresponding to the mode string
+     *
+     * @param string $mode
+     * @return int
+     * @throws \UnexpectedValueException if the block cipher mode is unsupported
+     */
+    private static function getEncryptionMode($mode)
+    {
+        switch ($mode) {
+            case 'CBC':
+            case 'ECB':
+            case 'CFB':
+            case 'OFB':
+            case 'CTR':
+                return $mode;
+        }
+        throw new \UnexpectedValueException('Unsupported block cipher mode of operation');
+    }
+
+    /**
+     * Returns a cipher object corresponding to a string
+     *
+     * @param string $algo
+     * @return string
+     * @throws \UnexpectedValueException if the encryption algorithm is unsupported
+     */
+    private static function getEncryptionObject($algo)
+    {
+        $modes = '(CBC|ECB|CFB|OFB|CTR)';
+        switch (true) {
+            case preg_match("#^AES-(128|192|256)-$modes$#", $algo, $matches):
+                $cipher = new AES(self::getEncryptionMode($matches[2]));
+                $cipher->setKeyLength($matches[1]);
+                return $cipher;
+            case preg_match("#^DES-EDE3-$modes$#", $algo, $matches):
+                return new TripleDES(self::getEncryptionMode($matches[1]));
+            case preg_match("#^DES-$modes$#", $algo, $matches):
+                return new DES(self::getEncryptionMode($matches[1]));
+            default:
+                throw new UnsupportedAlgorithmException($algo . ' is not a supported algorithm');
+        }
+    }
+
+    /**
+     * Generate a symmetric key for PKCS#1 keys
+     *
+     * @param string $password
+     * @param string $iv
+     * @param int $length
+     * @return string
+     */
+    private static function generateSymmetricKey($password, $iv, $length)
+    {
+        $symkey = '';
+        $iv = substr($iv, 0, 8);
+        while (strlen($symkey) < $length) {
+            $symkey .= md5($symkey . $password . $iv, true);
+        }
+        return substr($symkey, 0, $length);
+    }
+
+    /**
+     * Break a public or private key down into its constituent components
+     *
+     * @param string $key
+     * @param string $password optional
+     * @return array
+     */
+    protected static function load($key, $password)
+    {
+        if (!Strings::is_stringable($key)) {
+            throw new \UnexpectedValueException('Key should be a string - not a ' . gettype($key));
+        }
+
+        /* Although PKCS#1 proposes a format that public and private keys can use, encrypting them is
+           "outside the scope" of PKCS#1.  PKCS#1 then refers you to PKCS#12 and PKCS#15 if you're wanting to
+           protect private keys, however, that's not what OpenSSL* does.  OpenSSL protects private keys by adding
+           two new "fields" to the key - DEK-Info and Proc-Type.  These fields are discussed here:
+
+           http://tools.ietf.org/html/rfc1421#section-4.6.1.1
+           http://tools.ietf.org/html/rfc1421#section-4.6.1.3
+
+           DES-EDE3-CBC as an algorithm, however, is not discussed anywhere, near as I can tell.
+           DES-CBC and DES-EDE are discussed in RFC1423, however, DES-EDE3-CBC isn't, nor is its key derivation
+           function.  As is, the definitive authority on this encoding scheme isn't the IETF but rather OpenSSL's
+           own implementation.  ie. the implementation *is* the standard and any bugs that may exist in that
+           implementation are part of the standard, as well.
+
+           * OpenSSL is the de facto standard.  It's utilized by OpenSSH and other projects */
+        if (preg_match('#DEK-Info: (.+),(.+)#', $key, $matches)) {
+            $iv = Strings::hex2bin(trim($matches[2]));
+            // remove the Proc-Type / DEK-Info sections as they're no longer needed
+            $key = preg_replace('#^(?:Proc-Type|DEK-Info): .*#m', '', $key);
+            $ciphertext = ASN1::extractBER($key);
+            if ($ciphertext === false) {
+                $ciphertext = $key;
+            }
+            $crypto = self::getEncryptionObject($matches[1]);
+            $crypto->setKey(self::generateSymmetricKey($password, $iv, $crypto->getKeyLength() >> 3));
+            $crypto->setIV($iv);
+            $key = $crypto->decrypt($ciphertext);
+        } else {
+            if (self::$format != self::MODE_DER) {
+                $decoded = ASN1::extractBER($key);
+                if ($decoded !== false) {
+                    $key = $decoded;
+                } elseif (self::$format == self::MODE_PEM) {
+                    throw new \UnexpectedValueException('Expected base64-encoded PEM format but was unable to decode base64 text');
+                }
+            }
+        }
+
+        return $key;
+    }
+
+    /**
+     * Wrap a private key appropriately
+     *
+     * @param string $key
+     * @param string $type
+     * @param string $password
+     * @param array $options optional
+     * @return string
+     */
+    protected static function wrapPrivateKey($key, $type, $password, array $options = [])
+    {
+        if (empty($password) || !is_string($password)) {
+            return "-----BEGIN $type PRIVATE KEY-----\r\n" .
+                   chunk_split(Strings::base64_encode($key), 64) .
+                   "-----END $type PRIVATE KEY-----";
+        }
+
+        $encryptionAlgorithm = isset($options['encryptionAlgorithm']) ? $options['encryptionAlgorithm'] : self::$defaultEncryptionAlgorithm;
+
+        $cipher = self::getEncryptionObject($encryptionAlgorithm);
+        $iv = Random::string($cipher->getBlockLength() >> 3);
+        $cipher->setKey(self::generateSymmetricKey($password, $iv, $cipher->getKeyLength() >> 3));
+        $cipher->setIV($iv);
+        $iv = strtoupper(Strings::bin2hex($iv));
+        return "-----BEGIN $type PRIVATE KEY-----\r\n" .
+               "Proc-Type: 4,ENCRYPTED\r\n" .
+               "DEK-Info: " . $encryptionAlgorithm . ",$iv\r\n" .
+               "\r\n" .
+               chunk_split(Strings::base64_encode($cipher->encrypt($key)), 64) .
+               "-----END $type PRIVATE KEY-----";
+    }
+
+    /**
+     * Wrap a public key appropriately
+     *
+     * @param string $key
+     * @param string $type
+     * @return string
+     */
+    protected static function wrapPublicKey($key, $type)
+    {
+        return "-----BEGIN $type PUBLIC KEY-----\r\n" .
+               chunk_split(Strings::base64_encode($key), 64) .
+               "-----END $type PUBLIC KEY-----";
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Common/Formats/Keys/PKCS8.php ---
@@ -0,0 +1,725 @@
+<?php
+
+/**
+ * PKCS#8 Formatted Key Handler
+ *
+ * PHP version 5
+ *
+ * Used by PHP's openssl_public_encrypt() and openssl's rsautl (when -pubin is set)
+ *
+ * Processes keys with the following headers:
+ *
+ * -----BEGIN ENCRYPTED PRIVATE KEY-----
+ * -----BEGIN PRIVATE KEY-----
+ * -----BEGIN PUBLIC KEY-----
+ *
+ * Analogous to ssh-keygen's pkcs8 format (as specified by -m). Although PKCS8
+ * is specific to private keys it's basically creating a DER-encoded wrapper
+ * for keys. This just extends that same concept to public keys (much like ssh-keygen)
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\Common\Formats\Keys;
+
+use phpseclib3\Common\Functions\Strings;
+use phpseclib3\Crypt\AES;
+use phpseclib3\Crypt\DES;
+use phpseclib3\Crypt\Random;
+use phpseclib3\Crypt\RC2;
+use phpseclib3\Crypt\RC4;
+use phpseclib3\Crypt\TripleDES;
+use phpseclib3\Exception\InsufficientSetupException;
+use phpseclib3\Exception\UnsupportedAlgorithmException;
+use phpseclib3\File\ASN1;
+use phpseclib3\File\ASN1\Maps;
+
+/**
+ * PKCS#8 Formatted Key Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class PKCS8 extends PKCS
+{
+    /**
+     * Default encryption algorithm
+     *
+     * @var string
+     */
+    private static $defaultEncryptionAlgorithm = 'id-PBES2';
+
+    /**
+     * Default encryption scheme
+     *
+     * Only used when defaultEncryptionAlgorithm is id-PBES2
+     *
+     * @var string
+     */
+    private static $defaultEncryptionScheme = 'aes128-CBC-PAD';
+
+    /**
+     * Default PRF
+     *
+     * Only used when defaultEncryptionAlgorithm is id-PBES2
+     *
+     * @var string
+     */
+    private static $defaultPRF = 'id-hmacWithSHA256';
+
+    /**
+     * Default Iteration Count
+     *
+     * @var int
+     */
+    private static $defaultIterationCount = 2048;
+
+    /**
+     * OIDs loaded
+     *
+     * @var bool
+     */
+    private static $oidsLoaded = false;
+
+    /**
+     * Sets the default encryption algorithm
+     *
+     * @param string $algo
+     */
+    public static function setEncryptionAlgorithm($algo)
+    {
+        self::$defaultEncryptionAlgorithm = $algo;
+    }
+
+    /**
+     * Sets the default encryption algorithm for PBES2
+     *
+     * @param string $algo
+     */
+    public static function setEncryptionScheme($algo)
+    {
+        self::$defaultEncryptionScheme = $algo;
+    }
+
+    /**
+     * Sets the iteration count
+     *
+     * @param int $count
+     */
+    public static function setIterationCount($count)
+    {
+        self::$defaultIterationCount = $count;
+    }
+
+    /**
+     * Sets the PRF for PBES2
+     *
+     * @param string $algo
+     */
+    public static function setPRF($algo)
+    {
+        self::$defaultPRF = $algo;
+    }
+
+    /**
+     * Returns a SymmetricKey object based on a PBES1 $algo
+     *
+     * @return \phpseclib3\Crypt\Common\SymmetricKey
+     * @param string $algo
+     */
+    private static function getPBES1EncryptionObject($algo)
+    {
+        $algo = preg_match('#^pbeWith(?:MD2|MD5|SHA1|SHA)And(.*?)-CBC$#', $algo, $matches) ?
+            $matches[1] :
+            substr($algo, 13); // strlen('pbeWithSHAAnd') == 13
+
+        switch ($algo) {
+            case 'DES':
+                $cipher = new DES('cbc');
+                break;
+            case 'RC2':
+                $cipher = new RC2('cbc');
+                $cipher->setKeyLength(64);
+                break;
+            case '3-KeyTripleDES':
+                $cipher = new TripleDES('cbc');
+                break;
+            case '2-KeyTripleDES':
+                $cipher = new TripleDES('cbc');
+                $cipher->setKeyLength(128);
+                break;
+            case '128BitRC2':
+                $cipher = new RC2('cbc');
+                $cipher->setKeyLength(128);
+                break;
+            case '40BitRC2':
+                $cipher = new RC2('cbc');
+                $cipher->setKeyLength(40);
+                break;
+            case '128BitRC4':
+                $cipher = new RC4();
+                $cipher->setKeyLength(128);
+                break;
+            case '40BitRC4':
+                $cipher = new RC4();
+                $cipher->setKeyLength(40);
+                break;
+            default:
+                throw new UnsupportedAlgorithmException("$algo is not a supported algorithm");
+        }
+
+        return $cipher;
+    }
+
+    /**
+     * Returns a hash based on a PBES1 $algo
+     *
+     * @return string
+     * @param string $algo
+     */
+    private static function getPBES1Hash($algo)
+    {
+        if (preg_match('#^pbeWith(MD2|MD5|SHA1|SHA)And.*?-CBC$#', $algo, $matches)) {
+            return $matches[1] == 'SHA' ? 'sha1' : $matches[1];
+        }
+
+        return 'sha1';
+    }
+
+    /**
+     * Returns a KDF baesd on a PBES1 $algo
+     *
+     * @return string
+     * @param string $algo
+     */
+    private static function getPBES1KDF($algo)
+    {
+        switch ($algo) {
+            case 'pbeWithMD2AndDES-CBC':
+            case 'pbeWithMD2AndRC2-CBC':
+            case 'pbeWithMD5AndDES-CBC':
+            case 'pbeWithMD5AndRC2-CBC':
+            case 'pbeWithSHA1AndDES-CBC':
+            case 'pbeWithSHA1AndRC2-CBC':
+                return 'pbkdf1';
+        }
+
+        return 'pkcs12';
+    }
+
+    /**
+     * Returns a SymmetricKey object baesd on a PBES2 $algo
+     *
+     * @return SymmetricKey
+     * @param string $algo
+     */
+    private static function getPBES2EncryptionObject($algo)
+    {
+        switch ($algo) {
+            case 'desCBC':
+                $cipher = new DES('cbc');
+                break;
+            case 'des-EDE3-CBC':
+                $cipher = new TripleDES('cbc');
+                break;
+            case 'rc2CBC':
+                $cipher = new RC2('cbc');
+                // in theory this can be changed
+                $cipher->setKeyLength(128);
+                break;
+            case 'rc5-CBC-PAD':
+                throw new UnsupportedAlgorithmException('rc5-CBC-PAD is not supported for PBES2 PKCS#8 keys');
+            case 'aes128-CBC-PAD':
+            case 'aes192-CBC-PAD':
+            case 'aes256-CBC-PAD':
+                $cipher = new AES('cbc');
+                $cipher->setKeyLength(substr($algo, 3, 3));
+                break;
+            default:
+                throw new UnsupportedAlgorithmException("$algo is not supported");
+        }
+
+        return $cipher;
+    }
+
+    /**
+     * Initialize static variables
+     *
+     */
+    private static function initialize_static_variables()
+    {
+        if (!isset(static::$childOIDsLoaded)) {
+            throw new InsufficientSetupException('This class should not be called directly');
+        }
+
+        if (!static::$childOIDsLoaded) {
+            ASN1::loadOIDs(is_array(static::OID_NAME) ?
+                array_combine(static::OID_NAME, static::OID_VALUE) :
+                [static::OID_NAME => static::OID_VALUE]);
+            static::$childOIDsLoaded = true;
+        }
+        if (!self::$oidsLoaded) {
+            // from https://tools.ietf.org/html/rfc2898
+            ASN1::loadOIDs([
+               // PBES1 encryption schemes
+               'pbeWithMD2AndDES-CBC' => '1.2.840.113549.1.5.1',
+               'pbeWithMD2AndRC2-CBC' => '1.2.840.113549.1.5.4',
+               'pbeWithMD5AndDES-CBC' => '1.2.840.113549.1.5.3',
+               'pbeWithMD5AndRC2-CBC' => '1.2.840.113549.1.5.6',
+               'pbeWithSHA1AndDES-CBC' => '1.2.840.113549.1.5.10',
+               'pbeWithSHA1AndRC2-CBC' => '1.2.840.113549.1.5.11',
+
+               // from PKCS#12:
+               // https://tools.ietf.org/html/rfc7292
+               'pbeWithSHAAnd128BitRC4' => '1.2.840.113549.1.12.1.1',
+               'pbeWithSHAAnd40BitRC4' => '1.2.840.113549.1.12.1.2',
+               'pbeWithSHAAnd3-KeyTripleDES-CBC' => '1.2.840.113549.1.12.1.3',
+               'pbeWithSHAAnd2-KeyTripleDES-CBC' => '1.2.840.113549.1.12.1.4',
+               'pbeWithSHAAnd128BitRC2-CBC' => '1.2.840.113549.1.12.1.5',
+               'pbeWithSHAAnd40BitRC2-CBC' => '1.2.840.113549.1.12.1.6',
+
+               'id-PBKDF2' => '1.2.840.113549.1.5.12',
+               'id-PBES2' => '1.2.840.113549.1.5.13',
+               'id-PBMAC1' => '1.2.840.113549.1.5.14',
+
+               // from PKCS#5 v2.1:
+               // http://www.rsa.com/rsalabs/pkcs/files/h11302-wp-pkcs5v2-1-password-based-cryptography-standard.pdf
+               'id-hmacWithSHA1' => '1.2.840.113549.2.7',
+               'id-hmacWithSHA224' => '1.2.840.113549.2.8',
+               'id-hmacWithSHA256' => '1.2.840.113549.2.9',
+               'id-hmacWithSHA384' => '1.2.840.113549.2.10',
+               'id-hmacWithSHA512' => '1.2.840.113549.2.11',
+               'id-hmacWithSHA512-224' => '1.2.840.113549.2.12',
+               'id-hmacWithSHA512-256' => '1.2.840.113549.2.13',
+
+               'desCBC'       => '1.3.14.3.2.7',
+               'des-EDE3-CBC' => '1.2.840.113549.3.7',
+               'rc2CBC' => '1.2.840.113549.3.2',
+               'rc5-CBC-PAD' => '1.2.840.113549.3.9',
+
+               'aes128-CBC-PAD' => '2.16.840.1.101.3.4.1.2',
+               'aes192-CBC-PAD' => '2.16.840.1.101.3.4.1.22',
+               'aes256-CBC-PAD' => '2.16.840.1.101.3.4.1.42'
+            ]);
+            self::$oidsLoaded = true;
+        }
+    }
+
+    /**
+     * Break a public or private key down into its constituent components
+     *
+     * @param string $key
+     * @param string $password optional
+     * @return array
+     */
+    protected static function load($key, $password = '')
+    {
+        if (!Strings::is_stringable($key)) {
+            throw new \UnexpectedValueException('Key should be a string - not a ' . gettype($key));
+        }
+
+        $isPublic = strpos($key, 'PUBLIC') !== false;
+        $isPrivate = strpos($key, 'PRIVATE') !== false;
+
+        $decoded = self::preParse($key);
+
+        $meta = [];
+
+        $decrypted = ASN1::asn1map($decoded[0], Maps\EncryptedPrivateKeyInfo::MAP);
+        if (strlen($password) && is_array($decrypted)) {
+            $algorithm = $decrypted['encryptionAlgorithm']['algorithm'];
+            switch ($algorithm) {
+                // PBES1
+                case 'pbeWithMD2AndDES-CBC':
+                case 'pbeWithMD2AndRC2-CBC':
+                case 'pbeWithMD5AndDES-CBC':
+                case 'pbeWithMD5AndRC2-CBC':
+                case 'pbeWithSHA1AndDES-CBC':
+                case 'pbeWithSHA1AndRC2-CBC':
+                case 'pbeWithSHAAnd3-KeyTripleDES-CBC':
+                case 'pbeWithSHAAnd2-KeyTripleDES-CBC':
+                case 'pbeWithSHAAnd128BitRC2-CBC':
+                case 'pbeWithSHAAnd40BitRC2-CBC':
+                case 'pbeWithSHAAnd128BitRC4':
+                case 'pbeWithSHAAnd40BitRC4':
+                    $cipher = self::getPBES1EncryptionObject($algorithm);
+                    $hash = self::getPBES1Hash($algorithm);
+                    $kdf = self::getPBES1KDF($algorithm);
+
+                    $meta['meta']['algorithm'] = $algorithm;
+
+                    $temp = ASN1::decodeBER($decrypted['encryptionAlgorithm']['parameters']);
+                    if (!$temp) {
+                        throw new \RuntimeException('Unable to decode BER');
+                    }
+                    extract(ASN1::asn1map($temp[0], Maps\PBEParameter::MAP));
+                    $iterationCount = (int) $iterationCount->toString();
+                    $cipher->setPassword($password, $kdf, $hash, $salt, $iterationCount);
+                    $key = $cipher->decrypt($decrypted['encryptedData']);
+                    $decoded = ASN1::decodeBER($key);
+                    if (!$decoded) {
+                        throw new \RuntimeException('Unable to decode BER 2');
+                    }
+
+                    break;
+                case 'id-PBES2':
+                    $meta['meta']['algorithm'] = $algorithm;
+
+                    $temp = ASN1::decodeBER($decrypted['encryptionAlgorithm']['parameters']);
+                    if (!$temp) {
+                        throw new \RuntimeException('Unable to decode BER');
+                    }
+                    $temp = ASN1::asn1map($temp[0], Maps\PBES2params::MAP);
+                    extract($temp);
+
+                    $cipher = self::getPBES2EncryptionObject($encryptionScheme['algorithm']);
+                    $meta['meta']['cipher'] = $encryptionScheme['algorithm'];
+
+                    $temp = ASN1::decodeBER($decrypted['encryptionAlgorithm']['parameters']);
+                    if (!$temp) {
+                        throw new \RuntimeException('Unable to decode BER');
+                    }
+                    $temp = ASN1::asn1map($temp[0], Maps\PBES2params::MAP);
+                    extract($temp);
+
+                    if (!$cipher instanceof RC2) {
+                        $cipher->setIV($encryptionScheme['parameters']['octetString']);
+                    } else {
+                        $temp = ASN1::decodeBER($encryptionScheme['parameters']);
+                        if (!$temp) {
+                            throw new \RuntimeException('Unable to decode BER');
+                        }
+                        extract(ASN1::asn1map($temp[0], Maps\RC2CBCParameter::MAP));
+                        $effectiveKeyLength = (int) $rc2ParametersVersion->toString();
+                        switch ($effectiveKeyLength) {
+                            case 160:
+                                $effectiveKeyLength = 40;
+                                break;
+                            case 120:
+                                $effectiveKeyLength = 64;
+                                break;
+                            case 58:
+                                $effectiveKeyLength = 128;
+                                break;
+                            //default: // should be >= 256
+                        }
+                        $cipher->setIV($iv);
+                        $cipher->setKeyLength($effectiveKeyLength);
+                    }
+
+                    $meta['meta']['keyDerivationFunc'] = $keyDerivationFunc['algorithm'];
+                    switch ($keyDerivationFunc['algorithm']) {
+                        case 'id-PBKDF2':
+                            $temp = ASN1::decodeBER($keyDerivationFunc['parameters']);
+                            if (!$temp) {
+                                throw new \RuntimeException('Unable to decode BER');
+                            }
+                            $prf = ['algorithm' => 'id-hmacWithSHA1'];
+                            $params = ASN1::asn1map($temp[0], Maps\PBKDF2params::MAP);
+                            extract($params);
+                            $meta['meta']['prf'] = $prf['algorithm'];
+                            $hash = str_replace('-', '/', substr($prf['algorithm'], 11));
+                            $params = [
+                                $password,
+                                'pbkdf2',
+                                $hash,
+                                $salt,
+                                (int) $iterationCount->toString()
+                            ];
+                            if (isset($keyLength)) {
+                                $params[] = (int) $keyLength->toString();
+                            }
+                            $cipher->setPassword(...$params);
+                            $key = $cipher->decrypt($decrypted['encryptedData']);
+                            $decoded = ASN1::decodeBER($key);
+                            if (!$decoded) {
+                                throw new \RuntimeException('Unable to decode BER 3');
+                            }
+                            break;
+                        default:
+                            throw new UnsupportedAlgorithmException('Only PBKDF2 is supported for PBES2 PKCS#8 keys');
+                    }
+                    break;
+                case 'id-PBMAC1':
+                    //$temp = ASN1::decodeBER($decrypted['encryptionAlgorithm']['parameters']);
+                    //$value = ASN1::asn1map($temp[0], Maps\PBMAC1params::MAP);
+                    // since i can't find any implementation that does PBMAC1 it is unsupported
+                    throw new UnsupportedAlgorithmException('Only PBES1 and PBES2 PKCS#8 keys are supported.');
+                // at this point we'll assume that the key conforms to PublicKeyInfo
+            }
+        }
+
+        $private = ASN1::asn1map($decoded[0], Maps\OneAsymmetricKey::MAP);
+        if (is_array($private)) {
+            if ($isPublic) {
+                throw new \UnexpectedValueException('Human readable string claims public key but DER encoded string claims private key');
+            }
+
+            if (isset($private['privateKeyAlgorithm']['parameters']) && !$private['privateKeyAlgorithm']['parameters'] instanceof ASN1\Element && isset($decoded[0]['content'][1]['content'][1])) {
+                $temp = $decoded[0]['content'][1]['content'][1];
+                $private['privateKeyAlgorithm']['parameters'] = new ASN1\Element(substr($key, $temp['start'], $temp['length']));
+            }
+            if (is_array(static::OID_NAME)) {
+                if (!in_array($private['privateKeyAlgorithm']['algorithm'], static::OID_NAME)) {
+                    throw new UnsupportedAlgorithmException($private['privateKeyAlgorithm']['algorithm'] . ' is not a supported key type');
+                }
+            } else {
+                if ($private['privateKeyAlgorithm']['algorithm'] != static::OID_NAME) {
+                    throw new UnsupportedAlgorithmException('Only ' . static::OID_NAME . ' keys are supported; this is a ' . $private['privateKeyAlgorithm']['algorithm'] . ' key');
+                }
+            }
+            if (isset($private['publicKey'])) {
+                if ($private['publicKey'][0] != "\0") {
+                    throw new \UnexpectedValueException('The first byte of the public key should be null - not ' . bin2hex($private['publicKey'][0]));
+                }
+                $private['publicKey'] = substr($private['publicKey'], 1);
+            }
+            return $private + $meta;
+        }
+
+        // EncryptedPrivateKeyInfo and PublicKeyInfo have largely identical "signatures". the only difference
+        // is that the former has an octet string and the later has a bit string. the first byte of a bit
+        // string represents the number of bits in the last byte that are to be ignored but, currently,
+        // bit strings wanting a non-zero amount of bits trimmed are not supported
+        $public = ASN1::asn1map($decoded[0], Maps\PublicKeyInfo::MAP);
+
+        if (is_array($public)) {
+            if ($isPrivate) {
+                throw new \UnexpectedValueException('Human readable string claims private key but DER encoded string claims public key');
+            }
+
+            if ($public['publicKey'][0] != "\0") {
+                throw new \UnexpectedValueException('The first byte of the public key should be null - not ' . bin2hex($public['publicKey'][0]));
+            }
+            if (is_array(static::OID_NAME)) {
+                if (!in_array($public['publicKeyAlgorithm']['algorithm'], static::OID_NAME)) {
+                    throw new UnsupportedAlgorithmException($public['publicKeyAlgorithm']['algorithm'] . ' is not a supported key type');
+                }
+            } else {
+                if ($public['publicKeyAlgorithm']['algorithm'] != static::OID_NAME) {
+                    throw new UnsupportedAlgorithmException('Only ' . static::OID_NAME . ' keys are supported; this is a ' . $public['publicKeyAlgorithm']['algorithm'] . ' key');
+                }
+            }
+            if (isset($public['publicKeyAlgorithm']['parameters']) && !$public['publicKeyAlgorithm']['parameters'] instanceof ASN1\Element && isset($decoded[0]['content'][0]['content'][1])) {
+                $temp = $decoded[0]['content'][0]['content'][1];
+                $public['publicKeyAlgorithm']['parameters'] = new ASN1\Element(substr($key, $temp['start'], $temp['length']));
+            }
+            $public['publicKey'] = substr($public['publicKey'], 1);
+            return $public;
+        }
+
+        throw new \RuntimeException('Unable to parse using either OneAsymmetricKey or PublicKeyInfo ASN1 maps');
+    }
+
+    /**
+     * Wrap a private key appropriately
+     *
+     * @param string $key
+     * @param string $attr
+     * @param mixed $params
+     * @param string $password
+     * @param string $oid optional
+     * @param string $publicKey optional
+     * @param array $options optional
+     * @return string
+     */
+    protected static function wrapPrivateKey($key, $attr, $params, $password, $oid = null, $publicKey = '', array $options = [])
+    {
+        self::initialize_static_variables();
+
+        $key = [
+            'version' => 'v1',
+            'privateKeyAlgorithm' => [
+                'algorithm' => is_string(static::OID_NAME) ? static::OID_NAME : $oid
+             ],
+            'privateKey' => $key
+        ];
+        if ($oid != 'id-Ed25519' && $oid != 'id-Ed448') {
+            $key['privateKeyAlgorithm']['parameters'] = $params;
+        }
+        if (!empty($attr)) {
+            $key['attributes'] = $attr;
+        }
+        if (!empty($publicKey)) {
+            $key['version'] = 'v2';
+            $key['publicKey'] = $publicKey;
+        }
+        $key = ASN1::encodeDER($key, Maps\OneAsymmetricKey::MAP);
+        if (!empty($password) && is_string($password)) {
+            $salt = Random::string(8);
+
+            $iterationCount = isset($options['iterationCount']) ? $options['iterationCount'] : self::$defaultIterationCount;
+            $encryptionAlgorithm = isset($options['encryptionAlgorithm']) ? $options['encryptionAlgorithm'] : self::$defaultEncryptionAlgorithm;
+            $encryptionScheme = isset($options['encryptionScheme']) ? $options['encryptionScheme'] : self::$defaultEncryptionScheme;
+            $prf = isset($options['PRF']) ? $options['PRF'] : self::$defaultPRF;
+
+            if ($encryptionAlgorithm == 'id-PBES2') {
+                $crypto = self::getPBES2EncryptionObject($encryptionScheme);
+                $hash = str_replace('-', '/', substr($prf, 11));
+                $kdf = 'pbkdf2';
+                $iv = Random::string($crypto->getBlockLength() >> 3);
+
+                $PBKDF2params = [
+                    'salt' => $salt,
+                    'iterationCount' => $iterationCount,
+                    'prf' => ['algorithm' => $prf, 'parameters' => null]
+                ];
+                $PBKDF2params = ASN1::encodeDER($PBKDF2params, Maps\PBKDF2params::MAP);
+
+                if (!$crypto instanceof RC2) {
+                    $params = ['octetString' => $iv];
+                } else {
+                    $params = [
+                        'rc2ParametersVersion' => 58,
+                        'iv' => $iv
+                    ];
+                    $params = ASN1::encodeDER($params, Maps\RC2CBCParameter::MAP);
+                    $params = new ASN1\Element($params);
+                }
+
+                $params = [
+                    'keyDerivationFunc' => [
+                        'algorithm' => 'id-PBKDF2',
+                        'parameters' => new ASN1\Element($PBKDF2params)
+                    ],
+                    'encryptionScheme' => [
+                        'algorithm' => $encryptionScheme,
+                        'parameters' => $params
+                    ]
+                ];
+                $params = ASN1::encodeDER($params, Maps\PBES2params::MAP);
+
+                $crypto->setIV($iv);
+            } else {
+                $crypto = self::getPBES1EncryptionObject($encryptionAlgorithm);
+                $hash = self::getPBES1Hash($encryptionAlgorithm);
+                $kdf = self::getPBES1KDF($encryptionAlgorithm);
+
+                $params = [
+                    'salt' => $salt,
+                    'iterationCount' => $iterationCount
+                ];
+                $params = ASN1::encodeDER($params, Maps\PBEParameter::MAP);
+            }
+            $crypto->setPassword($password, $kdf, $hash, $salt, $iterationCount);
+            $key = $crypto->encrypt($key);
+
+            $key = [
+                'encryptionAlgorithm' => [
+                    'algorithm' => $encryptionAlgorithm,
+                    'parameters' => new ASN1\Element($params)
+                ],
+                'encryptedData' => $key
+            ];
+
+            $key = ASN1::encodeDER($key, Maps\EncryptedPrivateKeyInfo::MAP);
+
+            return "-----BEGIN ENCRYPTED PRIVATE KEY-----\r\n" .
+                   chunk_split(Strings::base64_encode($key), 64) .
+                   "-----END ENCRYPTED PRIVATE KEY-----";
+        }
+
+        return "-----BEGIN PRIVATE KEY-----\r\n" .
+               chunk_split(Strings::base64_encode($key), 64) .
+               "-----END PRIVATE KEY-----";
+    }
+
+    /**
+     * Wrap a public key appropriately
+     *
+     * @param string $key
+     * @param mixed $params
+     * @param string $oid
+     * @return string
+     */
+    protected static function wrapPublicKey($key, $params, $oid = null)
+    {
+        self::initialize_static_variables();
+
+        $key = [
+            'publicKeyAlgorithm' => [
+                'algorithm' => is_string(static::OID_NAME) ? static::OID_NAME : $oid
+            ],
+            'publicKey' => "\0" . $key
+        ];
+
+        if ($oid != 'id-Ed25519' && $oid != 'id-Ed448') {
+            $key['publicKeyAlgorithm']['parameters'] = $params;
+        }
+
+        $key = ASN1::encodeDER($key, Maps\PublicKeyInfo::MAP);
+
+        return "-----BEGIN PUBLIC KEY-----\r\n" .
+               chunk_split(Strings::base64_encode($key), 64) .
+               "-----END PUBLIC KEY-----";
+    }
+
+    /**
+     * Perform some preliminary parsing of the key
+     *
+     * @param string $key
+     * @return array
+     */
+    private static function preParse(&$key)
+    {
+        self::initialize_static_variables();
+
+        if (self::$format != self::MODE_DER) {
+            $decoded = ASN1::extractBER($key);
+            if ($decoded !== false) {
+                $key = $decoded;
+            } elseif (self::$format == self::MODE_PEM) {
+                throw new \UnexpectedValueException('Expected base64-encoded PEM format but was unable to decode base64 text');
+            }
+        }
+
+        $decoded = ASN1::decodeBER($key);
+        if (!$decoded) {
+            throw new \RuntimeException('Unable to decode BER');
+        }
+
+        return $decoded;
+    }
+
+    /**
+     * Returns the encryption parameters used by the key
+     *
+     * @param string $key
+     * @return array
+     */
+    public static function extractEncryptionAlgorithm($key)
+    {
+        if (!Strings::is_stringable($key)) {
+            throw new \UnexpectedValueException('Key should be a string - not a ' . gettype($key));
+        }
+
+        $decoded = self::preParse($key);
+
+        $r = ASN1::asn1map($decoded[0], ASN1\Maps\EncryptedPrivateKeyInfo::MAP);
+        if (!is_array($r)) {
+            throw new \RuntimeException('Unable to parse using EncryptedPrivateKeyInfo map');
+        }
+
+        if ($r['encryptionAlgorithm']['algorithm'] == 'id-PBES2') {
+            $decoded = ASN1::decodeBER($r['encryptionAlgorithm']['parameters']->element);
+            if (!$decoded) {
+                throw new \RuntimeException('Unable to decode BER');
+            }
+            $r['encryptionAlgorithm']['parameters'] = ASN1::asn1map($decoded[0], ASN1\Maps\PBES2params::MAP);
+
+            $kdf = &$r['encryptionAlgorithm']['parameters']['keyDerivationFunc'];
+            switch ($kdf['algorithm']) {
+                case 'id-PBKDF2':
+                    $decoded = ASN1::decodeBER($kdf['parameters']->element);
+                    if (!$decoded) {
+                        throw new \RuntimeException('Unable to decode BER');
+                    }
+                    $kdf['parameters'] = ASN1::asn1map($decoded[0], Maps\PBKDF2params::MAP);
+            }
+        }
+
+        return $r['encryptionAlgorithm'];
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Common/Formats/Keys/PuTTY.php ---
@@ -0,0 +1,374 @@
+<?php
+
+/**
+ * PuTTY Formatted Key Handler
+ *
+ * See PuTTY's SSHPUBK.C and https://tartarus.org/~simon/putty-snapshots/htmldoc/AppendixC.html
+ *
+ * PHP version 5
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2016 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\Common\Formats\Keys;
+
+use phpseclib3\Common\Functions\Strings;
+use phpseclib3\Crypt\AES;
+use phpseclib3\Crypt\Hash;
+use phpseclib3\Crypt\Random;
+use phpseclib3\Exception\UnsupportedAlgorithmException;
+
+/**
+ * PuTTY Formatted Key Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class PuTTY
+{
+    /**
+     * Default comment
+     *
+     * @var string
+     */
+    private static $comment = 'phpseclib-generated-key';
+
+    /**
+     * Default version
+     *
+     * @var int
+     */
+    private static $version = 2;
+
+    /**
+     * Sets the default comment
+     *
+     * @param string $comment
+     */
+    public static function setComment($comment)
+    {
+        self::$comment = str_replace(["\r", "\n"], '', $comment);
+    }
+
+    /**
+     * Sets the default version
+     *
+     * @param int $version
+     */
+    public static function setVersion($version)
+    {
+        if ($version != 2 && $version != 3) {
+            throw new \RuntimeException('Only supported versions are 2 and 3');
+        }
+        self::$version = $version;
+    }
+
+    /**
+     * Generate a symmetric key for PuTTY v2 keys
+     *
+     * @param string $password
+     * @param int $length
+     * @return string
+     */
+    private static function generateV2Key($password, $length)
+    {
+        $symkey = '';
+        $sequence = 0;
+        while (strlen($symkey) < $length) {
+            $temp = pack('Na*', $sequence++, $password);
+            $symkey .= Strings::hex2bin(sha1($temp));
+        }
+        return substr($symkey, 0, $length);
+    }
+
+    /**
+     * Generate a symmetric key for PuTTY v3 keys
+     *
+     * @param string $password
+     * @param string $flavour
+     * @param int $memory
+     * @param int $passes
+     * @param string $salt
+     * @return array
+     */
+    private static function generateV3Key($password, $flavour, $memory, $passes, $salt)
+    {
+        if (!function_exists('sodium_crypto_pwhash')) {
+            throw new \RuntimeException('sodium_crypto_pwhash needs to exist for Argon2 password hasing');
+        }
+
+        switch ($flavour) {
+            case 'Argon2i':
+                $flavour = SODIUM_CRYPTO_PWHASH_ALG_ARGON2I13;
+                break;
+            case 'Argon2id':
+                $flavour = SODIUM_CRYPTO_PWHASH_ALG_ARGON2ID13;
+                break;
+            default:
+                throw new UnsupportedAlgorithmException('Only Argon2i and Argon2id are supported');
+        }
+
+        $length = 80; // keylen + ivlen + mac_keylen
+        $temp = sodium_crypto_pwhash($length, $password, $salt, $passes, $memory << 10, $flavour);
+
+        $symkey = substr($temp, 0, 32);
+        $symiv = substr($temp, 32, 16);
+        $hashkey = substr($temp, -32);
+
+        return compact('symkey', 'symiv', 'hashkey');
+    }
+
+    /**
+     * Break a public or private key down into its constituent components
+     *
+     * @param string $key
+     * @param string $password
+     * @return array
+     */
+    public static function load($key, $password)
+    {
+        if (!Strings::is_stringable($key)) {
+            throw new \UnexpectedValueException('Key should be a string - not a ' . gettype($key));
+        }
+
+        if (strpos($key, 'BEGIN SSH2 PUBLIC KEY') !== false) {
+            $lines = preg_split('#[\r\n]+#', $key);
+            switch (true) {
+                case $lines[0] != '---- BEGIN SSH2 PUBLIC KEY ----':
+                    throw new \UnexpectedValueException('Key doesn\'t start with ---- BEGIN SSH2 PUBLIC KEY ----');
+                case $lines[count($lines) - 1] != '---- END SSH2 PUBLIC KEY ----':
+                    throw new \UnexpectedValueException('Key doesn\'t end with ---- END SSH2 PUBLIC KEY ----');
+            }
+            $lines = array_splice($lines, 1, -1);
+            $lines = array_map(function ($line) {
+                return rtrim($line, "\r\n");
+            }, $lines);
+            $data = $current = '';
+            $values = [];
+            $in_value = false;
+            foreach ($lines as $line) {
+                switch (true) {
+                    case preg_match('#^(.*?): (.*)#', $line, $match):
+                        $in_value = $line[strlen($line) - 1] == '\\';
+                        $current = strtolower($match[1]);
+                        $values[$current] = $in_value ? substr($match[2], 0, -1) : $match[2];
+                        break;
+                    case $in_value:
+                        $in_value = $line[strlen($line) - 1] == '\\';
+                        $values[$current] .= $in_value ? substr($line, 0, -1) : $line;
+                        break;
+                    default:
+                        $data .= $line;
+                }
+            }
+
+            $components = call_user_func([static::PUBLIC_HANDLER, 'load'], $data);
+            if ($components === false) {
+                throw new \UnexpectedValueException('Unable to decode public key');
+            }
+            $components += $values;
+            $components['comment'] = str_replace(['\\\\', '\"'], ['\\', '"'], $values['comment']);
+
+            return $components;
+        }
+
+        $components = [];
+
+        $key = preg_split('#\r\n|\r|\n#', trim($key));
+        if (Strings::shift($key[0], strlen('PuTTY-User-Key-File-')) != 'PuTTY-User-Key-File-') {
+            return false;
+        }
+        $version = (int) Strings::shift($key[0], 3); // should be either "2: " or "3: 0" prior to int casting
+        if ($version != 2 && $version != 3) {
+            throw new \RuntimeException('Only v2 and v3 PuTTY private keys are supported');
+        }
+        $components['type'] = $type = rtrim($key[0]);
+        if (!in_array($type, static::$types)) {
+            $error = count(static::$types) == 1 ?
+                'Only ' . static::$types[0] . ' keys are supported. ' :
+                '';
+            throw new UnsupportedAlgorithmException($error . 'This is an unsupported ' . $type . ' key');
+        }
+        $encryption = trim(preg_replace('#Encryption: (.+)#', '$1', $key[1]));
+        $components['comment'] = trim(preg_replace('#Comment: (.+)#', '$1', $key[2]));
+
+        $publicLength = trim(preg_replace('#Public-Lines: (\d+)#', '$1', $key[3]));
+        $public = Strings::base64_decode(implode('', array_map('trim', array_slice($key, 4, $publicLength))));
+
+        $source = Strings::packSSH2('ssss', $type, $encryption, $components['comment'], $public);
+
+        extract(unpack('Nlength', Strings::shift($public, 4)));
+        $newtype = Strings::shift($public, $length);
+        if ($newtype != $type) {
+            throw new \RuntimeException('The binary type does not match the human readable type field');
+        }
+
+        $components['public'] = $public;
+
+        switch ($version) {
+            case 3:
+                $hashkey = '';
+                break;
+            case 2:
+                $hashkey = 'putty-private-key-file-mac-key';
+        }
+
+        $offset = $publicLength + 4;
+        switch ($encryption) {
+            case 'aes256-cbc':
+                $crypto = new AES('cbc');
+                switch ($version) {
+                    case 3:
+                        $flavour = trim(preg_replace('#Key-Derivation: (.*)#', '$1', $key[$offset++]));
+                        $memory = trim(preg_replace('#Argon2-Memory: (\d+)#', '$1', $key[$offset++]));
+                        $passes = trim(preg_replace('#Argon2-Passes: (\d+)#', '$1', $key[$offset++]));
+                        $parallelism = trim(preg_replace('#Argon2-Parallelism: (\d+)#', '$1', $key[$offset++]));
+                        $salt = Strings::hex2bin(trim(preg_replace('#Argon2-Salt: ([0-9a-f]+)#', '$1', $key[$offset++])));
+
+                        extract(self::generateV3Key($password, $flavour, $memory, $passes, $salt));
+
+                        break;
+                    case 2:
+                        $symkey = self::generateV2Key($password, 32);
+                        $symiv = str_repeat("\0", $crypto->getBlockLength() >> 3);
+                        $hashkey .= $password;
+                }
+        }
+
+        switch ($version) {
+            case 3:
+                $hash = new Hash('sha256');
+                $hash->setKey($hashkey);
+                break;
+            case 2:
+                $hash = new Hash('sha1');
+                $hash->setKey(sha1($hashkey, true));
+        }
+
+        $privateLength = trim(preg_replace('#Private-Lines: (\d+)#', '$1', $key[$offset++]));
+        $private = Strings::base64_decode(implode('', array_map('trim', array_slice($key, $offset, $privateLength))));
+
+        if ($encryption != 'none') {
+            $crypto->setKey($symkey);
+            $crypto->setIV($symiv);
+            $crypto->disablePadding();
+            $private = $crypto->decrypt($private);
+        }
+
+        $source .= Strings::packSSH2('s', $private);
+
+        $hmac = trim(preg_replace('#Private-MAC: (.+)#', '$1', $key[$offset + $privateLength]));
+        $hmac = Strings::hex2bin($hmac);
+
+        if (!hash_equals($hash->hash($source), $hmac)) {
+            throw new \UnexpectedValueException('MAC validation error');
+        }
+
+        $components['private'] = $private;
+
+        return $components;
+    }
+
+    /**
+     * Wrap a private key appropriately
+     *
+     * @param string $public
+     * @param string $private
+     * @param string $type
+     * @param string $password
+     * @param array $options optional
+     * @return string
+     */
+    protected static function wrapPrivateKey($public, $private, $type, $password, array $options = [])
+    {
+        $encryption = (!empty($password) || is_string($password)) ? 'aes256-cbc' : 'none';
+        $comment = isset($options['comment']) ? $options['comment'] : self::$comment;
+        $version = isset($options['version']) ? $options['version'] : self::$version;
+
+        $key = "PuTTY-User-Key-File-$version: $type\r\n";
+        $key .= "Encryption: $encryption\r\n";
+        $key .= "Comment: $comment\r\n";
+
+        $public = Strings::packSSH2('s', $type) . $public;
+
+        $source = Strings::packSSH2('ssss', $type, $encryption, $comment, $public);
+
+        $public = Strings::base64_encode($public);
+        $key .= "Public-Lines: " . ((strlen($public) + 63) >> 6) . "\r\n";
+        $key .= chunk_split($public, 64);
+
+        if (empty($password) && !is_string($password)) {
+            $source .= Strings::packSSH2('s', $private);
+            switch ($version) {
+                case 3:
+                    $hash = new Hash('sha256');
+                    $hash->setKey('');
+                    break;
+                case 2:
+                    $hash = new Hash('sha1');
+                    $hash->setKey(sha1('putty-private-key-file-mac-key', true));
+            }
+        } else {
+            $private .= Random::string(16 - (strlen($private) & 15));
+            $source .= Strings::packSSH2('s', $private);
+            $crypto = new AES('cbc');
+
+            switch ($version) {
+                case 3:
+                    $salt = Random::string(16);
+                    $key .= "Key-Derivation: Argon2id\r\n";
+                    $key .= "Argon2-Memory: 8192\r\n";
+                    $key .= "Argon2-Passes: 13\r\n";
+                    $key .= "Argon2-Parallelism: 1\r\n";
+                    $key .= "Argon2-Salt: " . Strings::bin2hex($salt) . "\r\n";
+                    extract(self::generateV3Key($password, 'Argon2id', 8192, 13, $salt));
+
+                    $hash = new Hash('sha256');
+                    $hash->setKey($hashkey);
+
+                    break;
+                case 2:
+                    $symkey = self::generateV2Key($password, 32);
+                    $symiv = str_repeat("\0", $crypto->getBlockLength() >> 3);
+                    $hashkey = 'putty-private-key-file-mac-key' . $password;
+
+                    $hash = new Hash('sha1');
+                    $hash->setKey(sha1($hashkey, true));
+            }
+
+            $crypto->setKey($symkey);
+            $crypto->setIV($symiv);
+            $crypto->disablePadding();
+            $private = $crypto->encrypt($private);
+            $mac = $hash->hash($source);
+        }
+
+        $private = Strings::base64_encode($private);
+        $key .= 'Private-Lines: ' . ((strlen($private) + 63) >> 6) . "\r\n";
+        $key .= chunk_split($private, 64);
+        $key .= 'Private-MAC: ' . Strings::bin2hex($hash->hash($source)) . "\r\n";
+
+        return $key;
+    }
+
+    /**
+     * Wrap a public key appropriately
+     *
+     * This is basically the format described in RFC 4716 (https://tools.ietf.org/html/rfc4716)
+     *
+     * @param string $key
+     * @param string $type
+     * @return string
+     */
+    protected static function wrapPublicKey($key, $type)
+    {
+        $key = pack('Na*a*', strlen($type), $type, $key);
+        $key = "---- BEGIN SSH2 PUBLIC KEY ----\r\n" .
+               'Comment: "' . str_replace(['\\', '"'], ['\\\\', '\"'], self::$comment) . "\"\r\n" .
+               chunk_split(Strings::base64_encode($key), 64) .
+               '---- END SSH2 PUBLIC KEY ----';
+        return $key;
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Common/Formats/Signature/Raw.php ---
@@ -0,0 +1,60 @@
+<?php
+
+/**
+ * Raw Signature Handler
+ *
+ * PHP version 5
+ *
+ * Handles signatures as arrays
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2016 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\Common\Formats\Signature;
+
+use phpseclib3\Math\BigInteger;
+
+/**
+ * Raw Signature Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class Raw
+{
+    /**
+     * Loads a signature
+     *
+     * @param array $sig
+     * @return array|bool
+     */
+    public static function load($sig)
+    {
+        switch (true) {
+            case !is_array($sig):
+            case !isset($sig['r']) || !isset($sig['s']):
+            case !$sig['r'] instanceof BigInteger:
+            case !$sig['s'] instanceof BigInteger:
+                return false;
+        }
+
+        return [
+            'r' => $sig['r'],
+            's' => $sig['s']
+        ];
+    }
+
+    /**
+     * Returns a signature in the appropriate format
+     *
+     * @param \phpseclib3\Math\BigInteger $r
+     * @param \phpseclib3\Math\BigInteger $s
+     * @return string
+     */
+    public static function save(BigInteger $r, BigInteger $s)
+    {
+        return compact('r', 's');
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Common/PrivateKey.php ---
@@ -0,0 +1,31 @@
+<?php
+
+/**
+ * PrivateKey interface
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2009 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\Common;
+
+/**
+ * PrivateKey interface
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+interface PrivateKey
+{
+    public function sign($message);
+    //public function decrypt($ciphertext);
+    public function getPublicKey();
+    public function toString($type, array $options = []);
+
+    /**
+     * @param string|false $password
+     * @return mixed
+     */
+    public function withPassword($password = false);
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Common/PublicKey.php ---
@@ -0,0 +1,25 @@
+<?php
+
+/**
+ * PublicKey interface
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2009 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\Common;
+
+/**
+ * PublicKey interface
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+interface PublicKey
+{
+    public function verify($message, $signature);
+    //public function encrypt($plaintext);
+    public function toString($type, array $options = []);
+    public function getFingerprint($algorithm);
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Common/StreamCipher.php ---
@@ -0,0 +1,54 @@
+<?php
+
+/**
+ * Base Class for all stream ciphers
+ *
+ * PHP version 5
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @author    Hans-Juergen Petrich <petrich@tronic-media.com>
+ * @copyright 2007 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\Common;
+
+/**
+ * Base Class for all stream cipher classes
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class StreamCipher extends SymmetricKey
+{
+    /**
+     * Block Length of the cipher
+     *
+     * Stream ciphers do not have a block size
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::block_size
+     * @var int
+     */
+    protected $block_size = 0;
+
+    /**
+     * Default Constructor.
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::__construct()
+     * @return \phpseclib3\Crypt\Common\StreamCipher
+     */
+    public function __construct()
+    {
+        parent::__construct('stream');
+    }
+
+    /**
+     * Stream ciphers not use an IV
+     *
+     * @return bool
+     */
+    public function usesIV()
+    {
+        return false;
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Common/Traits/Fingerprint.php ---
@@ -0,0 +1,57 @@
+<?php
+
+/**
+ * Fingerprint Trait for Public Keys
+ *
+ * PHP version 5
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\Common\Traits;
+
+use phpseclib3\Crypt\Hash;
+
+/**
+ * Fingerprint Trait for Private Keys
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+trait Fingerprint
+{
+    /**
+     * Returns the public key's fingerprint
+     *
+     * The public key's fingerprint is returned, which is equivalent to running `ssh-keygen -lf rsa.pub`. If there is
+     * no public key currently loaded, false is returned.
+     * Example output (md5): "c1:b1:30:29:d7:b8:de:6c:97:77:10:d7:46:41:63:87" (as specified by RFC 4716)
+     *
+     * @param string $algorithm The hashing algorithm to be used. Valid options are 'md5' and 'sha256'. False is returned
+     * for invalid values.
+     * @return mixed
+     */
+    public function getFingerprint($algorithm = 'md5')
+    {
+        $type = self::validatePlugin('Keys', 'OpenSSH', 'savePublicKey');
+        if ($type === false) {
+            return false;
+        }
+        $key = $this->toString('OpenSSH', ['binary' => true]);
+        if ($key === false) {
+            return false;
+        }
+        switch ($algorithm) {
+            case 'sha256':
+                $hash = new Hash('sha256');
+                $base = base64_encode($hash->hash($key));
+                return substr($base, 0, strlen($base) - 1);
+            case 'md5':
+                return substr(chunk_split(md5($key), 2, ':'), 0, -1);
+            default:
+                return false;
+        }
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/Common/Traits/PasswordProtected.php ---
@@ -0,0 +1,46 @@
+<?php
+
+/**
+ * Password Protected Trait for Private Keys
+ *
+ * PHP version 5
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\Common\Traits;
+
+/**
+ * Password Protected Trait for Private Keys
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+trait PasswordProtected
+{
+    /**
+     * Password
+     *
+     * @var string|bool
+     */
+    private $password = false;
+
+    /**
+     * Sets the password
+     *
+     * Private keys can be encrypted with a password.  To unset the password, pass in the empty string or false.
+     * Or rather, pass in $password such that empty($password) && !is_string($password) is true.
+     *
+     * @see self::createKey()
+     * @see self::load()
+     * @param string|bool $password
+     */
+    public function withPassword($password = false)
+    {
+        $new = clone $this;
+        $new->password = $password;
+        return $new;
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DES.php ---
@@ -0,0 +1,1392 @@
+<?php
+
+/**
+ * Pure-PHP implementation of DES.
+ *
+ * Uses mcrypt, if available, and an internal implementation, otherwise.
+ *
+ * PHP version 5
+ *
+ * Useful resources are as follows:
+ *
+ *  - {@link http://en.wikipedia.org/wiki/DES_supplementary_material Wikipedia: DES supplementary material}
+ *  - {@link http://www.itl.nist.gov/fipspubs/fip46-2.htm FIPS 46-2 - (DES), Data Encryption Standard}
+ *  - {@link http://www.cs.eku.edu/faculty/styer/460/Encrypt/JS-DES.html JavaScript DES Example}
+ *
+ * Here's a short example of how to use this library:
+ * <code>
+ * <?php
+ *    include 'vendor/autoload.php';
+ *
+ *    $des = new \phpseclib3\Crypt\DES('ctr');
+ *
+ *    $des->setKey('abcdefgh');
+ *
+ *    $size = 10 * 1024;
+ *    $plaintext = '';
+ *    for ($i = 0; $i < $size; $i++) {
+ *        $plaintext.= 'a';
+ *    }
+ *
+ *    echo $des->decrypt($des->encrypt($plaintext));
+ * ?>
+ * </code>
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2007 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt;
+
+use phpseclib3\Crypt\Common\BlockCipher;
+use phpseclib3\Exception\BadModeException;
+
+/**
+ * Pure-PHP implementation of DES.
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+class DES extends BlockCipher
+{
+    /**
+     * Contains $keys[self::ENCRYPT]
+     *
+     * @see \phpseclib3\Crypt\DES::setupKey()
+     * @see \phpseclib3\Crypt\DES::processBlock()
+     */
+    const ENCRYPT = 0;
+    /**
+     * Contains $keys[self::DECRYPT]
+     *
+     * @see \phpseclib3\Crypt\DES::setupKey()
+     * @see \phpseclib3\Crypt\DES::processBlock()
+     */
+    const DECRYPT = 1;
+
+    /**
+     * Block Length of the cipher
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::block_size
+     * @var int
+     */
+    protected $block_size = 8;
+
+    /**
+     * Key Length (in bytes)
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::setKeyLength()
+     * @var int
+     */
+    protected $key_length = 8;
+
+    /**
+     * The mcrypt specific name of the cipher
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::cipher_name_mcrypt
+     * @var string
+     */
+    protected $cipher_name_mcrypt = 'des';
+
+    /**
+     * The OpenSSL names of the cipher / modes
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::openssl_mode_names
+     * @var array
+     */
+    protected $openssl_mode_names = [
+        self::MODE_ECB => 'des-ecb',
+        self::MODE_CBC => 'des-cbc',
+        self::MODE_CFB => 'des-cfb',
+        self::MODE_OFB => 'des-ofb'
+        // self::MODE_CTR is undefined for DES
+    ];
+
+    /**
+     * Optimizing value while CFB-encrypting
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::cfb_init_len
+     * @var int
+     */
+    protected $cfb_init_len = 500;
+
+    /**
+     * Switch for DES/3DES encryption
+     *
+     * Used only if $engine == self::ENGINE_INTERNAL
+     *
+     * @see self::setupKey()
+     * @see self::processBlock()
+     * @var int
+     */
+    protected $des_rounds = 1;
+
+    /**
+     * max possible size of $key
+     *
+     * @see self::setKey()
+     * @var string
+     */
+    protected $key_length_max = 8;
+
+    /**
+     * The Key Schedule
+     *
+     * @see self::setupKey()
+     * @var array
+     */
+    private $keys;
+
+    /**
+     * Key Cache "key"
+     *
+     * @see self::setupKey()
+     * @var array
+     */
+    private $kl;
+
+    /**
+     * Shuffle table.
+     *
+     * For each byte value index, the entry holds an 8-byte string
+     * with each byte containing all bits in the same state as the
+     * corresponding bit in the index value.
+     *
+     * @see self::processBlock()
+     * @see self::setupKey()
+     * @var array
+     */
+    protected static $shuffle = [
+        "\x00\x00\x00\x00\x00\x00\x00\x00", "\x00\x00\x00\x00\x00\x00\x00\xFF",
+        "\x00\x00\x00\x00\x00\x00\xFF\x00", "\x00\x00\x00\x00\x00\x00\xFF\xFF",
+        "\x00\x00\x00\x00\x00\xFF\x00\x00", "\x00\x00\x00\x00\x00\xFF\x00\xFF",
+        "\x00\x00\x00\x00\x00\xFF\xFF\x00", "\x00\x00\x00\x00\x00\xFF\xFF\xFF",
+        "\x00\x00\x00\x00\xFF\x00\x00\x00", "\x00\x00\x00\x00\xFF\x00\x00\xFF",
+        "\x00\x00\x00\x00\xFF\x00\xFF\x00", "\x00\x00\x00\x00\xFF\x00\xFF\xFF",
+        "\x00\x00\x00\x00\xFF\xFF\x00\x00", "\x00\x00\x00\x00\xFF\xFF\x00\xFF",
+        "\x00\x00\x00\x00\xFF\xFF\xFF\x00", "\x00\x00\x00\x00\xFF\xFF\xFF\xFF",
+        "\x00\x00\x00\xFF\x00\x00\x00\x00", "\x00\x00\x00\xFF\x00\x00\x00\xFF",
+        "\x00\x00\x00\xFF\x00\x00\xFF\x00", "\x00\x00\x00\xFF\x00\x00\xFF\xFF",
+        "\x00\x00\x00\xFF\x00\xFF\x00\x00", "\x00\x00\x00\xFF\x00\xFF\x00\xFF",
+        "\x00\x00\x00\xFF\x00\xFF\xFF\x00", "\x00\x00\x00\xFF\x00\xFF\xFF\xFF",
+        "\x00\x00\x00\xFF\xFF\x00\x00\x00", "\x00\x00\x00\xFF\xFF\x00\x00\xFF",
+        "\x00\x00\x00\xFF\xFF\x00\xFF\x00", "\x00\x00\x00\xFF\xFF\x00\xFF\xFF",
+        "\x00\x00\x00\xFF\xFF\xFF\x00\x00", "\x00\x00\x00\xFF\xFF\xFF\x00\xFF",
+        "\x00\x00\x00\xFF\xFF\xFF\xFF\x00", "\x00\x00\x00\xFF\xFF\xFF\xFF\xFF",
+        "\x00\x00\xFF\x00\x00\x00\x00\x00", "\x00\x00\xFF\x00\x00\x00\x00\xFF",
+        "\x00\x00\xFF\x00\x00\x00\xFF\x00", "\x00\x00\xFF\x00\x00\x00\xFF\xFF",
+        "\x00\x00\xFF\x00\x00\xFF\x00\x00", "\x00\x00\xFF\x00\x00\xFF\x00\xFF",
+        "\x00\x00\xFF\x00\x00\xFF\xFF\x00", "\x00\x00\xFF\x00\x00\xFF\xFF\xFF",
+        "\x00\x00\xFF\x00\xFF\x00\x00\x00", "\x00\x00\xFF\x00\xFF\x00\x00\xFF",
+        "\x00\x00\xFF\x00\xFF\x00\xFF\x00", "\x00\x00\xFF\x00\xFF\x00\xFF\xFF",
+        "\x00\x00\xFF\x00\xFF\xFF\x00\x00", "\x00\x00\xFF\x00\xFF\xFF\x00\xFF",
+        "\x00\x00\xFF\x00\xFF\xFF\xFF\x00", "\x00\x00\xFF\x00\xFF\xFF\xFF\xFF",
+        "\x00\x00\xFF\xFF\x00\x00\x00\x00", "\x00\x00\xFF\xFF\x00\x00\x00\xFF",
+        "\x00\x00\xFF\xFF\x00\x00\xFF\x00", "\x00\x00\xFF\xFF\x00\x00\xFF\xFF",
+        "\x00\x00\xFF\xFF\x00\xFF\x00\x00", "\x00\x00\xFF\xFF\x00\xFF\x00\xFF",
+        "\x00\x00\xFF\xFF\x00\xFF\xFF\x00", "\x00\x00\xFF\xFF\x00\xFF\xFF\xFF",
+        "\x00\x00\xFF\xFF\xFF\x00\x00\x00", "\x00\x00\xFF\xFF\xFF\x00\x00\xFF",
+        "\x00\x00\xFF\xFF\xFF\x00\xFF\x00", "\x00\x00\xFF\xFF\xFF\x00\xFF\xFF",
+        "\x00\x00\xFF\xFF\xFF\xFF\x00\x00", "\x00\x00\xFF\xFF\xFF\xFF\x00\xFF",
+        "\x00\x00\xFF\xFF\xFF\xFF\xFF\x00", "\x00\x00\xFF\xFF\xFF\xFF\xFF\xFF",
+        "\x00\xFF\x00\x00\x00\x00\x00\x00", "\x00\xFF\x00\x00\x00\x00\x00\xFF",
+        "\x00\xFF\x00\x00\x00\x00\xFF\x00", "\x00\xFF\x00\x00\x00\x00\xFF\xFF",
+        "\x00\xFF\x00\x00\x00\xFF\x00\x00", "\x00\xFF\x00\x00\x00\xFF\x00\xFF",
+        "\x00\xFF\x00\x00\x00\xFF\xFF\x00", "\x00\xFF\x00\x00\x00\xFF\xFF\xFF",
+        "\x00\xFF\x00\x00\xFF\x00\x00\x00", "\x00\xFF\x00\x00\xFF\x00\x00\xFF",
+        "\x00\xFF\x00\x00\xFF\x00\xFF\x00", "\x00\xFF\x00\x00\xFF\x00\xFF\xFF",
+        "\x00\xFF\x00\x00\xFF\xFF\x00\x00", "\x00\xFF\x00\x00\xFF\xFF\x00\xFF",
+        "\x00\xFF\x00\x00\xFF\xFF\xFF\x00", "\x00\xFF\x00\x00\xFF\xFF\xFF\xFF",
+        "\x00\xFF\x00\xFF\x00\x00\x00\x00", "\x00\xFF\x00\xFF\x00\x00\x00\xFF",
+        "\x00\xFF\x00\xFF\x00\x00\xFF\x00", "\x00\xFF\x00\xFF\x00\x00\xFF\xFF",
+        "\x00\xFF\x00\xFF\x00\xFF\x00\x00", "\x00\xFF\x00\xFF\x00\xFF\x00\xFF",
+        "\x00\xFF\x00\xFF\x00\xFF\xFF\x00", "\x00\xFF\x00\xFF\x00\xFF\xFF\xFF",
+        "\x00\xFF\x00\xFF\xFF\x00\x00\x00", "\x00\xFF\x00\xFF\xFF\x00\x00\xFF",
+        "\x00\xFF\x00\xFF\xFF\x00\xFF\x00", "\x00\xFF\x00\xFF\xFF\x00\xFF\xFF",
+        "\x00\xFF\x00\xFF\xFF\xFF\x00\x00", "\x00\xFF\x00\xFF\xFF\xFF\x00\xFF",
+        "\x00\xFF\x00\xFF\xFF\xFF\xFF\x00", "\x00\xFF\x00\xFF\xFF\xFF\xFF\xFF",
+        "\x00\xFF\xFF\x00\x00\x00\x00\x00", "\x00\xFF\xFF\x00\x00\x00\x00\xFF",
+        "\x00\xFF\xFF\x00\x00\x00\xFF\x00", "\x00\xFF\xFF\x00\x00\x00\xFF\xFF",
+        "\x00\xFF\xFF\x00\x00\xFF\x00\x00", "\x00\xFF\xFF\x00\x00\xFF\x00\xFF",
+        "\x00\xFF\xFF\x00\x00\xFF\xFF\x00", "\x00\xFF\xFF\x00\x00\xFF\xFF\xFF",
+        "\x00\xFF\xFF\x00\xFF\x00\x00\x00", "\x00\xFF\xFF\x00\xFF\x00\x00\xFF",
+        "\x00\xFF\xFF\x00\xFF\x00\xFF\x00", "\x00\xFF\xFF\x00\xFF\x00\xFF\xFF",
+        "\x00\xFF\xFF\x00\xFF\xFF\x00\x00", "\x00\xFF\xFF\x00\xFF\xFF\x00\xFF",
+        "\x00\xFF\xFF\x00\xFF\xFF\xFF\x00", "\x00\xFF\xFF\x00\xFF\xFF\xFF\xFF",
+        "\x00\xFF\xFF\xFF\x00\x00\x00\x00", "\x00\xFF\xFF\xFF\x00\x00\x00\xFF",
+        "\x00\xFF\xFF\xFF\x00\x00\xFF\x00", "\x00\xFF\xFF\xFF\x00\x00\xFF\xFF",
+        "\x00\xFF\xFF\xFF\x00\xFF\x00\x00", "\x00\xFF\xFF\xFF\x00\xFF\x00\xFF",
+        "\x00\xFF\xFF\xFF\x00\xFF\xFF\x00", "\x00\xFF\xFF\xFF\x00\xFF\xFF\xFF",
+        "\x00\xFF\xFF\xFF\xFF\x00\x00\x00", "\x00\xFF\xFF\xFF\xFF\x00\x00\xFF",
+        "\x00\xFF\xFF\xFF\xFF\x00\xFF\x00", "\x00\xFF\xFF\xFF\xFF\x00\xFF\xFF",
+        "\x00\xFF\xFF\xFF\xFF\xFF\x00\x00", "\x00\xFF\xFF\xFF\xFF\xFF\x00\xFF",
+        "\x00\xFF\xFF\xFF\xFF\xFF\xFF\x00", "\x00\xFF\xFF\xFF\xFF\xFF\xFF\xFF",
+        "\xFF\x00\x00\x00\x00\x00\x00\x00", "\xFF\x00\x00\x00\x00\x00\x00\xFF",
+        "\xFF\x00\x00\x00\x00\x00\xFF\x00", "\xFF\x00\x00\x00\x00\x00\xFF\xFF",
+        "\xFF\x00\x00\x00\x00\xFF\x00\x00", "\xFF\x00\x00\x00\x00\xFF\x00\xFF",
+        "\xFF\x00\x00\x00\x00\xFF\xFF\x00", "\xFF\x00\x00\x00\x00\xFF\xFF\xFF",
+        "\xFF\x00\x00\x00\xFF\x00\x00\x00", "\xFF\x00\x00\x00\xFF\x00\x00\xFF",
+        "\xFF\x00\x00\x00\xFF\x00\xFF\x00", "\xFF\x00\x00\x00\xFF\x00\xFF\xFF",
+        "\xFF\x00\x00\x00\xFF\xFF\x00\x00", "\xFF\x00\x00\x00\xFF\xFF\x00\xFF",
+        "\xFF\x00\x00\x00\xFF\xFF\xFF\x00", "\xFF\x00\x00\x00\xFF\xFF\xFF\xFF",
+        "\xFF\x00\x00\xFF\x00\x00\x00\x00", "\xFF\x00\x00\xFF\x00\x00\x00\xFF",
+        "\xFF\x00\x00\xFF\x00\x00\xFF\x00", "\xFF\x00\x00\xFF\x00\x00\xFF\xFF",
+        "\xFF\x00\x00\xFF\x00\xFF\x00\x00", "\xFF\x00\x00\xFF\x00\xFF\x00\xFF",
+        "\xFF\x00\x00\xFF\x00\xFF\xFF\x00", "\xFF\x00\x00\xFF\x00\xFF\xFF\xFF",
+        "\xFF\x00\x00\xFF\xFF\x00\x00\x00", "\xFF\x00\x00\xFF\xFF\x00\x00\xFF",
+        "\xFF\x00\x00\xFF\xFF\x00\xFF\x00", "\xFF\x00\x00\xFF\xFF\x00\xFF\xFF",
+        "\xFF\x00\x00\xFF\xFF\xFF\x00\x00", "\xFF\x00\x00\xFF\xFF\xFF\x00\xFF",
+        "\xFF\x00\x00\xFF\xFF\xFF\xFF\x00", "\xFF\x00\x00\xFF\xFF\xFF\xFF\xFF",
+        "\xFF\x00\xFF\x00\x00\x00\x00\x00", "\xFF\x00\xFF\x00\x00\x00\x00\xFF",
+        "\xFF\x00\xFF\x00\x00\x00\xFF\x00", "\xFF\x00\xFF\x00\x00\x00\xFF\xFF",
+        "\xFF\x00\xFF\x00\x00\xFF\x00\x00", "\xFF\x00\xFF\x00\x00\xFF\x00\xFF",
+        "\xFF\x00\xFF\x00\x00\xFF\xFF\x00", "\xFF\x00\xFF\x00\x00\xFF\xFF\xFF",
+        "\xFF\x00\xFF\x00\xFF\x00\x00\x00", "\xFF\x00\xFF\x00\xFF\x00\x00\xFF",
+        "\xFF\x00\xFF\x00\xFF\x00\xFF\x00", "\xFF\x00\xFF\x00\xFF\x00\xFF\xFF",
+        "\xFF\x00\xFF\x00\xFF\xFF\x00\x00", "\xFF\x00\xFF\x00\xFF\xFF\x00\xFF",
+        "\xFF\x00\xFF\x00\xFF\xFF\xFF\x00", "\xFF\x00\xFF\x00\xFF\xFF\xFF\xFF",
+        "\xFF\x00\xFF\xFF\x00\x00\x00\x00", "\xFF\x00\xFF\xFF\x00\x00\x00\xFF",
+        "\xFF\x00\xFF\xFF\x00\x00\xFF\x00", "\xFF\x00\xFF\xFF\x00\x00\xFF\xFF",
+        "\xFF\x00\xFF\xFF\x00\xFF\x00\x00", "\xFF\x00\xFF\xFF\x00\xFF\x00\xFF",
+        "\xFF\x00\xFF\xFF\x00\xFF\xFF\x00", "\xFF\x00\xFF\xFF\x00\xFF\xFF\xFF",
+        "\xFF\x00\xFF\xFF\xFF\x00\x00\x00", "\xFF\x00\xFF\xFF\xFF\x00\x00\xFF",
+        "\xFF\x00\xFF\xFF\xFF\x00\xFF\x00", "\xFF\x00\xFF\xFF\xFF\x00\xFF\xFF",
+        "\xFF\x00\xFF\xFF\xFF\xFF\x00\x00", "\xFF\x00\xFF\xFF\xFF\xFF\x00\xFF",
+        "\xFF\x00\xFF\xFF\xFF\xFF\xFF\x00", "\xFF\x00\xFF\xFF\xFF\xFF\xFF\xFF",
+        "\xFF\xFF\x00\x00\x00\x00\x00\x00", "\xFF\xFF\x00\x00\x00\x00\x00\xFF",
+        "\xFF\xFF\x00\x00\x00\x00\xFF\x00", "\xFF\xFF\x00\x00\x00\x00\xFF\xFF",
+        "\xFF\xFF\x00\x00\x00\xFF\x00\x00", "\xFF\xFF\x00\x00\x00\xFF\x00\xFF",
+        "\xFF\xFF\x00\x00\x00\xFF\xFF\x00", "\xFF\xFF\x00\x00\x00\xFF\xFF\xFF",
+        "\xFF\xFF\x00\x00\xFF\x00\x00\x00", "\xFF\xFF\x00\x00\xFF\x00\x00\xFF",
+        "\xFF\xFF\x00\x00\xFF\x00\xFF\x00", "\xFF\xFF\x00\x00\xFF\x00\xFF\xFF",
+        "\xFF\xFF\x00\x00\xFF\xFF\x00\x00", "\xFF\xFF\x00\x00\xFF\xFF\x00\xFF",
+        "\xFF\xFF\x00\x00\xFF\xFF\xFF\x00", "\xFF\xFF\x00\x00\xFF\xFF\xFF\xFF",
+        "\xFF\xFF\x00\xFF\x00\x00\x00\x00", "\xFF\xFF\x00\xFF\x00\x00\x00\xFF",
+        "\xFF\xFF\x00\xFF\x00\x00\xFF\x00", "\xFF\xFF\x00\xFF\x00\x00\xFF\xFF",
+        "\xFF\xFF\x00\xFF\x00\xFF\x00\x00", "\xFF\xFF\x00\xFF\x00\xFF\x00\xFF",
+        "\xFF\xFF\x00\xFF\x00\xFF\xFF\x00", "\xFF\xFF\x00\xFF\x00\xFF\xFF\xFF",
+        "\xFF\xFF\x00\xFF\xFF\x00\x00\x00", "\xFF\xFF\x00\xFF\xFF\x00\x00\xFF",
+        "\xFF\xFF\x00\xFF\xFF\x00\xFF\x00", "\xFF\xFF\x00\xFF\xFF\x00\xFF\xFF",
+        "\xFF\xFF\x00\xFF\xFF\xFF\x00\x00", "\xFF\xFF\x00\xFF\xFF\xFF\x00\xFF",
+        "\xFF\xFF\x00\xFF\xFF\xFF\xFF\x00", "\xFF\xFF\x00\xFF\xFF\xFF\xFF\xFF",
+        "\xFF\xFF\xFF\x00\x00\x00\x00\x00", "\xFF\xFF\xFF\x00\x00\x00\x00\xFF",
+        "\xFF\xFF\xFF\x00\x00\x00\xFF\x00", "\xFF\xFF\xFF\x00\x00\x00\xFF\xFF",
+        "\xFF\xFF\xFF\x00\x00\xFF\x00\x00", "\xFF\xFF\xFF\x00\x00\xFF\x00\xFF",
+        "\xFF\xFF\xFF\x00\x00\xFF\xFF\x00", "\xFF\xFF\xFF\x00\x00\xFF\xFF\xFF",
+        "\xFF\xFF\xFF\x00\xFF\x00\x00\x00", "\xFF\xFF\xFF\x00\xFF\x00\x00\xFF",
+        "\xFF\xFF\xFF\x00\xFF\x00\xFF\x00", "\xFF\xFF\xFF\x00\xFF\x00\xFF\xFF",
+        "\xFF\xFF\xFF\x00\xFF\xFF\x00\x00", "\xFF\xFF\xFF\x00\xFF\xFF\x00\xFF",
+        "\xFF\xFF\xFF\x00\xFF\xFF\xFF\x00", "\xFF\xFF\xFF\x00\xFF\xFF\xFF\xFF",
+        "\xFF\xFF\xFF\xFF\x00\x00\x00\x00", "\xFF\xFF\xFF\xFF\x00\x00\x00\xFF",
+        "\xFF\xFF\xFF\xFF\x00\x00\xFF\x00", "\xFF\xFF\xFF\xFF\x00\x00\xFF\xFF",
+        "\xFF\xFF\xFF\xFF\x00\xFF\x00\x00", "\xFF\xFF\xFF\xFF\x00\xFF\x00\xFF",
+        "\xFF\xFF\xFF\xFF\x00\xFF\xFF\x00", "\xFF\xFF\xFF\xFF\x00\xFF\xFF\xFF",
+        "\xFF\xFF\xFF\xFF\xFF\x00\x00\x00", "\xFF\xFF\xFF\xFF\xFF\x00\x00\xFF",
+        "\xFF\xFF\xFF\xFF\xFF\x00\xFF\x00", "\xFF\xFF\xFF\xFF\xFF\x00\xFF\xFF",
+        "\xFF\xFF\xFF\xFF\xFF\xFF\x00\x00", "\xFF\xFF\xFF\xFF\xFF\xFF\x00\xFF",
+        "\xFF\xFF\xFF\xFF\xFF\xFF\xFF\x00", "\xFF\xFF\xFF\xFF\xFF\xFF\xFF\xFF"
+    ];
+
+    /**
+     * IP mapping helper table.
+     *
+     * Indexing this table with each source byte performs the initial bit permutation.
+     *
+     * @var array
+     */
+    protected static $ipmap = [
+        0x00, 0x10, 0x01, 0x11, 0x20, 0x30, 0x21, 0x31,
+        0x02, 0x12, 0x03, 0x13, 0x22, 0x32, 0x23, 0x33,
+        0x40, 0x50, 0x41, 0x51, 0x60, 0x70, 0x61, 0x71,
+        0x42, 0x52, 0x43, 0x53, 0x62, 0x72, 0x63, 0x73,
+        0x04, 0x14, 0x05, 0x15, 0x24, 0x34, 0x25, 0x35,
+        0x06, 0x16, 0x07, 0x17, 0x26, 0x36, 0x27, 0x37,
+        0x44, 0x54, 0x45, 0x55, 0x64, 0x74, 0x65, 0x75,
+        0x46, 0x56, 0x47, 0x57, 0x66, 0x76, 0x67, 0x77,
+        0x80, 0x90, 0x81, 0x91, 0xA0, 0xB0, 0xA1, 0xB1,
+        0x82, 0x92, 0x83, 0x93, 0xA2, 0xB2, 0xA3, 0xB3,
+        0xC0, 0xD0, 0xC1, 0xD1, 0xE0, 0xF0, 0xE1, 0xF1,
+        0xC2, 0xD2, 0xC3, 0xD3, 0xE2, 0xF2, 0xE3, 0xF3,
+        0x84, 0x94, 0x85, 0x95, 0xA4, 0xB4, 0xA5, 0xB5,
+        0x86, 0x96, 0x87, 0x97, 0xA6, 0xB6, 0xA7, 0xB7,
+        0xC4, 0xD4, 0xC5, 0xD5, 0xE4, 0xF4, 0xE5, 0xF5,
+        0xC6, 0xD6, 0xC7, 0xD7, 0xE6, 0xF6, 0xE7, 0xF7,
+        0x08, 0x18, 0x09, 0x19, 0x28, 0x38, 0x29, 0x39,
+        0x0A, 0x1A, 0x0B, 0x1B, 0x2A, 0x3A, 0x2B, 0x3B,
+        0x48, 0x58, 0x49, 0x59, 0x68, 0x78, 0x69, 0x79,
+        0x4A, 0x5A, 0x4B, 0x5B, 0x6A, 0x7A, 0x6B, 0x7B,
+        0x0C, 0x1C, 0x0D, 0x1D, 0x2C, 0x3C, 0x2D, 0x3D,
+        0x0E, 0x1E, 0x0F, 0x1F, 0x2E, 0x3E, 0x2F, 0x3F,
+        0x4C, 0x5C, 0x4D, 0x5D, 0x6C, 0x7C, 0x6D, 0x7D,
+        0x4E, 0x5E, 0x4F, 0x5F, 0x6E, 0x7E, 0x6F, 0x7F,
+        0x88, 0x98, 0x89, 0x99, 0xA8, 0xB8, 0xA9, 0xB9,
+        0x8A, 0x9A, 0x8B, 0x9B, 0xAA, 0xBA, 0xAB, 0xBB,
+        0xC8, 0xD8, 0xC9, 0xD9, 0xE8, 0xF8, 0xE9, 0xF9,
+        0xCA, 0xDA, 0xCB, 0xDB, 0xEA, 0xFA, 0xEB, 0xFB,
+        0x8C, 0x9C, 0x8D, 0x9D, 0xAC, 0xBC, 0xAD, 0xBD,
+        0x8E, 0x9E, 0x8F, 0x9F, 0xAE, 0xBE, 0xAF, 0xBF,
+        0xCC, 0xDC, 0xCD, 0xDD, 0xEC, 0xFC, 0xED, 0xFD,
+        0xCE, 0xDE, 0xCF, 0xDF, 0xEE, 0xFE, 0xEF, 0xFF
+    ];
+
+    /**
+     * Inverse IP mapping helper table.
+     * Indexing this table with a byte value reverses the bit order.
+     *
+     * @var array
+     */
+    protected static $invipmap = [
+        0x00, 0x80, 0x40, 0xC0, 0x20, 0xA0, 0x60, 0xE0,
+        0x10, 0x90, 0x50, 0xD0, 0x30, 0xB0, 0x70, 0xF0,
+        0x08, 0x88, 0x48, 0xC8, 0x28, 0xA8, 0x68, 0xE8,
+        0x18, 0x98, 0x58, 0xD8, 0x38, 0xB8, 0x78, 0xF8,
+        0x04, 0x84, 0x44, 0xC4, 0x24, 0xA4, 0x64, 0xE4,
+        0x14, 0x94, 0x54, 0xD4, 0x34, 0xB4, 0x74, 0xF4,
+        0x0C, 0x8C, 0x4C, 0xCC, 0x2C, 0xAC, 0x6C, 0xEC,
+        0x1C, 0x9C, 0x5C, 0xDC, 0x3C, 0xBC, 0x7C, 0xFC,
+        0x02, 0x82, 0x42, 0xC2, 0x22, 0xA2, 0x62, 0xE2,
+        0x12, 0x92, 0x52, 0xD2, 0x32, 0xB2, 0x72, 0xF2,
+        0x0A, 0x8A, 0x4A, 0xCA, 0x2A, 0xAA, 0x6A, 0xEA,
+        0x1A, 0x9A, 0x5A, 0xDA, 0x3A, 0xBA, 0x7A, 0xFA,
+        0x06, 0x86, 0x46, 0xC6, 0x26, 0xA6, 0x66, 0xE6,
+        0x16, 0x96, 0x56, 0xD6, 0x36, 0xB6, 0x76, 0xF6,
+        0x0E, 0x8E, 0x4E, 0xCE, 0x2E, 0xAE, 0x6E, 0xEE,
+        0x1E, 0x9E, 0x5E, 0xDE, 0x3E, 0xBE, 0x7E, 0xFE,
+        0x01, 0x81, 0x41, 0xC1, 0x21, 0xA1, 0x61, 0xE1,
+        0x11, 0x91, 0x51, 0xD1, 0x31, 0xB1, 0x71, 0xF1,
+        0x09, 0x89, 0x49, 0xC9, 0x29, 0xA9, 0x69, 0xE9,
+        0x19, 0x99, 0x59, 0xD9, 0x39, 0xB9, 0x79, 0xF9,
+        0x05, 0x85, 0x45, 0xC5, 0x25, 0xA5, 0x65, 0xE5,
+        0x15, 0x95, 0x55, 0xD5, 0x35, 0xB5, 0x75, 0xF5,
+        0x0D, 0x8D, 0x4D, 0xCD, 0x2D, 0xAD, 0x6D, 0xED,
+        0x1D, 0x9D, 0x5D, 0xDD, 0x3D, 0xBD, 0x7D, 0xFD,
+        0x03, 0x83, 0x43, 0xC3, 0x23, 0xA3, 0x63, 0xE3,
+        0x13, 0x93, 0x53, 0xD3, 0x33, 0xB3, 0x73, 0xF3,
+        0x0B, 0x8B, 0x4B, 0xCB, 0x2B, 0xAB, 0x6B, 0xEB,
+        0x1B, 0x9B, 0x5B, 0xDB, 0x3B, 0xBB, 0x7B, 0xFB,
+        0x07, 0x87, 0x47, 0xC7, 0x27, 0xA7, 0x67, 0xE7,
+        0x17, 0x97, 0x57, 0xD7, 0x37, 0xB7, 0x77, 0xF7,
+        0x0F, 0x8F, 0x4F, 0xCF, 0x2F, 0xAF, 0x6F, 0xEF,
+        0x1F, 0x9F, 0x5F, 0xDF, 0x3F, 0xBF, 0x7F, 0xFF
+    ];
+
+    /**
+     * Pre-permuted S-box1
+     *
+     * Each box ($sbox1-$sbox8) has been vectorized, then each value pre-permuted using the
+     * P table: concatenation can then be replaced by exclusive ORs.
+     *
+     * @var array
+     */
+    protected static $sbox1 = [
+        0x00808200, 0x00000000, 0x00008000, 0x00808202,
+        0x00808002, 0x00008202, 0x00000002, 0x00008000,
+        0x00000200, 0x00808200, 0x00808202, 0x00000200,
+        0x00800202, 0x00808002, 0x00800000, 0x00000002,
+        0x00000202, 0x00800200, 0x00800200, 0x00008200,
+        0x00008200, 0x00808000, 0x00808000, 0x00800202,
+        0x00008002, 0x00800002, 0x00800002, 0x00008002,
+        0x00000000, 0x00000202, 0x00008202, 0x00800000,
+        0x00008000, 0x00808202, 0x00000002, 0x00808000,
+        0x00808200, 0x00800000, 0x00800000, 0x00000200,
+        0x00808002, 0x00008000, 0x00008200, 0x00800002,
+        0x00000200, 0x00000002, 0x00800202, 0x00008202,
+        0x00808202, 0x00008002, 0x00808000, 0x00800202,
+        0x00800002, 0x00000202, 0x00008202, 0x00808200,
+        0x00000202, 0x00800200, 0x00800200, 0x00000000,
+        0x00008002, 0x00008200, 0x00000000, 0x00808002
+    ];
+
+    /**
+     * Pre-permuted S-box2
+     *
+     * @var array
+     */
+    protected static $sbox2 = [
+        0x40084010, 0x40004000, 0x00004000, 0x00084010,
+        0x00080000, 0x00000010, 0x40080010, 0x40004010,
+        0x40000010, 0x40084010, 0x40084000, 0x40000000,
+        0x40004000, 0x00080000, 0x00000010, 0x40080010,
+        0x00084000, 0x00080010, 0x40004010, 0x00000000,
+        0x40000000, 0x00004000, 0x00084010, 0x40080000,
+        0x00080010, 0x40000010, 0x00000000, 0x00084000,
+        0x00004010, 0x40084000, 0x40080000, 0x00004010,
+        0x00000000, 0x00084010, 0x40080010, 0x00080000,
+        0x40004010, 0x40080000, 0x40084000, 0x00004000,
+        0x40080000, 0x40004000, 0x00000010, 0x40084010,
+        0x00084010, 0x00000010, 0x00004000, 0x40000000,
+        0x00004010, 0x40084000, 0x00080000, 0x40000010,
+        0x00080010, 0x40004010, 0x40000010, 0x00080010,
+        0x00084000, 0x00000000, 0x40004000, 0x00004010,
+        0x40000000, 0x40080010, 0x40084010, 0x00084000
+    ];
+
+    /**
+     * Pre-permuted S-box3
+     *
+     * @var array
+     */
+    protected static $sbox3 = [
+        0x00000104, 0x04010100, 0x00000000, 0x04010004,
+        0x04000100, 0x00000000, 0x00010104, 0x04000100,
+        0x00010004, 0x04000004, 0x04000004, 0x00010000,
+        0x04010104, 0x00010004, 0x04010000, 0x00000104,
+        0x04000000, 0x00000004, 0x04010100, 0x00000100,
+        0x00010100, 0x04010000, 0x04010004, 0x00010104,
+        0x04000104, 0x00010100, 0x00010000, 0x04000104,
+        0x00000004, 0x04010104, 0x00000100, 0x04000000,
+        0x04010100, 0x04000000, 0x00010004, 0x00000104,
+        0x00010000, 0x04010100, 0x04000100, 0x00000000,
+        0x00000100, 0x00010004, 0x04010104, 0x04000100,
+        0x04000004, 0x00000100, 0x00000000, 0x04010004,
+        0x04000104, 0x00010000, 0x04000000, 0x04010104,
+        0x00000004, 0x00010104, 0x00010100, 0x04000004,
+        0x04010000, 0x04000104, 0x00000104, 0x04010000,
+        0x00010104, 0x00000004, 0x04010004, 0x00010100
+    ];
+
+    /**
+     * Pre-permuted S-box4
+     *
+     * @var array
+     */
+    protected static $sbox4 = [
+        0x80401000, 0x80001040, 0x80001040, 0x00000040,
+        0x00401040, 0x80400040, 0x80400000, 0x80001000,
+        0x00000000, 0x00401000, 0x00401000, 0x80401040,
+        0x80000040, 0x00000000, 0x00400040, 0x80400000,
+        0x80000000, 0x00001000, 0x00400000, 0x80401000,
+        0x00000040, 0x00400000, 0x80001000, 0x00001040,
+        0x80400040, 0x80000000, 0x00001040, 0x00400040,
+        0x00001000, 0x00401040, 0x80401040, 0x80000040,
+        0x00400040, 0x80400000, 0x00401000, 0x80401040,
+        0x80000040, 0x00000000, 0x00000000, 0x00401000,
+        0x00001040, 0x00400040, 0x80400040, 0x80000000,
+        0x80401000, 0x80001040, 0x80001040, 0x00000040,
+        0x80401040, 0x80000040, 0x80000000, 0x00001000,
+        0x80400000, 0x80001000, 0x00401040, 0x80400040,
+        0x80001000, 0x00001040, 0x00400000, 0x80401000,
+        0x00000040, 0x00400000, 0x00001000, 0x00401040
+    ];
+
+    /**
+     * Pre-permuted S-box5
+     *
+     * @var array
+     */
+    protected static $sbox5 = [
+        0x00000080, 0x01040080, 0x01040000, 0x21000080,
+        0x00040000, 0x00000080, 0x20000000, 0x01040000,
+        0x20040080, 0x00040000, 0x01000080, 0x20040080,
+        0x21000080, 0x21040000, 0x00040080, 0x20000000,
+        0x01000000, 0x20040000, 0x20040000, 0x00000000,
+        0x20000080, 0x21040080, 0x21040080, 0x01000080,
+        0x21040000, 0x20000080, 0x00000000, 0x21000000,
+        0x01040080, 0x01000000, 0x21000000, 0x00040080,
+        0x00040000, 0x21000080, 0x00000080, 0x01000000,
+        0x20000000, 0x01040000, 0x21000080, 0x20040080,
+        0x01000080, 0x20000000, 0x21040000, 0x01040080,
+        0x20040080, 0x00000080, 0x01000000, 0x21040000,
+        0x21040080, 0x00040080, 0x21000000, 0x21040080,
+        0x01040000, 0x00000000, 0x20040000, 0x21000000,
+        0x00040080, 0x01000080, 0x20000080, 0x00040000,
+        0x00000000, 0x20040000, 0x01040080, 0x20000080
+    ];
+
+    /**
+     * Pre-permuted S-box6
+     *
+     * @var array
+     */
+    protected static $sbox6 = [
+        0x10000008, 0x10200000, 0x00002000, 0x10202008,
+        0x10200000, 0x00000008, 0x10202008, 0x00200000,
+        0x10002000, 0x00202008, 0x00200000, 0x10000008,
+        0x00200008, 0x10002000, 0x10000000, 0x00002008,
+        0x00000000, 0x00200008, 0x10002008, 0x00002000,
+        0x00202000, 0x10002008, 0x00000008, 0x10200008,
+        0x10200008, 0x00000000, 0x00202008, 0x10202000,
+        0x00002008, 0x00202000, 0x10202000, 0x10000000,
+        0x10002000, 0x00000008, 0x10200008, 0x00202000,
+        0x10202008, 0x00200000, 0x00002008, 0x10000008,
+        0x00200000, 0x10002000, 0x10000000, 0x00002008,
+        0x10000008, 0x10202008, 0x00202000, 0x10200000,
+        0x00202008, 0x10202000, 0x00000000, 0x10200008,
+        0x00000008, 0x00002000, 0x10200000, 0x00202008,
+        0x00002000, 0x00200008, 0x10002008, 0x00000000,
+        0x10202000, 0x10000000, 0x00200008, 0x10002008
+    ];
+
+    /**
+     * Pre-permuted S-box7
+     *
+     * @var array
+     */
+    protected static $sbox7 = [
+        0x00100000, 0x02100001, 0x02000401, 0x00000000,
+        0x00000400, 0x02000401, 0x00100401, 0x02100400,
+        0x02100401, 0x00100000, 0x00000000, 0x02000001,
+        0x00000001, 0x02000000, 0x02100001, 0x00000401,
+        0x02000400, 0x00100401, 0x00100001, 0x02000400,
+        0x02000001, 0x02100000, 0x02100400, 0x00100001,
+        0x02100000, 0x00000400, 0x00000401, 0x02100401,
+        0x00100400, 0x00000001, 0x02000000, 0x00100400,
+        0x02000000, 0x00100400, 0x00100000, 0x02000401,
+        0x02000401, 0x02100001, 0x02100001, 0x00000001,
+        0x00100001, 0x02000000, 0x02000400, 0x00100000,
+        0x02100400, 0x00000401, 0x00100401, 0x02100400,
+        0x00000401, 0x02000001, 0x02100401, 0x02100000,
+        0x00100400, 0x00000000, 0x00000001, 0x02100401,
+        0x00000000, 0x00100401, 0x02100000, 0x00000400,
+        0x02000001, 0x02000400, 0x00000400, 0x00100001
+    ];
+
+    /**
+     * Pre-permuted S-box8
+     *
+     * @var array
+     */
+    protected static $sbox8 = [
+        0x08000820, 0x00000800, 0x00020000, 0x08020820,
+        0x08000000, 0x08000820, 0x00000020, 0x08000000,
+        0x00020020, 0x08020000, 0x08020820, 0x00020800,
+        0x08020800, 0x00020820, 0x00000800, 0x00000020,
+        0x08020000, 0x08000020, 0x08000800, 0x00000820,
+        0x00020800, 0x00020020, 0x08020020, 0x08020800,
+        0x00000820, 0x00000000, 0x00000000, 0x08020020,
+        0x08000020, 0x08000800, 0x00020820, 0x00020000,
+        0x00020820, 0x00020000, 0x08020800, 0x00000800,
+        0x00000020, 0x08020020, 0x00000800, 0x00020820,
+        0x08000800, 0x00000020, 0x08000020, 0x08020000,
+        0x08020020, 0x08000000, 0x00020000, 0x08000820,
+        0x00000000, 0x08020820, 0x00020020, 0x08000020,
+        0x08020000, 0x08000800, 0x08000820, 0x00000000,
+        0x08020820, 0x00020800, 0x00020800, 0x00000820,
+        0x00000820, 0x00020020, 0x08000000, 0x08020800
+    ];
+
+    /**
+     * Default Constructor.
+     *
+     * @param string $mode
+     * @throws BadModeException if an invalid / unsupported mode is provided
+     */
+    public function __construct($mode)
+    {
+        parent::__construct($mode);
+
+        if ($this->mode == self::MODE_STREAM) {
+            throw new BadModeException('Block ciphers cannot be ran in stream mode');
+        }
+    }
+
+    /**
+     * Test for engine validity
+     *
+     * This is mainly just a wrapper to set things up for \phpseclib3\Crypt\Common\SymmetricKey::isValidEngine()
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::isValidEngine()
+     * @param int $engine
+     * @return bool
+     */
+    protected function isValidEngineHelper($engine)
+    {
+        if ($this->key_length_max == 8) {
+            if ($engine == self::ENGINE_OPENSSL) {
+                // quoting https://www.openssl.org/news/openssl-3.0-notes.html, OpenSSL 3.0.1
+                // "Moved all variations of the EVP ciphers CAST5, BF, IDEA, SEED, RC2, RC4, RC5, and DES to the legacy provider"
+                // in theory openssl_get_cipher_methods() should catch this but, on GitHub Actions, at least, it does not
+                if (defined('OPENSSL_VERSION_TEXT') && version_compare(preg_replace('#OpenSSL (\d+\.\d+\.\d+) .*#', '$1', OPENSSL_VERSION_TEXT), '3.0.1', '>=')) {
+                    return false;
+                }
+                $this->cipher_name_openssl_ecb = 'des-ecb';
+                $this->cipher_name_openssl = 'des-' . $this->openssl_translate_mode();
+            }
+        }
+
+        return parent::isValidEngineHelper($engine);
+    }
+
+    /**
+     * Sets the key.
+     *
+     * Keys must be 64-bits long or 8 bytes long.
+     *
+     * DES also requires that every eighth bit be a parity bit, however, we'll ignore that.
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::setKey()
+     * @param string $key
+     */
+    public function setKey($key)
+    {
+        if (!($this instanceof TripleDES) && strlen($key) != 8) {
+            throw new \LengthException('Key of size ' . strlen($key) . ' not supported by this algorithm. Only keys of size 8 are supported');
+        }
+
+        // Sets the key
+        parent::setKey($key);
+    }
+
+    /**
+     * Encrypts a block
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::encryptBlock()
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::encrypt()
+     * @see self::encrypt()
+     * @param string $in
+     * @return string
+     */
+    protected function encryptBlock($in)
+    {
+        return $this->processBlock($in, self::ENCRYPT);
+    }
+
+    /**
+     * Decrypts a block
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::decryptBlock()
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::decrypt()
+     * @see self::decrypt()
+     * @param string $in
+     * @return string
+     */
+    protected function decryptBlock($in)
+    {
+        return $this->processBlock($in, self::DECRYPT);
+    }
+
+    /**
+     * Encrypts or decrypts a 64-bit block
+     *
+     * $mode should be either self::ENCRYPT or self::DECRYPT.  See
+     * {@link http://en.wikipedia.org/wiki/Image:Feistel.png Feistel.png} to get a general
+     * idea of what this function does.
+     *
+     * @see self::encryptBlock()
+     * @see self::decryptBlock()
+     * @param string $block
+     * @param int $mode
+     * @return string
+     */
+    private function processBlock($block, $mode)
+    {
+        static $sbox1, $sbox2, $sbox3, $sbox4, $sbox5, $sbox6, $sbox7, $sbox8, $shuffleip, $shuffleinvip;
+        if (!$sbox1) {
+            $sbox1 = array_map('intval', self::$sbox1);
+            $sbox2 = array_map('intval', self::$sbox2);
+            $sbox3 = array_map('intval', self::$sbox3);
+            $sbox4 = array_map('intval', self::$sbox4);
+            $sbox5 = array_map('intval', self::$sbox5);
+            $sbox6 = array_map('intval', self::$sbox6);
+            $sbox7 = array_map('intval', self::$sbox7);
+            $sbox8 = array_map('intval', self::$sbox8);
+            /* Merge $shuffle with $[inv]ipmap */
+            for ($i = 0; $i < 256; ++$i) {
+                $shuffleip[]    =  self::$shuffle[self::$ipmap[$i]];
+                $shuffleinvip[] =  self::$shuffle[self::$invipmap[$i]];
+            }
+        }
+
+        $keys  = $this->keys[$mode];
+        $ki    = -1;
+
+        // Do the initial IP permutation.
+        $t = unpack('Nl/Nr', $block);
+        list($l, $r) = [$t['l'], $t['r']];
+        $block = ($shuffleip[ $r        & 0xFF] & "\x80\x80\x80\x80\x80\x80\x80\x80") |
+                 ($shuffleip[($r >>  8) & 0xFF] & "\x40\x40\x40\x40\x40\x40\x40\x40") |
+                 ($shuffleip[($r >> 16) & 0xFF] & "\x20\x20\x20\x20\x20\x20\x20\x20") |
+                 ($shuffleip[($r >> 24) & 0xFF] & "\x10\x10\x10\x10\x10\x10\x10\x10") |
+                 ($shuffleip[ $l        & 0xFF] & "\x08\x08\x08\x08\x08\x08\x08\x08") |
+                 ($shuffleip[($l >>  8) & 0xFF] & "\x04\x04\x04\x04\x04\x04\x04\x04") |
+                 ($shuffleip[($l >> 16) & 0xFF] & "\x02\x02\x02\x02\x02\x02\x02\x02") |
+                 ($shuffleip[($l >> 24) & 0xFF] & "\x01\x01\x01\x01\x01\x01\x01\x01");
+
+        // Extract L0 and R0.
+        $t = unpack('Nl/Nr', $block);
+        list($l, $r) = [$t['l'], $t['r']];
+
+        for ($des_round = 0; $des_round < $this->des_rounds; ++$des_round) {
+            // Perform the 16 steps.
+            for ($i = 0; $i < 16; $i++) {
+                // start of "the Feistel (F) function" - see the following URL:
+                // http://en.wikipedia.org/wiki/Image:Data_Encryption_Standard_InfoBox_Diagram.png
+                // Merge key schedule.
+                $b1 = (($r >>  3) & 0x1FFFFFFF) ^ ($r << 29) ^ $keys[++$ki];
+                $b2 = (($r >> 31) & 0x00000001) ^ ($r <<  1) ^ $keys[++$ki];
+
+                // S-box indexing.
+                $t = $sbox1[($b1 >> 24) & 0x3F] ^ $sbox2[($b2 >> 24) & 0x3F] ^
+                     $sbox3[($b1 >> 16) & 0x3F] ^ $sbox4[($b2 >> 16) & 0x3F] ^
+                     $sbox5[($b1 >>  8) & 0x3F] ^ $sbox6[($b2 >>  8) & 0x3F] ^
+                     $sbox7[ $b1        & 0x3F] ^ $sbox8[ $b2        & 0x3F] ^ $l;
+                // end of "the Feistel (F) function"
+
+                $l = $r;
+                $r = $t;
+            }
+
+            // Last step should not permute L & R.
+            $t = $l;
+            $l = $r;
+            $r = $t;
+        }
+
+        // Perform the inverse IP permutation.
+        return ($shuffleinvip[($r >> 24) & 0xFF] & "\x80\x80\x80\x80\x80\x80\x80\x80") |
+               ($shuffleinvip[($l >> 24) & 0xFF] & "\x40\x40\x40\x40\x40\x40\x40\x40") |
+               ($shuffleinvip[($r >> 16) & 0xFF] & "\x20\x20\x20\x20\x20\x20\x20\x20") |
+               ($shuffleinvip[($l >> 16) & 0xFF] & "\x10\x10\x10\x10\x10\x10\x10\x10") |
+               ($shuffleinvip[($r >>  8) & 0xFF] & "\x08\x08\x08\x08\x08\x08\x08\x08") |
+               ($shuffleinvip[($l >>  8) & 0xFF] & "\x04\x04\x04\x04\x04\x04\x04\x04") |
+               ($shuffleinvip[ $r        & 0xFF] & "\x02\x02\x02\x02\x02\x02\x02\x02") |
+               ($shuffleinvip[ $l        & 0xFF] & "\x01\x01\x01\x01\x01\x01\x01\x01");
+    }
+
+    /**
+     * Creates the key schedule
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::setupKey()
+     */
+    protected function setupKey()
+    {
+        if (isset($this->kl['key']) && $this->key === $this->kl['key'] && $this->des_rounds === $this->kl['des_rounds']) {
+            // already expanded
+            return;
+        }
+        $this->kl = ['key' => $this->key, 'des_rounds' => $this->des_rounds];
+
+        static $shifts = [ // number of key bits shifted per round
+            1, 1, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2, 2, 1
+        ];
+
+        static $pc1map = [
+            0x00, 0x00, 0x08, 0x08, 0x04, 0x04, 0x0C, 0x0C,
+            0x02, 0x02, 0x0A, 0x0A, 0x06, 0x06, 0x0E, 0x0E,
+            0x10, 0x10, 0x18, 0x18, 0x14, 0x14, 0x1C, 0x1C,
+            0x12, 0x12, 0x1A, 0x1A, 0x16, 0x16, 0x1E, 0x1E,
+            0x20, 0x20, 0x28, 0x28, 0x24, 0x24, 0x2C, 0x2C,
+            0x22, 0x22, 0x2A, 0x2A, 0x26, 0x26, 0x2E, 0x2E,
+            0x30, 0x30, 0x38, 0x38, 0x34, 0x34, 0x3C, 0x3C,
+            0x32, 0x32, 0x3A, 0x3A, 0x36, 0x36, 0x3E, 0x3E,
+            0x40, 0x40, 0x48, 0x48, 0x44, 0x44, 0x4C, 0x4C,
+            0x42, 0x42, 0x4A, 0x4A, 0x46, 0x46, 0x4E, 0x4E,
+            0x50, 0x50, 0x58, 0x58, 0x54, 0x54, 0x5C, 0x5C,
+            0x52, 0x52, 0x5A, 0x5A, 0x56, 0x56, 0x5E, 0x5E,
+            0x60, 0x60, 0x68, 0x68, 0x64, 0x64, 0x6C, 0x6C,
+            0x62, 0x62, 0x6A, 0x6A, 0x66, 0x66, 0x6E, 0x6E,
+            0x70, 0x70, 0x78, 0x78, 0x74, 0x74, 0x7C, 0x7C,
+            0x72, 0x72, 0x7A, 0x7A, 0x76, 0x76, 0x7E, 0x7E,
+            0x80, 0x80, 0x88, 0x88, 0x84, 0x84, 0x8C, 0x8C,
+            0x82, 0x82, 0x8A, 0x8A, 0x86, 0x86, 0x8E, 0x8E,
+            0x90, 0x90, 0x98, 0x98, 0x94, 0x94, 0x9C, 0x9C,
+            0x92, 0x92, 0x9A, 0x9A, 0x96, 0x96, 0x9E, 0x9E,
+            0xA0, 0xA0, 0xA8, 0xA8, 0xA4, 0xA4, 0xAC, 0xAC,
+            0xA2, 0xA2, 0xAA, 0xAA, 0xA6, 0xA6, 0xAE, 0xAE,
+            0xB0, 0xB0, 0xB8, 0xB8, 0xB4, 0xB4, 0xBC, 0xBC,
+            0xB2, 0xB2, 0xBA, 0xBA, 0xB6, 0xB6, 0xBE, 0xBE,
+            0xC0, 0xC0, 0xC8, 0xC8, 0xC4, 0xC4, 0xCC, 0xCC,
+            0xC2, 0xC2, 0xCA, 0xCA, 0xC6, 0xC6, 0xCE, 0xCE,
+            0xD0, 0xD0, 0xD8, 0xD8, 0xD4, 0xD4, 0xDC, 0xDC,
+            0xD2, 0xD2, 0xDA, 0xDA, 0xD6, 0xD6, 0xDE, 0xDE,
+            0xE0, 0xE0, 0xE8, 0xE8, 0xE4, 0xE4, 0xEC, 0xEC,
+            0xE2, 0xE2, 0xEA, 0xEA, 0xE6, 0xE6, 0xEE, 0xEE,
+            0xF0, 0xF0, 0xF8, 0xF8, 0xF4, 0xF4, 0xFC, 0xFC,
+            0xF2, 0xF2, 0xFA, 0xFA, 0xF6, 0xF6, 0xFE, 0xFE
+        ];
+
+        // Mapping tables for the PC-2 transformation.
+        static $pc2mapc1 = [
+            0x00000000, 0x00000400, 0x00200000, 0x00200400,
+            0x00000001, 0x00000401, 0x00200001, 0x00200401,
+            0x02000000, 0x02000400, 0x02200000, 0x02200400,
+            0x02000001, 0x02000401, 0x02200001, 0x02200401
+        ];
+        static $pc2mapc2 = [
+            0x00000000, 0x00000800, 0x08000000, 0x08000800,
+            0x00010000, 0x00010800, 0x08010000, 0x08010800,
+            0x00000000, 0x00000800, 0x08000000, 0x08000800,
+            0x00010000, 0x00010800, 0x08010000, 0x08010800,
+            0x00000100, 0x00000900, 0x08000100, 0x08000900,
+            0x00010100, 0x00010900, 0x08010100, 0x08010900,
+            0x00000100, 0x00000900, 0x08000100, 0x08000900,
+            0x00010100, 0x00010900, 0x08010100, 0x08010900,
+            0x00000010, 0x00000810, 0x08000010, 0x08000810,
+            0x00010010, 0x00010810, 0x08010010, 0x08010810,
+            0x00000010, 0x00000810, 0x08000010, 0x08000810,
+            0x00010010, 0x00010810, 0x08010010, 0x08010810,
+            0x00000110, 0x00000910, 0x08000110, 0x08000910,
+            0x00010110, 0x00010910, 0x08010110, 0x08010910,
+            0x00000110, 0x00000910, 0x08000110, 0x08000910,
+            0x00010110, 0x00010910, 0x08010110, 0x08010910,
+            0x00040000, 0x00040800, 0x08040000, 0x08040800,
+            0x00050000, 0x00050800, 0x08050000, 0x08050800,
+            0x00040000, 0x00040800, 0x08040000, 0x08040800,
+            0x00050000, 0x00050800, 0x08050000, 0x08050800,
+            0x00040100, 0x00040900, 0x08040100, 0x08040900,
+            0x00050100, 0x00050900, 0x08050100, 0x08050900,
+            0x00040100, 0x00040900, 0x08040100, 0x08040900,
+            0x00050100, 0x00050900, 0x08050100, 0x08050900,
+            0x00040010, 0x00040810, 0x08040010, 0x08040810,
+            0x00050010, 0x00050810, 0x08050010, 0x08050810,
+            0x00040010, 0x00040810, 0x08040010, 0x08040810,
+            0x00050010, 0x00050810, 0x08050010, 0x08050810,
+            0x00040110, 0x00040910, 0x08040110, 0x08040910,
+            0x00050110, 0x00050910, 0x08050110, 0x08050910,
+            0x00040110, 0x00040910, 0x08040110, 0x08040910,
+            0x00050110, 0x00050910, 0x08050110, 0x08050910,
+            0x01000000, 0x01000800, 0x09000000, 0x09000800,
+            0x01010000, 0x01010800, 0x09010000, 0x09010800,
+            0x01000000, 0x01000800, 0x09000000, 0x09000800,
+            0x01010000, 0x01010800, 0x09010000, 0x09010800,
+            0x01000100, 0x01000900, 0x09000100, 0x09000900,
+            0x01010100, 0x01010900, 0x09010100, 0x09010900,
+            0x01000100, 0x01000900, 0x09000100, 0x09000900,
+            0x01010100, 0x01010900, 0x09010100, 0x09010900,
+            0x01000010, 0x01000810, 0x09000010, 0x09000810,
+            0x01010010, 0x01010810, 0x09010010, 0x09010810,
+            0x01000010, 0x01000810, 0x09000010, 0x09000810,
+            0x01010010, 0x01010810, 0x09010010, 0x09010810,
+            0x01000110, 0x01000910, 0x09000110, 0x09000910,
+            0x01010110, 0x01010910, 0x09010110, 0x09010910,
+            0x01000110, 0x01000910, 0x09000110, 0x09000910,
+            0x01010110, 0x01010910, 0x09010110, 0x09010910,
+            0x01040000, 0x01040800, 0x09040000, 0x09040800,
+            0x01050000, 0x01050800, 0x09050000, 0x09050800,
+            0x01040000, 0x01040800, 0x09040000, 0x09040800,
+            0x01050000, 0x01050800, 0x09050000, 0x09050800,
+            0x01040100, 0x01040900, 0x09040100, 0x09040900,
+            0x01050100, 0x01050900, 0x09050100, 0x09050900,
+            0x01040100, 0x01040900, 0x09040100, 0x09040900,
+            0x01050100, 0x01050900, 0x09050100, 0x09050900,
+            0x01040010, 0x01040810, 0x09040010, 0x09040810,
+            0x01050010, 0x01050810, 0x09050010, 0x09050810,
+            0x01040010, 0x01040810, 0x09040010, 0x09040810,
+            0x01050010, 0x01050810, 0x09050010, 0x09050810,
+            0x01040110, 0x01040910, 0x09040110, 0x09040910,
+            0x01050110, 0x01050910, 0x09050110, 0x09050910,
+            0x01040110, 0x01040910, 0x09040110, 0x09040910,
+            0x01050110, 0x01050910, 0x09050110, 0x09050910
+        ];
+        static $pc2mapc3 = [
+            0x00000000, 0x00000004, 0x00001000, 0x00001004,
+            0x00000000, 0x00000004, 0x00001000, 0x00001004,
+            0x10000000, 0x10000004, 0x10001000, 0x10001004,
+            0x10000000, 0x10000004, 0x10001000, 0x10001004,
+            0x00000020, 0x00000024, 0x00001020, 0x00001024,
+            0x00000020, 0x00000024, 0x00001020, 0x00001024,
+            0x10000020, 0x10000024, 0x10001020, 0x10001024,
+            0x10000020, 0x10000024, 0x10001020, 0x10001024,
+            0x00080000, 0x00080004, 0x00081000, 0x00081004,
+            0x00080000, 0x00080004, 0x00081000, 0x00081004,
+            0x10080000, 0x10080004, 0x10081000, 0x10081004,
+            0x10080000, 0x10080004, 0x10081000, 0x10081004,
+            0x00080020, 0x00080024, 0x00081020, 0x00081024,
+            0x00080020, 0x00080024, 0x00081020, 0x00081024,
+            0x10080020, 0x10080024, 0x10081020, 0x10081024,
+            0x10080020, 0x10080024, 0x10081020, 0x10081024,
+            0x20000000, 0x20000004, 0x20001000, 0x20001004,
+            0x20000000, 0x20000004, 0x20001000, 0x20001004,
+            0x30000000, 0x30000004, 0x30001000, 0x30001004,
+            0x30000000, 0x30000004, 0x30001000, 0x30001004,
+            0x20000020, 0x20000024, 0x20001020, 0x20001024,
+            0x20000020, 0x20000024, 0x20001020, 0x20001024,
+            0x30000020, 0x30000024, 0x30001020, 0x30001024,
+            0x30000020, 0x30000024, 0x30001020, 0x30001024,
+            0x20080000, 0x20080004, 0x20081000, 0x20081004,
+            0x20080000, 0x20080004, 0x20081000, 0x20081004,
+            0x30080000, 0x30080004, 0x30081000, 0x30081004,
+            0x30080000, 0x30080004, 0x30081000, 0x30081004,
+            0x20080020, 0x20080024, 0x20081020, 0x20081024,
+            0x20080020, 0x20080024, 0x20081020, 0x20081024,
+            0x30080020, 0x30080024, 0x30081020, 0x30081024,
+            0x30080020, 0x30080024, 0x30081020, 0x30081024,
+            0x00000002, 0x00000006, 0x00001002, 0x00001006,
+            0x00000002, 0x00000006, 0x00001002, 0x00001006,
+            0x10000002, 0x10000006, 0x10001002, 0x10001006,
+            0x10000002, 0x10000006, 0x10001002, 0x10001006,
+            0x00000022, 0x00000026, 0x00001022, 0x00001026,
+            0x00000022, 0x00000026, 0x00001022, 0x00001026,
+            0x10000022, 0x10000026, 0x10001022, 0x10001026,
+            0x10000022, 0x10000026, 0x10001022, 0x10001026,
+            0x00080002, 0x00080006, 0x00081002, 0x00081006,
+            0x00080002, 0x00080006, 0x00081002, 0x00081006,
+            0x10080002, 0x10080006, 0x10081002, 0x10081006,
+            0x10080002, 0x10080006, 0x10081002, 0x10081006,
+            0x00080022, 0x00080026, 0x00081022, 0x00081026,
+            0x00080022, 0x00080026, 0x00081022, 0x00081026,
+            0x10080022, 0x10080026, 0x10081022, 0x10081026,
+            0x10080022, 0x10080026, 0x10081022, 0x10081026,
+            0x20000002, 0x20000006, 0x20001002, 0x20001006,
+            0x20000002, 0x20000006, 0x20001002, 0x20001006,
+            0x30000002, 0x30000006, 0x30001002, 0x30001006,
+            0x30000002, 0x30000006, 0x30001002, 0x30001006,
+            0x20000022, 0x20000026, 0x20001022, 0x20001026,
+            0x20000022, 0x20000026, 0x20001022, 0x20001026,
+            0x30000022, 0x30000026, 0x30001022, 0x30001026,
+            0x30000022, 0x30000026, 0x30001022, 0x30001026,
+            0x20080002, 0x20080006, 0x20081002, 0x20081006,
+            0x20080002, 0x20080006, 0x20081002, 0x20081006,
+            0x30080002, 0x30080006, 0x30081002, 0x30081006,
+            0x30080002, 0x30080006, 0x30081002, 0x30081006,
+            0x20080022, 0x20080026, 0x20081022, 0x20081026,
+            0x20080022, 0x20080026, 0x20081022, 0x20081026,
+            0x30080022, 0x30080026, 0x30081022, 0x30081026,
+            0x30080022, 0x30080026, 0x30081022, 0x30081026
+        ];
+        static $pc2mapc4 = [
+            0x00000000, 0x00100000, 0x00000008, 0x00100008,
+            0x00000200, 0x00100200, 0x00000208, 0x00100208,
+            0x00000000, 0x00100000, 0x00000008, 0x00100008,
+            0x00000200, 0x00100200, 0x00000208, 0x00100208,
+            0x04000000, 0x04100000, 0x04000008, 0x04100008,
+            0x04000200, 0x04100200, 0x04000208, 0x04100208,
+            0x04000000, 0x04100000, 0x04000008, 0x04100008,
+            0x04000200, 0x04100200, 0x04000208, 0x04100208,
+            0x00002000, 0x00102000, 0x00002008, 0x00102008,
+            0x00002200, 0x00102200, 0x00002208, 0x00102208,
+            0x00002000, 0x00102000, 0x00002008, 0x00102008,
+            0x00002200, 0x00102200, 0x00002208, 0x00102208,
+            0x04002000, 0x04102000, 0x04002008, 0x04102008,
+            0x04002200, 0x04102200, 0x04002208, 0x04102208,
+            0x04002000, 0x04102000, 0x04002008, 0x04102008,
+            0x04002200, 0x04102200, 0x04002208, 0x04102208,
+            0x00000000, 0x00100000, 0x00000008, 0x00100008,
+            0x00000200, 0x00100200, 0x00000208, 0x00100208,
+            0x00000000, 0x00100000, 0x00000008, 0x00100008,
+            0x00000200, 0x00100200, 0x00000208, 0x00100208,
+            0x04000000, 0x04100000, 0x04000008, 0x04100008,
+            0x04000200, 0x04100200, 0x04000208, 0x04100208,
+            0x04000000, 0x04100000, 0x04000008, 0x04100008,
+            0x04000200, 0x04100200, 0x04000208, 0x04100208,
+            0x00002000, 0x00102000, 0x00002008, 0x00102008,
+            0x00002200, 0x00102200, 0x00002208, 0x00102208,
+            0x00002000, 0x00102000, 0x00002008, 0x00102008,
+            0x00002200, 0x00102200, 0x00002208, 0x00102208,
+            0x04002000, 0x04102000, 0x04002008, 0x04102008,
+            0x04002200, 0x04102200, 0x04002208, 0x04102208,
+            0x04002000, 0x04102000, 0x04002008, 0x04102008,
+            0x04002200, 0x04102200, 0x04002208, 0x04102208,
+            0x00020000, 0x00120000, 0x00020008, 0x00120008,
+            0x00020200, 0x00120200, 0x00020208, 0x00120208,
+            0x00020000, 0x00120000, 0x00020008, 0x00120008,
+            0x00020200, 0x00120200, 0x00020208, 0x00120208,
+            0x04020000, 0x04120000, 0x04020008, 0x04120008,
+            0x04020200, 0x04120200, 0x04020208, 0x04120208,
+            0x04020000, 0x04120000, 0x04020008, 0x04120008,
+            0x04020200, 0x04120200, 0x04020208, 0x04120208,
+            0x00022000, 0x00122000, 0x00022008, 0x00122008,
+            0x00022200, 0x00122200, 0x00022208, 0x00122208,
+            0x00022000, 0x00122000, 0x00022008, 0x00122008,
+            0x00022200, 0x00122200, 0x00022208, 0x00122208,
+            0x04022000, 0x04122000, 0x04022008, 0x04122008,
+            0x04022200, 0x04122200, 0x04022208, 0x04122208,
+            0x04022000, 0x04122000, 0x04022008, 0x04122008,
+            0x04022200, 0x04122200, 0x04022208, 0x04122208,
+            0x00020000, 0x00120000, 0x00020008, 0x00120008,
+            0x00020200, 0x00120200, 0x00020208, 0x00120208,
+            0x00020000, 0x00120000, 0x00020008, 0x00120008,
+            0x00020200, 0x00120200, 0x00020208, 0x00120208,
+            0x04020000, 0x04120000, 0x04020008, 0x04120008,
+            0x04020200, 0x04120200, 0x04020208, 0x04120208,
+            0x04020000, 0x04120000, 0x04020008, 0x04120008,
+            0x04020200, 0x04120200, 0x04020208, 0x04120208,
+            0x00022000, 0x00122000, 0x00022008, 0x00122008,
+            0x00022200, 0x00122200, 0x00022208, 0x00122208,
+            0x00022000, 0x00122000, 0x00022008, 0x00122008,
+            0x00022200, 0x00122200, 0x00022208, 0x00122208,
+            0x04022000, 0x04122000, 0x04022008, 0x04122008,
+            0x04022200, 0x04122200, 0x04022208, 0x04122208,
+            0x04022000, 0x04122000, 0x04022008, 0x04122008,
+            0x04022200, 0x04122200, 0x04022208, 0x04122208
+        ];
+        static $pc2mapd1 = [
+            0x00000000, 0x00000001, 0x08000000, 0x08000001,
+            0x00200000, 0x00200001, 0x08200000, 0x08200001,
+            0x00000002, 0x00000003, 0x08000002, 0x08000003,
+            0x00200002, 0x00200003, 0x08200002, 0x08200003
+        ];
+        static $pc2mapd2 = [
+            0x00000000, 0x00100000, 0x00000800, 0x00100800,
+            0x00000000, 0x00100000, 0x00000800, 0x00100800,
+            0x04000000, 0x04100000, 0x04000800, 0x04100800,
+            0x04000000, 0x04100000, 0x04000800, 0x04100800,
+            0x00000004, 0x00100004, 0x00000804, 0x00100804,
+            0x00000004, 0x00100004, 0x00000804, 0x00100804,
+            0x04000004, 0x04100004, 0x04000804, 0x04100804,
+            0x04000004, 0x04100004, 0x04000804, 0x04100804,
+            0x00000000, 0x00100000, 0x00000800, 0x00100800,
+            0x00000000, 0x00100000, 0x00000800, 0x00100800,
+            0x04000000, 0x04100000, 0x04000800, 0x04100800,
+            0x04000000, 0x04100000, 0x04000800, 0x04100800,
+            0x00000004, 0x00100004, 0x00000804, 0x00100804,
+            0x00000004, 0x00100004, 0x00000804, 0x00100804,
+            0x04000004, 0x04100004, 0x04000804, 0x04100804,
+            0x04000004, 0x04100004, 0x04000804, 0x04100804,
+            0x00000200, 0x00100200, 0x00000A00, 0x00100A00,
+            0x00000200, 0x00100200, 0x00000A00, 0x00100A00,
+            0x04000200, 0x04100200, 0x04000A00, 0x04100A00,
+            0x04000200, 0x04100200, 0x04000A00, 0x04100A00,
+            0x00000204, 0x00100204, 0x00000A04, 0x00100A04,
+            0x00000204, 0x00100204, 0x00000A04, 0x00100A04,
+            0x04000204, 0x04100204, 0x04000A04, 0x04100A04,
+            0x04000204, 0x04100204, 0x04000A04, 0x04100A04,
+            0x00000200, 0x00100200, 0x00000A00, 0x00100A00,
+            0x00000200, 0x00100200, 0x00000A00, 0x00100A00,
+            0x04000200, 0x04100200, 0x04000A00, 0x04100A00,
+            0x04000200, 0x04100200, 0x04000A00, 0x04100A00,
+            0x00000204, 0x00100204, 0x00000A04, 0x00100A04,
+            0x00000204, 0x00100204, 0x00000A04, 0x00100A04,
+            0x04000204, 0x04100204, 0x04000A04, 0x04100A04,
+            0x04000204, 0x04100204, 0x04000A04, 0x04100A04,
+            0x00020000, 0x00120000, 0x00020800, 0x00120800,
+            0x00020000, 0x00120000, 0x00020800, 0x00120800,
+            0x04020000, 0x04120000, 0x04020800, 0x04120800,
+            0x04020000, 0x04120000, 0x04020800, 0x04120800,
+            0x00020004, 0x00120004, 0x00020804, 0x00120804,
+            0x00020004, 0x00120004, 0x00020804, 0x00120804,
+            0x04020004, 0x04120004, 0x04020804, 0x04120804,
+            0x04020004, 0x04120004, 0x04020804, 0x04120804,
+            0x00020000, 0x00120000, 0x00020800, 0x00120800,
+            0x00020000, 0x00120000, 0x00020800, 0x00120800,
+            0x04020000, 0x04120000, 0x04020800, 0x04120800,
+            0x04020000, 0x04120000, 0x04020800, 0x04120800,
+            0x00020004, 0x00120004, 0x00020804, 0x00120804,
+            0x00020004, 0x00120004, 0x00020804, 0x00120804,
+            0x04020004, 0x04120004, 0x04020804, 0x04120804,
+            0x04020004, 0x04120004, 0x04020804, 0x04120804,
+            0x00020200, 0x00120200, 0x00020A00, 0x00120A00,
+            0x00020200, 0x00120200, 0x00020A00, 0x00120A00,
+            0x04020200, 0x04120200, 0x04020A00, 0x04120A00,
+            0x04020200, 0x04120200, 0x04020A00, 0x04120A00,
+            0x00020204, 0x00120204, 0x00020A04, 0x00120A04,
+            0x00020204, 0x00120204, 0x00020A04, 0x00120A04,
+            0x04020204, 0x04120204, 0x04020A04, 0x04120A04,
+            0x04020204, 0x04120204, 0x04020A04, 0x04120A04,
+            0x00020200, 0x00120200, 0x00020A00, 0x00120A00,
+            0x00020200, 0x00120200, 0x00020A00, 0x00120A00,
+            0x04020200, 0x04120200, 0x04020A00, 0x04120A00,
+            0x04020200, 0x04120200, 0x04020A00, 0x04120A00,
+            0x00020204, 0x00120204, 0x00020A04, 0x00120A04,
+            0x00020204, 0x00120204, 0x00020A04, 0x00120A04,
+            0x04020204, 0x04120204, 0x04020A04, 0x04120A04,
+            0x04020204, 0x04120204, 0x04020A04, 0x04120A04
+        ];
+        static $pc2mapd3 = [
+            0x00000000, 0x00010000, 0x02000000, 0x02010000,
+            0x00000020, 0x00010020, 0x02000020, 0x02010020,
+            0x00040000, 0x00050000, 0x02040000, 0x02050000,
+            0x00040020, 0x00050020, 0x02040020, 0x02050020,
+            0x00002000, 0x00012000, 0x02002000, 0x02012000,
+            0x00002020, 0x00012020, 0x02002020, 0x02012020,
+            0x00042000, 0x00052000, 0x02042000, 0x02052000,
+            0x00042020, 0x00052020, 0x02042020, 0x02052020,
+            0x00000000, 0x00010000, 0x02000000, 0x02010000,
+            0x00000020, 0x00010020, 0x02000020, 0x02010020,
+            0x00040000, 0x00050000, 0x02040000, 0x02050000,
+            0x00040020, 0x00050020, 0x02040020, 0x02050020,
+            0x00002000, 0x00012000, 0x02002000, 0x02012000,
+            0x00002020, 0x00012020, 0x02002020, 0x02012020,
+            0x00042000, 0x00052000, 0x02042000, 0x02052000,
+            0x00042020, 0x00052020, 0x02042020, 0x02052020,
+            0x00000010, 0x00010010, 0x02000010, 0x02010010,
+            0x00000030, 0x00010030, 0x02000030, 0x02010030,
+            0x00040010, 0x00050010, 0x02040010, 0x02050010,
+            0x00040030, 0x00050030, 0x02040030, 0x02050030,
+            0x00002010, 0x00012010, 0x02002010, 0x02012010,
+            0x00002030, 0x00012030, 0x02002030, 0x02012030,
+            0x00042010, 0x00052010, 0x02042010, 0x02052010,
+            0x00042030, 0x00052030, 0x02042030, 0x02052030,
+            0x00000010, 0x00010010, 0x02000010, 0x02010010,
+            0x00000030, 0x00010030, 0x02000030, 0x02010030,
+            0x00040010, 0x00050010, 0x02040010, 0x02050010,
+            0x00040030, 0x00050030, 0x02040030, 0x02050030,
+            0x00002010, 0x00012010, 0x02002010, 0x02012010,
+            0x00002030, 0x00012030, 0x02002030, 0x02012030,
+            0x00042010, 0x00052010, 0x02042010, 0x02052010,
+            0x00042030, 0x00052030, 0x02042030, 0x02052030,
+            0x20000000, 0x20010000, 0x22000000, 0x22010000,
+            0x20000020, 0x20010020, 0x22000020, 0x22010020,
+            0x20040000, 0x20050000, 0x22040000, 0x22050000,
+            0x20040020, 0x20050020, 0x22040020, 0x22050020,
+            0x20002000, 0x20012000, 0x22002000, 0x22012000,
+            0x20002020, 0x20012020, 0x22002020, 0x22012020,
+            0x20042000, 0x20052000, 0x22042000, 0x22052000,
+            0x20042020, 0x20052020, 0x22042020, 0x22052020,
+            0x20000000, 0x20010000, 0x22000000, 0x22010000,
+            0x20000020, 0x20010020, 0x22000020, 0x22010020,
+            0x20040000, 0x20050000, 0x22040000, 0x22050000,
+            0x20040020, 0x20050020, 0x22040020, 0x22050020,
+            0x20002000, 0x20012000, 0x22002000, 0x22012000,
+            0x20002020, 0x20012020, 0x22002020, 0x22012020,
+            0x20042000, 0x20052000, 0x22042000, 0x22052000,
+            0x20042020, 0x20052020, 0x22042020, 0x22052020,
+            0x20000010, 0x20010010, 0x22000010, 0x22010010,
+            0x20000030, 0x20010030, 0x22000030, 0x22010030,
+            0x20040010, 0x20050010, 0x22040010, 0x22050010,
+            0x20040030, 0x20050030, 0x22040030, 0x22050030,
+            0x20002010, 0x20012010, 0x22002010, 0x22012010,
+            0x20002030, 0x20012030, 0x22002030, 0x22012030,
+            0x20042010, 0x20052010, 0x22042010, 0x22052010,
+            0x20042030, 0x20052030, 0x22042030, 0x22052030,
+            0x20000010, 0x20010010, 0x22000010, 0x22010010,
+            0x20000030, 0x20010030, 0x22000030, 0x22010030,
+            0x20040010, 0x20050010, 0x22040010, 0x22050010,
+            0x20040030, 0x20050030, 0x22040030, 0x22050030,
+            0x20002010, 0x20012010, 0x22002010, 0x22012010,
+            0x20002030, 0x20012030, 0x22002030, 0x22012030,
+            0x20042010, 0x20052010, 0x22042010, 0x22052010,
+            0x20042030, 0x20052030, 0x22042030, 0x22052030
+        ];
+        static $pc2mapd4 = [
+            0x00000000, 0x00000400, 0x01000000, 0x01000400,
+            0x00000000, 0x00000400, 0x01000000, 0x01000400,
+            0x00000100, 0x00000500, 0x01000100, 0x01000500,
+            0x00000100, 0x00000500, 0x01000100, 0x01000500,
+            0x10000000, 0x10000400, 0x11000000, 0x11000400,
+            0x10000000, 0x10000400, 0x11000000, 0x11000400,
+            0x10000100, 0x10000500, 0x11000100, 0x11000500,
+            0x10000100, 0x10000500, 0x11000100, 0x11000500,
+            0x00080000, 0x00080400, 0x01080000, 0x01080400,
+            0x00080000, 0x00080400, 0x01080000, 0x01080400,
+            0x00080100, 0x00080500, 0x01080100, 0x01080500,
+            0x00080100, 0x00080500, 0x01080100, 0x01080500,
+            0x10080000, 0x10080400, 0x11080000, 0x11080400,
+            0x10080000, 0x10080400, 0x11080000, 0x11080400,
+            0x10080100, 0x10080500, 0x11080100, 0x11080500,
+            0x10080100, 0x10080500, 0x11080100, 0x11080500,
+            0x00000008, 0x00000408, 0x01000008, 0x01000408,
+            0x00000008, 0x00000408, 0x01000008, 0x01000408,
+            0x00000108, 0x00000508, 0x01000108, 0x01000508,
+            0x00000108, 0x00000508, 0x01000108, 0x01000508,
+            0x10000008, 0x10000408, 0x11000008, 0x11000408,
+            0x10000008, 0x10000408, 0x11000008, 0x11000408,
+            0x10000108, 0x10000508, 0x11000108, 0x11000508,
+            0x10000108, 0x10000508, 0x11000108, 0x11000508,
+            0x00080008, 0x00080408, 0x01080008, 0x01080408,
+            0x00080008, 0x00080408, 0x01080008, 0x01080408,
+            0x00080108, 0x00080508, 0x01080108, 0x01080508,
+            0x00080108, 0x00080508, 0x01080108, 0x01080508,
+            0x10080008, 0x10080408, 0x11080008, 0x11080408,
+            0x10080008, 0x10080408, 0x11080008, 0x11080408,
+            0x10080108, 0x10080508, 0x11080108, 0x11080508,
+            0x10080108, 0x10080508, 0x11080108, 0x11080508,
+            0x00001000, 0x00001400, 0x01001000, 0x01001400,
+            0x00001000, 0x00001400, 0x01001000, 0x01001400,
+            0x00001100, 0x00001500, 0x01001100, 0x01001500,
+            0x00001100, 0x00001500, 0x01001100, 0x01001500,
+            0x10001000, 0x10001400, 0x11001000, 0x11001400,
+            0x10001000, 0x10001400, 0x11001000, 0x11001400,
+            0x10001100, 0x10001500, 0x11001100, 0x11001500,
+            0x10001100, 0x10001500, 0x11001100, 0x11001500,
+            0x00081000, 0x00081400, 0x01081000, 0x01081400,
+            0x00081000, 0x00081400, 0x01081000, 0x01081400,
+            0x00081100, 0x00081500, 0x01081100, 0x01081500,
+            0x00081100, 0x00081500, 0x01081100, 0x01081500,
+            0x10081000, 0x10081400, 0x11081000, 0x11081400,
+            0x10081000, 0x10081400, 0x11081000, 0x11081400,
+            0x10081100, 0x10081500, 0x11081100, 0x11081500,
+            0x10081100, 0x10081500, 0x11081100, 0x11081500,
+            0x00001008, 0x00001408, 0x01001008, 0x01001408,
+            0x00001008, 0x00001408, 0x01001008, 0x01001408,
+            0x00001108, 0x00001508, 0x01001108, 0x01001508,
+            0x00001108, 0x00001508, 0x01001108, 0x01001508,
+            0x10001008, 0x10001408, 0x11001008, 0x11001408,
+            0x10001008, 0x10001408, 0x11001008, 0x11001408,
+            0x10001108, 0x10001508, 0x11001108, 0x11001508,
+            0x10001108, 0x10001508, 0x11001108, 0x11001508,
+            0x00081008, 0x00081408, 0x01081008, 0x01081408,
+            0x00081008, 0x00081408, 0x01081008, 0x01081408,
+            0x00081108, 0x00081508, 0x01081108, 0x01081508,
+            0x00081108, 0x00081508, 0x01081108, 0x01081508,
+            0x10081008, 0x10081408, 0x11081008, 0x11081408,
+            0x10081008, 0x10081408, 0x11081008, 0x11081408,
+            0x10081108, 0x10081508, 0x11081108, 0x11081508,
+            0x10081108, 0x10081508, 0x11081108, 0x11081508
+        ];
+
+        $keys = [];
+        for ($des_round = 0; $des_round < $this->des_rounds; ++$des_round) {
+            // pad the key and remove extra characters as appropriate.
+            $key = str_pad(substr($this->key, $des_round * 8, 8), 8, "\0");
+
+            // Perform the PC/1 transformation and compute C and D.
+            $t = unpack('Nl/Nr', $key);
+            list($l, $r) = [$t['l'], $t['r']];
+            $key = (self::$shuffle[$pc1map[ $r        & 0xFF]] & "\x80\x80\x80\x80\x80\x80\x80\x00") |
+                   (self::$shuffle[$pc1map[($r >>  8) & 0xFF]] & "\x40\x40\x40\x40\x40\x40\x40\x00") |
+                   (self::$shuffle[$pc1map[($r >> 16) & 0xFF]] & "\x20\x20\x20\x20\x20\x20\x20\x00") |
+                   (self::$shuffle[$pc1map[($r >> 24) & 0xFF]] & "\x10\x10\x10\x10\x10\x10\x10\x00") |
+                   (self::$shuffle[$pc1map[ $l        & 0xFF]] & "\x08\x08\x08\x08\x08\x08\x08\x00") |
+                   (self::$shuffle[$pc1map[($l >>  8) & 0xFF]] & "\x04\x04\x04\x04\x04\x04\x04\x00") |
+                   (self::$shuffle[$pc1map[($l >> 16) & 0xFF]] & "\x02\x02\x02\x02\x02\x02\x02\x00") |
+                   (self::$shuffle[$pc1map[($l >> 24) & 0xFF]] & "\x01\x01\x01\x01\x01\x01\x01\x00");
+            $key = unpack('Nc/Nd', $key);
+            $c = ( $key['c'] >> 4) & 0x0FFFFFFF;
+            $d = (($key['d'] >> 4) & 0x0FFFFFF0) | ($key['c'] & 0x0F);
+
+            $keys[$des_round] = [
+                self::ENCRYPT => [],
+                self::DECRYPT => array_fill(0, 32, 0)
+            ];
+            for ($i = 0, $ki = 31; $i < 16; ++$i, $ki -= 2) {
+                $c <<= $shifts[$i];
+                $c = ($c | ($c >> 28)) & 0x0FFFFFFF;
+                $d <<= $shifts[$i];
+                $d = ($d | ($d >> 28)) & 0x0FFFFFFF;
+
+                // Perform the PC-2 transformation.
+                $cp = $pc2mapc1[ $c >> 24        ] | $pc2mapc2[($c >> 16) & 0xFF] |
+                      $pc2mapc3[($c >>  8) & 0xFF] | $pc2mapc4[ $c        & 0xFF];
+                $dp = $pc2mapd1[ $d >> 24        ] | $pc2mapd2[($d >> 16) & 0xFF] |
+                      $pc2mapd3[($d >>  8) & 0xFF] | $pc2mapd4[ $d        & 0xFF];
+
+                // Reorder: odd bytes/even bytes. Push the result in key schedule.
+                $val1 = ( $cp        & intval(0xFF000000)) | (($cp <<  8) & 0x00FF0000) |
+                        (($dp >> 16) & 0x0000FF00) | (($dp >>  8) & 0x000000FF);
+                $val2 = (($cp <<  8) & intval(0xFF000000)) | (($cp << 16) & 0x00FF0000) |
+                        (($dp >>  8) & 0x0000FF00) | ( $dp        & 0x000000FF);
+                $keys[$des_round][self::ENCRYPT][       ] = $val1;
+                $keys[$des_round][self::DECRYPT][$ki - 1] = $val1;
+                $keys[$des_round][self::ENCRYPT][       ] = $val2;
+                $keys[$des_round][self::DECRYPT][$ki    ] = $val2;
+            }
+        }
+
+        switch ($this->des_rounds) {
+            case 3: // 3DES keys
+                $this->keys = [
+                    self::ENCRYPT => array_merge(
+                        $keys[0][self::ENCRYPT],
+                        $keys[1][self::DECRYPT],
+                        $keys[2][self::ENCRYPT]
+                    ),
+                    self::DECRYPT => array_merge(
+                        $keys[2][self::DECRYPT],
+                        $keys[1][self::ENCRYPT],
+                        $keys[0][self::DECRYPT]
+                    )
+                ];
+                break;
+            // case 1: // DES keys
+            default:
+                $this->keys = [
+                    self::ENCRYPT => $keys[0][self::ENCRYPT],
+                    self::DECRYPT => $keys[0][self::DECRYPT]
+                ];
+        }
+    }
+
+    /**
+     * Setup the performance-optimized function for de/encrypt()
+     *
+     * @see \phpseclib3\Crypt\Common\SymmetricKey::setupInlineCrypt()
+     */
+    protected function setupInlineCrypt()
+    {
+        // Engine configuration for:
+        // -  DES ($des_rounds == 1) or
+        // - 3DES ($des_rounds == 3)
+        $des_rounds = $this->des_rounds;
+
+        $init_crypt = 'static $sbox1, $sbox2, $sbox3, $sbox4, $sbox5, $sbox6, $sbox7, $sbox8, $shuffleip, $shuffleinvip;
+            if (!$sbox1) {
+                $sbox1 = array_map("intval", self::$sbox1);
+                $sbox2 = array_map("intval", self::$sbox2);
+                $sbox3 = array_map("intval", self::$sbox3);
+                $sbox4 = array_map("intval", self::$sbox4);
+                $sbox5 = array_map("intval", self::$sbox5);
+                $sbox6 = array_map("intval", self::$sbox6);
+                $sbox7 = array_map("intval", self::$sbox7);
+                $sbox8 = array_map("intval", self::$sbox8);'
+                /* Merge $shuffle with $[inv]ipmap */ . '
+                for ($i = 0; $i < 256; ++$i) {
+                    $shuffleip[]    =  self::$shuffle[self::$ipmap[$i]];
+                    $shuffleinvip[] =  self::$shuffle[self::$invipmap[$i]];
+                }
+            }
+        ';
+
+        $k = [
+            self::ENCRYPT => $this->keys[self::ENCRYPT],
+            self::DECRYPT => $this->keys[self::DECRYPT]
+        ];
+        $init_encrypt = '';
+        $init_decrypt = '';
+
+        // Creating code for en- and decryption.
+        $crypt_block = [];
+        foreach ([self::ENCRYPT, self::DECRYPT] as $c) {
+            /* Do the initial IP permutation. */
+            $crypt_block[$c] = '
+                $in = unpack("N*", $in);
+                $l  = $in[1];
+                $r  = $in[2];
+                $in = unpack("N*",
+                    ($shuffleip[ $r        & 0xFF] & "\x80\x80\x80\x80\x80\x80\x80\x80") |
+                    ($shuffleip[($r >>  8) & 0xFF] & "\x40\x40\x40\x40\x40\x40\x40\x40") |
+                    ($shuffleip[($r >> 16) & 0xFF] & "\x20\x20\x20\x20\x20\x20\x20\x20") |
+                    ($shuffleip[($r >> 24) & 0xFF] & "\x10\x10\x10\x10\x10\x10\x10\x10") |
+                    ($shuffleip[ $l        & 0xFF] & "\x08\x08\x08\x08\x08\x08\x08\x08") |
+                    ($shuffleip[($l >>  8) & 0xFF] & "\x04\x04\x04\x04\x04\x04\x04\x04") |
+                    ($shuffleip[($l >> 16) & 0xFF] & "\x02\x02\x02\x02\x02\x02\x02\x02") |
+                    ($shuffleip[($l >> 24) & 0xFF] & "\x01\x01\x01\x01\x01\x01\x01\x01")
+                );
+                ' . /* Extract L0 and R0 */ '
+                $l = $in[1];
+                $r = $in[2];
+            ';
+
+            $l = '$l';
+            $r = '$r';
+
+            // Perform DES or 3DES.
+            for ($ki = -1, $des_round = 0; $des_round < $des_rounds; ++$des_round) {
+                // Perform the 16 steps.
+                for ($i = 0; $i < 16; ++$i) {
+                    // start of "the Feistel (F) function" - see the following URL:
+                    // http://en.wikipedia.org/wiki/Image:Data_Encryption_Standard_InfoBox_Diagram.png
+                    // Merge key schedule.
+                    $crypt_block[$c] .= '
+                        $b1 = ((' . $r . ' >>  3) & 0x1FFFFFFF)  ^ (' . $r . ' << 29) ^ ' . $k[$c][++$ki] . ';
+                        $b2 = ((' . $r . ' >> 31) & 0x00000001)  ^ (' . $r . ' <<  1) ^ ' . $k[$c][++$ki] . ';' .
+                        /* S-box indexing. */
+                        $l . ' = $sbox1[($b1 >> 24) & 0x3F] ^ $sbox2[($b2 >> 24) & 0x3F] ^
+                                 $sbox3[($b1 >> 16) & 0x3F] ^ $sbox4[($b2 >> 16) & 0x3F] ^
+                                 $sbox5[($b1 >>  8) & 0x3F] ^ $sbox6[($b2 >>  8) & 0x3F] ^
+                                 $sbox7[ $b1        & 0x3F] ^ $sbox8[ $b2        & 0x3F] ^ ' . $l . ';
+                    ';
+                    // end of "the Feistel (F) function"
+
+                    // swap L & R
+                    list($l, $r) = [$r, $l];
+                }
+                list($l, $r) = [$r, $l];
+            }
+
+            // Perform the inverse IP permutation.
+            $crypt_block[$c] .= '$in =
+                ($shuffleinvip[($l >> 24) & 0xFF] & "\x80\x80\x80\x80\x80\x80\x80\x80") |
+                ($shuffleinvip[($r >> 24) & 0xFF] & "\x40\x40\x40\x40\x40\x40\x40\x40") |
+                ($shuffleinvip[($l >> 16) & 0xFF] & "\x20\x20\x20\x20\x20\x20\x20\x20") |
+                ($shuffleinvip[($r >> 16) & 0xFF] & "\x10\x10\x10\x10\x10\x10\x10\x10") |
+                ($shuffleinvip[($l >>  8) & 0xFF] & "\x08\x08\x08\x08\x08\x08\x08\x08") |
+                ($shuffleinvip[($r >>  8) & 0xFF] & "\x04\x04\x04\x04\x04\x04\x04\x04") |
+                ($shuffleinvip[ $l        & 0xFF] & "\x02\x02\x02\x02\x02\x02\x02\x02") |
+                ($shuffleinvip[ $r        & 0xFF] & "\x01\x01\x01\x01\x01\x01\x01\x01");
+            ';
+        }
+
+        // Creates the inline-crypt function
+        $this->inline_crypt = $this->createInlineCryptFunction(
+            [
+               'init_crypt'    => $init_crypt,
+               'init_encrypt'  => $init_encrypt,
+               'init_decrypt'  => $init_decrypt,
+               'encrypt_block' => $crypt_block[self::ENCRYPT],
+               'decrypt_block' => $crypt_block[self::DECRYPT]
+            ]
+        );
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DH.php ---
@@ -0,0 +1,405 @@
+<?php
+
+/**
+ * Pure-PHP (EC)DH implementation
+ *
+ * PHP version 5
+ *
+ * Here's an example of how to compute a shared secret with this library:
+ * <code>
+ * <?php
+ * include 'vendor/autoload.php';
+ *
+ * $ourPrivate = \phpseclib3\Crypt\DH::createKey();
+ * $secret = DH::computeSecret($ourPrivate, $theirPublic);
+ *
+ * ?>
+ * </code>
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2016 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt;
+
+use phpseclib3\Crypt\Common\AsymmetricKey;
+use phpseclib3\Crypt\DH\Parameters;
+use phpseclib3\Crypt\DH\PrivateKey;
+use phpseclib3\Crypt\DH\PublicKey;
+use phpseclib3\Exception\NoKeyLoadedException;
+use phpseclib3\Exception\UnsupportedOperationException;
+use phpseclib3\Math\BigInteger;
+
+/**
+ * Pure-PHP (EC)DH implementation
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class DH extends AsymmetricKey
+{
+    /**
+     * Algorithm Name
+     *
+     * @var string
+     */
+    const ALGORITHM = 'DH';
+
+    /**
+     * DH prime
+     *
+     * @var \phpseclib3\Math\BigInteger
+     */
+    protected $prime;
+
+    /**
+     * DH Base
+     *
+     * Prime divisor of p-1
+     *
+     * @var \phpseclib3\Math\BigInteger
+     */
+    protected $base;
+
+    /**
+     * Public Key
+     *
+     * @var \phpseclib3\Math\BigInteger
+     */
+    protected $publicKey;
+
+    /**
+     * Create DH parameters
+     *
+     * This method is a bit polymorphic. It can take any of the following:
+     *  - two BigInteger's (prime and base)
+     *  - an integer representing the size of the prime in bits (the base is assumed to be 2)
+     *  - a string (eg. diffie-hellman-group14-sha1)
+     *
+     * @return Parameters
+     */
+    public static function createParameters(...$args)
+    {
+        $class = new \ReflectionClass(static::class);
+        if ($class->isFinal()) {
+            throw new \RuntimeException('createParameters() should not be called from final classes (' . static::class . ')');
+        }
+
+        $params = new Parameters();
+        if (count($args) == 2 && $args[0] instanceof BigInteger && $args[1] instanceof BigInteger) {
+            //if (!$args[0]->isPrime()) {
+            //    throw new \InvalidArgumentException('The first parameter should be a prime number');
+            //}
+            $params->prime = $args[0];
+            $params->base = $args[1];
+            return $params;
+        } elseif (count($args) == 1 && is_numeric($args[0])) {
+            $params->prime = BigInteger::randomPrime($args[0]);
+            $params->base = new BigInteger(2);
+            return $params;
+        } elseif (count($args) != 1 || !is_string($args[0])) {
+            throw new \InvalidArgumentException('Valid parameters are either: two BigInteger\'s (prime and base), a single integer (the length of the prime; base is assumed to be 2) or a string');
+        }
+        switch ($args[0]) {
+            // see http://tools.ietf.org/html/rfc2409#section-6.2 and
+            // http://tools.ietf.org/html/rfc2412, appendex E
+            case 'diffie-hellman-group1-sha1':
+                $prime = 'FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74' .
+                         '020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F1437' .
+                         '4FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED' .
+                         'EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE65381FFFFFFFFFFFFFFFF';
+                break;
+            // see http://tools.ietf.org/html/rfc3526#section-3
+            case 'diffie-hellman-group14-sha1': // 2048-bit MODP Group
+            case 'diffie-hellman-group14-sha256':
+                $prime = 'FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74' .
+                         '020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F1437' .
+                         '4FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED' .
+                         'EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF05' .
+                         '98DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB' .
+                         '9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3B' .
+                         'E39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF695581718' .
+                         '3995497CEA956AE515D2261898FA051015728E5A8AACAA68FFFFFFFFFFFFFFFF';
+                break;
+            // see https://tools.ietf.org/html/rfc3526#section-4
+            case 'diffie-hellman-group15-sha512': // 3072-bit MODP Group
+                $prime = 'FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74' .
+                         '020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F1437' .
+                         '4FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED' .
+                         'EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF05' .
+                         '98DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB' .
+                         '9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3B' .
+                         'E39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF695581718' .
+                         '3995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33' .
+                         'A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7' .
+                         'ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864' .
+                         'D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E2' .
+                         '08E24FA074E5AB3143DB5BFCE0FD108E4B82D120A93AD2CAFFFFFFFFFFFFFFFF';
+                break;
+            // see https://tools.ietf.org/html/rfc3526#section-5
+            case 'diffie-hellman-group16-sha512': // 4096-bit MODP Group
+                $prime = 'FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74' .
+                         '020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F1437' .
+                         '4FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED' .
+                         'EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF05' .
+                         '98DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB' .
+                         '9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3B' .
+                         'E39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF695581718' .
+                         '3995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33' .
+                         'A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7' .
+                         'ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864' .
+                         'D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E2' .
+                         '08E24FA074E5AB3143DB5BFCE0FD108E4B82D120A92108011A723C12A787E6D7' .
+                         '88719A10BDBA5B2699C327186AF4E23C1A946834B6150BDA2583E9CA2AD44CE8' .
+                         'DBBBC2DB04DE8EF92E8EFC141FBECAA6287C59474E6BC05D99B2964FA090C3A2' .
+                         '233BA186515BE7ED1F612970CEE2D7AFB81BDD762170481CD0069127D5B05AA9' .
+                         '93B4EA988D8FDDC186FFB7DC90A6C08F4DF435C934063199FFFFFFFFFFFFFFFF';
+                break;
+            // see https://tools.ietf.org/html/rfc3526#section-6
+            case 'diffie-hellman-group17-sha512': // 6144-bit MODP Group
+                $prime = 'FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74' .
+                         '020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F1437' .
+                         '4FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED' .
+                         'EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF05' .
+                         '98DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB' .
+                         '9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3B' .
+                         'E39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF695581718' .
+                         '3995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33' .
+                         'A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7' .
+                         'ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864' .
+                         'D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E2' .
+                         '08E24FA074E5AB3143DB5BFCE0FD108E4B82D120A92108011A723C12A787E6D7' .
+                         '88719A10BDBA5B2699C327186AF4E23C1A946834B6150BDA2583E9CA2AD44CE8' .
+                         'DBBBC2DB04DE8EF92E8EFC141FBECAA6287C59474E6BC05D99B2964FA090C3A2' .
+                         '233BA186515BE7ED1F612970CEE2D7AFB81BDD762170481CD0069127D5B05AA9' .
+                         '93B4EA988D8FDDC186FFB7DC90A6C08F4DF435C93402849236C3FAB4D27C7026' .
+                         'C1D4DCB2602646DEC9751E763DBA37BDF8FF9406AD9E530EE5DB382F413001AE' .
+                         'B06A53ED9027D831179727B0865A8918DA3EDBEBCF9B14ED44CE6CBACED4BB1B' .
+                         'DB7F1447E6CC254B332051512BD7AF426FB8F401378CD2BF5983CA01C64B92EC' .
+                         'F032EA15D1721D03F482D7CE6E74FEF6D55E702F46980C82B5A84031900B1C9E' .
+                         '59E7C97FBEC7E8F323A97A7E36CC88BE0F1D45B7FF585AC54BD407B22B4154AA' .
+                         'CC8F6D7EBF48E1D814CC5ED20F8037E0A79715EEF29BE32806A1D58BB7C5DA76' .
+                         'F550AA3D8A1FBFF0EB19CCB1A313D55CDA56C9EC2EF29632387FE8D76E3C0468' .
+                         '043E8F663F4860EE12BF2D5B0B7474D6E694F91E6DCC4024FFFFFFFFFFFFFFFF';
+                break;
+            // see https://tools.ietf.org/html/rfc3526#section-7
+            case 'diffie-hellman-group18-sha512': // 8192-bit MODP Group
+                $prime = 'FFFFFFFFFFFFFFFFC90FDAA22168C234C4C6628B80DC1CD129024E088A67CC74' .
+                         '020BBEA63B139B22514A08798E3404DDEF9519B3CD3A431B302B0A6DF25F1437' .
+                         '4FE1356D6D51C245E485B576625E7EC6F44C42E9A637ED6B0BFF5CB6F406B7ED' .
+                         'EE386BFB5A899FA5AE9F24117C4B1FE649286651ECE45B3DC2007CB8A163BF05' .
+                         '98DA48361C55D39A69163FA8FD24CF5F83655D23DCA3AD961C62F356208552BB' .
+                         '9ED529077096966D670C354E4ABC9804F1746C08CA18217C32905E462E36CE3B' .
+                         'E39E772C180E86039B2783A2EC07A28FB5C55DF06F4C52C9DE2BCBF695581718' .
+                         '3995497CEA956AE515D2261898FA051015728E5A8AAAC42DAD33170D04507A33' .
+                         'A85521ABDF1CBA64ECFB850458DBEF0A8AEA71575D060C7DB3970F85A6E1E4C7' .
+                         'ABF5AE8CDB0933D71E8C94E04A25619DCEE3D2261AD2EE6BF12FFA06D98A0864' .
+                         'D87602733EC86A64521F2B18177B200CBBE117577A615D6C770988C0BAD946E2' .
+                         '08E24FA074E5AB3143DB5BFCE0FD108E4B82D120A92108011A723C12A787E6D7' .
+                         '88719A10BDBA5B2699C327186AF4E23C1A946834B6150BDA2583E9CA2AD44CE8' .
+                         'DBBBC2DB04DE8EF92E8EFC141FBECAA6287C59474E6BC05D99B2964FA090C3A2' .
+                         '233BA186515BE7ED1F612970CEE2D7AFB81BDD762170481CD0069127D5B05AA9' .
+                         '93B4EA988D8FDDC186FFB7DC90A6C08F4DF435C93402849236C3FAB4D27C7026' .
+                         'C1D4DCB2602646DEC9751E763DBA37BDF8FF9406AD9E530EE5DB382F413001AE' .
+                         'B06A53ED9027D831179727B0865A8918DA3EDBEBCF9B14ED44CE6CBACED4BB1B' .
+                         'DB7F1447E6CC254B332051512BD7AF426FB8F401378CD2BF5983CA01C64B92EC' .
+                         'F032EA15D1721D03F482D7CE6E74FEF6D55E702F46980C82B5A84031900B1C9E' .
+                         '59E7C97FBEC7E8F323A97A7E36CC88BE0F1D45B7FF585AC54BD407B22B4154AA' .
+                         'CC8F6D7EBF48E1D814CC5ED20F8037E0A79715EEF29BE32806A1D58BB7C5DA76' .
+                         'F550AA3D8A1FBFF0EB19CCB1A313D55CDA56C9EC2EF29632387FE8D76E3C0468' .
+                         '043E8F663F4860EE12BF2D5B0B7474D6E694F91E6DBE115974A3926F12FEE5E4' .
+                         '38777CB6A932DF8CD8BEC4D073B931BA3BC832B68D9DD300741FA7BF8AFC47ED' .
+                         '2576F6936BA424663AAB639C5AE4F5683423B4742BF1C978238F16CBE39D652D' .
+                         'E3FDB8BEFC848AD922222E04A4037C0713EB57A81A23F0C73473FC646CEA306B' .
+                         '4BCBC8862F8385DDFA9D4B7FA2C087E879683303ED5BDD3A062B3CF5B3A278A6' .
+                         '6D2A13F83F44F82DDF310EE074AB6A364597E899A0255DC164F31CC50846851D' .
+                         'F9AB48195DED7EA1B1D510BD7EE74D73FAF36BC31ECFA268359046F4EB879F92' .
+                         '4009438B481C6CD7889A002ED5EE382BC9190DA6FC026E479558E4475677E9AA' .
+                         '9E3050E2765694DFC81F56E880B96E7160C980DD98EDD3DFFFFFFFFFFFFFFFFF';
+                break;
+            default:
+                throw new \InvalidArgumentException('Invalid named prime provided');
+        }
+
+        $params->prime = new BigInteger($prime, 16);
+        $params->base = new BigInteger(2);
+
+        return $params;
+    }
+
+    /**
+     * Create public / private key pair.
+     *
+     * The rationale for the second parameter is described in http://tools.ietf.org/html/rfc4419#section-6.2 :
+     *
+     * "To increase the speed of the key exchange, both client and server may
+     *  reduce the size of their private exponents.  It should be at least
+     *  twice as long as the key material that is generated from the shared
+     *  secret.  For more details, see the paper by van Oorschot and Wiener
+     *  [VAN-OORSCHOT]."
+     *
+     * $length is in bits
+     *
+     * @param Parameters $params
+     * @param int $length optional
+     * @return DH\PrivateKey
+     */
+    public static function createKey(Parameters $params, $length = 0)
+    {
+        $class = new \ReflectionClass(static::class);
+        if ($class->isFinal()) {
+            throw new \RuntimeException('createKey() should not be called from final classes (' . static::class . ')');
+        }
+
+        $one = new BigInteger(1);
+        if ($length) {
+            $max = $one->bitwise_leftShift($length);
+            $max = $max->subtract($one);
+        } else {
+            $max = $params->prime->subtract($one);
+        }
+
+        $key = new PrivateKey();
+        $key->prime = $params->prime;
+        $key->base = $params->base;
+        $key->privateKey = BigInteger::randomRange($one, $max);
+        $key->publicKey = $key->base->powMod($key->privateKey, $key->prime);
+        return $key;
+    }
+
+    /**
+     * Compute Shared Secret
+     *
+     * @param PrivateKey|EC $private
+     * @param PublicKey|BigInteger|string $public
+     * @return mixed
+     */
+    public static function computeSecret($private, $public)
+    {
+        if ($private instanceof PrivateKey) { // DH\PrivateKey
+            switch (true) {
+                case $public instanceof PublicKey:
+                    if (!$private->prime->equals($public->prime) || !$private->base->equals($public->base)) {
+                        throw new \InvalidArgumentException('The public and private key do not share the same prime and / or base numbers');
+                    }
+                    return $public->publicKey->powMod($private->privateKey, $private->prime)->toBytes(true);
+                case is_string($public):
+                    $public = new BigInteger($public, -256);
+                    // fall-through
+                case $public instanceof BigInteger:
+                    return $public->powMod($private->privateKey, $private->prime)->toBytes(true);
+                default:
+                    throw new \InvalidArgumentException('$public needs to be an instance of DH\PublicKey, a BigInteger or a string');
+            }
+        }
+
+        if ($private instanceof EC\PrivateKey) {
+            switch (true) {
+                case $public instanceof EC\PublicKey:
+                    $public = $public->getEncodedCoordinates();
+                    // fall-through
+                case is_string($public):
+                    $point = $private->multiply($public);
+                    switch ($private->getCurve()) {
+                        case 'Curve25519':
+                        case 'Curve448':
+                            $secret = $point;
+                            break;
+                        default:
+                            // according to https://www.secg.org/sec1-v2.pdf#page=33 only X is returned
+                            $secret = substr($point, 1, (strlen($point) - 1) >> 1);
+                    }
+                    /*
+                    if (($secret[0] & "\x80") === "\x80") {
+                        $secret = "\0$secret";
+                    }
+                    */
+                    return $secret;
+                default:
+                    throw new \InvalidArgumentException('$public needs to be an instance of EC\PublicKey or a string (an encoded coordinate)');
+            }
+        }
+    }
+
+    /**
+     * Load the key
+     *
+     * @param string $key
+     * @param string $password optional
+     * @return AsymmetricKey
+     */
+    public static function load($key, $password = false)
+    {
+        try {
+            return EC::load($key, $password);
+        } catch (NoKeyLoadedException $e) {
+        }
+
+        return parent::load($key, $password);
+    }
+
+    /**
+     * OnLoad Handler
+     *
+     * @return bool
+     */
+    protected static function onLoad(array $components)
+    {
+        if (!isset($components['privateKey']) && !isset($components['publicKey'])) {
+            $new = new Parameters();
+        } else {
+            $new = isset($components['privateKey']) ?
+                new PrivateKey() :
+                new PublicKey();
+        }
+
+        $new->prime = $components['prime'];
+        $new->base = $components['base'];
+
+        if (isset($components['privateKey'])) {
+            $new->privateKey = $components['privateKey'];
+        }
+        if (isset($components['publicKey'])) {
+            $new->publicKey = $components['publicKey'];
+        }
+
+        return $new;
+    }
+
+    /**
+     * Determines which hashing function should be used
+     *
+     * @param string $hash
+     */
+    public function withHash($hash)
+    {
+        throw new UnsupportedOperationException('DH does not use a hash algorithm');
+    }
+
+    /**
+     * Returns the hash algorithm currently being used
+     *
+     */
+    public function getHash()
+    {
+        throw new UnsupportedOperationException('DH does not use a hash algorithm');
+    }
+
+    /**
+     * Returns the parameters
+     *
+     * A public / private key is only returned if the currently loaded "key" contains an x or y
+     * value.
+     *
+     * @see self::getPublicKey()
+     * @return mixed
+     */
+    public function getParameters()
+    {
+        $type = DH::validatePlugin('Keys', 'PKCS1', 'saveParameters');
+
+        $key = $type::saveParameters($this->prime, $this->base);
+        return DH::load($key, 'PKCS1');
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DH/Formats/Keys/PKCS1.php ---
@@ -0,0 +1,77 @@
+<?php
+
+/**
+ * "PKCS1" Formatted EC Key Handler
+ *
+ * PHP version 5
+ *
+ * Processes keys with the following headers:
+ *
+ * -----BEGIN DH PARAMETERS-----
+ *
+ * Technically, PKCS1 is for RSA keys, only, but we're using PKCS1 to describe
+ * DSA, whose format isn't really formally described anywhere, so might as well
+ * use it to describe this, too.
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DH\Formats\Keys;
+
+use phpseclib3\Crypt\Common\Formats\Keys\PKCS1 as Progenitor;
+use phpseclib3\File\ASN1;
+use phpseclib3\File\ASN1\Maps;
+use phpseclib3\Math\BigInteger;
+
+/**
+ * "PKCS1" Formatted DH Key Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class PKCS1 extends Progenitor
+{
+    /**
+     * Break a public or private key down into its constituent components
+     *
+     * @param string $key
+     * @param string $password optional
+     * @return array
+     */
+    public static function load($key, $password = '')
+    {
+        $key = parent::load($key, $password);
+
+        $decoded = ASN1::decodeBER($key);
+        if (!$decoded) {
+            throw new \RuntimeException('Unable to decode BER');
+        }
+
+        $components = ASN1::asn1map($decoded[0], Maps\DHParameter::MAP);
+        if (!is_array($components)) {
+            throw new \RuntimeException('Unable to perform ASN1 mapping on parameters');
+        }
+
+        return $components;
+    }
+
+    /**
+     * Convert EC parameters to the appropriate format
+     *
+     * @return string
+     */
+    public static function saveParameters(BigInteger $prime, BigInteger $base, array $options = [])
+    {
+        $params = [
+            'prime' => $prime,
+            'base' => $base
+        ];
+        $params = ASN1::encodeDER($params, Maps\DHParameter::MAP);
+
+        return "-----BEGIN DH PARAMETERS-----\r\n" .
+               chunk_split(base64_encode($params), 64) .
+               "-----END DH PARAMETERS-----\r\n";
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DH/Formats/Keys/PKCS8.php ---
@@ -0,0 +1,132 @@
+<?php
+
+/**
+ * PKCS#8 Formatted DH Key Handler
+ *
+ * PHP version 5
+ *
+ * Processes keys with the following headers:
+ *
+ * -----BEGIN ENCRYPTED PRIVATE KEY-----
+ * -----BEGIN PRIVATE KEY-----
+ * -----BEGIN PUBLIC KEY-----
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DH\Formats\Keys;
+
+use phpseclib3\Crypt\Common\Formats\Keys\PKCS8 as Progenitor;
+use phpseclib3\File\ASN1;
+use phpseclib3\File\ASN1\Maps;
+use phpseclib3\Math\BigInteger;
+
+/**
+ * PKCS#8 Formatted DH Key Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class PKCS8 extends Progenitor
+{
+    /**
+     * OID Name
+     *
+     * @var string
+     */
+    const OID_NAME = 'dhKeyAgreement';
+
+    /**
+     * OID Value
+     *
+     * @var string
+     */
+    const OID_VALUE = '1.2.840.113549.1.3.1';
+
+    /**
+     * Child OIDs loaded
+     *
+     * @var bool
+     */
+    protected static $childOIDsLoaded = false;
+
+    /**
+     * Break a public or private key down into its constituent components
+     *
+     * @param string $key
+     * @param string $password optional
+     * @return array
+     */
+    public static function load($key, $password = '')
+    {
+        $key = parent::load($key, $password);
+
+        $type = isset($key['privateKey']) ? 'privateKey' : 'publicKey';
+
+        $decoded = ASN1::decodeBER($key[$type . 'Algorithm']['parameters']->element);
+        if (empty($decoded)) {
+            throw new \RuntimeException('Unable to decode BER of parameters');
+        }
+        $components = ASN1::asn1map($decoded[0], Maps\DHParameter::MAP);
+        if (!is_array($components)) {
+            throw new \RuntimeException('Unable to perform ASN1 mapping on parameters');
+        }
+
+        $decoded = ASN1::decodeBER($key[$type]);
+        switch (true) {
+            case !isset($decoded):
+            case !isset($decoded[0]['content']):
+            case !$decoded[0]['content'] instanceof BigInteger:
+                throw new \RuntimeException('Unable to decode BER of parameters');
+        }
+        $components[$type] = $decoded[0]['content'];
+
+        return $components;
+    }
+
+    /**
+     * Convert a private key to the appropriate format.
+     *
+     * @param \phpseclib3\Math\BigInteger $prime
+     * @param \phpseclib3\Math\BigInteger $base
+     * @param \phpseclib3\Math\BigInteger $privateKey
+     * @param \phpseclib3\Math\BigInteger $publicKey
+     * @param string $password optional
+     * @param array $options optional
+     * @return string
+     */
+    public static function savePrivateKey(BigInteger $prime, BigInteger $base, BigInteger $privateKey, BigInteger $publicKey, $password = '', array $options = [])
+    {
+        $params = [
+            'prime' => $prime,
+            'base' => $base
+        ];
+        $params = ASN1::encodeDER($params, Maps\DHParameter::MAP);
+        $params = new ASN1\Element($params);
+        $key = ASN1::encodeDER($privateKey, ['type' => ASN1::TYPE_INTEGER]);
+        return self::wrapPrivateKey($key, [], $params, $password, null, '', $options);
+    }
+
+    /**
+     * Convert a public key to the appropriate format
+     *
+     * @param \phpseclib3\Math\BigInteger $prime
+     * @param \phpseclib3\Math\BigInteger $base
+     * @param \phpseclib3\Math\BigInteger $publicKey
+     * @param array $options optional
+     * @return string
+     */
+    public static function savePublicKey(BigInteger $prime, BigInteger $base, BigInteger $publicKey, array $options = [])
+    {
+        $params = [
+            'prime' => $prime,
+            'base' => $base
+        ];
+        $params = ASN1::encodeDER($params, Maps\DHParameter::MAP);
+        $params = new ASN1\Element($params);
+        $key = ASN1::encodeDER($publicKey, ['type' => ASN1::TYPE_INTEGER]);
+        return self::wrapPublicKey($key, $params);
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DH/Parameters.php ---
@@ -0,0 +1,36 @@
+<?php
+
+/**
+ * DH Parameters
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DH;
+
+use phpseclib3\Crypt\DH;
+
+/**
+ * DH Parameters
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+final class Parameters extends DH
+{
+    /**
+     * Returns the parameters
+     *
+     * @param string $type
+     * @param array $options optional
+     * @return string
+     */
+    public function toString($type = 'PKCS1', array $options = [])
+    {
+        $type = self::validatePlugin('Keys', 'PKCS1', 'saveParameters');
+
+        return $type::saveParameters($this->prime, $this->base, $options);
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DH/PrivateKey.php ---
@@ -0,0 +1,75 @@
+<?php
+
+/**
+ * DH Private Key
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DH;
+
+use phpseclib3\Crypt\Common;
+use phpseclib3\Crypt\DH;
+
+/**
+ * DH Private Key
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+final class PrivateKey extends DH
+{
+    use Common\Traits\PasswordProtected;
+
+    /**
+     * Private Key
+     *
+     * @var \phpseclib3\Math\BigInteger
+     */
+    protected $privateKey;
+
+    /**
+     * Public Key
+     *
+     * @var \phpseclib3\Math\BigInteger
+     */
+    protected $publicKey;
+
+    /**
+     * Returns the public key
+     *
+     * @return DH\PublicKey
+     */
+    public function getPublicKey()
+    {
+        $type = self::validatePlugin('Keys', 'PKCS8', 'savePublicKey');
+
+        if (!isset($this->publicKey)) {
+            $this->publicKey = $this->base->powMod($this->privateKey, $this->prime);
+        }
+
+        $key = $type::savePublicKey($this->prime, $this->base, $this->publicKey);
+
+        return DH::loadFormat('PKCS8', $key);
+    }
+
+    /**
+     * Returns the private key
+     *
+     * @param string $type
+     * @param array $options optional
+     * @return string
+     */
+    public function toString($type, array $options = [])
+    {
+        $type = self::validatePlugin('Keys', $type, 'savePrivateKey');
+
+        if (!isset($this->publicKey)) {
+            $this->publicKey = $this->base->powMod($this->privateKey, $this->prime);
+        }
+
+        return $type::savePrivateKey($this->prime, $this->base, $this->privateKey, $this->publicKey, $this->password, $options);
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DH/PublicKey.php ---
@@ -0,0 +1,49 @@
+<?php
+
+/**
+ * DH Public Key
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DH;
+
+use phpseclib3\Crypt\Common;
+use phpseclib3\Crypt\DH;
+
+/**
+ * DH Public Key
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+final class PublicKey extends DH
+{
+    use Common\Traits\Fingerprint;
+
+    /**
+     * Returns the public key
+     *
+     * @param string $type
+     * @param array $options optional
+     * @return string
+     */
+    public function toString($type, array $options = [])
+    {
+        $type = self::validatePlugin('Keys', $type, 'savePublicKey');
+
+        return $type::savePublicKey($this->prime, $this->base, $this->publicKey, $options);
+    }
+
+    /**
+     * Returns the public key as a BigInteger
+     *
+     * @return \phpseclib3\Math\BigInteger
+     */
+    public function toBigInteger()
+    {
+        return $this->publicKey;
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DSA.php ---
@@ -0,0 +1,337 @@
+<?php
+
+/**
+ * Pure-PHP FIPS 186-4 compliant implementation of DSA.
+ *
+ * PHP version 5
+ *
+ * Here's an example of how to create signatures and verify signatures with this library:
+ * <code>
+ * <?php
+ * include 'vendor/autoload.php';
+ *
+ * $private = \phpseclib3\Crypt\DSA::createKey();
+ * $public = $private->getPublicKey();
+ *
+ * $plaintext = 'terrafrost';
+ *
+ * $signature = $private->sign($plaintext);
+ *
+ * echo $public->verify($plaintext, $signature) ? 'verified' : 'unverified';
+ * ?>
+ * </code>
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2016 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt;
+
+use phpseclib3\Crypt\Common\AsymmetricKey;
+use phpseclib3\Crypt\DSA\Parameters;
+use phpseclib3\Crypt\DSA\PrivateKey;
+use phpseclib3\Crypt\DSA\PublicKey;
+use phpseclib3\Exception\InsufficientSetupException;
+use phpseclib3\Math\BigInteger;
+
+/**
+ * Pure-PHP FIPS 186-4 compliant implementation of DSA.
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class DSA extends AsymmetricKey
+{
+    /**
+     * Algorithm Name
+     *
+     * @var string
+     */
+    const ALGORITHM = 'DSA';
+
+    /**
+     * DSA Prime P
+     *
+     * @var \phpseclib3\Math\BigInteger
+     */
+    protected $p;
+
+    /**
+     * DSA Group Order q
+     *
+     * Prime divisor of p-1
+     *
+     * @var \phpseclib3\Math\BigInteger
+     */
+    protected $q;
+
+    /**
+     * DSA Group Generator G
+     *
+     * @var \phpseclib3\Math\BigInteger
+     */
+    protected $g;
+
+    /**
+     * DSA public key value y
+     *
+     * @var \phpseclib3\Math\BigInteger
+     */
+    protected $y;
+
+    /**
+     * Signature Format
+     *
+     * @var string
+     */
+    protected $sigFormat;
+
+    /**
+     * Signature Format (Short)
+     *
+     * @var string
+     */
+    protected $shortFormat;
+
+    /**
+     * Create DSA parameters
+     *
+     * @param int $L
+     * @param int $N
+     * @return \phpseclib3\Crypt\DSA|bool
+     */
+    public static function createParameters($L = 2048, $N = 224)
+    {
+        self::initialize_static_variables();
+
+        $class = new \ReflectionClass(static::class);
+        if ($class->isFinal()) {
+            throw new \RuntimeException('createParameters() should not be called from final classes (' . static::class . ')');
+        }
+
+        if (!isset(self::$engines['PHP'])) {
+            self::useBestEngine();
+        }
+
+        switch (true) {
+            case $N == 160:
+            /*
+              in FIPS 186-1 and 186-2 N was fixed at 160 whereas K had an upper bound of 1024.
+              RFC 4253 (SSH Transport Layer Protocol) references FIPS 186-2 and as such most
+              SSH DSA implementations only support keys with an N of 160.
+              puttygen let's you set the size of L (but not the size of N) and uses 2048 as the
+              default L value. that's not really compliant with any of the FIPS standards, however,
+              for the purposes of maintaining compatibility with puttygen, we'll support it
+            */
+            //case ($L >= 512 || $L <= 1024) && (($L & 0x3F) == 0) && $N == 160:
+            // FIPS 186-3 changed this as follows:
+            //case $L == 1024 && $N == 160:
+            case $L == 2048 && $N == 224:
+            case $L == 2048 && $N == 256:
+            case $L == 3072 && $N == 256:
+                break;
+            default:
+                throw new \InvalidArgumentException('Invalid values for N and L');
+        }
+
+        $two = new BigInteger(2);
+
+        $q = BigInteger::randomPrime($N);
+        $divisor = $q->multiply($two);
+
+        do {
+            $x = BigInteger::random($L);
+            list(, $c) = $x->divide($divisor);
+            $p = $x->subtract($c->subtract(self::$one));
+        } while ($p->getLength() != $L || !$p->isPrime());
+
+        $p_1 = $p->subtract(self::$one);
+        list($e) = $p_1->divide($q);
+
+        // quoting http://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.186-4.pdf#page=50 ,
+        // "h could be obtained from a random number generator or from a counter that
+        //  changes after each use". PuTTY (sshdssg.c) starts h off at 1 and increments
+        // it on each loop. wikipedia says "commonly h = 2 is used" so we'll just do that
+        $h = clone $two;
+        while (true) {
+            $g = $h->powMod($e, $p);
+            if (!$g->equals(self::$one)) {
+                break;
+            }
+            $h = $h->add(self::$one);
+        }
+
+        $dsa = new Parameters();
+        $dsa->p = $p;
+        $dsa->q = $q;
+        $dsa->g = $g;
+
+        return $dsa;
+    }
+
+    /**
+     * Create public / private key pair.
+     *
+     * This method is a bit polymorphic. It can take a DSA/Parameters object, L / N as two distinct parameters or
+     * no parameters (at which point L and N will be generated with this method)
+     *
+     * Returns the private key, from which the publickey can be extracted
+     *
+     * @param int[] ...$args
+     * @return DSA\PrivateKey
+     */
+    public static function createKey(...$args)
+    {
+        self::initialize_static_variables();
+
+        $class = new \ReflectionClass(static::class);
+        if ($class->isFinal()) {
+            throw new \RuntimeException('createKey() should not be called from final classes (' . static::class . ')');
+        }
+
+        if (!isset(self::$engines['PHP'])) {
+            self::useBestEngine();
+        }
+
+        if (count($args) == 2 && is_int($args[0]) && is_int($args[1])) {
+            $params = self::createParameters($args[0], $args[1]);
+        } elseif (count($args) == 1 && $args[0] instanceof Parameters) {
+            $params = $args[0];
+        } elseif (!count($args)) {
+            $params = self::createParameters();
+        } else {
+            throw new InsufficientSetupException('Valid parameters are either two integers (L and N), a single DSA object or no parameters at all.');
+        }
+
+        $private = new PrivateKey();
+        $private->p = $params->p;
+        $private->q = $params->q;
+        $private->g = $params->g;
+
+        $private->x = BigInteger::randomRange(self::$one, $private->q->subtract(self::$one));
+        $private->y = $private->g->powMod($private->x, $private->p);
+
+        //$public = clone $private;
+        //unset($public->x);
+
+        return $private
+            ->withHash($params->hash->getHash())
+            ->withSignatureFormat($params->shortFormat);
+    }
+
+    /**
+     * OnLoad Handler
+     *
+     * @return bool
+     */
+    protected static function onLoad(array $components)
+    {
+        if (!isset(self::$engines['PHP'])) {
+            self::useBestEngine();
+        }
+
+        if (!isset($components['x']) && !isset($components['y'])) {
+            $new = new Parameters();
+        } elseif (isset($components['x'])) {
+            $new = new PrivateKey();
+            $new->x = $components['x'];
+        } else {
+            $new = new PublicKey();
+        }
+
+        $new->p = $components['p'];
+        $new->q = $components['q'];
+        $new->g = $components['g'];
+
+        if (isset($components['y'])) {
+            $new->y = $components['y'];
+        }
+
+        return $new;
+    }
+
+    /**
+     * Constructor
+     *
+     * PublicKey and PrivateKey objects can only be created from abstract RSA class
+     */
+    protected function __construct()
+    {
+        $this->sigFormat = self::validatePlugin('Signature', 'ASN1');
+        $this->shortFormat = 'ASN1';
+
+        parent::__construct();
+    }
+
+    /**
+     * Returns the key size
+     *
+     * More specifically, this L (the length of DSA Prime P) and N (the length of DSA Group Order q)
+     *
+     * @return array
+     */
+    public function getLength()
+    {
+        return ['L' => $this->p->getLength(), 'N' => $this->q->getLength()];
+    }
+
+    /**
+     * Returns the current engine being used
+     *
+     * @see self::useInternalEngine()
+     * @see self::useBestEngine()
+     * @return string
+     */
+    public function getEngine()
+    {
+        if (!isset(self::$engines['PHP'])) {
+            self::useBestEngine();
+        }
+        return self::$engines['OpenSSL'] && in_array($this->hash->getHash(), openssl_get_md_methods()) ?
+            'OpenSSL' : 'PHP';
+    }
+
+    /**
+     * Returns the parameters
+     *
+     * A public / private key is only returned if the currently loaded "key" contains an x or y
+     * value.
+     *
+     * @see self::getPublicKey()
+     * @return mixed
+     */
+    public function getParameters()
+    {
+        $type = self::validatePlugin('Keys', 'PKCS1', 'saveParameters');
+
+        $key = $type::saveParameters($this->p, $this->q, $this->g);
+        return DSA::load($key, 'PKCS1')
+            ->withHash($this->hash->getHash())
+            ->withSignatureFormat($this->shortFormat);
+    }
+
+    /**
+     * Determines the signature padding mode
+     *
+     * Valid values are: ASN1, SSH2, Raw
+     *
+     * @param string $format
+     */
+    public function withSignatureFormat($format)
+    {
+        $new = clone $this;
+        $new->shortFormat = $format;
+        $new->sigFormat = self::validatePlugin('Signature', $format);
+        return $new;
+    }
+
+    /**
+     * Returns the signature format currently being used
+     *
+     */
+    public function getSignatureFormat()
+    {
+        return $this->shortFormat;
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DSA/Formats/Keys/OpenSSH.php ---
@@ -0,0 +1,118 @@
+<?php
+
+/**
+ * OpenSSH Formatted DSA Key Handler
+ *
+ * PHP version 5
+ *
+ * Place in $HOME/.ssh/authorized_keys
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DSA\Formats\Keys;
+
+use phpseclib3\Common\Functions\Strings;
+use phpseclib3\Crypt\Common\Formats\Keys\OpenSSH as Progenitor;
+use phpseclib3\Math\BigInteger;
+
+/**
+ * OpenSSH Formatted DSA Key Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class OpenSSH extends Progenitor
+{
+    /**
+     * Supported Key Types
+     *
+     * @var array
+     */
+    protected static $types = ['ssh-dss'];
+
+    /**
+     * Break a public or private key down into its constituent components
+     *
+     * @param string $key
+     * @param string $password optional
+     * @return array
+     */
+    public static function load($key, $password = '')
+    {
+        $parsed = parent::load($key, $password);
+
+        if (isset($parsed['paddedKey'])) {
+            list($type) = Strings::unpackSSH2('s', $parsed['paddedKey']);
+            if ($type != $parsed['type']) {
+                throw new \RuntimeException("The public and private keys are not of the same type ($type vs $parsed[type])");
+            }
+
+            list($p, $q, $g, $y, $x, $comment) = Strings::unpackSSH2('i5s', $parsed['paddedKey']);
+
+            return compact('p', 'q', 'g', 'y', 'x', 'comment');
+        }
+
+        list($p, $q, $g, $y) = Strings::unpackSSH2('iiii', $parsed['publicKey']);
+
+        $comment = $parsed['comment'];
+
+        return compact('p', 'q', 'g', 'y', 'comment');
+    }
+
+    /**
+     * Convert a public key to the appropriate format
+     *
+     * @param \phpseclib3\Math\BigInteger $p
+     * @param \phpseclib3\Math\BigInteger $q
+     * @param \phpseclib3\Math\BigInteger $g
+     * @param \phpseclib3\Math\BigInteger $y
+     * @param array $options optional
+     * @return string
+     */
+    public static function savePublicKey(BigInteger $p, BigInteger $q, BigInteger $g, BigInteger $y, array $options = [])
+    {
+        if ($q->getLength() != 160) {
+            throw new \InvalidArgumentException('SSH only supports keys with an N (length of Group Order q) of 160');
+        }
+
+        // from <http://tools.ietf.org/html/rfc4253#page-15>:
+        // string    "ssh-dss"
+        // mpint     p
+        // mpint     q
+        // mpint     g
+        // mpint     y
+        $DSAPublicKey = Strings::packSSH2('siiii', 'ssh-dss', $p, $q, $g, $y);
+
+        if (isset($options['binary']) ? $options['binary'] : self::$binary) {
+            return $DSAPublicKey;
+        }
+
+        $comment = isset($options['comment']) ? $options['comment'] : self::$comment;
+        $DSAPublicKey = 'ssh-dss ' . base64_encode($DSAPublicKey) . ' ' . $comment;
+
+        return $DSAPublicKey;
+    }
+
+    /**
+     * Convert a private key to the appropriate format.
+     *
+     * @param \phpseclib3\Math\BigInteger $p
+     * @param \phpseclib3\Math\BigInteger $q
+     * @param \phpseclib3\Math\BigInteger $g
+     * @param \phpseclib3\Math\BigInteger $y
+     * @param \phpseclib3\Math\BigInteger $x
+     * @param string $password optional
+     * @param array $options optional
+     * @return string
+     */
+    public static function savePrivateKey(BigInteger $p, BigInteger $q, BigInteger $g, BigInteger $y, BigInteger $x, $password = '', array $options = [])
+    {
+        $publicKey = self::savePublicKey($p, $q, $g, $y, ['binary' => true]);
+        $privateKey = Strings::packSSH2('si5', 'ssh-dss', $p, $q, $g, $y, $x);
+
+        return self::wrapPrivateKey($publicKey, $privateKey, $password, $options);
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DSA/Formats/Keys/PKCS1.php ---
@@ -0,0 +1,143 @@
+<?php
+
+/**
+ * PKCS#1 Formatted DSA Key Handler
+ *
+ * PHP version 5
+ *
+ * Used by File/X509.php
+ *
+ * Processes keys with the following headers:
+ *
+ * -----BEGIN DSA PRIVATE KEY-----
+ * -----BEGIN DSA PUBLIC KEY-----
+ * -----BEGIN DSA PARAMETERS-----
+ *
+ * Analogous to ssh-keygen's pem format (as specified by -m)
+ *
+ * Also, technically, PKCS1 decribes RSA but I am not aware of a formal specification for DSA.
+ * The DSA private key format seems to have been adapted from the RSA private key format so
+ * we're just re-using that as the name.
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DSA\Formats\Keys;
+
+use phpseclib3\Common\Functions\Strings;
+use phpseclib3\Crypt\Common\Formats\Keys\PKCS1 as Progenitor;
+use phpseclib3\File\ASN1;
+use phpseclib3\File\ASN1\Maps;
+use phpseclib3\Math\BigInteger;
+
+/**
+ * PKCS#1 Formatted DSA Key Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class PKCS1 extends Progenitor
+{
+    /**
+     * Break a public or private key down into its constituent components
+     *
+     * @param string $key
+     * @param string $password optional
+     * @return array
+     */
+    public static function load($key, $password = '')
+    {
+        $key = parent::load($key, $password);
+
+        $decoded = ASN1::decodeBER($key);
+        if (!$decoded) {
+            throw new \RuntimeException('Unable to decode BER');
+        }
+
+        $key = ASN1::asn1map($decoded[0], Maps\DSAParams::MAP);
+        if (is_array($key)) {
+            return $key;
+        }
+
+        $key = ASN1::asn1map($decoded[0], Maps\DSAPrivateKey::MAP);
+        if (is_array($key)) {
+            return $key;
+        }
+
+        $key = ASN1::asn1map($decoded[0], Maps\DSAPublicKey::MAP);
+        if (is_array($key)) {
+            return $key;
+        }
+
+        throw new \RuntimeException('Unable to perform ASN1 mapping');
+    }
+
+    /**
+     * Convert DSA parameters to the appropriate format
+     *
+     * @param \phpseclib3\Math\BigInteger $p
+     * @param \phpseclib3\Math\BigInteger $q
+     * @param \phpseclib3\Math\BigInteger $g
+     * @return string
+     */
+    public static function saveParameters(BigInteger $p, BigInteger $q, BigInteger $g)
+    {
+        $key = [
+            'p' => $p,
+            'q' => $q,
+            'g' => $g
+        ];
+
+        $key = ASN1::encodeDER($key, Maps\DSAParams::MAP);
+
+        return "-----BEGIN DSA PARAMETERS-----\r\n" .
+               chunk_split(Strings::base64_encode($key), 64) .
+               "-----END DSA PARAMETERS-----\r\n";
+    }
+
+    /**
+     * Convert a private key to the appropriate format.
+     *
+     * @param \phpseclib3\Math\BigInteger $p
+     * @param \phpseclib3\Math\BigInteger $q
+     * @param \phpseclib3\Math\BigInteger $g
+     * @param \phpseclib3\Math\BigInteger $y
+     * @param \phpseclib3\Math\BigInteger $x
+     * @param string $password optional
+     * @param array $options optional
+     * @return string
+     */
+    public static function savePrivateKey(BigInteger $p, BigInteger $q, BigInteger $g, BigInteger $y, BigInteger $x, $password = '', array $options = [])
+    {
+        $key = [
+            'version' => 0,
+            'p' => $p,
+            'q' => $q,
+            'g' => $g,
+            'y' => $y,
+            'x' => $x
+        ];
+
+        $key = ASN1::encodeDER($key, Maps\DSAPrivateKey::MAP);
+
+        return self::wrapPrivateKey($key, 'DSA', $password, $options);
+    }
+
+    /**
+     * Convert a public key to the appropriate format
+     *
+     * @param \phpseclib3\Math\BigInteger $p
+     * @param \phpseclib3\Math\BigInteger $q
+     * @param \phpseclib3\Math\BigInteger $g
+     * @param \phpseclib3\Math\BigInteger $y
+     * @return string
+     */
+    public static function savePublicKey(BigInteger $p, BigInteger $q, BigInteger $g, BigInteger $y)
+    {
+        $key = ASN1::encodeDER($y, Maps\DSAPublicKey::MAP);
+
+        return self::wrapPublicKey($key, 'DSA');
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DSA/Formats/Keys/PKCS8.php ---
@@ -0,0 +1,146 @@
+<?php
+
+/**
+ * PKCS#8 Formatted DSA Key Handler
+ *
+ * PHP version 5
+ *
+ * Processes keys with the following headers:
+ *
+ * -----BEGIN ENCRYPTED PRIVATE KEY-----
+ * -----BEGIN PRIVATE KEY-----
+ * -----BEGIN PUBLIC KEY-----
+ *
+ * Analogous to ssh-keygen's pkcs8 format (as specified by -m). Although PKCS8
+ * is specific to private keys it's basically creating a DER-encoded wrapper
+ * for keys. This just extends that same concept to public keys (much like ssh-keygen)
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DSA\Formats\Keys;
+
+use phpseclib3\Crypt\Common\Formats\Keys\PKCS8 as Progenitor;
+use phpseclib3\File\ASN1;
+use phpseclib3\File\ASN1\Maps;
+use phpseclib3\Math\BigInteger;
+
+/**
+ * PKCS#8 Formatted DSA Key Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class PKCS8 extends Progenitor
+{
+    /**
+     * OID Name
+     *
+     * @var string
+     */
+    const OID_NAME = 'id-dsa';
+
+    /**
+     * OID Value
+     *
+     * @var string
+     */
+    const OID_VALUE = '1.2.840.10040.4.1';
+
+    /**
+     * Child OIDs loaded
+     *
+     * @var bool
+     */
+    protected static $childOIDsLoaded = false;
+
+    /**
+     * Break a public or private key down into its constituent components
+     *
+     * @param string $key
+     * @param string $password optional
+     * @return array
+     */
+    public static function load($key, $password = '')
+    {
+        $key = parent::load($key, $password);
+
+        $type = isset($key['privateKey']) ? 'privateKey' : 'publicKey';
+
+        $decoded = ASN1::decodeBER($key[$type . 'Algorithm']['parameters']->element);
+        if (!$decoded) {
+            throw new \RuntimeException('Unable to decode BER of parameters');
+        }
+        $components = ASN1::asn1map($decoded[0], Maps\DSAParams::MAP);
+        if (!is_array($components)) {
+            throw new \RuntimeException('Unable to perform ASN1 mapping on parameters');
+        }
+
+        $decoded = ASN1::decodeBER($key[$type]);
+        if (empty($decoded)) {
+            throw new \RuntimeException('Unable to decode BER');
+        }
+
+        $var = $type == 'privateKey' ? 'x' : 'y';
+        $components[$var] = ASN1::asn1map($decoded[0], Maps\DSAPublicKey::MAP);
+        if (!$components[$var] instanceof BigInteger) {
+            throw new \RuntimeException('Unable to perform ASN1 mapping');
+        }
+
+        if (isset($key['meta'])) {
+            $components['meta'] = $key['meta'];
+        }
+
+        return $components;
+    }
+
+    /**
+     * Convert a private key to the appropriate format.
+     *
+     * @param \phpseclib3\Math\BigInteger $p
+     * @param \phpseclib3\Math\BigInteger $q
+     * @param \phpseclib3\Math\BigInteger $g
+     * @param \phpseclib3\Math\BigInteger $y
+     * @param \phpseclib3\Math\BigInteger $x
+     * @param string $password optional
+     * @param array $options optional
+     * @return string
+     */
+    public static function savePrivateKey(BigInteger $p, BigInteger $q, BigInteger $g, BigInteger $y, BigInteger $x, $password = '', array $options = [])
+    {
+        $params = [
+            'p' => $p,
+            'q' => $q,
+            'g' => $g
+        ];
+        $params = ASN1::encodeDER($params, Maps\DSAParams::MAP);
+        $params = new ASN1\Element($params);
+        $key = ASN1::encodeDER($x, Maps\DSAPublicKey::MAP);
+        return self::wrapPrivateKey($key, [], $params, $password, null, '', $options);
+    }
+
+    /**
+     * Convert a public key to the appropriate format
+     *
+     * @param \phpseclib3\Math\BigInteger $p
+     * @param \phpseclib3\Math\BigInteger $q
+     * @param \phpseclib3\Math\BigInteger $g
+     * @param \phpseclib3\Math\BigInteger $y
+     * @param array $options optional
+     * @return string
+     */
+    public static function savePublicKey(BigInteger $p, BigInteger $q, BigInteger $g, BigInteger $y, array $options = [])
+    {
+        $params = [
+            'p' => $p,
+            'q' => $q,
+            'g' => $g
+        ];
+        $params = ASN1::encodeDER($params, Maps\DSAParams::MAP);
+        $params = new ASN1\Element($params);
+        $key = ASN1::encodeDER($y, Maps\DSAPublicKey::MAP);
+        return self::wrapPublicKey($key, $params);
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DSA/Formats/Keys/PuTTY.php ---
@@ -0,0 +1,109 @@
+<?php
+
+/**
+ * PuTTY Formatted DSA Key Handler
+ *
+ * puttygen does not generate DSA keys with an N of anything other than 160, however,
+ * it can still load them and convert them. PuTTY will load them, too, but SSH servers
+ * won't accept them. Since PuTTY formatted keys are primarily used with SSH this makes
+ * keys with N > 160 kinda useless, hence this handlers not supporting such keys.
+ *
+ * PHP version 5
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DSA\Formats\Keys;
+
+use phpseclib3\Common\Functions\Strings;
+use phpseclib3\Crypt\Common\Formats\Keys\PuTTY as Progenitor;
+use phpseclib3\Math\BigInteger;
+
+/**
+ * PuTTY Formatted DSA Key Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class PuTTY extends Progenitor
+{
+    /**
+     * Public Handler
+     *
+     * @var string
+     */
+    const PUBLIC_HANDLER = 'phpseclib3\Crypt\DSA\Formats\Keys\OpenSSH';
+
+    /**
+     * Algorithm Identifier
+     *
+     * @var array
+     */
+    protected static $types = ['ssh-dss'];
+
+    /**
+     * Break a public or private key down into its constituent components
+     *
+     * @param string $key
+     * @param string $password optional
+     * @return array
+     */
+    public static function load($key, $password = '')
+    {
+        $components = parent::load($key, $password);
+        if (!isset($components['private'])) {
+            return $components;
+        }
+        extract($components);
+        unset($components['public'], $components['private']);
+
+        list($p, $q, $g, $y) = Strings::unpackSSH2('iiii', $public);
+        list($x) = Strings::unpackSSH2('i', $private);
+
+        return compact('p', 'q', 'g', 'y', 'x', 'comment');
+    }
+
+    /**
+     * Convert a private key to the appropriate format.
+     *
+     * @param \phpseclib3\Math\BigInteger $p
+     * @param \phpseclib3\Math\BigInteger $q
+     * @param \phpseclib3\Math\BigInteger $g
+     * @param \phpseclib3\Math\BigInteger $y
+     * @param \phpseclib3\Math\BigInteger $x
+     * @param string $password optional
+     * @param array $options optional
+     * @return string
+     */
+    public static function savePrivateKey(BigInteger $p, BigInteger $q, BigInteger $g, BigInteger $y, BigInteger $x, $password = false, array $options = [])
+    {
+        if ($q->getLength() != 160) {
+            throw new \InvalidArgumentException('SSH only supports keys with an N (length of Group Order q) of 160');
+        }
+
+        $public = Strings::packSSH2('iiii', $p, $q, $g, $y);
+        $private = Strings::packSSH2('i', $x);
+
+        return self::wrapPrivateKey($public, $private, 'ssh-dss', $password, $options);
+    }
+
+    /**
+     * Convert a public key to the appropriate format
+     *
+     * @param \phpseclib3\Math\BigInteger $p
+     * @param \phpseclib3\Math\BigInteger $q
+     * @param \phpseclib3\Math\BigInteger $g
+     * @param \phpseclib3\Math\BigInteger $y
+     * @return string
+     */
+    public static function savePublicKey(BigInteger $p, BigInteger $q, BigInteger $g, BigInteger $y)
+    {
+        if ($q->getLength() != 160) {
+            throw new \InvalidArgumentException('SSH only supports keys with an N (length of Group Order q) of 160');
+        }
+
+        return self::wrapPublicKey(Strings::packSSH2('iiii', $p, $q, $g, $y), 'ssh-dss');
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DSA/Formats/Keys/Raw.php ---
@@ -0,0 +1,85 @@
+<?php
+
+/**
+ * Raw DSA Key Handler
+ *
+ * PHP version 5
+ *
+ * Reads and creates arrays as DSA keys
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DSA\Formats\Keys;
+
+use phpseclib3\Math\BigInteger;
+
+/**
+ * Raw DSA Key Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class Raw
+{
+    /**
+     * Break a public or private key down into its constituent components
+     *
+     * @param array $key
+     * @param string $password optional
+     * @return array
+     */
+    public static function load($key, $password = '')
+    {
+        if (!is_array($key)) {
+            throw new \UnexpectedValueException('Key should be a array - not a ' . gettype($key));
+        }
+
+        switch (true) {
+            case !isset($key['p']) || !isset($key['q']) || !isset($key['g']):
+            case !$key['p'] instanceof BigInteger:
+            case !$key['q'] instanceof BigInteger:
+            case !$key['g'] instanceof BigInteger:
+            case !isset($key['x']) && !isset($key['y']):
+            case isset($key['x']) && !$key['x'] instanceof BigInteger:
+            case isset($key['y']) && !$key['y'] instanceof BigInteger:
+                throw new \UnexpectedValueException('Key appears to be malformed');
+        }
+
+        $options = ['p' => 1, 'q' => 1, 'g' => 1, 'x' => 1, 'y' => 1];
+
+        return array_intersect_key($key, $options);
+    }
+
+    /**
+     * Convert a private key to the appropriate format.
+     *
+     * @param \phpseclib3\Math\BigInteger $p
+     * @param \phpseclib3\Math\BigInteger $q
+     * @param \phpseclib3\Math\BigInteger $g
+     * @param \phpseclib3\Math\BigInteger $y
+     * @param \phpseclib3\Math\BigInteger $x
+     * @param string $password optional
+     * @return string
+     */
+    public static function savePrivateKey(BigInteger $p, BigInteger $q, BigInteger $g, BigInteger $y, BigInteger $x, $password = '')
+    {
+        return compact('p', 'q', 'g', 'y', 'x');
+    }
+
+    /**
+     * Convert a public key to the appropriate format
+     *
+     * @param \phpseclib3\Math\BigInteger $p
+     * @param \phpseclib3\Math\BigInteger $q
+     * @param \phpseclib3\Math\BigInteger $g
+     * @param \phpseclib3\Math\BigInteger $y
+     * @return string
+     */
+    public static function savePublicKey(BigInteger $p, BigInteger $q, BigInteger $g, BigInteger $y)
+    {
+        return compact('p', 'q', 'g', 'y');
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DSA/Formats/Keys/XML.php ---
@@ -0,0 +1,132 @@
+<?php
+
+/**
+ * XML Formatted DSA Key Handler
+ *
+ * While XKMS defines a private key format for RSA it does not do so for DSA. Quoting that standard:
+ *
+ * "[XKMS] does not specify private key parameters for the DSA signature algorithm since the algorithm only
+ *  supports signature modes and so the application of server generated keys and key recovery is of limited
+ *  value"
+ *
+ * PHP version 5
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DSA\Formats\Keys;
+
+use phpseclib3\Common\Functions\Strings;
+use phpseclib3\Exception\BadConfigurationException;
+use phpseclib3\Math\BigInteger;
+
+/**
+ * XML Formatted DSA Key Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class XML
+{
+    /**
+     * Break a public or private key down into its constituent components
+     *
+     * @param string $key
+     * @param string $password optional
+     * @return array
+     */
+    public static function load($key, $password = '')
+    {
+        if (!Strings::is_stringable($key)) {
+            throw new \UnexpectedValueException('Key should be a string - not a ' . gettype($key));
+        }
+
+        if (!class_exists('DOMDocument')) {
+            throw new BadConfigurationException('The dom extension is not setup correctly on this system');
+        }
+
+        $use_errors = libxml_use_internal_errors(true);
+
+        $dom = new \DOMDocument();
+        if (substr($key, 0, 5) != '<?xml') {
+            $key = '<xml>' . $key . '</xml>';
+        }
+        if (!$dom->loadXML($key)) {
+            libxml_use_internal_errors($use_errors);
+            throw new \UnexpectedValueException('Key does not appear to contain XML');
+        }
+        $xpath = new \DOMXPath($dom);
+        $keys = ['p', 'q', 'g', 'y', 'j', 'seed', 'pgencounter'];
+        foreach ($keys as $key) {
+            // $dom->getElementsByTagName($key) is case-sensitive
+            $temp = $xpath->query("//*[translate(local-name(), 'ABCDEFGHIJKLMNOPQRSTUVWXYZ','abcdefghijklmnopqrstuvwxyz')='$key']");
+            if (!$temp->length) {
+                continue;
+            }
+            $value = new BigInteger(Strings::base64_decode($temp->item(0)->nodeValue), 256);
+            switch ($key) {
+                case 'p': // a prime modulus meeting the [DSS] requirements
+                    // Parameters P, Q, and G can be public and common to a group of users. They might be known
+                    // from application context. As such, they are optional but P and Q must either both appear
+                    // or both be absent
+                    $components['p'] = $value;
+                    break;
+                case 'q': // an integer in the range 2**159 < Q < 2**160 which is a prime divisor of P-1
+                    $components['q'] = $value;
+                    break;
+                case 'g': // an integer with certain properties with respect to P and Q
+                    $components['g'] = $value;
+                    break;
+                case 'y': // G**X mod P (where X is part of the private key and not made public)
+                    $components['y'] = $value;
+                    // the remaining options do not do anything
+                case 'j': // (P - 1) / Q
+                    // Parameter J is available for inclusion solely for efficiency as it is calculatable from
+                    // P and Q
+                case 'seed': // a DSA prime generation seed
+                    // Parameters seed and pgenCounter are used in the DSA prime number generation algorithm
+                    // specified in [DSS]. As such, they are optional but must either both be present or both
+                    // be absent
+                case 'pgencounter': // a DSA prime generation counter
+            }
+        }
+
+        libxml_use_internal_errors($use_errors);
+
+        if (!isset($components['y'])) {
+            throw new \UnexpectedValueException('Key is missing y component');
+        }
+
+        switch (true) {
+            case !isset($components['p']):
+            case !isset($components['q']):
+            case !isset($components['g']):
+                return ['y' => $components['y']];
+        }
+
+        return $components;
+    }
+
+    /**
+     * Convert a public key to the appropriate format
+     *
+     * See https://www.w3.org/TR/xmldsig-core/#sec-DSAKeyValue
+     *
+     * @param \phpseclib3\Math\BigInteger $p
+     * @param \phpseclib3\Math\BigInteger $q
+     * @param \phpseclib3\Math\BigInteger $g
+     * @param \phpseclib3\Math\BigInteger $y
+     * @return string
+     */
+    public static function savePublicKey(BigInteger $p, BigInteger $q, BigInteger $g, BigInteger $y)
+    {
+        return "<DSAKeyValue>\r\n" .
+               '  <P>' . Strings::base64_encode($p->toBytes()) . "</P>\r\n" .
+               '  <Q>' . Strings::base64_encode($q->toBytes()) . "</Q>\r\n" .
+               '  <G>' . Strings::base64_encode($g->toBytes()) . "</G>\r\n" .
+               '  <Y>' . Strings::base64_encode($y->toBytes()) . "</Y>\r\n" .
+               '</DSAKeyValue>';
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DSA/Formats/Signature/ASN1.php ---
@@ -0,0 +1,62 @@
+<?php
+
+/**
+ * ASN1 Signature Handler
+ *
+ * PHP version 5
+ *
+ * Handles signatures in the format described in
+ * https://tools.ietf.org/html/rfc3279#section-2.2.2
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2016 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DSA\Formats\Signature;
+
+use phpseclib3\File\ASN1 as Encoder;
+use phpseclib3\File\ASN1\Maps;
+use phpseclib3\Math\BigInteger;
+
+/**
+ * ASN1 Signature Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class ASN1
+{
+    /**
+     * Loads a signature
+     *
+     * @param string $sig
+     * @return array|bool
+     */
+    public static function load($sig)
+    {
+        if (!is_string($sig)) {
+            return false;
+        }
+
+        $decoded = Encoder::decodeBER($sig);
+        if (empty($decoded)) {
+            return false;
+        }
+        $components = Encoder::asn1map($decoded[0], Maps\DssSigValue::MAP);
+
+        return $components;
+    }
+
+    /**
+     * Returns a signature in the appropriate format
+     *
+     * @param \phpseclib3\Math\BigInteger $r
+     * @param \phpseclib3\Math\BigInteger $s
+     * @return string
+     */
+    public static function save(BigInteger $r, BigInteger $s)
+    {
+        return Encoder::encodeDER(compact('r', 's'), Maps\DssSigValue::MAP);
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DSA/Formats/Signature/Raw.php ---
@@ -0,0 +1,25 @@
+<?php
+
+/**
+ * Raw DSA Signature Handler
+ *
+ * PHP version 5
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2016 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DSA\Formats\Signature;
+
+use phpseclib3\Crypt\Common\Formats\Signature\Raw as Progenitor;
+
+/**
+ * Raw DSA Signature Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class Raw extends Progenitor
+{
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DSA/Formats/Signature/SSH2.php ---
@@ -0,0 +1,74 @@
+<?php
+
+/**
+ * SSH2 Signature Handler
+ *
+ * PHP version 5
+ *
+ * Handles signatures in the format used by SSH2
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2016 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DSA\Formats\Signature;
+
+use phpseclib3\Common\Functions\Strings;
+use phpseclib3\Math\BigInteger;
+
+/**
+ * SSH2 Signature Handler
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+abstract class SSH2
+{
+    /**
+     * Loads a signature
+     *
+     * @param string $sig
+     * @return mixed
+     */
+    public static function load($sig)
+    {
+        if (!is_string($sig)) {
+            return false;
+        }
+
+        $result = Strings::unpackSSH2('ss', $sig);
+        if ($result === false) {
+            return false;
+        }
+        list($type, $blob) = $result;
+        if ($type != 'ssh-dss' || strlen($blob) != 40) {
+            return false;
+        }
+
+        return [
+            'r' => new BigInteger(substr($blob, 0, 20), 256),
+            's' => new BigInteger(substr($blob, 20), 256)
+        ];
+    }
+
+    /**
+     * Returns a signature in the appropriate format
+     *
+     * @param \phpseclib3\Math\BigInteger $r
+     * @param \phpseclib3\Math\BigInteger $s
+     * @return string
+     */
+    public static function save(BigInteger $r, BigInteger $s)
+    {
+        if ($r->getLength() > 160 || $s->getLength() > 160) {
+            return false;
+        }
+        return Strings::packSSH2(
+            'ss',
+            'ssh-dss',
+            str_pad($r->toBytes(), 20, "\0", STR_PAD_LEFT) .
+            str_pad($s->toBytes(), 20, "\0", STR_PAD_LEFT)
+        );
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DSA/Parameters.php ---
@@ -0,0 +1,36 @@
+<?php
+
+/**
+ * DSA Parameters
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DSA;
+
+use phpseclib3\Crypt\DSA;
+
+/**
+ * DSA Parameters
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+final class Parameters extends DSA
+{
+    /**
+     * Returns the parameters
+     *
+     * @param string $type
+     * @param array $options optional
+     * @return string
+     */
+    public function toString($type = 'PKCS1', array $options = [])
+    {
+        $type = self::validatePlugin('Keys', 'PKCS1', 'saveParameters');
+
+        return $type::saveParameters($this->p, $this->q, $this->g, $options);
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DSA/PrivateKey.php ---
@@ -0,0 +1,152 @@
+<?php
+
+/**
+ * DSA Private Key
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DSA;
+
+use phpseclib3\Crypt\Common;
+use phpseclib3\Crypt\DSA;
+use phpseclib3\Crypt\DSA\Formats\Signature\ASN1 as ASN1Signature;
+use phpseclib3\Math\BigInteger;
+
+/**
+ * DSA Private Key
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+final class PrivateKey extends DSA implements Common\PrivateKey
+{
+    use Common\Traits\PasswordProtected;
+
+    /**
+     * DSA secret exponent x
+     *
+     * @var \phpseclib3\Math\BigInteger
+     */
+    protected $x;
+
+    /**
+     * Returns the public key
+     *
+     * If you do "openssl rsa -in private.rsa -pubout -outform PEM" you get a PKCS8 formatted key
+     * that contains a publicKeyAlgorithm AlgorithmIdentifier and a publicKey BIT STRING.
+     * An AlgorithmIdentifier contains an OID and a parameters field. With RSA public keys this
+     * parameters field is NULL. With DSA PKCS8 public keys it is not - it contains the p, q and g
+     * variables. The publicKey BIT STRING contains, simply, the y variable. This can be verified
+     * by getting a DSA PKCS8 public key:
+     *
+     * "openssl dsa -in private.dsa -pubout -outform PEM"
+     *
+     * ie. just swap out rsa with dsa in the rsa command above.
+     *
+     * A PKCS1 public key corresponds to the publicKey portion of the PKCS8 key. In the case of RSA
+     * the publicKey portion /is/ the key. In the case of DSA it is not. You cannot verify a signature
+     * without the parameters and the PKCS1 DSA public key format does not include the parameters.
+     *
+     * @see self::getPrivateKey()
+     * @return mixed
+     */
+    public function getPublicKey()
+    {
+        $type = self::validatePlugin('Keys', 'PKCS8', 'savePublicKey');
+
+        if (!isset($this->y)) {
+            $this->y = $this->g->powMod($this->x, $this->p);
+        }
+
+        $key = $type::savePublicKey($this->p, $this->q, $this->g, $this->y);
+
+        return DSA::loadFormat('PKCS8', $key)
+            ->withHash($this->hash->getHash())
+            ->withSignatureFormat($this->shortFormat);
+    }
+
+    /**
+     * Create a signature
+     *
+     * @see self::verify()
+     * @param string $message
+     * @return mixed
+     */
+    public function sign($message)
+    {
+        $format = $this->sigFormat;
+
+        if (self::$engines['OpenSSL'] && in_array($this->hash->getHash(), openssl_get_md_methods())) {
+            $signature = '';
+            $result = openssl_sign($message, $signature, $this->toString('PKCS8'), $this->hash->getHash());
+
+            if ($result) {
+                if ($this->shortFormat == 'ASN1') {
+                    return $signature;
+                }
+
+                extract(ASN1Signature::load($signature));
+
+                return $format::save($r, $s);
+            }
+        }
+
+        $h = $this->hash->hash($message);
+        $h = $this->bits2int($h);
+
+        while (true) {
+            $k = BigInteger::randomRange(self::$one, $this->q->subtract(self::$one));
+            $r = $this->g->powMod($k, $this->p);
+            list(, $r) = $r->divide($this->q);
+            if ($r->equals(self::$zero)) {
+                continue;
+            }
+            $kinv = $k->modInverse($this->q);
+            $temp = $h->add($this->x->multiply($r));
+            $temp = $kinv->multiply($temp);
+            list(, $s) = $temp->divide($this->q);
+            if (!$s->equals(self::$zero)) {
+                break;
+            }
+        }
+
+        // the following is an RFC6979 compliant implementation of deterministic DSA
+        // it's unused because it's mainly intended for use when a good CSPRNG isn't
+        // available. if phpseclib's CSPRNG isn't good then even key generation is
+        // suspect
+        /*
+        $h1 = $this->hash->hash($message);
+        $k = $this->computek($h1);
+        $r = $this->g->powMod($k, $this->p);
+        list(, $r) = $r->divide($this->q);
+        $kinv = $k->modInverse($this->q);
+        $h1 = $this->bits2int($h1);
+        $temp = $h1->add($this->x->multiply($r));
+        $temp = $kinv->multiply($temp);
+        list(, $s) = $temp->divide($this->q);
+        */
+
+        return $format::save($r, $s);
+    }
+
+    /**
+     * Returns the private key
+     *
+     * @param string $type
+     * @param array $options optional
+     * @return string
+     */
+    public function toString($type, array $options = [])
+    {
+        $type = self::validatePlugin('Keys', $type, 'savePrivateKey');
+
+        if (!isset($this->y)) {
+            $this->y = $this->g->powMod($this->x, $this->p);
+        }
+
+        return $type::savePrivateKey($this->p, $this->q, $this->g, $this->y, $this->x, $this->password, $options);
+    }
+}

--- private/vendor/phpseclib/phpseclib/phpseclib/Crypt/DSA/PublicKey.php ---
@@ -0,0 +1,86 @@
+<?php
+
+/**
+ * DSA Public Key
+ *
+ * @author    Jim Wigginton <terrafrost@php.net>
+ * @copyright 2015 Jim Wigginton
+ * @license   http://www.opensource.org/licenses/mit-license.html  MIT License
+ * @link      http://phpseclib.sourceforge.net
+ */
+
+namespace phpseclib3\Crypt\DSA;
+
+use phpseclib3\Crypt\Common;
+use phpseclib3\Crypt\DSA;
+use phpseclib3\Crypt\DSA\Formats\Signature\ASN1 as ASN1Signature;
+
+/**
+ * DSA Public Key
+ *
+ * @author  Jim Wigginton <terrafrost@php.net>
+ */
+final class PublicKey extends DSA implements Common\PublicKey
+{
+    use Common\Traits\Fingerprint;
+
+    /**
+     * Verify a signature
+     *
+     * @see self::verify()
+     * @param string $message
+     * @param string $signature
+     * @return mixed
+     */
+    public function verify($message, $signature)
+    {
+        $format = $this->sigFormat;
+
+        $params = $format::load($signature);
+        if ($params === false || count($params) != 2) {
+            return false;
+        }
+        extract($params);
+
+        if (self::$engines['OpenSSL'] && in_array($this->hash->getHash(), openssl_get_md_methods())) {
+            $sig = $format != 'ASN1' ? ASN1Signature::save($r, $s) : $signature;
+
+            $result = openssl_verify($message, $sig, $this->toString('PKCS8'), $this->hash->getHash());
+
+            if ($result != -1) {
+                return (bool) $result;
+            }
+        }
+
+        $q_1 = $this->q->subtract(self::$one);
+        if (!$r->between(self::$one, $q_1) || !$s->between(self::$one, $q_1)) {
+            return false;
+        }
+
+        $w = $s->modInverse($this->q);
+        $h = $this->hash->hash($message);
+        $h = $this->bits2int($h);
+        list(, $u1) = $h->multiply($w)->divide($this->q);
+        list(, $u2) = $r->multiply($w)->divide($this->q);
+        $v1 = $this->g->powMod($u1, $this->p);
+        $v2 = $this->y->powMod($u2, $this->p);
+        list(, $v) = $v1->multiply($v2)->divide($this->p);
+        list(, $v) = $v->divide($this->q);
+
+        return $v->equals($r);
+    }
+
+    /**
+     * Returns the public key
+     *
+     * @param string $type
+     * @param array $options optional
+     * @return string
+     */
+    public function toString($type, array $options = [])
+    {
+        $type = self::validatePlugin('Keys', $type, 'savePublicKey');
+
+        return $type::savePublicKey($this->p, $this->q, $this->g, $this->y, $options);
+    }
+}

