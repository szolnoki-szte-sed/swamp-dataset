--- includes/html/common/eventlog.inc.php ---
@@ -13,6 +13,8 @@
  * @author     LibreNMS Contributors
 */
 
+$vars['eventtype'] = 'test\"-alert(document.cookie)//';
+
 $common_output[] = '
 <div class="table-responsive">
     <table id="eventlog" class="table table-hover table-condensed table-striped">
@@ -36,7 +38,7 @@
     {
         return {
             device: ' . (empty($vars['device']) ? 'null' : (int) $vars['device']) . ',
-            eventtype: "' . addcslashes($vars['eventtype'] ?? '', '"') . '",
+            eventtype: "' . htmlspecialchars($vars['eventtype'] ?? '') . '",
         };
     },
     url: "' . url('/ajax/table/eventlog') . '"

--- includes/html/common/syslog.inc.php ---
@@ -37,11 +37,11 @@
     post: function ()
     {
         return {
-            device: "' . addcslashes($vars['device'] ?? '', '"') . '",
-            program: "' . addcslashes($vars['program'] ?? '', '"') . '",
-            priority: "' . addcslashes($vars['priority'] ?? '', '"') . '",
-            to: "' . addcslashes($vars['to'] ?? '', '"') . '",
-            from: "' . addcslashes($vars['from'] ?? '', '"') . '",
+            device: "' . htmlspecialchars($vars['device'] ?? '') . '",
+            program: "' . htmlspecialchars($vars['program'] ?? '') . '",
+            priority: "' . htmlspecialchars($vars['priority'] ?? '') . '",
+            to: "' . htmlspecialchars($vars['to'] ?? '') . '",
+            from: "' . htmlspecialchars($vars['from'] ?? '') . '",
         };
     },
     url: "' . url('/ajax/table/syslog') . '"

--- includes/html/pages/eventlog.inc.php ---
@@ -106,6 +106,6 @@
                 }
             }
         }
-    })<?php echo Request::get('eventtype') ? ".val('" . addcslashes(Request::get('eventtype'), "'") . "').trigger('change');" : ''; ?>;
+    })<?php echo Request::get('eventtype') ? ".val('" . htmlspecialchars(Request::get('eventtype')) . "').trigger('change');" : ''; ?>;
 
 </script>

--- includes/html/pages/syslog.inc.php ---
@@ -171,7 +171,7 @@
                 }
             }
         }
-    })<?php echo isset($vars['program']) ? ".val('" . addcslashes($vars['program'], "'") . "').trigger('change');" : ''; ?>;
+    })<?php echo isset($vars['program']) ? ".val('" . htmlspecialchars($vars['program']) . "').trigger('change');" : ''; ?>;
 
     $("#priority").select2({
         theme: "bootstrap",
@@ -191,6 +191,6 @@
                 }
             }
         }
-    })<?php echo isset($vars['priority']) ? ".val('" . addcslashes($vars['priority'], "'") . "').trigger('change');" : ''; ?>;
+    })<?php echo isset($vars['priority']) ? ".val('" . htmlspecialchars($vars['priority']) . "').trigger('change');" : ''; ?>;
 </script>
 

