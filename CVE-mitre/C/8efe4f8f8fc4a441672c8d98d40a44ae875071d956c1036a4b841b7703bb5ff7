--- ChangeLog ---
@@ -75,6 +75,9 @@ pointers had out of place PCRE2_CALL_CONVENTION in src/pcre2.h.*. These
 produced errors when building for Windows with #define PCRE2_CALL_CONVENTION
 __stdcall.
 
+20. A negative repeat value in a pcre2test subject line was not being 
+diagnosed, leading to infinite looping.
+
 
 Version 10.40 15-April-2022
 ---------------------------

--- src/pcre2test.c ---
@@ -6844,9 +6844,9 @@ while ((c = *p++) != 0)
       }
 
     i = (int32_t)li;
-    if (i-- == 0)
+    if (i-- <= 0)
       {
-      fprintf(outfile, "** Zero repeat not allowed\n");
+      fprintf(outfile, "** Zero or negative repeat not allowed\n");
       return PR_OK;
       }
 

--- testdata/testinput2 ---
@@ -5932,4 +5932,7 @@ a)"xI
 /[Aa]{2,3}/BI
     aabcd
 
+--
+    \[X]{-10}
+
 # End of testinput2

--- testdata/testoutput2 ---
@@ -17746,6 +17746,10 @@ Subject length lower bound = 2
     aabcd
  0: aa
 
+--
+    \[X]{-10}
+** Zero or negative repeat not allowed
+
 # End of testinput2
 Error -70: PCRE2_ERROR_BADDATA (unknown error number)
 Error -62: bad serialized data

