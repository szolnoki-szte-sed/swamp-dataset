--- main/inc/lib/social.lib.php ---
@@ -2409,7 +2409,6 @@ public static function getScriptToGetOpenGraph(): string
     public static function displayWallForm(string $urlForm): string
     {
         $form = self::getWallForm($urlForm);
-        $form->protect();
 
         return Display::panel($form->returnForm(), get_lang('SocialWall'));
     }
@@ -3397,6 +3396,7 @@ private static function getWallForm(string $urlForm): FormValidator
         $form->addHtml('</div></div>');
         $form->addHtml('</div>');
         $form->addHidden('url_content', '');
+        $form->protect();
 
         return $form;
     }

