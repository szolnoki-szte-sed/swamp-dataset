--- phpmyfaq/ajaxservice.php ---
@@ -774,6 +774,11 @@
             break;
         }
 
+        if ($userId !== $user->getUserIdByEmail($email)) {
+            $message = ['error' => 'User ID / email mismatch!'];
+            break;
+        }
+
         if (strlen($password) <= 7 || strlen($confirm) <= 7) {
             $message = ['error' => $PMF_LANG['ad_passwd_fail']];
             break;

--- phpmyfaq/src/phpMyFAQ/User.php ---
@@ -908,7 +908,7 @@ public function getUserIdByEmail(string $email): int
 
         $userData = $this->userdata->fetchAll('email', $email);
 
-        return (int)$userData['user_id'];
+        return $userData['user_id'];
     }
 
     /**

