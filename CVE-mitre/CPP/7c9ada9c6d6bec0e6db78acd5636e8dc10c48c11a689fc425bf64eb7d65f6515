--- src/function/table/sniff_csv.cpp ---
@@ -36,6 +36,10 @@ static unique_ptr<GlobalTableFunctionState> CSVSniffInitGlobal(ClientContext &co
 static unique_ptr<FunctionData> CSVSniffBind(ClientContext &context, TableFunctionBindInput &input,
                                              vector<LogicalType> &return_types, vector<string> &names) {
 	auto result = make_uniq<CSVSniffFunctionData>();
+	auto &config = DBConfig::GetConfig(context);
+	if (!config.options.enable_external_access) {
+		throw PermissionException("sniff_csv is disabled through configuration");
+	}
 	result->path = input.inputs[0].ToString();
 	auto it = input.named_parameters.find("auto_detect");
 	if (it != input.named_parameters.end()) {

--- test/sql/copy/csv/csv_external_access.test ---
@@ -31,3 +31,9 @@ COPY date_test TO '__TEST_DIR__/date.csv'
 statement error
 SET enable_external_access=true;
 ----
+
+# sniffer also respects external access flag
+statement error
+FROM sniff_csv('test/sql/copy/csv/data/test/date.csv');
+----
+Permission Error: sniff_csv is disabled through configuration

