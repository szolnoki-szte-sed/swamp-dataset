--- front/send_inventory.php ---
@@ -50,13 +50,12 @@
 //Session::checkRight('config', "w");
 
 $itemtype = $_GET['itemtype'];
-$function = $_GET['function'];
 $items_id = $_GET['items_id'];
 
 header('Cache-control: private, must-revalidate'); /// IE BUG + SSL
 header('Content-disposition: attachment; filename='.$_GET['filename']);
 header('Content-type: text/plain');
 
 
-call_user_func(['PluginFusioninventoryToolbox', $function], $items_id, $itemtype);
+call_user_func(['PluginFusioninventoryToolbox', 'sendXML'], $items_id, $itemtype);
 

--- inc/toolbox.class.php ---
@@ -518,7 +518,8 @@ static function sendSerializedInventory($items_id, $itemtype) {
     * @param string $itemtype
     */
    static function sendXML($items_id, $itemtype) {
-      if (call_user_func([$itemtype, 'canView'])) {
+      if (preg_match("/^([a-zA-Z]+)\/(\d+)\/(\d+)\.xml$/", $items_id)
+         && call_user_func([$itemtype, 'canView'])) {
          $xml = file_get_contents(GLPI_PLUGIN_DOC_DIR."/fusioninventory/xml/".$items_id);
          echo $xml;
       } else {

