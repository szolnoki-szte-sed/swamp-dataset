--- ChangeLog ---
@@ -1,4 +1,6 @@
 1.9.42
+Security:
+  * FIX: Fix XSS in std_table.php gadget
 
 1.9.41
 Frontend:

--- share/userfiles/gadgets/std_table.php ---
@@ -300,7 +300,7 @@
                 if ($value > 0 || $show_all == 1) {
                     $global_cls = (substr($stat, 2) == $current_state) ? $current_state : '';
                     echo '<th class="'.$global_cls.'">';
-                    echo substr(substr(strchr($stat, "_"), 1), 0, 4);
+                    echo htmlspecialchars(substr(substr(strchr($stat, "_"), 1), 0, 4));
                     echo "</th>";
                 }
             }
@@ -318,7 +318,7 @@
     if ($group_states == 0 || strpos($stat, "S_") === 0) {
         if ($value > 0 || $show_all == 1) {
             if ($value > 0) {
-                $class = substr(strchr($stat, "_"), 1);
+                $class = htmlspecialchars(substr(strchr($stat, "_"), 1));
             }
             else {
                 $class = 'EMPTY';

