--- upload/changelog/551.json ---
@@ -1,6 +1,6 @@
 {
   "version":"5.5.1",
-  "revision":"199",
+  "revision":"200",
   "status":"dev",
   "detail":[
     {
@@ -193,6 +193,7 @@
         ,"Fix signup wrong date format"
         ,"Fix featured video filter"
         ,"Fix search results pagination"
+        ,"Fix upload security issue (Thanks @0xbko)"
       ]
     },
     {

--- upload/includes/classes/photos.class.php ---
@@ -2906,9 +2906,9 @@ function photo_embed_codes($newArr)
      *
      * @return string
      */
-    function encode_key($key)
+    function encode_key($key): string
     {
-        return base64_encode(serialize($key));
+        return base64_encode(json_encode($key));
     }
 
     /**
@@ -2920,7 +2920,7 @@ function encode_key($key)
      */
     function decode_key($key)
     {
-        return unserialize(base64_decode($key));
+        return json_decode(base64_decode($key));
     }
 
     /**

--- upload/includes/classes/rediscache.class.php ---
@@ -105,7 +105,6 @@ public function isEnabled(): bool
         return $this->isEnabled;
     }
 
-
     private static function redislize($data): string
     {
         // Only serialize if it's not a string or a integer

--- upload/upload.php ---
@@ -8,7 +8,7 @@
 subtitle('upload');
 
 if (isset($_GET['collection'])) {
-    $selected_collection = unserialize(base64_decode($_GET['collection']));
+    $selected_collection = json_decode(base64_decode($_GET['collection']));
     assign('selected_collection', Collection::getInstance()->getOne(['collection_id'=>$selected_collection]));
 }
 

--- upload/view_collection.php ---
@@ -78,14 +78,14 @@
         subtitle($cdetails['collection_name']);
         if ($cdetails['type'] == 'photos') {
             if (SEO == 'yes') {
-                $link = '/photo_upload/' . base64_encode(serialize($cdetails['collection_id']));
+                $link = '/photo_upload/' . base64_encode(json_encode($cdetails['collection_id']));
             }
-            $link = '/photo_upload.php?collection=' . base64_encode(serialize($cdetails['collection_id']));
+            $link = '/photo_upload.php?collection=' . base64_encode(json_encode($cdetails['collection_id']));
         } elseif ($cdetails['type'] == 'videos') {
             if (SEO == 'yes') {
-                $link = '/upload/' . base64_encode(serialize($cdetails['collection_id']));
+                $link = '/upload/' . base64_encode(json_encode($cdetails['collection_id']));
             }
-            $link = '/upload.php?collection=' . base64_encode(serialize($cdetails['collection_id']));
+            $link = '/upload.php?collection=' . base64_encode(json_encode($cdetails['collection_id']));
         }
         assign('link_add_more',  $link);
     }

