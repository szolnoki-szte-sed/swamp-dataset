--- lib/Controller/Library.php ---
@@ -1635,7 +1635,9 @@ public function download(Request $request, Response $response, $id)
         $downloader->useLogger($this->getLog()->getLoggerInterface());
 
         $params = $this->getSanitizer($request->getParams());
-        if ($params->getCheckbox('preview') == 1) {
+
+        // Check if preview is allowed for the module
+        if ($params->getCheckbox('preview') == 1 && $module->allowPreview === 1) {
             $this->getLog()->debug('download: preview mode, seeing if we can output an image/video');
 
             // Output a 1px image if we're not allowed to see the media.

--- lib/Controller/Module.php ---
@@ -256,6 +256,11 @@ public function settings(Request $request, Response $response, $id)
             $setting->setValueByType($sanitizedParams, null, true);
         }
 
+        // Preview is not allowed for generic file type
+        if ($module->allowPreview === 0 && $sanitizedParams->getCheckbox('previewEnabled') == 1) {
+            throw new InvalidArgumentException(__('Preview is disabled'));
+        }
+
         // Save
         $module->save();
 

--- lib/Entity/Module.php ---
@@ -290,6 +290,7 @@ class Module implements \JsonSerializable
     public $errors;
 
     // </editor-fold>
+    public $allowPreview;
 
     /** @var ModuleFactory */
     private $moduleFactory;

--- lib/Factory/ModuleFactory.php ---
@@ -754,6 +754,7 @@ private function createFromXml(string $file, array $modulesWithSettings): Module
         $module->renderAs = $this->getFirstValueOrDefaultFromXmlNode($xml, 'renderAs');
         $module->defaultDuration = intval($this->getFirstValueOrDefaultFromXmlNode($xml, 'defaultDuration'));
         $module->hasThumbnail = intval($this->getFirstValueOrDefaultFromXmlNode($xml, 'hasThumbnail', 0));
+        $module->allowPreview = intval($this->getFirstValueOrDefaultFromXmlNode($xml, 'allowPreview', 1));
 
         // Validator classes
         foreach ($xml->getElementsByTagName('validatorClass') as $node) {

--- modules/genericfile.xml ---
@@ -38,6 +38,7 @@
             <default>apk,ipk,js,html,htm</default>
         </property>
     </settings>
+    <allowPreview>0</allowPreview>
     <properties></properties>
     <preview></preview>
     <stencil>

--- views/module-form-settings.twig ---
@@ -44,7 +44,7 @@
 
                 {% set title %}{% trans "Preview Enabled?" %}{% endset %}
                 {% set helpText %}{% trans "When Preview is Enabled users will be able to see a preview in the layout editor." %}{% endset %}
-                {{ forms.checkbox("previewEnabled", title, module.previewEnabled, helpText) }}
+                {{ forms.checkbox("previewEnabled", title, module.previewEnabled, helpText, "", "", module.allowPreview == 0) }}
 
                 {% set title %}{% trans "Enabled?" %}{% endset %}
                 {% set helpText %}{% trans "When Enabled users will be able to add media using this module." %}{% endset %}

