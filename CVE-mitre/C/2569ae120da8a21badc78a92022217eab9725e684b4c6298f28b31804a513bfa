--- miniupnpc/Changelog.txt ---
@@ -1,6 +1,9 @@
 $Id: Changelog.txt,v 1.187 2013/06/06 21:36:39 nanard Exp $
 miniUPnP client Changelog.
 
+2013/10/07:
+  fixed potential buffer overrun in miniwget.c
+
 2013/08/01:
   define MAXHOSTNAMELEN if not already done
 

--- miniupnpc/miniwget.c ---
@@ -162,7 +162,7 @@ getHTTPResponse(int s, int * size)
 							chunked = 1;
 						}
 					}
-					while(header_buf[i]=='\r' || header_buf[i] == '\n')
+					while((i < (int)header_buf_used) && (header_buf[i]=='\r' || header_buf[i] == '\n'))
 						i++;
 					linestart = i;
 					colon = linestart;

