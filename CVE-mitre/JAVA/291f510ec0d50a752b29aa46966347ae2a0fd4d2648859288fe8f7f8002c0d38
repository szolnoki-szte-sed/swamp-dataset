--- .idea/libraries/Maven__org_owasp_encoder_encoder_1_2_3.xml ---
@@ -1,13 +0,0 @@
-<component name="libraryTable">
-  <library name="Maven: org.owasp.encoder:encoder:1.2.3">
-    <CLASSES>
-      <root url="jar://$MAVEN_REPOSITORY$/org/owasp/encoder/encoder/1.2.3/encoder-1.2.3.jar!/" />
-    </CLASSES>
-    <JAVADOC>
-      <root url="jar://$MAVEN_REPOSITORY$/org/owasp/encoder/encoder/1.2.3/encoder-1.2.3-javadoc.jar!/" />
-    </JAVADOC>
-    <SOURCES>
-      <root url="jar://$MAVEN_REPOSITORY$/org/owasp/encoder/encoder/1.2.3/encoder-1.2.3-sources.jar!/" />
-    </SOURCES>
-  </library>
-</component>
\ No newline at end of file

--- src/main/java/io/whitesource/cure/FileSecurityUtils.java ---
@@ -22,7 +22,7 @@ public static boolean isFileOutsideDir(
           @NonNull final String filePath, @NonNull final String baseDirPath) throws IOException {
     File file = new File(filePath);
     File baseDir = new File(baseDirPath);
-    return !file.getCanonicalPath().startsWith(baseDir.getCanonicalPath());
+    return !file.getCanonicalFile().toPath().startsWith(baseDir.getCanonicalFile().toPath());
   }
 
   /**

--- src/test/java/io/whitesource/cure/FileSecurityUtilsTests.java ---
@@ -50,6 +50,13 @@ void normalize_validInput_successfullyWithResult() {
     Assertions.assertEquals(expectedResult, actualResult);
   }
 
+  @Test
+  void isFileOutsideDirStartsWithTest() throws IOException {
+    String taintedInput = "/usr/foo/../foo-bar/bar";
+    String baseDir = "/usr/foo";
+    Assertions.assertTrue(FileSecurityUtils.isFileOutsideDir(taintedInput, baseDir));
+  }
+
   @Test
   void normalize_null_successfully() {
     Assertions.assertNull(FileSecurityUtils.normalize(null));

