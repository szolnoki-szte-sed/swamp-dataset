--- ChangeLog ---
@@ -1,3 +1,11 @@
+2022-04-16  Jose E. Marchesi  <jemarch@gnu.org>
+
+	CVE-2021-46019
+	CVE-2021-46022
+	CVE-2021-46022
+	* src/rec-parser.c (rec_parse_comment): Avoid 0xff being
+	interpreted as (int) -1.
+
 2022-04-16  Jose E. Marchesi  <jemarch@gnu.org>
 
 	* configure.ac: Remove algol68 bindings support.

--- src/rec-parser.c ---
@@ -432,7 +432,7 @@ rec_parse_comment (rec_parser_t parser, rec_comment_t *comment)
                 c = '\n';
             }
 
-          if (rec_buf_putc (c, buf) == EOF)
+          if (rec_buf_putc (ci, buf) == EOF)
             {
               /* Out of memory */
               parser->error = REC_PARSER_ENOMEM;

