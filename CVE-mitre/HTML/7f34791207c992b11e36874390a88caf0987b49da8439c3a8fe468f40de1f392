--- .env ---
@@ -1,8 +1,8 @@
 VITE_API_ID=1025907
 VITE_API_HASH=452b0359b988148995f22ff0f4229750
 VITE_VERSION=2.0.0
-VITE_VERSION_FULL=2.0.0 (486)
-VITE_BUILD=486
+VITE_VERSION_FULL=2.0.0 (487)
+VITE_BUILD=487
 VITE_MTPROTO_WORKER=1
 VITE_MTPROTO_SW=
 VITE_MTPROTO_HTTP=

--- public/avatar-HalcuPNE.js ---
@@ -1,2 +1,2 @@
-import{B as _,I as M,r as se}from"./button-aS2SE0kp.js";import{o as ne,L as oe,t as ae,D as N,m as re}from"./wrapEmojiText-pejq-WF4.js";import{ah as q,M as ce,c as X,aq as le,g as Y,F as z,aj as he,a as de,ak as K,E as ue,ai as A,d as j,a8 as pe,i as U}from"./index-XZA1-3MU.js";import{a as L,d as fe}from"./page-eb81Un_i.js";import{S as me}from"./scrollable-OU41biYL.js";function ve(n){return q&&n instanceof TouchEvent&&n.touches[0].clientX<30}class ge{constructor(){if(this.onPopState=e=>{const t=window.location.hash,i=e.state;if(this.debug&&this.log("popstate",e,this.isPossibleSwipe,t),t!==this.currentHash)if(this.debug&&this.log.warn(`hash changed, new=${t}, current=${this.currentHash}, overridden=${this.overriddenHash}`),i===this.id&&this.overriddenHash&&this.overriddenHash!==t)this.overrideHash(this.overriddenHash);else if(i&&!this.overriddenHash&&t)this.overrideHash();else{this.currentHash=t,this.onHashChange&&this.onHashChange();return}if(i!==this.id&&(this.pushState(),!this.navigations.length))return;const s=this.navigations.pop();if(!s){this.pushState();return}this.manual=!this.isPossibleSwipe,this.handleItem(s,this.navigations.length)},this.onKeyDown=e=>{const t=this.navigations[this.navigations.length-1];t&&e.key==="Escape"&&(!t.onEscape||t.onEscape())&&(X(e),this.back(t.type))},this.onTouchStart=e=>{e.touches.length>1||(this.debug&&this.log("touchstart"),ve(e)&&(this.isPossibleSwipe=!0,window.addEventListener("touchend",()=>{setTimeout(()=>{this.isPossibleSwipe=!1},100)},{passive:!0,once:!0})))},this.navigations=[],this.id=Date.now(),this.manual=!1,this.log=le("NC"),this.debug=!0,this.currentHash=window.location.hash,this.overriddenHash="",this.isPossibleSwipe=!1,window.addEventListener("popstate",this.onPopState),window.addEventListener("keydown",this.onKeyDown,{capture:!0,passive:!1}),q){const e={passive:!0};window.addEventListener("touchstart",this.onTouchStart,e)}history.scrollRestoration="manual",this.pushState()}overrideHash(e=""){e&&e[0]!=="#"?e="#"+e:e==="#"&&(e=""),this.currentHash!==e&&(this.overriddenHash=this.currentHash=e,this.replaceState(),this.pushState())}handleItem(e,t=this.navigations.indexOf(e)){const i=e.onPop(this.manual?void 0:!1);this.debug&&this.log("popstate, navigation:",e,this.navigations),i===!1?this.spliceItems(Math.min(this.navigations.length,t),0,e):e.noBlurOnPop||Y(),this.manual=!1}findItemByType(e){for(let t=this.navigations.length-1;t>=0;--t){const i=this.navigations[t];if(i.type===e)return{item:i,index:t}}}back(e){if(e){const t=this.findItemByType(e);if(t){this.backByItem(t.item,t.index);return}}history.back()}backByItem(e,t=this.navigations.indexOf(e)){t!==-1&&(this.manual=!0,this.navigations.splice(t,1),this.handleItem(e,t))}onItemAdded(e){this.debug&&this.log("onItemAdded",e,this.navigations),e.noHistory||this.pushState()}pushItem(e){this.navigations.push(e),this.onItemAdded(e)}unshiftItem(e){this.navigations.unshift(e),this.onItemAdded(e)}spliceItems(e,t,...i){this.navigations.splice(e,t,...i),i.forEach(s=>{this.onItemAdded(s)})}pushState(){this.debug&&this.log("push"),this.manual=!1,history.pushState(this.id,"")}replaceState(){this.debug&&this.log.warn("replace");const e=location.origin+location.pathname+location.search+this.overriddenHash;history.replaceState(this.id,"",e)}removeItem(e){e&&z(this.navigations,e)}removeByType(e,t=!1){for(let i=this.navigations.length-1;i>=0&&!(this.navigations[i].type===e&&(this.navigations.splice(i,1),t));--i);}}const w=new ge;ce.appNavigationController=w;function be(n){if(n.key==="Enter"&&!he&&!n.isComposing){if(de.settings.sendShortcut==="enter")return n.shiftKey||n.ctrlKey||n.metaKey?void 0:!0;{const e=K?n.metaKey:n.ctrlKey;if(n.shiftKey||(K?n.ctrlKey:n.metaKey))return;if(e)return!0}}return!1}function Ae(n){n.requestFullscreen?n.requestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.msRequestFullscreen&&n.msRequestFullscreen()}function Oe(){document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}function ye(n,e,t){const i=t?t.add(n):n.addEventListener.bind(n);"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange".split(" ").forEach(s=>{i(s,e,!1)})}function $(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function Fe(){return!!$()}const Ce=(n,e={})=>{const t=n?.split(" ");return _("btn-icon"+(t?.length>1?" "+t.slice(1).join(" "):""),{icon:t?.[0]||void 0,...e})},O=document.body;let C=O;const G=()=>{C=$()||O,P.reAppend()};ye(O,G);const p=class p extends ue{constructor(e,t={}){if(super(!1),this.element=document.createElement("div"),this.container=document.createElement("div"),this.header=document.createElement("div"),this.title=document.createElement("div"),this.element.classList.add("popup"),this.element.className="popup"+(e?" "+e:""),this.container.classList.add("popup-container","z-depth-1"),A.isDarkOverlayActive&&(this.night=!0,this.element.classList.add("night")),this.header.classList.add("popup-header"),t.title&&(this.title.classList.add("popup-title"),typeof t.title=="string"?j(this.title,t.title):typeof t.title!="boolean"&&this.title.append(t.title),this.header.append(this.title)),this.isConfirmationNeededOnClose=t.isConfirmationNeededOnClose,this.middlewareHelper=ne(),this.listenerSetter=new oe,this.managers=p.MANAGERS,this.confirmShortcutIsSendShortcut=t.confirmShortcutIsSendShortcut,t.closable&&(this.btnClose=Ce("",{noRipple:!0}),this.btnClose.classList.add("popup-close"),this.header.prepend(this.btnClose),t.onBackClick?(this.btnCloseAnimatedIcon=document.createElement("div"),this.btnCloseAnimatedIcon.classList.add("animated-close-icon"),this.btnClose.append(this.btnCloseAnimatedIcon)):this.btnClose.append(M("close")),L(this.btnClose,()=>{t.onBackClick&&this.btnCloseAnimatedIcon.classList.contains("state-back")?(this.btnCloseAnimatedIcon.classList.remove("state-back"),t.onBackClick()):this.hide()},{listenerSetter:this.listenerSetter})),this.withoutOverlay=t.withoutOverlay,this.withoutOverlay&&this.element.classList.add("no-overlay"),t.overlayClosable&&L(this.element,i=>{pe(i.target,"popup-container")||!i.target.isConnected||this.hide()},{listenerSetter:this.listenerSetter}),t.withConfirm&&(this.btnConfirm=document.createElement("button"),this.btnConfirm.classList.add("btn-primary","btn-color-primary"),t.withConfirm!==!0&&this.btnConfirm.append(U(t.withConfirm)),this.header.append(this.btnConfirm)),this.container.append(this.header),t.body&&(this.body=document.createElement("div"),this.body.classList.add("popup-body"),this.container.append(this.body)),t.scrollable){const i=this.scrollable=new me(this.body);if(this.attachScrollableListeners(),t.floatingHeader){this.attachScrollableListeners(this.header);const s=document.createElement("div");s.classList.add("popup-header-background"),this.header.prepend(s),this.header.classList.add("is-floating")}this.body||this.header.after(i.container)}t.footer&&(this.footer=document.createElement("div"),this.footer.classList.add("popup-footer"),(this.body||this.container).append(this.footer)),this.btnConfirmOnEnter=this.btnConfirm,this.setButtons(t.buttons),this.element.append(this.container),p.POPUPS.push(this)}setButtons(e){if(this.buttons=e,this.buttonsEl&&(this.buttonsEl.remove(),this.buttonsEl=void 0),!e?.length)return;const t=this.buttonsEl=document.createElement("div");t.classList.add("popup-buttons");const i=e.map(s=>{const r=document.createElement("button");if(r.className="popup-button btn"+(s.isDanger?" danger":" primary"),s.noRipple||se(r),s.text?r.append(s.text):s.langKey&&r.append(U(s.langKey,s.langArgs)),s.iconLeft||s.iconRight){const f=M(s.iconLeft||s.iconRight,"popup-button-icon",s.iconLeft?"left":"right");r.classList.add("with-icon"),s.iconLeft?r.prepend(f):r.append(f)}return L(r,async f=>{let c=s.callback?.(f);if(c!==void 0&&c instanceof Promise){const m=ae([s.element],!0);try{c=await c}catch{c=!1}c===!1&&m()}c!==!1&&this.hide()},{listenerSetter:this.listenerSetter}),s.element=r});if(!this.btnConfirmOnEnter&&e.length===2){const s=e.find(r=>!r.isCancel);s&&(this.btnConfirmOnEnter=s.element)}e.length>=3&&t.classList.add("is-vertical-layout"),t.append(...i),this.container.append(t)}attachScrollableListeners(e){return this.scrollable.attachBorderListeners(e)}onContentUpdate(){this.scrollable?.onAdditionalScroll?.()}show(){this.navigationItem={type:"popup",onPop:()=>{if(this.isConfirmationNeededOnClose){const e=this.isConfirmationNeededOnClose();if(e)return Promise.resolve(e).then(()=>{this.destroy()}),!1}return this.destroy()}},w.pushItem(this.navigationItem),Y(),C.append(this.element),this.element.offsetWidth,this.element.classList.add("active"),this.onContentUpdate(),this.withoutOverlay||(A.isOverlayActive=!0,N.checkAnimations2(!0)),setTimeout(()=>{this.element.classList.contains("active")&&this.listenerSetter.add(document.body)("keydown",e=>{!this.btnConfirmOnEnter||this.btnConfirmOnEnter.disabled||p.POPUPS[p.POPUPS.length-1]!==this||(this.confirmShortcutIsSendShortcut?be(e):e.key==="Enter")&&(fe(this.btnConfirmOnEnter),X(e))})},0)}hide(){this.destroyed||!this.navigationItem||w.backByItem(this.navigationItem)}hideWithCallback(e){this.addEventListener("closeAfterTimeout",e),this.hide()}forceHide(){return this.destroy()}destroy(){this.destroyed||(this.destroyed=!0,this.dispatchEvent("close"),this.element.classList.add("hiding"),this.element.classList.remove("active"),this.listenerSetter.removeAll(),this.middlewareHelper.destroy(),this.withoutOverlay||(A.isOverlayActive=!1),w.removeItem(this.navigationItem),this.navigationItem=void 0,z(p.POPUPS,this),G(),setTimeout(()=>{this.element.remove(),this.dispatchEvent("closeAfterTimeout"),this.cleanup(),this.scrollable?.destroy(),this.withoutOverlay||N.checkAnimations2(!1)},250))}static reAppend(){this.POPUPS.forEach(e=>{const{element:t,container:i}=e,s=t.parentElement;s&&s!==C&&C!==i&&C.append(t)})}static getPopups(e){return this.POPUPS.filter(t=>t instanceof e)}static createPopup(e,...t){return new e(...t)}};p.POPUPS=[];let P=p;const xe=n=>(n.find(t=>t.isCancel)||n.push({langKey:"Cancel",isCancel:!0}),n);function Ee(n,e){let t,i,s,r=0,f=0,c=0,m=0,v=0;const F=4,d={},Z=50,x=200,B=200;n.complete?T():n.onload=T;function V(){i.removeEventListener("mousedown",E),i.removeEventListener("touchstart",E),i.removeEventListener("wheel",W),document.removeEventListener("mouseup",g),document.removeEventListener("touchend",g),document.removeEventListener("mousemove",b),document.removeEventListener("touchmove",b),document.removeEventListener("keypress",D),t.remove(),i.remove(),s.remove()}function J(){i.addEventListener("mousedown",E,!1),i.addEventListener("touchstart",E,!1),i.addEventListener("wheel",W,!1),document.addEventListener("keypress",D,!1)}function T(){n.classList.add("crop-blur"),n.draggable=!1,s=new Image,s.src=n.src,s.draggable=!1,s.classList.add("crop-overlay-image"),e||(e=document.createElement("canvas")),t=document.createElement("div"),t.classList.add("crop-component"),i=document.createElement("div"),i.classList.add("crop-overlay");const o=document.createElement("div");o.classList.add("crop-overlay-color"),t.appendChild(i),n.parentNode.appendChild(t),t.appendChild(s),t.appendChild(n),t.appendChild(o),i.appendChild(s),s.style.maxWidth=n.width+"px",v=n.naturalWidth/n.offsetWidth;const h=n.offsetWidth/2-x/2,l=n.offsetHeight/2-B/2;R(x,B),k(h,l),I(h,l),J()}function R(o,a){c=o*v,m=a*v,i.style.width=o+"px",i.style.height=a+"px"}function k(o,a){f=a*v,r=o*v,s.style.top=-a+"px",s.style.left=-o+"px"}function I(o,a){i.style.top=a+"px",i.style.left=o+"px"}function Q(o){d.container_width=i.offsetWidth,d.container_height=i.offsetHeight,d.container_left=i.offsetLeft,d.container_top=i.offsetTop,d.mouse_x=(o.clientX||o.pageX||o.touches&&o.touches[0].clientX)+window.scrollX,d.mouse_y=(o.clientY||o.pageY||o.touches&&o.touches[0].clientY)+window.scrollY}function H(o){o=o*Math.PI*2;const a=Math.floor(i.clientWidth+o),h=Math.floor(i.clientHeight+o),l=s.clientWidth,S=s.clientHeight;let u,y;if(a<Z)return;if(a>l)return;u=i.offsetLeft-o/2,y=i.offsetTop-o/2;const te=u+a,ie=y+h;u<0&&(u=0),y<0&&(y=0),!(te>l)&&(ie>S||(R(a,a),k(u,y),I(u,y)))}function D(o){switch(o.preventDefault(),String.fromCharCode(o.charCode)){case"+":H(F);break;case"-":H(-F);break}}function W(o){o.preventDefault(),H(o.deltaY>0?1:-1)}function E(o){o.preventDefault(),o.stopPropagation(),Q(o),document.addEventListener("mousemove",b),document.addEventListener("touchmove",b),document.addEventListener("mouseup",g),document.addEventListener("touchend",g)}function g(o){o.preventDefault(),document.removeEventListener("mouseup",g),document.removeEventListener("touchend",g),document.removeEventListener("mousemove",b),document.removeEventListener("touchmove",b)}function b(o){const a={x:0,y:0};o.preventDefault(),o.stopPropagation(),a.x=o.pageX||o.touches&&o.touches[0].pageX,a.y=o.pageY||o.touches&&o.touches[0].pageY;let h=a.x-(d.mouse_x-d.container_left),l=a.y-(d.mouse_y-d.container_top);const S=i.offsetWidth,u=i.offsetHeight;h<0?h=0:h>s.offsetWidth-S&&(h=s.offsetWidth-S),l<0?l=0:l>s.offsetHeight-u&&(l=s.offsetHeight-u),k(h,l),I(h,l)}function ee(){e.width=c,e.height=m,e.getContext("2d").drawImage(n,r,f,c,m,0,0,c,m)}return{crop:ee,removeHandlers:V}}function Se(n,e){return new Promise(t=>{const i=new FileReader;i.addEventListener("loadend",s=>{t(s.target.result)}),i[e](n)})}function Le(n){return Se(n,"readAsDataURL")}class Be extends P{constructor(e={}){super("popup-avatar",{closable:!0}),this.image=new Image,this.cropper={crop:()=>{},removeHandlers:()=>{}},this.h6=document.createElement("h6"),j(this.h6,"Popup.Avatar.Title"),this.btnClose.classList.remove("btn-icon"),this.header.append(this.h6),this.cropContainer=document.createElement("div"),this.cropContainer.classList.add("crop"),this.cropContainer.append(this.image),e.isForum&&this.cropContainer.classList.add("is-forum"),this.input=document.createElement("input"),this.input.type="file",this.input.style.display="none",this.listenerSetter.add(this.input)("change",t=>{const i=t.target.files[0];i&&Le(i).then(s=>{this.image=new Image,this.cropContainer.append(this.image),this.image.src=s,this.image.onload=()=>{this.show(),this.cropper=Ee(this.image,this.canvas),this.input.value=""}})},!1),this.btnConfirm=_("btn-primary btn-color-primary btn-circle btn-crop btn-icon z-depth-1",{noRipple:!0,icon:"check"}),L(this.btnConfirm,()=>{this.cropper.crop(),this.hide(),this.canvas.toBlob(t=>{this.blob=t,this.darkenCanvas(),this.resolve()},"image/jpeg",1)},{listenerSetter:this.listenerSetter}),this.container.append(this.cropContainer,this.btnConfirm,this.input),this.addEventListener("closeAfterTimeout",()=>{this.cropper.removeHandlers(),this.image&&this.image.remove()})}resolve(){this.onCrop(()=>re.upload(this.blob))}open(e,t){this.canvas=e,this.onCrop=t,this.input.click()}darkenCanvas(){const e=this.canvas.getContext("2d");e.fillStyle="rgba(0, 0, 0, 0.3)",e.fillRect(0,0,this.canvas.width,this.canvas.height)}}export{Ce as B,P,Be as a,xe as b,w as c,ye as d,Fe as e,Oe as f,Le as g,be as h,ve as i,Ae as r};
-//# sourceMappingURL=avatar-ohgkiWHW.js.map
+import{B as _,I as M,r as se}from"./button-Mm7TqKr1.js";import{o as ne,L as oe,t as ae,D as N,m as re}from"./wrapEmojiText-PAHdiQbe.js";import{ah as q,M as ce,c as X,aq as le,g as Y,F as z,aj as he,a as de,ak as K,E as ue,ai as A,d as j,a8 as pe,i as U}from"./index-M8z-nwNm.js";import{a as L,d as fe}from"./page-kT6kVFv9.js";import{S as me}from"./scrollable-ILmNatrX.js";function ve(n){return q&&n instanceof TouchEvent&&n.touches[0].clientX<30}class ge{constructor(){if(this.onPopState=e=>{const t=window.location.hash,i=e.state;if(this.debug&&this.log("popstate",e,this.isPossibleSwipe,t),t!==this.currentHash)if(this.debug&&this.log.warn(`hash changed, new=${t}, current=${this.currentHash}, overridden=${this.overriddenHash}`),i===this.id&&this.overriddenHash&&this.overriddenHash!==t)this.overrideHash(this.overriddenHash);else if(i&&!this.overriddenHash&&t)this.overrideHash();else{this.currentHash=t,this.onHashChange&&this.onHashChange();return}if(i!==this.id&&(this.pushState(),!this.navigations.length))return;const s=this.navigations.pop();if(!s){this.pushState();return}this.manual=!this.isPossibleSwipe,this.handleItem(s,this.navigations.length)},this.onKeyDown=e=>{const t=this.navigations[this.navigations.length-1];t&&e.key==="Escape"&&(!t.onEscape||t.onEscape())&&(X(e),this.back(t.type))},this.onTouchStart=e=>{e.touches.length>1||(this.debug&&this.log("touchstart"),ve(e)&&(this.isPossibleSwipe=!0,window.addEventListener("touchend",()=>{setTimeout(()=>{this.isPossibleSwipe=!1},100)},{passive:!0,once:!0})))},this.navigations=[],this.id=Date.now(),this.manual=!1,this.log=le("NC"),this.debug=!0,this.currentHash=window.location.hash,this.overriddenHash="",this.isPossibleSwipe=!1,window.addEventListener("popstate",this.onPopState),window.addEventListener("keydown",this.onKeyDown,{capture:!0,passive:!1}),q){const e={passive:!0};window.addEventListener("touchstart",this.onTouchStart,e)}history.scrollRestoration="manual",this.pushState()}overrideHash(e=""){e&&e[0]!=="#"?e="#"+e:e==="#"&&(e=""),this.currentHash!==e&&(this.overriddenHash=this.currentHash=e,this.replaceState(),this.pushState())}handleItem(e,t=this.navigations.indexOf(e)){const i=e.onPop(this.manual?void 0:!1);this.debug&&this.log("popstate, navigation:",e,this.navigations),i===!1?this.spliceItems(Math.min(this.navigations.length,t),0,e):e.noBlurOnPop||Y(),this.manual=!1}findItemByType(e){for(let t=this.navigations.length-1;t>=0;--t){const i=this.navigations[t];if(i.type===e)return{item:i,index:t}}}back(e){if(e){const t=this.findItemByType(e);if(t){this.backByItem(t.item,t.index);return}}history.back()}backByItem(e,t=this.navigations.indexOf(e)){t!==-1&&(this.manual=!0,this.navigations.splice(t,1),this.handleItem(e,t))}onItemAdded(e){this.debug&&this.log("onItemAdded",e,this.navigations),e.noHistory||this.pushState()}pushItem(e){this.navigations.push(e),this.onItemAdded(e)}unshiftItem(e){this.navigations.unshift(e),this.onItemAdded(e)}spliceItems(e,t,...i){this.navigations.splice(e,t,...i),i.forEach(s=>{this.onItemAdded(s)})}pushState(){this.debug&&this.log("push"),this.manual=!1,history.pushState(this.id,"")}replaceState(){this.debug&&this.log.warn("replace");const e=location.origin+location.pathname+location.search+this.overriddenHash;history.replaceState(this.id,"",e)}removeItem(e){e&&z(this.navigations,e)}removeByType(e,t=!1){for(let i=this.navigations.length-1;i>=0&&!(this.navigations[i].type===e&&(this.navigations.splice(i,1),t));--i);}}const w=new ge;ce.appNavigationController=w;function be(n){if(n.key==="Enter"&&!he&&!n.isComposing){if(de.settings.sendShortcut==="enter")return n.shiftKey||n.ctrlKey||n.metaKey?void 0:!0;{const e=K?n.metaKey:n.ctrlKey;if(n.shiftKey||(K?n.ctrlKey:n.metaKey))return;if(e)return!0}}return!1}function Ae(n){n.requestFullscreen?n.requestFullscreen():n.mozRequestFullScreen?n.mozRequestFullScreen():n.webkitRequestFullscreen?n.webkitRequestFullscreen():n.msRequestFullscreen&&n.msRequestFullscreen()}function Oe(){document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen?document.webkitCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen()}function ye(n,e,t){const i=t?t.add(n):n.addEventListener.bind(n);"webkitfullscreenchange mozfullscreenchange fullscreenchange MSFullscreenChange".split(" ").forEach(s=>{i(s,e,!1)})}function $(){return document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement}function Fe(){return!!$()}const Ce=(n,e={})=>{const t=n?.split(" ");return _("btn-icon"+(t?.length>1?" "+t.slice(1).join(" "):""),{icon:t?.[0]||void 0,...e})},O=document.body;let C=O;const G=()=>{C=$()||O,P.reAppend()};ye(O,G);const p=class p extends ue{constructor(e,t={}){if(super(!1),this.element=document.createElement("div"),this.container=document.createElement("div"),this.header=document.createElement("div"),this.title=document.createElement("div"),this.element.classList.add("popup"),this.element.className="popup"+(e?" "+e:""),this.container.classList.add("popup-container","z-depth-1"),A.isDarkOverlayActive&&(this.night=!0,this.element.classList.add("night")),this.header.classList.add("popup-header"),t.title&&(this.title.classList.add("popup-title"),typeof t.title=="string"?j(this.title,t.title):typeof t.title!="boolean"&&this.title.append(t.title),this.header.append(this.title)),this.isConfirmationNeededOnClose=t.isConfirmationNeededOnClose,this.middlewareHelper=ne(),this.listenerSetter=new oe,this.managers=p.MANAGERS,this.confirmShortcutIsSendShortcut=t.confirmShortcutIsSendShortcut,t.closable&&(this.btnClose=Ce("",{noRipple:!0}),this.btnClose.classList.add("popup-close"),this.header.prepend(this.btnClose),t.onBackClick?(this.btnCloseAnimatedIcon=document.createElement("div"),this.btnCloseAnimatedIcon.classList.add("animated-close-icon"),this.btnClose.append(this.btnCloseAnimatedIcon)):this.btnClose.append(M("close")),L(this.btnClose,()=>{t.onBackClick&&this.btnCloseAnimatedIcon.classList.contains("state-back")?(this.btnCloseAnimatedIcon.classList.remove("state-back"),t.onBackClick()):this.hide()},{listenerSetter:this.listenerSetter})),this.withoutOverlay=t.withoutOverlay,this.withoutOverlay&&this.element.classList.add("no-overlay"),t.overlayClosable&&L(this.element,i=>{pe(i.target,"popup-container")||!i.target.isConnected||this.hide()},{listenerSetter:this.listenerSetter}),t.withConfirm&&(this.btnConfirm=document.createElement("button"),this.btnConfirm.classList.add("btn-primary","btn-color-primary"),t.withConfirm!==!0&&this.btnConfirm.append(U(t.withConfirm)),this.header.append(this.btnConfirm)),this.container.append(this.header),t.body&&(this.body=document.createElement("div"),this.body.classList.add("popup-body"),this.container.append(this.body)),t.scrollable){const i=this.scrollable=new me(this.body);if(this.attachScrollableListeners(),t.floatingHeader){this.attachScrollableListeners(this.header);const s=document.createElement("div");s.classList.add("popup-header-background"),this.header.prepend(s),this.header.classList.add("is-floating")}this.body||this.header.after(i.container)}t.footer&&(this.footer=document.createElement("div"),this.footer.classList.add("popup-footer"),(this.body||this.container).append(this.footer)),this.btnConfirmOnEnter=this.btnConfirm,this.setButtons(t.buttons),this.element.append(this.container),p.POPUPS.push(this)}setButtons(e){if(this.buttons=e,this.buttonsEl&&(this.buttonsEl.remove(),this.buttonsEl=void 0),!e?.length)return;const t=this.buttonsEl=document.createElement("div");t.classList.add("popup-buttons");const i=e.map(s=>{const r=document.createElement("button");if(r.className="popup-button btn"+(s.isDanger?" danger":" primary"),s.noRipple||se(r),s.text?r.append(s.text):s.langKey&&r.append(U(s.langKey,s.langArgs)),s.iconLeft||s.iconRight){const f=M(s.iconLeft||s.iconRight,"popup-button-icon",s.iconLeft?"left":"right");r.classList.add("with-icon"),s.iconLeft?r.prepend(f):r.append(f)}return L(r,async f=>{let c=s.callback?.(f);if(c!==void 0&&c instanceof Promise){const m=ae([s.element],!0);try{c=await c}catch{c=!1}c===!1&&m()}c!==!1&&this.hide()},{listenerSetter:this.listenerSetter}),s.element=r});if(!this.btnConfirmOnEnter&&e.length===2){const s=e.find(r=>!r.isCancel);s&&(this.btnConfirmOnEnter=s.element)}e.length>=3&&t.classList.add("is-vertical-layout"),t.append(...i),this.container.append(t)}attachScrollableListeners(e){return this.scrollable.attachBorderListeners(e)}onContentUpdate(){this.scrollable?.onAdditionalScroll?.()}show(){this.navigationItem={type:"popup",onPop:()=>{if(this.isConfirmationNeededOnClose){const e=this.isConfirmationNeededOnClose();if(e)return Promise.resolve(e).then(()=>{this.destroy()}),!1}return this.destroy()}},w.pushItem(this.navigationItem),Y(),C.append(this.element),this.element.offsetWidth,this.element.classList.add("active"),this.onContentUpdate(),this.withoutOverlay||(A.isOverlayActive=!0,N.checkAnimations2(!0)),setTimeout(()=>{this.element.classList.contains("active")&&this.listenerSetter.add(document.body)("keydown",e=>{!this.btnConfirmOnEnter||this.btnConfirmOnEnter.disabled||p.POPUPS[p.POPUPS.length-1]!==this||(this.confirmShortcutIsSendShortcut?be(e):e.key==="Enter")&&(fe(this.btnConfirmOnEnter),X(e))})},0)}hide(){this.destroyed||!this.navigationItem||w.backByItem(this.navigationItem)}hideWithCallback(e){this.addEventListener("closeAfterTimeout",e),this.hide()}forceHide(){return this.destroy()}destroy(){this.destroyed||(this.destroyed=!0,this.dispatchEvent("close"),this.element.classList.add("hiding"),this.element.classList.remove("active"),this.listenerSetter.removeAll(),this.middlewareHelper.destroy(),this.withoutOverlay||(A.isOverlayActive=!1),w.removeItem(this.navigationItem),this.navigationItem=void 0,z(p.POPUPS,this),G(),setTimeout(()=>{this.element.remove(),this.dispatchEvent("closeAfterTimeout"),this.cleanup(),this.scrollable?.destroy(),this.withoutOverlay||N.checkAnimations2(!1)},250))}static reAppend(){this.POPUPS.forEach(e=>{const{element:t,container:i}=e,s=t.parentElement;s&&s!==C&&C!==i&&C.append(t)})}static getPopups(e){return this.POPUPS.filter(t=>t instanceof e)}static createPopup(e,...t){return new e(...t)}};p.POPUPS=[];let P=p;const xe=n=>(n.find(t=>t.isCancel)||n.push({langKey:"Cancel",isCancel:!0}),n);function Ee(n,e){let t,i,s,r=0,f=0,c=0,m=0,v=0;const F=4,d={},Z=50,x=200,B=200;n.complete?T():n.onload=T;function V(){i.removeEventListener("mousedown",E),i.removeEventListener("touchstart",E),i.removeEventListener("wheel",W),document.removeEventListener("mouseup",g),document.removeEventListener("touchend",g),document.removeEventListener("mousemove",b),document.removeEventListener("touchmove",b),document.removeEventListener("keypress",D),t.remove(),i.remove(),s.remove()}function J(){i.addEventListener("mousedown",E,!1),i.addEventListener("touchstart",E,!1),i.addEventListener("wheel",W,!1),document.addEventListener("keypress",D,!1)}function T(){n.classList.add("crop-blur"),n.draggable=!1,s=new Image,s.src=n.src,s.draggable=!1,s.classList.add("crop-overlay-image"),e||(e=document.createElement("canvas")),t=document.createElement("div"),t.classList.add("crop-component"),i=document.createElement("div"),i.classList.add("crop-overlay");const o=document.createElement("div");o.classList.add("crop-overlay-color"),t.appendChild(i),n.parentNode.appendChild(t),t.appendChild(s),t.appendChild(n),t.appendChild(o),i.appendChild(s),s.style.maxWidth=n.width+"px",v=n.naturalWidth/n.offsetWidth;const h=n.offsetWidth/2-x/2,l=n.offsetHeight/2-B/2;R(x,B),k(h,l),I(h,l),J()}function R(o,a){c=o*v,m=a*v,i.style.width=o+"px",i.style.height=a+"px"}function k(o,a){f=a*v,r=o*v,s.style.top=-a+"px",s.style.left=-o+"px"}function I(o,a){i.style.top=a+"px",i.style.left=o+"px"}function Q(o){d.container_width=i.offsetWidth,d.container_height=i.offsetHeight,d.container_left=i.offsetLeft,d.container_top=i.offsetTop,d.mouse_x=(o.clientX||o.pageX||o.touches&&o.touches[0].clientX)+window.scrollX,d.mouse_y=(o.clientY||o.pageY||o.touches&&o.touches[0].clientY)+window.scrollY}function H(o){o=o*Math.PI*2;const a=Math.floor(i.clientWidth+o),h=Math.floor(i.clientHeight+o),l=s.clientWidth,S=s.clientHeight;let u,y;if(a<Z)return;if(a>l)return;u=i.offsetLeft-o/2,y=i.offsetTop-o/2;const te=u+a,ie=y+h;u<0&&(u=0),y<0&&(y=0),!(te>l)&&(ie>S||(R(a,a),k(u,y),I(u,y)))}function D(o){switch(o.preventDefault(),String.fromCharCode(o.charCode)){case"+":H(F);break;case"-":H(-F);break}}function W(o){o.preventDefault(),H(o.deltaY>0?1:-1)}function E(o){o.preventDefault(),o.stopPropagation(),Q(o),document.addEventListener("mousemove",b),document.addEventListener("touchmove",b),document.addEventListener("mouseup",g),document.addEventListener("touchend",g)}function g(o){o.preventDefault(),document.removeEventListener("mouseup",g),document.removeEventListener("touchend",g),document.removeEventListener("mousemove",b),document.removeEventListener("touchmove",b)}function b(o){const a={x:0,y:0};o.preventDefault(),o.stopPropagation(),a.x=o.pageX||o.touches&&o.touches[0].pageX,a.y=o.pageY||o.touches&&o.touches[0].pageY;let h=a.x-(d.mouse_x-d.container_left),l=a.y-(d.mouse_y-d.container_top);const S=i.offsetWidth,u=i.offsetHeight;h<0?h=0:h>s.offsetWidth-S&&(h=s.offsetWidth-S),l<0?l=0:l>s.offsetHeight-u&&(l=s.offsetHeight-u),k(h,l),I(h,l)}function ee(){e.width=c,e.height=m,e.getContext("2d").drawImage(n,r,f,c,m,0,0,c,m)}return{crop:ee,removeHandlers:V}}function Se(n,e){return new Promise(t=>{const i=new FileReader;i.addEventListener("loadend",s=>{t(s.target.result)}),i[e](n)})}function Le(n){return Se(n,"readAsDataURL")}class Be extends P{constructor(e={}){super("popup-avatar",{closable:!0}),this.image=new Image,this.cropper={crop:()=>{},removeHandlers:()=>{}},this.h6=document.createElement("h6"),j(this.h6,"Popup.Avatar.Title"),this.btnClose.classList.remove("btn-icon"),this.header.append(this.h6),this.cropContainer=document.createElement("div"),this.cropContainer.classList.add("crop"),this.cropContainer.append(this.image),e.isForum&&this.cropContainer.classList.add("is-forum"),this.input=document.createElement("input"),this.input.type="file",this.input.style.display="none",this.listenerSetter.add(this.input)("change",t=>{const i=t.target.files[0];i&&Le(i).then(s=>{this.image=new Image,this.cropContainer.append(this.image),this.image.src=s,this.image.onload=()=>{this.show(),this.cropper=Ee(this.image,this.canvas),this.input.value=""}})},!1),this.btnConfirm=_("btn-primary btn-color-primary btn-circle btn-crop btn-icon z-depth-1",{noRipple:!0,icon:"check"}),L(this.btnConfirm,()=>{this.cropper.crop(),this.hide(),this.canvas.toBlob(t=>{this.blob=t,this.darkenCanvas(),this.resolve()},"image/jpeg",1)},{listenerSetter:this.listenerSetter}),this.container.append(this.cropContainer,this.btnConfirm,this.input),this.addEventListener("closeAfterTimeout",()=>{this.cropper.removeHandlers(),this.image&&this.image.remove()})}resolve(){this.onCrop(()=>re.upload(this.blob))}open(e,t){this.canvas=e,this.onCrop=t,this.input.click()}darkenCanvas(){const e=this.canvas.getContext("2d");e.fillStyle="rgba(0, 0, 0, 0.3)",e.fillRect(0,0,this.canvas.width,this.canvas.height)}}export{Ce as B,P,Be as a,xe as b,w as c,ye as d,Fe as e,Oe as f,Le as g,be as h,ve as i,Ae as r};
+//# sourceMappingURL=avatar-HalcuPNE.js.map

--- public/button-Mm7TqKr1.js ---
@@ -1,2 +1,2 @@
-import{M as w,k as L,h as I,I as y,j as k,a8 as x,e as M,ch as A,i as D}from"./index-XZA1-3MU.js";import{i as R,f as O}from"./page-eb81Un_i.js";class P{constructor(){this.promises={},this.raf=L.bind(null),this.scheduled=!1}do(e,t){let r=this.promises[e];return r||(this.scheduleFlush(),r=this.promises[e]=I()),t!==void 0&&r.then(()=>t()),r}measure(e){return this.do("read",e)}mutate(e){return this.do("write",e)}mutateElement(e,t){const r=R(e),n=r?this.mutate():Promise.resolve();return t!==void 0&&(r?n.then(()=>t()):t()),n}scheduleFlush(){this.scheduled||(this.scheduled=!0,this.raf(()=>{this.promises.read&&this.promises.read.resolve(),this.promises.write&&this.promises.write.resolve(),this.scheduled=!1,this.promises={}}))}}const E=new P;w&&(w.sequentialDom=E);let T=0;function U(i,e=()=>Promise.resolve(),t=null,r=!1,n=i){if(i.querySelector(".c-ripple"))return;i.classList.add("rp");const d=document.createElement("div");d.classList.add("c-ripple"),i.classList.contains("rp-square")&&d.classList.add("is-square"),i[r?"prepend":"append"](d);let l;const g=(a,c)=>{const p=Date.now(),s=document.createElement("div"),m=T++,f=+window.getComputedStyle(d).getPropertyValue("--ripple-duration").replace("s","")*1e3,S=l=()=>{const o=Date.now()-p,h=()=>{E.mutate(()=>{s.remove()}),t?.(m)};if(o<f){const _=Math.max(f-o,f/2);setTimeout(()=>s.classList.add("hiding"),Math.max(_-f/2,0)),setTimeout(h,_)}else s.classList.add("hiding"),setTimeout(h,f/2);y||(window.removeEventListener("contextmenu",l),window.removeEventListener("mousemove",l)),l=null,u=!1};e?.(m),L(()=>{if(S!==l)return;const o=d.getBoundingClientRect();s.classList.add("c-ripple__circle");const h=a-o.left,_=c-o.top,b=Math.sqrt((Math.abs(_-o.height/2)+o.height/2)**2+(Math.abs(h-o.width/2)+o.width/2)**2),q=h-b/2,C=_-b/2;s.style.width=s.style.height=b+"px",s.style.left=q+"px",s.style.top=C+"px",s.style.opacity="0",d.append(s),s.offsetWidth,s.style.opacity=""})},v=a=>a.target!==i&&(["BUTTON","A"].includes(a.target.tagName)||x(a.target,"c-ripple")!==d)&&(n===i||!O(a.target,n))&&!x(a.target,"checkbox-field");let u=!1;if(y){const a=()=>{l?.()};n.addEventListener("touchstart",c=>{if(!k.isAvailable("animations")||c.touches.length>1||u||v(c))return;u=!0;const{clientX:p,clientY:s}=c.touches[0];g(p,s),n.addEventListener("touchend",a,{once:!0}),window.addEventListener("touchmove",m=>{m.cancelBubble=!0,m.stopPropagation(),a(),n.removeEventListener("touchend",a)},{once:!0})},{passive:!0})}else n.addEventListener("mousedown",a=>{if(![0,2].includes(a.button)||!k.isAvailable("animations")||n.dataset.ripple==="0"||v(a))return;if(u){u=!1;return}const{clientX:c,clientY:p}=a;g(c,p),window.addEventListener("mouseup",l,{once:!0,passive:!0}),window.addEventListener("contextmenu",l,{once:!0,passive:!0})},{passive:!0})}const z={check:"e900",checks:"e901",activesessions:"e902",add:"e903",add_reaction:"e904",addboost:"e905",addmember_filled:"e906",adduser:"e907",admin:"e908",animals:"e909",animations:"e90a",archive:"e90b",arrow_down:"e90c",arrow_next:"e90d",arrowcircle:"e90e",attach:"e90f",audio_repeat:"e910",audio_repeat_single:"e911",author_hidden:"e912",avatarnext:"e913",avatarprevious:"e914",binfilled:"e915",bold:"e916",bomb:"e917",boost:"e918",boostcircle:"e919",botcom:"e91a",bots:"e91b",bug:"e91c",calendar:"e91d",calendarfilter:"e91e",camera:"e91f",cameraadd:"e920",car:"e921",card:"e922",card_outline:"e923",channel:"e924",channelviews:"e925",chatspinned:"e926",chatsplaceholder:"e927",check1:"e928",checkbox:"e929",checkboxblock:"e92a",checkboxempty:"e92b",checkboxon:"e92c",checkretract:"e92d",checkround:"e92e",checkround_filled:"e92f",clock:"e930",close:"e931",clouddownload:"e932",colorize:"e933",comments:"e934",commentssticker:"e935",copy:"e936",crossround:"e937",darkmode:"e938",data:"e939",delete:"e93a",delete_filled:"e93b",deletedaccount:"e93c",deleteleft:"e93d",deleteuser:"e93e",devices:"e93f",document:"e940",down:"e941",download:"e942",dragfiles:"e943",dragmedia:"e944",eats:"e945",edit:"e946",email:"e947",endcall_filled:"e948",enter:"e949",eye:"e94a",eye1:"e94b",eye2:"e94c",eyecross_outline:"e94d",fast_forward:"e94e",fast_rewind:"e94f",favourites:"e950",flag:"e951",flip:"e952",folder:"e953",fontsize:"e954",forward:"e955",forward_filled:"e956",fullscreen:"e957",gc_microphone:"e958",gc_microphoneoff:"e959",gifs:"e95a",gift:"e95b",gift_premium:"e95c",group:"e95d",group_filled:"e95e",groupmedia:"e95f",groupmediaoff:"e960",hand:"e961",help:"e962",hide:"e963",image:"e964",info:"e965",info2:"e966",italic:"e967",keyboard:"e968",lamp:"e969",language:"e96a",largepause:"e96b",largeplay:"e96c",left:"e96d",limit_chat:"e96e",limit_chats:"e96f",limit_file:"e970",limit_folders:"e971",limit_link:"e972",limit_pin:"e973",link:"e974",list:"e975",listscreenshare:"e976",livelocation:"e977",location:"e978",lock:"e979",lockoff:"e97a",loginlogodesktop:"e97b",loginlogomobile:"e97c",logout:"e97d",mediaspoiler:"e97e",mediaspoileroff:"e97f",mention:"e980",menu:"e981",message:"e982",message_jump:"e983",message_quote:"e984",messageunread:"e985",microphone:"e986",microphone_crossed:"e987",microphone_crossed_filled:"e988",microphone_filled:"e989",minus:"e98a",monospace:"e98b",more:"e98c",multistories:"e98d",mute:"e98e",muted:"e98f",mynotes:"e990",newchannel:"e991",newchannel_filled:"e992",newchat_filled:"e993",newgroup:"e994",newgroup_filled:"e995",newprivate:"e996",newprivate_filled:"e997",newtab:"e998",next:"e999",noncontacts:"e99a",nosound:"e99b",online:"e99c",passwordoff:"e99d",pause:"e99e",permissions:"e99f",phone:"e9a0",phone_filled:"e9a1",pin:"e9a2",pinlist:"e9a3",pinned_filled:"e9a4",pinnedchat:"e9a5",pip:"e9a6",play:"e9a7",playback_05:"e9a8",playback_15:"e9a9",playback_1x:"e9aa",playback_2x:"e9ab",plus:"e9ac",plusround:"e9ad",poll:"e9ae",premium_addone:"e9af",premium_avatars:"e9b0",premium_badge:"e9b1",premium_colors:"e9b2",premium_double:"e9b3",premium_emoji:"e9b4",premium_filesize:"e9b5",premium_lastseen:"e9b6",premium_limits:"e9b7",premium_lock:"e9b8",premium_management:"e9b9",premium_noads:"e9ba",premium_privacy:"e9bb",premium_reactions:"e9bc",premium_restrict:"e9bd",premium_speed:"e9be",premium_status:"e9bf",premium_stickers:"e9c0",premium_tags:"e9c1",premium_transcription:"e9c2",premium_translate:"e9c3",premium_unlock:"e9c4",premium_wallpaper:"e9c5",previous:"e9c6",promote:"e9c7",quote:"e9c8",quote_outline:"e9c9",radiooff:"e9ca",radioon:"e9cb",reactions:"e9cc",reactions_filled:"e9cd",readchats:"e9ce",recent:"e9cf",replace:"e9d0",reply:"e9d1",reply_filled:"e9d2",restrict:"e9d3",rightpanel:"e9d4",rotate_left:"e9d5",rotate_right:"e9d6",saved:"e9d7",savedmessages:"e9d8",schedule:"e9d9",scheduled:"e9da",search:"e9db",select:"e9dc",send:"e9dd",send2:"e9de",sending:"e9df",sendingerror:"e9e0",settings:"e9e1",settings_filled:"e9e2",sharescreen_filled:"e9e3",shipping:"e9e4",shuffle:"e9e5",smallscreen:"e9e6",smile:"e9e7",speaker:"e9e8",speakerfilled:"e9e9",speakeroff:"e9ea",speakerofffilled:"e9eb",spoiler:"e9ec",sport:"e9ed",star:"e9ee",star_filled:"e9ef",statistics:"e9f0",stickers:"e9f1",stickers_face:"e9f2",stop:"e9f3",stories:"e9f4",storyreply:"e9f5",storyrepost:"e9f6",strikethrough:"e9f7",tag:"e9f8",tag_add:"e9f9",tag_crossed:"e9fa",tag_filter:"e9fb",tag_name:"e9fc",textedit:"e9fd",timer:"e9fe",tip:"e9ff",tools:"ea00",topics:"ea01",transcribe:"ea02",unarchive:"ea03",unclaimed:"ea04",underline:"ea05",unmute:"ea06",unpin:"ea07",unread:"ea08",up:"ea09",user:"ea0a",username:"ea0b",videocamera:"ea0c",videocamera_crossed_filled:"ea0d",videocamera_filled:"ea0e",videochat:"ea0f",volume_down:"ea10",volume_mute:"ea11",volume_off:"ea12",volume_up:"ea13",webview:"ea14",zoomin:"ea15",zoomout:"ea16"},B=new Set(["avatarnext","avatarprevious","arrow_next","channel","chatspinned","fast_forward","fast_rewind","forward","forward_filled","group","group_filled","left","listscreenshare","logout","muted","newchannel_filled","newchannel","newgroup","newgroup_filled","next","nosound","previous","send","send2","reply","reply_filled","sharescreen_filled","transcribe","storyreply","premium_noads","topics","pinlist","deleteleft"]);function N(i){return String.fromCharCode(parseInt(z[i],16))}function j(i,...e){const t=document.createElement("span");return M.isRTL&&B.has(i)&&e.push("icon-reflect"),t.classList.add(A,...e),t.textContent=N(i),t}function H(i,e={}){const t=document.createElement(e.asLink?"a":e.asDiv?"div":"button");return t.className=i,e.noRipple||(e.rippleSquare&&t.classList.add("rp-square"),U(t)),e.icon&&F(t,e.icon,!1),e.onlyMobile&&t.classList.add("only-handhelds"),e.disabled&&t.setAttribute("disabled","true"),e.text&&t.append(D(e.text,e.textArgs)),t}function F(i,e,t=i.querySelector(".button-icon")){const r=j(e,"button-icon");return t?t.replaceWith(r):i.append(r),r}export{H as B,j as I,F as a,N as g,U as r,E as s};
-//# sourceMappingURL=button-aS2SE0kp.js.map
+import{M as w,k as L,h as I,I as y,j as k,a8 as x,e as M,ch as A,i as D}from"./index-M8z-nwNm.js";import{i as R,f as O}from"./page-kT6kVFv9.js";class P{constructor(){this.promises={},this.raf=L.bind(null),this.scheduled=!1}do(e,t){let r=this.promises[e];return r||(this.scheduleFlush(),r=this.promises[e]=I()),t!==void 0&&r.then(()=>t()),r}measure(e){return this.do("read",e)}mutate(e){return this.do("write",e)}mutateElement(e,t){const r=R(e),n=r?this.mutate():Promise.resolve();return t!==void 0&&(r?n.then(()=>t()):t()),n}scheduleFlush(){this.scheduled||(this.scheduled=!0,this.raf(()=>{this.promises.read&&this.promises.read.resolve(),this.promises.write&&this.promises.write.resolve(),this.scheduled=!1,this.promises={}}))}}const E=new P;w&&(w.sequentialDom=E);let T=0;function U(i,e=()=>Promise.resolve(),t=null,r=!1,n=i){if(i.querySelector(".c-ripple"))return;i.classList.add("rp");const d=document.createElement("div");d.classList.add("c-ripple"),i.classList.contains("rp-square")&&d.classList.add("is-square"),i[r?"prepend":"append"](d);let l;const g=(a,c)=>{const p=Date.now(),s=document.createElement("div"),m=T++,f=+window.getComputedStyle(d).getPropertyValue("--ripple-duration").replace("s","")*1e3,S=l=()=>{const o=Date.now()-p,h=()=>{E.mutate(()=>{s.remove()}),t?.(m)};if(o<f){const _=Math.max(f-o,f/2);setTimeout(()=>s.classList.add("hiding"),Math.max(_-f/2,0)),setTimeout(h,_)}else s.classList.add("hiding"),setTimeout(h,f/2);y||(window.removeEventListener("contextmenu",l),window.removeEventListener("mousemove",l)),l=null,u=!1};e?.(m),L(()=>{if(S!==l)return;const o=d.getBoundingClientRect();s.classList.add("c-ripple__circle");const h=a-o.left,_=c-o.top,b=Math.sqrt((Math.abs(_-o.height/2)+o.height/2)**2+(Math.abs(h-o.width/2)+o.width/2)**2),q=h-b/2,C=_-b/2;s.style.width=s.style.height=b+"px",s.style.left=q+"px",s.style.top=C+"px",s.style.opacity="0",d.append(s),s.offsetWidth,s.style.opacity=""})},v=a=>a.target!==i&&(["BUTTON","A"].includes(a.target.tagName)||x(a.target,"c-ripple")!==d)&&(n===i||!O(a.target,n))&&!x(a.target,"checkbox-field");let u=!1;if(y){const a=()=>{l?.()};n.addEventListener("touchstart",c=>{if(!k.isAvailable("animations")||c.touches.length>1||u||v(c))return;u=!0;const{clientX:p,clientY:s}=c.touches[0];g(p,s),n.addEventListener("touchend",a,{once:!0}),window.addEventListener("touchmove",m=>{m.cancelBubble=!0,m.stopPropagation(),a(),n.removeEventListener("touchend",a)},{once:!0})},{passive:!0})}else n.addEventListener("mousedown",a=>{if(![0,2].includes(a.button)||!k.isAvailable("animations")||n.dataset.ripple==="0"||v(a))return;if(u){u=!1;return}const{clientX:c,clientY:p}=a;g(c,p),window.addEventListener("mouseup",l,{once:!0,passive:!0}),window.addEventListener("contextmenu",l,{once:!0,passive:!0})},{passive:!0})}const z={check:"e900",checks:"e901",activesessions:"e902",add:"e903",add_reaction:"e904",addboost:"e905",addmember_filled:"e906",adduser:"e907",admin:"e908",animals:"e909",animations:"e90a",archive:"e90b",arrow_down:"e90c",arrow_next:"e90d",arrowcircle:"e90e",attach:"e90f",audio_repeat:"e910",audio_repeat_single:"e911",author_hidden:"e912",avatarnext:"e913",avatarprevious:"e914",binfilled:"e915",bold:"e916",bomb:"e917",boost:"e918",boostcircle:"e919",botcom:"e91a",bots:"e91b",bug:"e91c",calendar:"e91d",calendarfilter:"e91e",camera:"e91f",cameraadd:"e920",car:"e921",card:"e922",card_outline:"e923",channel:"e924",channelviews:"e925",chatspinned:"e926",chatsplaceholder:"e927",check1:"e928",checkbox:"e929",checkboxblock:"e92a",checkboxempty:"e92b",checkboxon:"e92c",checkretract:"e92d",checkround:"e92e",checkround_filled:"e92f",clock:"e930",close:"e931",clouddownload:"e932",colorize:"e933",comments:"e934",commentssticker:"e935",copy:"e936",crossround:"e937",darkmode:"e938",data:"e939",delete:"e93a",delete_filled:"e93b",deletedaccount:"e93c",deleteleft:"e93d",deleteuser:"e93e",devices:"e93f",document:"e940",down:"e941",download:"e942",dragfiles:"e943",dragmedia:"e944",eats:"e945",edit:"e946",email:"e947",endcall_filled:"e948",enter:"e949",eye:"e94a",eye1:"e94b",eye2:"e94c",eyecross_outline:"e94d",fast_forward:"e94e",fast_rewind:"e94f",favourites:"e950",flag:"e951",flip:"e952",folder:"e953",fontsize:"e954",forward:"e955",forward_filled:"e956",fullscreen:"e957",gc_microphone:"e958",gc_microphoneoff:"e959",gifs:"e95a",gift:"e95b",gift_premium:"e95c",group:"e95d",group_filled:"e95e",groupmedia:"e95f",groupmediaoff:"e960",hand:"e961",help:"e962",hide:"e963",image:"e964",info:"e965",info2:"e966",italic:"e967",keyboard:"e968",lamp:"e969",language:"e96a",largepause:"e96b",largeplay:"e96c",left:"e96d",limit_chat:"e96e",limit_chats:"e96f",limit_file:"e970",limit_folders:"e971",limit_link:"e972",limit_pin:"e973",link:"e974",list:"e975",listscreenshare:"e976",livelocation:"e977",location:"e978",lock:"e979",lockoff:"e97a",loginlogodesktop:"e97b",loginlogomobile:"e97c",logout:"e97d",mediaspoiler:"e97e",mediaspoileroff:"e97f",mention:"e980",menu:"e981",message:"e982",message_jump:"e983",message_quote:"e984",messageunread:"e985",microphone:"e986",microphone_crossed:"e987",microphone_crossed_filled:"e988",microphone_filled:"e989",minus:"e98a",monospace:"e98b",more:"e98c",multistories:"e98d",mute:"e98e",muted:"e98f",mynotes:"e990",newchannel:"e991",newchannel_filled:"e992",newchat_filled:"e993",newgroup:"e994",newgroup_filled:"e995",newprivate:"e996",newprivate_filled:"e997",newtab:"e998",next:"e999",noncontacts:"e99a",nosound:"e99b",online:"e99c",passwordoff:"e99d",pause:"e99e",permissions:"e99f",phone:"e9a0",phone_filled:"e9a1",pin:"e9a2",pinlist:"e9a3",pinned_filled:"e9a4",pinnedchat:"e9a5",pip:"e9a6",play:"e9a7",playback_05:"e9a8",playback_15:"e9a9",playback_1x:"e9aa",playback_2x:"e9ab",plus:"e9ac",plusround:"e9ad",poll:"e9ae",premium_addone:"e9af",premium_avatars:"e9b0",premium_badge:"e9b1",premium_colors:"e9b2",premium_double:"e9b3",premium_emoji:"e9b4",premium_filesize:"e9b5",premium_lastseen:"e9b6",premium_limits:"e9b7",premium_lock:"e9b8",premium_management:"e9b9",premium_noads:"e9ba",premium_privacy:"e9bb",premium_reactions:"e9bc",premium_restrict:"e9bd",premium_speed:"e9be",premium_status:"e9bf",premium_stickers:"e9c0",premium_tags:"e9c1",premium_transcription:"e9c2",premium_translate:"e9c3",premium_unlock:"e9c4",premium_wallpaper:"e9c5",previous:"e9c6",promote:"e9c7",quote:"e9c8",quote_outline:"e9c9",radiooff:"e9ca",radioon:"e9cb",reactions:"e9cc",reactions_filled:"e9cd",readchats:"e9ce",recent:"e9cf",replace:"e9d0",reply:"e9d1",reply_filled:"e9d2",restrict:"e9d3",rightpanel:"e9d4",rotate_left:"e9d5",rotate_right:"e9d6",saved:"e9d7",savedmessages:"e9d8",schedule:"e9d9",scheduled:"e9da",search:"e9db",select:"e9dc",send:"e9dd",send2:"e9de",sending:"e9df",sendingerror:"e9e0",settings:"e9e1",settings_filled:"e9e2",sharescreen_filled:"e9e3",shipping:"e9e4",shuffle:"e9e5",smallscreen:"e9e6",smile:"e9e7",speaker:"e9e8",speakerfilled:"e9e9",speakeroff:"e9ea",speakerofffilled:"e9eb",spoiler:"e9ec",sport:"e9ed",star:"e9ee",star_filled:"e9ef",statistics:"e9f0",stickers:"e9f1",stickers_face:"e9f2",stop:"e9f3",stories:"e9f4",storyreply:"e9f5",storyrepost:"e9f6",strikethrough:"e9f7",tag:"e9f8",tag_add:"e9f9",tag_crossed:"e9fa",tag_filter:"e9fb",tag_name:"e9fc",textedit:"e9fd",timer:"e9fe",tip:"e9ff",tools:"ea00",topics:"ea01",transcribe:"ea02",unarchive:"ea03",unclaimed:"ea04",underline:"ea05",unmute:"ea06",unpin:"ea07",unread:"ea08",up:"ea09",user:"ea0a",username:"ea0b",videocamera:"ea0c",videocamera_crossed_filled:"ea0d",videocamera_filled:"ea0e",videochat:"ea0f",volume_down:"ea10",volume_mute:"ea11",volume_off:"ea12",volume_up:"ea13",webview:"ea14",zoomin:"ea15",zoomout:"ea16"},B=new Set(["avatarnext","avatarprevious","arrow_next","channel","chatspinned","fast_forward","fast_rewind","forward","forward_filled","group","group_filled","left","listscreenshare","logout","muted","newchannel_filled","newchannel","newgroup","newgroup_filled","next","nosound","previous","send","send2","reply","reply_filled","sharescreen_filled","transcribe","storyreply","premium_noads","topics","pinlist","deleteleft"]);function N(i){return String.fromCharCode(parseInt(z[i],16))}function j(i,...e){const t=document.createElement("span");return M.isRTL&&B.has(i)&&e.push("icon-reflect"),t.classList.add(A,...e),t.textContent=N(i),t}function H(i,e={}){const t=document.createElement(e.asLink?"a":e.asDiv?"div":"button");return t.className=i,e.noRipple||(e.rippleSquare&&t.classList.add("rp-square"),U(t)),e.icon&&F(t,e.icon,!1),e.onlyMobile&&t.classList.add("only-handhelds"),e.disabled&&t.setAttribute("disabled","true"),e.text&&t.append(D(e.text,e.textArgs)),t}function F(i,e,t=i.querySelector(".button-icon")){const r=j(e,"button-icon");return t?t.replaceWith(r):i.append(r),r}export{H as B,j as I,F as a,N as g,U as r,E as s};
+//# sourceMappingURL=button-Mm7TqKr1.js.map

--- public/button-Mm7TqKr1.js.map ---
@@ -1 +1 @@
-{"version":3,"file":"button-aS2SE0kp.js","sources":["../src/helpers/sequentialDom.ts","../src/components/ripple.ts","../src/icons.ts","../src/iconsReverse.ts","../src/components/icon.ts","../src/components/button.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {fastRaf} from './schedulers';\nimport deferredPromise, {CancellablePromise} from './cancellablePromise';\nimport {MOUNT_CLASS_TO} from '../config/debug';\nimport isInDOM from './dom/isInDOM';\n\nclass SequentialDom {\n  private promises: Partial<{\n    read: CancellablePromise<void>,\n    write: CancellablePromise<void>\n  }> = {};\n  private raf = fastRaf.bind(null);\n  private scheduled = false;\n\n  private do(kind: keyof SequentialDom['promises'], callback?: VoidFunction) {\n    let promise = this.promises[kind];\n    if(!promise) {\n      this.scheduleFlush();\n      promise = this.promises[kind] = deferredPromise<void>();\n    }\n\n    if(callback !== undefined) {\n      promise.then(() => callback());\n    }\n\n    return promise;\n  }\n\n  public measure(callback?: VoidFunction) {\n    return this.do('read', callback);\n  }\n\n  public mutate(callback?: VoidFunction) {\n    return this.do('write', callback);\n  }\n\n  /**\n   * Will fire instantly if element is not connected\n   * @param element\n   * @param callback\n   */\n  public mutateElement(element: HTMLElement, callback?: VoidFunction) {\n    const isConnected = isInDOM(element);\n    const promise = isConnected ? this.mutate() : Promise.resolve();\n\n    if(callback !== undefined) {\n      if(!isConnected) {\n        callback();\n      } else {\n        promise.then(() => callback());\n      }\n    }\n\n    return promise;\n  }\n\n  private scheduleFlush() {\n    if(!this.scheduled) {\n      this.scheduled = true;\n\n      this.raf(() => {\n        this.promises.read && this.promises.read.resolve();\n        this.promises.write && this.promises.write.resolve();\n\n        this.scheduled = false;\n        this.promises = {};\n      });\n    }\n  }\n}\n\nconst sequentialDom = new SequentialDom();\nMOUNT_CLASS_TO && (MOUNT_CLASS_TO.sequentialDom = sequentialDom);\nexport default sequentialDom;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport findUpClassName from '../helpers/dom/findUpClassName';\nimport sequentialDom from '../helpers/sequentialDom';\nimport IS_TOUCH_SUPPORTED from '../environment/touchSupport';\nimport rootScope from '../lib/rootScope';\nimport findUpAsChild from '../helpers/dom/findUpAsChild';\nimport {fastRaf} from '../helpers/schedulers';\nimport liteMode from '../helpers/liteMode';\n\nlet rippleClickId = 0;\nexport default function ripple(\n  elem: HTMLElement,\n  callback: (id: number) => Promise<boolean | void> = () => Promise.resolve(),\n  onEnd: (id: number) => void = null,\n  prepend = false,\n  attachListenerTo = elem\n) {\n  // return;\n  if(elem.querySelector('.c-ripple')) return;\n  elem.classList.add('rp');\n\n  const r = document.createElement('div');\n  r.classList.add('c-ripple');\n\n  const isSquare = elem.classList.contains('rp-square');\n  if(isSquare) {\n    r.classList.add('is-square');\n  }\n\n  elem[prepend ? 'prepend' : 'append'](r);\n\n  let handler: () => void;\n  // let animationEndPromise: Promise<number>;\n  const drawRipple = (clientX: number, clientY: number) => {\n    const startTime = Date.now();\n    const circle = document.createElement('div');\n\n    const clickId = rippleClickId++;\n\n    // console.log('ripple drawRipple');\n\n    // const auto = elem.classList.contains('row-sortable') && !elem.classList.contains('cant-sort');\n    const auto = false;\n    const duration = (auto ? .3 : +window.getComputedStyle(r).getPropertyValue('--ripple-duration').replace('s', '')) * 1000;\n    // console.log('ripple duration', duration);\n\n    const _handler = handler = () => {\n    // handler = () => animationEndPromise.then((duration) => {\n      // console.log('ripple animation was:', duration);\n\n      // const duration = isSquare || mediaSizes.isMobile ? 200 : 700;\n      // return;\n      const elapsedTime = Date.now() - startTime;\n      const cb = () => {\n        // console.log('ripple elapsedTime total pre-remove:', Date.now() - startTime);\n        sequentialDom.mutate(() => {\n          circle.remove();\n        });\n\n        onEnd?.(clickId);\n      };\n      if(elapsedTime < duration) {\n        const delay = Math.max(duration - elapsedTime, duration / 2);\n        setTimeout(() => circle.classList.add('hiding'), Math.max(delay - duration / 2, 0));\n\n        setTimeout(cb, delay);\n      } else {\n        circle.classList.add('hiding');\n        setTimeout(cb, duration / 2);\n      }\n\n      if(!IS_TOUCH_SUPPORTED) {\n        window.removeEventListener('contextmenu', handler);\n        window.removeEventListener('mousemove', handler);\n      }\n\n      handler = null;\n      touchStartFired = false;\n    };\n    // });\n\n    callback?.(clickId);\n\n    /* callback().then((bad) => {\n      if(bad) {\n        span.remove();\n        return;\n      } */\n\n    // console.log('ripple after promise', Date.now() - startTime);\n    // console.log('ripple tooSlow:', tooSlow);\n    /* if(tooSlow) {\n        span.remove();\n        return;\n      } */\n\n    fastRaf(() => {\n      if(_handler !== handler) {\n        return;\n      }\n\n      const rect = r.getBoundingClientRect();\n      circle.classList.add('c-ripple__circle');\n\n      const clickX = clientX - rect.left;\n      const clickY = clientY - rect.top;\n\n      const radius = Math.sqrt((Math.abs(clickY - rect.height / 2) + rect.height / 2) ** 2 + (Math.abs(clickX - rect.width / 2) + rect.width / 2) ** 2);\n      const size = radius;\n\n      // center of circle\n      const x = clickX - size / 2;\n      const y = clickY - size / 2;\n\n      // console.log('ripple click', offsetFromCenter, size, clickX, clickY);\n\n      circle.style.width = circle.style.height = size + 'px';\n      circle.style.left = x + 'px';\n      circle.style.top = y + 'px';\n      circle.style.opacity = '0';\n\n      //     \n      /* animationEndPromise = new Promise((resolve) => {\n          span.addEventListener('animationend', () => {\n            // 713 -> 700\n            resolve(((Date.now() - startTime) / 100 | 0) * 100);\n          }, {once: true});\n        }); */\n\n      //             \n      /* span.style.display = 'none';\n        r.append(span);\n        duration = +window.getComputedStyle(span).getPropertyValue('animation-duration').replace('s', '') * 1000;\n        span.style.display = ''; */\n\n      r.append(circle);\n\n      void circle.offsetWidth; // force reflow\n      circle.style.opacity = '';\n\n      if(auto) {\n        // window.addEventListener('mousemove', handler, {once: true, passive: true});\n        handler();\n      }\n\n      // r.classList.add('active');\n      // handler();\n    });\n    // });\n  };\n\n  const isRippleUnneeded = (e: Event) => {\n    return e.target !== elem && (\n      ['BUTTON', 'A'].includes((e.target as HTMLElement).tagName) ||\n        findUpClassName(e.target as HTMLElement, 'c-ripple') !== r\n    ) && (\n      attachListenerTo === elem ||\n        !findUpAsChild(e.target as HTMLElement, attachListenerTo)\n    ) && !findUpClassName(e.target, 'checkbox-field');\n  };\n\n  // TODO: rename this variable\n  let touchStartFired = false;\n  if(IS_TOUCH_SUPPORTED) {\n    const touchEnd = () => {\n      handler?.();\n    };\n\n    attachListenerTo.addEventListener('touchstart', (e) => {\n      if(!liteMode.isAvailable('animations')) {\n        return;\n      }\n\n      // console.log('ripple touchstart', e);\n      if(e.touches.length > 1 || touchStartFired || isRippleUnneeded(e)) {\n        return;\n      }\n\n      // console.log('touchstart', e);\n      touchStartFired = true;\n\n      const {clientX, clientY} = e.touches[0];\n      drawRipple(clientX, clientY);\n      attachListenerTo.addEventListener('touchend', touchEnd, {once: true});\n\n      window.addEventListener('touchmove', (e) => {\n        e.cancelBubble = true;\n        e.stopPropagation();\n        touchEnd();\n        attachListenerTo.removeEventListener('touchend', touchEnd);\n      }, {once: true});\n    }, {passive: true});\n  } else {\n    attachListenerTo.addEventListener('mousedown', (e) => {\n      if(![0, 2].includes(e.button)) { // only left and right buttons\n        return;\n      }\n\n      if(!liteMode.isAvailable('animations')) {\n        return;\n      }\n      // console.log('ripple mousedown', e, e.target, findUpClassName(e.target as HTMLElement, 'c-ripple') === r);\n\n      if(attachListenerTo.dataset.ripple === '0' || isRippleUnneeded(e)) {\n        return;\n      } else if(touchStartFired) {\n        touchStartFired = false;\n        return;\n      }\n\n      const {clientX, clientY} = e;\n      drawRipple(clientX, clientY);\n      window.addEventListener('mouseup', handler, {once: true, passive: true});\n      window.addEventListener('contextmenu', handler, {once: true, passive: true});\n    }, {passive: true});\n  }\n}\n","const Icons = {\n  check: 'e900',\n  checks: 'e901',\n  activesessions: 'e902',\n  add: 'e903',\n  add_reaction: 'e904',\n  addboost: 'e905',\n  addmember_filled: 'e906',\n  adduser: 'e907',\n  admin: 'e908',\n  animals: 'e909',\n  animations: 'e90a',\n  archive: 'e90b',\n  arrow_down: 'e90c',\n  arrow_next: 'e90d',\n  arrowcircle: 'e90e',\n  attach: 'e90f',\n  audio_repeat: 'e910',\n  audio_repeat_single: 'e911',\n  author_hidden: 'e912',\n  avatarnext: 'e913',\n  avatarprevious: 'e914',\n  binfilled: 'e915',\n  bold: 'e916',\n  bomb: 'e917',\n  boost: 'e918',\n  boostcircle: 'e919',\n  botcom: 'e91a',\n  bots: 'e91b',\n  bug: 'e91c',\n  calendar: 'e91d',\n  calendarfilter: 'e91e',\n  camera: 'e91f',\n  cameraadd: 'e920',\n  car: 'e921',\n  card: 'e922',\n  card_outline: 'e923',\n  channel: 'e924',\n  channelviews: 'e925',\n  chatspinned: 'e926',\n  chatsplaceholder: 'e927',\n  check1: 'e928',\n  checkbox: 'e929',\n  checkboxblock: 'e92a',\n  checkboxempty: 'e92b',\n  checkboxon: 'e92c',\n  checkretract: 'e92d',\n  checkround: 'e92e',\n  checkround_filled: 'e92f',\n  clock: 'e930',\n  close: 'e931',\n  clouddownload: 'e932',\n  colorize: 'e933',\n  comments: 'e934',\n  commentssticker: 'e935',\n  copy: 'e936',\n  crossround: 'e937',\n  darkmode: 'e938',\n  data: 'e939',\n  delete: 'e93a',\n  delete_filled: 'e93b',\n  deletedaccount: 'e93c',\n  deleteleft: 'e93d',\n  deleteuser: 'e93e',\n  devices: 'e93f',\n  document: 'e940',\n  down: 'e941',\n  download: 'e942',\n  dragfiles: 'e943',\n  dragmedia: 'e944',\n  eats: 'e945',\n  edit: 'e946',\n  email: 'e947',\n  endcall_filled: 'e948',\n  enter: 'e949',\n  eye: 'e94a',\n  eye1: 'e94b',\n  eye2: 'e94c',\n  eyecross_outline: 'e94d',\n  fast_forward: 'e94e',\n  fast_rewind: 'e94f',\n  favourites: 'e950',\n  flag: 'e951',\n  flip: 'e952',\n  folder: 'e953',\n  fontsize: 'e954',\n  forward: 'e955',\n  forward_filled: 'e956',\n  fullscreen: 'e957',\n  gc_microphone: 'e958',\n  gc_microphoneoff: 'e959',\n  gifs: 'e95a',\n  gift: 'e95b',\n  gift_premium: 'e95c',\n  group: 'e95d',\n  group_filled: 'e95e',\n  groupmedia: 'e95f',\n  groupmediaoff: 'e960',\n  hand: 'e961',\n  help: 'e962',\n  hide: 'e963',\n  image: 'e964',\n  info: 'e965',\n  info2: 'e966',\n  italic: 'e967',\n  keyboard: 'e968',\n  lamp: 'e969',\n  language: 'e96a',\n  largepause: 'e96b',\n  largeplay: 'e96c',\n  left: 'e96d',\n  limit_chat: 'e96e',\n  limit_chats: 'e96f',\n  limit_file: 'e970',\n  limit_folders: 'e971',\n  limit_link: 'e972',\n  limit_pin: 'e973',\n  link: 'e974',\n  list: 'e975',\n  listscreenshare: 'e976',\n  livelocation: 'e977',\n  location: 'e978',\n  lock: 'e979',\n  lockoff: 'e97a',\n  loginlogodesktop: 'e97b',\n  loginlogomobile: 'e97c',\n  logout: 'e97d',\n  mediaspoiler: 'e97e',\n  mediaspoileroff: 'e97f',\n  mention: 'e980',\n  menu: 'e981',\n  message: 'e982',\n  message_jump: 'e983',\n  message_quote: 'e984',\n  messageunread: 'e985',\n  microphone: 'e986',\n  microphone_crossed: 'e987',\n  microphone_crossed_filled: 'e988',\n  microphone_filled: 'e989',\n  minus: 'e98a',\n  monospace: 'e98b',\n  more: 'e98c',\n  multistories: 'e98d',\n  mute: 'e98e',\n  muted: 'e98f',\n  mynotes: 'e990',\n  newchannel: 'e991',\n  newchannel_filled: 'e992',\n  newchat_filled: 'e993',\n  newgroup: 'e994',\n  newgroup_filled: 'e995',\n  newprivate: 'e996',\n  newprivate_filled: 'e997',\n  newtab: 'e998',\n  next: 'e999',\n  noncontacts: 'e99a',\n  nosound: 'e99b',\n  online: 'e99c',\n  passwordoff: 'e99d',\n  pause: 'e99e',\n  permissions: 'e99f',\n  phone: 'e9a0',\n  phone_filled: 'e9a1',\n  pin: 'e9a2',\n  pinlist: 'e9a3',\n  pinned_filled: 'e9a4',\n  pinnedchat: 'e9a5',\n  pip: 'e9a6',\n  play: 'e9a7',\n  playback_05: 'e9a8',\n  playback_15: 'e9a9',\n  playback_1x: 'e9aa',\n  playback_2x: 'e9ab',\n  plus: 'e9ac',\n  plusround: 'e9ad',\n  poll: 'e9ae',\n  premium_addone: 'e9af',\n  premium_avatars: 'e9b0',\n  premium_badge: 'e9b1',\n  premium_colors: 'e9b2',\n  premium_double: 'e9b3',\n  premium_emoji: 'e9b4',\n  premium_filesize: 'e9b5',\n  premium_lastseen: 'e9b6',\n  premium_limits: 'e9b7',\n  premium_lock: 'e9b8',\n  premium_management: 'e9b9',\n  premium_noads: 'e9ba',\n  premium_privacy: 'e9bb',\n  premium_reactions: 'e9bc',\n  premium_restrict: 'e9bd',\n  premium_speed: 'e9be',\n  premium_status: 'e9bf',\n  premium_stickers: 'e9c0',\n  premium_tags: 'e9c1',\n  premium_transcription: 'e9c2',\n  premium_translate: 'e9c3',\n  premium_unlock: 'e9c4',\n  premium_wallpaper: 'e9c5',\n  previous: 'e9c6',\n  promote: 'e9c7',\n  quote: 'e9c8',\n  quote_outline: 'e9c9',\n  radiooff: 'e9ca',\n  radioon: 'e9cb',\n  reactions: 'e9cc',\n  reactions_filled: 'e9cd',\n  readchats: 'e9ce',\n  recent: 'e9cf',\n  replace: 'e9d0',\n  reply: 'e9d1',\n  reply_filled: 'e9d2',\n  restrict: 'e9d3',\n  rightpanel: 'e9d4',\n  rotate_left: 'e9d5',\n  rotate_right: 'e9d6',\n  saved: 'e9d7',\n  savedmessages: 'e9d8',\n  schedule: 'e9d9',\n  scheduled: 'e9da',\n  search: 'e9db',\n  select: 'e9dc',\n  send: 'e9dd',\n  send2: 'e9de',\n  sending: 'e9df',\n  sendingerror: 'e9e0',\n  settings: 'e9e1',\n  settings_filled: 'e9e2',\n  sharescreen_filled: 'e9e3',\n  shipping: 'e9e4',\n  shuffle: 'e9e5',\n  smallscreen: 'e9e6',\n  smile: 'e9e7',\n  speaker: 'e9e8',\n  speakerfilled: 'e9e9',\n  speakeroff: 'e9ea',\n  speakerofffilled: 'e9eb',\n  spoiler: 'e9ec',\n  sport: 'e9ed',\n  star: 'e9ee',\n  star_filled: 'e9ef',\n  statistics: 'e9f0',\n  stickers: 'e9f1',\n  stickers_face: 'e9f2',\n  stop: 'e9f3',\n  stories: 'e9f4',\n  storyreply: 'e9f5',\n  storyrepost: 'e9f6',\n  strikethrough: 'e9f7',\n  tag: 'e9f8',\n  tag_add: 'e9f9',\n  tag_crossed: 'e9fa',\n  tag_filter: 'e9fb',\n  tag_name: 'e9fc',\n  textedit: 'e9fd',\n  timer: 'e9fe',\n  tip: 'e9ff',\n  tools: 'ea00',\n  topics: 'ea01',\n  transcribe: 'ea02',\n  unarchive: 'ea03',\n  unclaimed: 'ea04',\n  underline: 'ea05',\n  unmute: 'ea06',\n  unpin: 'ea07',\n  unread: 'ea08',\n  up: 'ea09',\n  user: 'ea0a',\n  username: 'ea0b',\n  videocamera: 'ea0c',\n  videocamera_crossed_filled: 'ea0d',\n  videocamera_filled: 'ea0e',\n  videochat: 'ea0f',\n  volume_down: 'ea10',\n  volume_mute: 'ea11',\n  volume_off: 'ea12',\n  volume_up: 'ea13',\n  webview: 'ea14',\n  zoomin: 'ea15',\n  zoomout: 'ea16'\n};\n\nexport default Icons;\n","const IconsReverse = new Set<Icon>([\n  'avatarnext',\n  'avatarprevious',\n  'arrow_next',\n  'channel',\n  'chatspinned',\n  'fast_forward',\n  'fast_rewind',\n  'forward',\n  'forward_filled',\n  'group',\n  'group_filled',\n  'left',\n  'listscreenshare',\n  'logout',\n  'muted',\n  'newchannel_filled',\n  'newchannel',\n  'newgroup',\n  'newgroup_filled',\n  'next',\n  'nosound',\n  'previous',\n  'send',\n  'send2',\n  'reply',\n  'reply_filled',\n  'sharescreen_filled',\n  'transcribe',\n  'storyreply',\n  'premium_noads',\n  'topics',\n  'pinlist',\n  'deleteleft'\n]);\n\nexport default IconsReverse;\n","import {TGICO_CLASS} from '../helpers/tgico';\nimport Icons from '../icons';\nimport IconsReverse from '../iconsReverse';\nimport I18n from '../lib/langPack';\n\nexport function getIconContent(icon: Icon) {\n  return String.fromCharCode(parseInt(Icons[icon], 16));\n}\n\nexport default function Icon(icon: Icon, ...classes: string[]) {\n  const span = document.createElement('span');\n  if(I18n.isRTL && IconsReverse.has(icon)) {\n    classes.push('icon-reflect');\n  }\n\n  span.classList.add(TGICO_CLASS/* ...tgico(icon) */, ...classes);\n  span.textContent = getIconContent(icon);\n  return span;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {FormatterArguments, i18n, LangPackKey} from '../lib/langPack';\nimport Icon from './icon';\nimport ripple from './ripple';\n\nexport type ButtonOptions = Partial<{\n  noRipple: true,\n  onlyMobile: true,\n  icon: Icon,\n  rippleSquare: true,\n  text: LangPackKey,\n  textArgs?: FormatterArguments,\n  disabled: boolean,\n  asDiv: boolean,\n  asLink: boolean\n}>;\n\nexport default function Button<T extends ButtonOptions>(className: string, options: T = {} as T): T['asLink'] extends true ? HTMLAnchorElement : HTMLButtonElement {\n  const button = document.createElement(options.asLink ? 'a' : (options.asDiv ? 'div' : 'button'));\n  button.className = className;\n\n  if(!options.noRipple) {\n    if(options.rippleSquare) {\n      button.classList.add('rp-square');\n    }\n\n    ripple(button);\n  }\n\n  if(options.icon) {\n    replaceButtonIcon(button, options.icon, false);\n  }\n\n  if(options.onlyMobile) {\n    button.classList.add('only-handhelds');\n  }\n\n  if(options.disabled) {\n    button.setAttribute('disabled', 'true');\n  }\n\n  if(options.text) {\n    button.append(i18n(options.text, options.textArgs));\n  }\n\n  return button as any;\n}\n\nexport function replaceButtonIcon(element: HTMLElement, icon: Icon, oldIcon: Element | false = element.querySelector('.button-icon')) {\n  const newIcon = Icon(icon, 'button-icon');\n  if(oldIcon) oldIcon.replaceWith(newIcon);\n  else element.append(newIcon);\n  return newIcon;\n}\n"],"names":["SequentialDom","fastRaf","kind","callback","promise","deferredPromise","element","isConnected","isInDOM","sequentialDom","MOUNT_CLASS_TO","rippleClickId","ripple","elem","onEnd","prepend","attachListenerTo","r","handler","drawRipple","clientX","clientY","startTime","circle","clickId","duration","_handler","elapsedTime","cb","delay","IS_TOUCH_SUPPORTED","touchStartFired","rect","clickX","clickY","size","x","y","isRippleUnneeded","e","findUpClassName","findUpAsChild","touchEnd","liteMode","Icons","IconsReverse","getIconContent","icon","Icon","classes","span","I18n","TGICO_CLASS","Button","className","options","button","replaceButtonIcon","i18n","oldIcon","newIcon"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"button-Mm7TqKr1.js","sources":["../src/helpers/sequentialDom.ts","../src/components/ripple.ts","../src/icons.ts","../src/iconsReverse.ts","../src/components/icon.ts","../src/components/button.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {fastRaf} from './schedulers';\nimport deferredPromise, {CancellablePromise} from './cancellablePromise';\nimport {MOUNT_CLASS_TO} from '../config/debug';\nimport isInDOM from './dom/isInDOM';\n\nclass SequentialDom {\n  private promises: Partial<{\n    read: CancellablePromise<void>,\n    write: CancellablePromise<void>\n  }> = {};\n  private raf = fastRaf.bind(null);\n  private scheduled = false;\n\n  private do(kind: keyof SequentialDom['promises'], callback?: VoidFunction) {\n    let promise = this.promises[kind];\n    if(!promise) {\n      this.scheduleFlush();\n      promise = this.promises[kind] = deferredPromise<void>();\n    }\n\n    if(callback !== undefined) {\n      promise.then(() => callback());\n    }\n\n    return promise;\n  }\n\n  public measure(callback?: VoidFunction) {\n    return this.do('read', callback);\n  }\n\n  public mutate(callback?: VoidFunction) {\n    return this.do('write', callback);\n  }\n\n  /**\n   * Will fire instantly if element is not connected\n   * @param element\n   * @param callback\n   */\n  public mutateElement(element: HTMLElement, callback?: VoidFunction) {\n    const isConnected = isInDOM(element);\n    const promise = isConnected ? this.mutate() : Promise.resolve();\n\n    if(callback !== undefined) {\n      if(!isConnected) {\n        callback();\n      } else {\n        promise.then(() => callback());\n      }\n    }\n\n    return promise;\n  }\n\n  private scheduleFlush() {\n    if(!this.scheduled) {\n      this.scheduled = true;\n\n      this.raf(() => {\n        this.promises.read && this.promises.read.resolve();\n        this.promises.write && this.promises.write.resolve();\n\n        this.scheduled = false;\n        this.promises = {};\n      });\n    }\n  }\n}\n\nconst sequentialDom = new SequentialDom();\nMOUNT_CLASS_TO && (MOUNT_CLASS_TO.sequentialDom = sequentialDom);\nexport default sequentialDom;\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport findUpClassName from '../helpers/dom/findUpClassName';\nimport sequentialDom from '../helpers/sequentialDom';\nimport IS_TOUCH_SUPPORTED from '../environment/touchSupport';\nimport rootScope from '../lib/rootScope';\nimport findUpAsChild from '../helpers/dom/findUpAsChild';\nimport {fastRaf} from '../helpers/schedulers';\nimport liteMode from '../helpers/liteMode';\n\nlet rippleClickId = 0;\nexport default function ripple(\n  elem: HTMLElement,\n  callback: (id: number) => Promise<boolean | void> = () => Promise.resolve(),\n  onEnd: (id: number) => void = null,\n  prepend = false,\n  attachListenerTo = elem\n) {\n  // return;\n  if(elem.querySelector('.c-ripple')) return;\n  elem.classList.add('rp');\n\n  const r = document.createElement('div');\n  r.classList.add('c-ripple');\n\n  const isSquare = elem.classList.contains('rp-square');\n  if(isSquare) {\n    r.classList.add('is-square');\n  }\n\n  elem[prepend ? 'prepend' : 'append'](r);\n\n  let handler: () => void;\n  // let animationEndPromise: Promise<number>;\n  const drawRipple = (clientX: number, clientY: number) => {\n    const startTime = Date.now();\n    const circle = document.createElement('div');\n\n    const clickId = rippleClickId++;\n\n    // console.log('ripple drawRipple');\n\n    // const auto = elem.classList.contains('row-sortable') && !elem.classList.contains('cant-sort');\n    const auto = false;\n    const duration = (auto ? .3 : +window.getComputedStyle(r).getPropertyValue('--ripple-duration').replace('s', '')) * 1000;\n    // console.log('ripple duration', duration);\n\n    const _handler = handler = () => {\n    // handler = () => animationEndPromise.then((duration) => {\n      // console.log('ripple animation was:', duration);\n\n      // const duration = isSquare || mediaSizes.isMobile ? 200 : 700;\n      // return;\n      const elapsedTime = Date.now() - startTime;\n      const cb = () => {\n        // console.log('ripple elapsedTime total pre-remove:', Date.now() - startTime);\n        sequentialDom.mutate(() => {\n          circle.remove();\n        });\n\n        onEnd?.(clickId);\n      };\n      if(elapsedTime < duration) {\n        const delay = Math.max(duration - elapsedTime, duration / 2);\n        setTimeout(() => circle.classList.add('hiding'), Math.max(delay - duration / 2, 0));\n\n        setTimeout(cb, delay);\n      } else {\n        circle.classList.add('hiding');\n        setTimeout(cb, duration / 2);\n      }\n\n      if(!IS_TOUCH_SUPPORTED) {\n        window.removeEventListener('contextmenu', handler);\n        window.removeEventListener('mousemove', handler);\n      }\n\n      handler = null;\n      touchStartFired = false;\n    };\n    // });\n\n    callback?.(clickId);\n\n    /* callback().then((bad) => {\n      if(bad) {\n        span.remove();\n        return;\n      } */\n\n    // console.log('ripple after promise', Date.now() - startTime);\n    // console.log('ripple tooSlow:', tooSlow);\n    /* if(tooSlow) {\n        span.remove();\n        return;\n      } */\n\n    fastRaf(() => {\n      if(_handler !== handler) {\n        return;\n      }\n\n      const rect = r.getBoundingClientRect();\n      circle.classList.add('c-ripple__circle');\n\n      const clickX = clientX - rect.left;\n      const clickY = clientY - rect.top;\n\n      const radius = Math.sqrt((Math.abs(clickY - rect.height / 2) + rect.height / 2) ** 2 + (Math.abs(clickX - rect.width / 2) + rect.width / 2) ** 2);\n      const size = radius;\n\n      // center of circle\n      const x = clickX - size / 2;\n      const y = clickY - size / 2;\n\n      // console.log('ripple click', offsetFromCenter, size, clickX, clickY);\n\n      circle.style.width = circle.style.height = size + 'px';\n      circle.style.left = x + 'px';\n      circle.style.top = y + 'px';\n      circle.style.opacity = '0';\n\n      //     \n      /* animationEndPromise = new Promise((resolve) => {\n          span.addEventListener('animationend', () => {\n            // 713 -> 700\n            resolve(((Date.now() - startTime) / 100 | 0) * 100);\n          }, {once: true});\n        }); */\n\n      //             \n      /* span.style.display = 'none';\n        r.append(span);\n        duration = +window.getComputedStyle(span).getPropertyValue('animation-duration').replace('s', '') * 1000;\n        span.style.display = ''; */\n\n      r.append(circle);\n\n      void circle.offsetWidth; // force reflow\n      circle.style.opacity = '';\n\n      if(auto) {\n        // window.addEventListener('mousemove', handler, {once: true, passive: true});\n        handler();\n      }\n\n      // r.classList.add('active');\n      // handler();\n    });\n    // });\n  };\n\n  const isRippleUnneeded = (e: Event) => {\n    return e.target !== elem && (\n      ['BUTTON', 'A'].includes((e.target as HTMLElement).tagName) ||\n        findUpClassName(e.target as HTMLElement, 'c-ripple') !== r\n    ) && (\n      attachListenerTo === elem ||\n        !findUpAsChild(e.target as HTMLElement, attachListenerTo)\n    ) && !findUpClassName(e.target, 'checkbox-field');\n  };\n\n  // TODO: rename this variable\n  let touchStartFired = false;\n  if(IS_TOUCH_SUPPORTED) {\n    const touchEnd = () => {\n      handler?.();\n    };\n\n    attachListenerTo.addEventListener('touchstart', (e) => {\n      if(!liteMode.isAvailable('animations')) {\n        return;\n      }\n\n      // console.log('ripple touchstart', e);\n      if(e.touches.length > 1 || touchStartFired || isRippleUnneeded(e)) {\n        return;\n      }\n\n      // console.log('touchstart', e);\n      touchStartFired = true;\n\n      const {clientX, clientY} = e.touches[0];\n      drawRipple(clientX, clientY);\n      attachListenerTo.addEventListener('touchend', touchEnd, {once: true});\n\n      window.addEventListener('touchmove', (e) => {\n        e.cancelBubble = true;\n        e.stopPropagation();\n        touchEnd();\n        attachListenerTo.removeEventListener('touchend', touchEnd);\n      }, {once: true});\n    }, {passive: true});\n  } else {\n    attachListenerTo.addEventListener('mousedown', (e) => {\n      if(![0, 2].includes(e.button)) { // only left and right buttons\n        return;\n      }\n\n      if(!liteMode.isAvailable('animations')) {\n        return;\n      }\n      // console.log('ripple mousedown', e, e.target, findUpClassName(e.target as HTMLElement, 'c-ripple') === r);\n\n      if(attachListenerTo.dataset.ripple === '0' || isRippleUnneeded(e)) {\n        return;\n      } else if(touchStartFired) {\n        touchStartFired = false;\n        return;\n      }\n\n      const {clientX, clientY} = e;\n      drawRipple(clientX, clientY);\n      window.addEventListener('mouseup', handler, {once: true, passive: true});\n      window.addEventListener('contextmenu', handler, {once: true, passive: true});\n    }, {passive: true});\n  }\n}\n","const Icons = {\n  check: 'e900',\n  checks: 'e901',\n  activesessions: 'e902',\n  add: 'e903',\n  add_reaction: 'e904',\n  addboost: 'e905',\n  addmember_filled: 'e906',\n  adduser: 'e907',\n  admin: 'e908',\n  animals: 'e909',\n  animations: 'e90a',\n  archive: 'e90b',\n  arrow_down: 'e90c',\n  arrow_next: 'e90d',\n  arrowcircle: 'e90e',\n  attach: 'e90f',\n  audio_repeat: 'e910',\n  audio_repeat_single: 'e911',\n  author_hidden: 'e912',\n  avatarnext: 'e913',\n  avatarprevious: 'e914',\n  binfilled: 'e915',\n  bold: 'e916',\n  bomb: 'e917',\n  boost: 'e918',\n  boostcircle: 'e919',\n  botcom: 'e91a',\n  bots: 'e91b',\n  bug: 'e91c',\n  calendar: 'e91d',\n  calendarfilter: 'e91e',\n  camera: 'e91f',\n  cameraadd: 'e920',\n  car: 'e921',\n  card: 'e922',\n  card_outline: 'e923',\n  channel: 'e924',\n  channelviews: 'e925',\n  chatspinned: 'e926',\n  chatsplaceholder: 'e927',\n  check1: 'e928',\n  checkbox: 'e929',\n  checkboxblock: 'e92a',\n  checkboxempty: 'e92b',\n  checkboxon: 'e92c',\n  checkretract: 'e92d',\n  checkround: 'e92e',\n  checkround_filled: 'e92f',\n  clock: 'e930',\n  close: 'e931',\n  clouddownload: 'e932',\n  colorize: 'e933',\n  comments: 'e934',\n  commentssticker: 'e935',\n  copy: 'e936',\n  crossround: 'e937',\n  darkmode: 'e938',\n  data: 'e939',\n  delete: 'e93a',\n  delete_filled: 'e93b',\n  deletedaccount: 'e93c',\n  deleteleft: 'e93d',\n  deleteuser: 'e93e',\n  devices: 'e93f',\n  document: 'e940',\n  down: 'e941',\n  download: 'e942',\n  dragfiles: 'e943',\n  dragmedia: 'e944',\n  eats: 'e945',\n  edit: 'e946',\n  email: 'e947',\n  endcall_filled: 'e948',\n  enter: 'e949',\n  eye: 'e94a',\n  eye1: 'e94b',\n  eye2: 'e94c',\n  eyecross_outline: 'e94d',\n  fast_forward: 'e94e',\n  fast_rewind: 'e94f',\n  favourites: 'e950',\n  flag: 'e951',\n  flip: 'e952',\n  folder: 'e953',\n  fontsize: 'e954',\n  forward: 'e955',\n  forward_filled: 'e956',\n  fullscreen: 'e957',\n  gc_microphone: 'e958',\n  gc_microphoneoff: 'e959',\n  gifs: 'e95a',\n  gift: 'e95b',\n  gift_premium: 'e95c',\n  group: 'e95d',\n  group_filled: 'e95e',\n  groupmedia: 'e95f',\n  groupmediaoff: 'e960',\n  hand: 'e961',\n  help: 'e962',\n  hide: 'e963',\n  image: 'e964',\n  info: 'e965',\n  info2: 'e966',\n  italic: 'e967',\n  keyboard: 'e968',\n  lamp: 'e969',\n  language: 'e96a',\n  largepause: 'e96b',\n  largeplay: 'e96c',\n  left: 'e96d',\n  limit_chat: 'e96e',\n  limit_chats: 'e96f',\n  limit_file: 'e970',\n  limit_folders: 'e971',\n  limit_link: 'e972',\n  limit_pin: 'e973',\n  link: 'e974',\n  list: 'e975',\n  listscreenshare: 'e976',\n  livelocation: 'e977',\n  location: 'e978',\n  lock: 'e979',\n  lockoff: 'e97a',\n  loginlogodesktop: 'e97b',\n  loginlogomobile: 'e97c',\n  logout: 'e97d',\n  mediaspoiler: 'e97e',\n  mediaspoileroff: 'e97f',\n  mention: 'e980',\n  menu: 'e981',\n  message: 'e982',\n  message_jump: 'e983',\n  message_quote: 'e984',\n  messageunread: 'e985',\n  microphone: 'e986',\n  microphone_crossed: 'e987',\n  microphone_crossed_filled: 'e988',\n  microphone_filled: 'e989',\n  minus: 'e98a',\n  monospace: 'e98b',\n  more: 'e98c',\n  multistories: 'e98d',\n  mute: 'e98e',\n  muted: 'e98f',\n  mynotes: 'e990',\n  newchannel: 'e991',\n  newchannel_filled: 'e992',\n  newchat_filled: 'e993',\n  newgroup: 'e994',\n  newgroup_filled: 'e995',\n  newprivate: 'e996',\n  newprivate_filled: 'e997',\n  newtab: 'e998',\n  next: 'e999',\n  noncontacts: 'e99a',\n  nosound: 'e99b',\n  online: 'e99c',\n  passwordoff: 'e99d',\n  pause: 'e99e',\n  permissions: 'e99f',\n  phone: 'e9a0',\n  phone_filled: 'e9a1',\n  pin: 'e9a2',\n  pinlist: 'e9a3',\n  pinned_filled: 'e9a4',\n  pinnedchat: 'e9a5',\n  pip: 'e9a6',\n  play: 'e9a7',\n  playback_05: 'e9a8',\n  playback_15: 'e9a9',\n  playback_1x: 'e9aa',\n  playback_2x: 'e9ab',\n  plus: 'e9ac',\n  plusround: 'e9ad',\n  poll: 'e9ae',\n  premium_addone: 'e9af',\n  premium_avatars: 'e9b0',\n  premium_badge: 'e9b1',\n  premium_colors: 'e9b2',\n  premium_double: 'e9b3',\n  premium_emoji: 'e9b4',\n  premium_filesize: 'e9b5',\n  premium_lastseen: 'e9b6',\n  premium_limits: 'e9b7',\n  premium_lock: 'e9b8',\n  premium_management: 'e9b9',\n  premium_noads: 'e9ba',\n  premium_privacy: 'e9bb',\n  premium_reactions: 'e9bc',\n  premium_restrict: 'e9bd',\n  premium_speed: 'e9be',\n  premium_status: 'e9bf',\n  premium_stickers: 'e9c0',\n  premium_tags: 'e9c1',\n  premium_transcription: 'e9c2',\n  premium_translate: 'e9c3',\n  premium_unlock: 'e9c4',\n  premium_wallpaper: 'e9c5',\n  previous: 'e9c6',\n  promote: 'e9c7',\n  quote: 'e9c8',\n  quote_outline: 'e9c9',\n  radiooff: 'e9ca',\n  radioon: 'e9cb',\n  reactions: 'e9cc',\n  reactions_filled: 'e9cd',\n  readchats: 'e9ce',\n  recent: 'e9cf',\n  replace: 'e9d0',\n  reply: 'e9d1',\n  reply_filled: 'e9d2',\n  restrict: 'e9d3',\n  rightpanel: 'e9d4',\n  rotate_left: 'e9d5',\n  rotate_right: 'e9d6',\n  saved: 'e9d7',\n  savedmessages: 'e9d8',\n  schedule: 'e9d9',\n  scheduled: 'e9da',\n  search: 'e9db',\n  select: 'e9dc',\n  send: 'e9dd',\n  send2: 'e9de',\n  sending: 'e9df',\n  sendingerror: 'e9e0',\n  settings: 'e9e1',\n  settings_filled: 'e9e2',\n  sharescreen_filled: 'e9e3',\n  shipping: 'e9e4',\n  shuffle: 'e9e5',\n  smallscreen: 'e9e6',\n  smile: 'e9e7',\n  speaker: 'e9e8',\n  speakerfilled: 'e9e9',\n  speakeroff: 'e9ea',\n  speakerofffilled: 'e9eb',\n  spoiler: 'e9ec',\n  sport: 'e9ed',\n  star: 'e9ee',\n  star_filled: 'e9ef',\n  statistics: 'e9f0',\n  stickers: 'e9f1',\n  stickers_face: 'e9f2',\n  stop: 'e9f3',\n  stories: 'e9f4',\n  storyreply: 'e9f5',\n  storyrepost: 'e9f6',\n  strikethrough: 'e9f7',\n  tag: 'e9f8',\n  tag_add: 'e9f9',\n  tag_crossed: 'e9fa',\n  tag_filter: 'e9fb',\n  tag_name: 'e9fc',\n  textedit: 'e9fd',\n  timer: 'e9fe',\n  tip: 'e9ff',\n  tools: 'ea00',\n  topics: 'ea01',\n  transcribe: 'ea02',\n  unarchive: 'ea03',\n  unclaimed: 'ea04',\n  underline: 'ea05',\n  unmute: 'ea06',\n  unpin: 'ea07',\n  unread: 'ea08',\n  up: 'ea09',\n  user: 'ea0a',\n  username: 'ea0b',\n  videocamera: 'ea0c',\n  videocamera_crossed_filled: 'ea0d',\n  videocamera_filled: 'ea0e',\n  videochat: 'ea0f',\n  volume_down: 'ea10',\n  volume_mute: 'ea11',\n  volume_off: 'ea12',\n  volume_up: 'ea13',\n  webview: 'ea14',\n  zoomin: 'ea15',\n  zoomout: 'ea16'\n};\n\nexport default Icons;\n","const IconsReverse = new Set<Icon>([\n  'avatarnext',\n  'avatarprevious',\n  'arrow_next',\n  'channel',\n  'chatspinned',\n  'fast_forward',\n  'fast_rewind',\n  'forward',\n  'forward_filled',\n  'group',\n  'group_filled',\n  'left',\n  'listscreenshare',\n  'logout',\n  'muted',\n  'newchannel_filled',\n  'newchannel',\n  'newgroup',\n  'newgroup_filled',\n  'next',\n  'nosound',\n  'previous',\n  'send',\n  'send2',\n  'reply',\n  'reply_filled',\n  'sharescreen_filled',\n  'transcribe',\n  'storyreply',\n  'premium_noads',\n  'topics',\n  'pinlist',\n  'deleteleft'\n]);\n\nexport default IconsReverse;\n","import {TGICO_CLASS} from '../helpers/tgico';\nimport Icons from '../icons';\nimport IconsReverse from '../iconsReverse';\nimport I18n from '../lib/langPack';\n\nexport function getIconContent(icon: Icon) {\n  return String.fromCharCode(parseInt(Icons[icon], 16));\n}\n\nexport default function Icon(icon: Icon, ...classes: string[]) {\n  const span = document.createElement('span');\n  if(I18n.isRTL && IconsReverse.has(icon)) {\n    classes.push('icon-reflect');\n  }\n\n  span.classList.add(TGICO_CLASS/* ...tgico(icon) */, ...classes);\n  span.textContent = getIconContent(icon);\n  return span;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {FormatterArguments, i18n, LangPackKey} from '../lib/langPack';\nimport Icon from './icon';\nimport ripple from './ripple';\n\nexport type ButtonOptions = Partial<{\n  noRipple: true,\n  onlyMobile: true,\n  icon: Icon,\n  rippleSquare: true,\n  text: LangPackKey,\n  textArgs?: FormatterArguments,\n  disabled: boolean,\n  asDiv: boolean,\n  asLink: boolean\n}>;\n\nexport default function Button<T extends ButtonOptions>(className: string, options: T = {} as T): T['asLink'] extends true ? HTMLAnchorElement : HTMLButtonElement {\n  const button = document.createElement(options.asLink ? 'a' : (options.asDiv ? 'div' : 'button'));\n  button.className = className;\n\n  if(!options.noRipple) {\n    if(options.rippleSquare) {\n      button.classList.add('rp-square');\n    }\n\n    ripple(button);\n  }\n\n  if(options.icon) {\n    replaceButtonIcon(button, options.icon, false);\n  }\n\n  if(options.onlyMobile) {\n    button.classList.add('only-handhelds');\n  }\n\n  if(options.disabled) {\n    button.setAttribute('disabled', 'true');\n  }\n\n  if(options.text) {\n    button.append(i18n(options.text, options.textArgs));\n  }\n\n  return button as any;\n}\n\nexport function replaceButtonIcon(element: HTMLElement, icon: Icon, oldIcon: Element | false = element.querySelector('.button-icon')) {\n  const newIcon = Icon(icon, 'button-icon');\n  if(oldIcon) oldIcon.replaceWith(newIcon);\n  else element.append(newIcon);\n  return newIcon;\n}\n"],"names":["SequentialDom","fastRaf","kind","callback","promise","deferredPromise","element","isConnected","isInDOM","sequentialDom","MOUNT_CLASS_TO","rippleClickId","ripple","elem","onEnd","prepend","attachListenerTo","r","handler","drawRipple","clientX","clientY","startTime","circle","clickId","duration","_handler","elapsedTime","cb","delay","IS_TOUCH_SUPPORTED","touchStartFired","rect","clickX","clickY","size","x","y","isRippleUnneeded","e","findUpClassName","findUpAsChild","touchEnd","liteMode","Icons","IconsReverse","getIconContent","icon","Icon","classes","span","I18n","TGICO_CLASS","Button","className","options","button","replaceButtonIcon","i18n","oldIcon","newIcon"],"mappings":"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"}
\ No newline at end of file

--- public/codeInputField-Ofayp2TX.js ---
@@ -1,2 +1,2 @@
-import{l as n,I as h}from"./wrapEmojiText-pejq-WF4.js";class d{constructor(i,t){this.inputField=i,this.size=t,this.max=45,this.needFrame=0,this.container=document.createElement("div"),this.container.classList.add("media-sticker-wrapper");const e=i.input;e.addEventListener("blur",()=>{this.playAnimation(0)}),e.addEventListener("input",o=>{this.playAnimation(i.value.length)})}playAnimation(i){if(!this.animation)return;i=Math.min(i,30);let t;i?(t=Math.round(Math.min(this.max,i)*(165/this.max)+11.33),this.idleAnimation&&(this.idleAnimation.stop(!0),this.idleAnimation.canvas[0].style.display="none"),this.animation.canvas[0].style.display=""):t=0;const e=this.needFrame>t?-1:1;this.animation.setDirection(e),this.needFrame!==0&&t===0&&this.animation.setSpeed(7),this.needFrame=t,this.animation.play()}load(){return this.loadPromise?this.loadPromise:this.loadPromise=Promise.all([n.loadAnimationAsAsset({container:this.container,loop:!0,autoplay:!0,width:this.size,height:this.size},"TwoFactorSetupMonkeyIdle").then(i=>(this.idleAnimation=i,this.inputField.value.length||i.play(),n.waitForFirstFrame(i))),n.loadAnimationAsAsset({container:this.container,loop:!1,autoplay:!1,width:this.size,height:this.size},"TwoFactorSetupMonkeyTracking").then(i=>(this.animation=i,this.inputField.value.length||(this.animation.canvas[0].style.display="none"),this.animation.addEventListener("enterFrame",t=>{(this.animation.direction===1&&t>=this.needFrame||this.animation.direction===-1&&t<=this.needFrame)&&(this.animation.setSpeed(1),this.animation.pause()),t===0&&this.needFrame===0&&this.idleAnimation&&(this.idleAnimation.canvas[0].style.display="",this.idleAnimation.play(),this.animation.canvas[0].style.display="none")}),n.waitForFirstFrame(i)))])}remove(){this.animation&&this.animation.remove(),this.idleAnimation&&this.idleAnimation.remove()}}class m extends h{constructor(i){super(Object.assign(i,{plainText:!0})),this.options=i;const t=this.input;t.type="tel",t.setAttribute("required",""),t.autocomplete="off";let e=0;this.input.addEventListener("input",o=>{this.input.classList.remove("error"),this.setLabel();const l=this.value.replace(/\D/g,"").slice(0,i.length);this.setValueSilently(l);const s=this.value.length;if(s===i.length)i.onFill(this.value);else if(s===e)return;e=s})}}export{m as C,d as T};
-//# sourceMappingURL=codeInputField-H0ySI27M.js.map
+import{l as n,I as h}from"./wrapEmojiText-PAHdiQbe.js";class d{constructor(i,t){this.inputField=i,this.size=t,this.max=45,this.needFrame=0,this.container=document.createElement("div"),this.container.classList.add("media-sticker-wrapper");const e=i.input;e.addEventListener("blur",()=>{this.playAnimation(0)}),e.addEventListener("input",o=>{this.playAnimation(i.value.length)})}playAnimation(i){if(!this.animation)return;i=Math.min(i,30);let t;i?(t=Math.round(Math.min(this.max,i)*(165/this.max)+11.33),this.idleAnimation&&(this.idleAnimation.stop(!0),this.idleAnimation.canvas[0].style.display="none"),this.animation.canvas[0].style.display=""):t=0;const e=this.needFrame>t?-1:1;this.animation.setDirection(e),this.needFrame!==0&&t===0&&this.animation.setSpeed(7),this.needFrame=t,this.animation.play()}load(){return this.loadPromise?this.loadPromise:this.loadPromise=Promise.all([n.loadAnimationAsAsset({container:this.container,loop:!0,autoplay:!0,width:this.size,height:this.size},"TwoFactorSetupMonkeyIdle").then(i=>(this.idleAnimation=i,this.inputField.value.length||i.play(),n.waitForFirstFrame(i))),n.loadAnimationAsAsset({container:this.container,loop:!1,autoplay:!1,width:this.size,height:this.size},"TwoFactorSetupMonkeyTracking").then(i=>(this.animation=i,this.inputField.value.length||(this.animation.canvas[0].style.display="none"),this.animation.addEventListener("enterFrame",t=>{(this.animation.direction===1&&t>=this.needFrame||this.animation.direction===-1&&t<=this.needFrame)&&(this.animation.setSpeed(1),this.animation.pause()),t===0&&this.needFrame===0&&this.idleAnimation&&(this.idleAnimation.canvas[0].style.display="",this.idleAnimation.play(),this.animation.canvas[0].style.display="none")}),n.waitForFirstFrame(i)))])}remove(){this.animation&&this.animation.remove(),this.idleAnimation&&this.idleAnimation.remove()}}class m extends h{constructor(i){super(Object.assign(i,{plainText:!0})),this.options=i;const t=this.input;t.type="tel",t.setAttribute("required",""),t.autocomplete="off";let e=0;this.input.addEventListener("input",o=>{this.input.classList.remove("error"),this.setLabel();const l=this.value.replace(/\D/g,"").slice(0,i.length);this.setValueSilently(l);const s=this.value.length;if(s===i.length)i.onFill(this.value);else if(s===e)return;e=s})}}export{m as C,d as T};
+//# sourceMappingURL=codeInputField-Ofayp2TX.js.map

--- public/codeInputField-Ofayp2TX.js.map ---
@@ -1 +1 @@
-{"version":3,"file":"codeInputField-H0ySI27M.js","sources":["../src/components/monkeys/tracking.ts","../src/components/codeInputField.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport InputField from '../inputField';\nimport lottieLoader from '../../lib/rlottie/lottieLoader';\nimport RLottiePlayer from '../../lib/rlottie/rlottiePlayer';\n\nexport default class TrackingMonkey {\n  public container: HTMLElement;\n\n  protected max = 45;\n  protected needFrame = 0;\n\n  protected animation: RLottiePlayer;\n  protected idleAnimation: RLottiePlayer;\n\n  protected loadPromise: Promise<any>;\n\n  constructor(protected inputField: InputField, protected size: number) {\n    this.container = document.createElement('div');\n    this.container.classList.add('media-sticker-wrapper');\n\n    const input = inputField.input;\n\n    input.addEventListener('blur', () => {\n      this.playAnimation(0);\n    });\n\n    input.addEventListener('input', (e) => {\n      this.playAnimation(inputField.value.length);\n    });\n\n    /* codeInput.addEventListener('focus', () => {\n      playAnimation(Math.max(codeInput.value.length, 1));\n    }); */\n  }\n\n  // 1st symbol = frame 15\n  // end symbol = frame 165\n  public playAnimation(length: number) {\n    if(!this.animation) return;\n\n    length = Math.min(length, 30);\n    let frame: number;\n    if(length) {\n      frame = Math.round(Math.min(this.max, length) * (165 / this.max) + 11.33);\n\n      if(this.idleAnimation) {\n        this.idleAnimation.stop(true);\n        this.idleAnimation.canvas[0].style.display = 'none';\n      }\n\n      this.animation.canvas[0].style.display = '';\n    } else {\n      /* const cb = (frameNo: number) => {\n        if(frameNo <= 1) { */\n      /* idleAnimation.play();\n          idleAnimation.canvas.style.display = '';\n          animation.canvas.style.display = 'none'; */\n      /*     animation.removeListener('enterFrame', cb);\n        }\n      };\n      animation.addListener('enterFrame', cb); */\n\n      frame = 0;\n    }\n    // animation.playSegments([1, 2]);\n\n    const direction = this.needFrame > frame ? -1 : 1;\n    // console.log('keydown', length, frame, direction);\n\n    this.animation.setDirection(direction);\n    if(this.needFrame !== 0 && frame === 0) {\n      this.animation.setSpeed(7);\n    }\n    /* let diff = Math.abs(needFrame - frame * direction);\n    if((diff / 20) > 1) animation.setSpeed(diff / 20 | 0); */\n    this.needFrame = frame;\n\n    this.animation.play();\n\n    /* animation.goToAndStop(15, true); */\n    // animation.goToAndStop(length / max * );\n  }\n\n  public load() {\n    if(this.loadPromise) return this.loadPromise;\n    return this.loadPromise = Promise.all([\n      lottieLoader.loadAnimationAsAsset({\n        container: this.container,\n        loop: true,\n        autoplay: true,\n        width: this.size,\n        height: this.size\n      }, 'TwoFactorSetupMonkeyIdle').then((animation) => {\n        this.idleAnimation = animation;\n\n        // ! animationIntersector will stop animation instantly\n        if(!this.inputField.value.length) {\n          animation.play();\n        }\n\n        return lottieLoader.waitForFirstFrame(animation);\n      }),\n\n      lottieLoader.loadAnimationAsAsset({\n        container: this.container,\n        loop: false,\n        autoplay: false,\n        width: this.size,\n        height: this.size\n      }, 'TwoFactorSetupMonkeyTracking').then((_animation) => {\n        this.animation = _animation;\n\n        if(!this.inputField.value.length) {\n          this.animation.canvas[0].style.display = 'none';\n        }\n\n        this.animation.addEventListener('enterFrame', currentFrame => {\n          // console.log('enterFrame', currentFrame, needFrame);\n          // let currentFrame = Math.round(e.currentTime);\n\n          if((this.animation.direction === 1 && currentFrame >= this.needFrame) ||\n            (this.animation.direction === -1 && currentFrame <= this.needFrame)) {\n            this.animation.setSpeed(1);\n            this.animation.pause();\n          }\n\n          if(currentFrame === 0 && this.needFrame === 0) {\n            // animation.curFrame = 0;\n\n            if(this.idleAnimation) {\n              this.idleAnimation.canvas[0].style.display = '';\n              this.idleAnimation.play();\n              this.animation.canvas[0].style.display = 'none';\n            }\n          }\n        });\n        // console.log(animation.getDuration(), animation.getDuration(true));\n\n        return lottieLoader.waitForFirstFrame(_animation);\n      })\n    ]);\n  }\n\n  public remove() {\n    if(this.animation) this.animation.remove();\n    if(this.idleAnimation) this.idleAnimation.remove();\n  }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport InputField, {InputFieldOptions} from './inputField';\n\nexport default class CodeInputField extends InputField {\n  constructor(public options: InputFieldOptions & {\n    length: number,\n    onFill: (code: string) => void\n  }) {\n    super(Object.assign(options, {\n      plainText: true\n    }));\n\n    const input = this.input as HTMLInputElement;\n    input.type = 'tel';\n    input.setAttribute('required', '');\n    input.autocomplete = 'off';\n\n    let lastLength = 0;\n    this.input.addEventListener('input', (e) => {\n      this.input.classList.remove('error');\n      this.setLabel();\n\n      const value = this.value.replace(/\\D/g, '').slice(0, options.length);\n      this.setValueSilently(value);\n\n      const length = this.value.length;\n      if(length === options.length) { // submit code\n        options.onFill(this.value);\n      } else if(length === lastLength) {\n        return;\n      }\n\n      lastLength = length;\n    });\n  }\n}\n"],"names":["TrackingMonkey","inputField","size","input","e","length","frame","direction","lottieLoader","animation","_animation","currentFrame","CodeInputField","InputField","options","lastLength","value"],"mappings":"uDAUA,MAAqBA,CAAe,CAWlC,YAAsBC,EAAkCC,EAAc,CAAhD,KAAA,WAAAD,EAAkC,KAAA,KAAAC,EARxD,KAAU,IAAM,GAChB,KAAU,UAAY,EAQf,KAAA,UAAY,SAAS,cAAc,KAAK,EACxC,KAAA,UAAU,UAAU,IAAI,uBAAuB,EAEpD,MAAMC,EAAQF,EAAW,MAEnBE,EAAA,iBAAiB,OAAQ,IAAM,CACnC,KAAK,cAAc,CAAC,CAAA,CACrB,EAEKA,EAAA,iBAAiB,QAAUC,GAAM,CAChC,KAAA,cAAcH,EAAW,MAAM,MAAM,CAAA,CAC3C,CAKH,CAIO,cAAcI,EAAgB,CACnC,GAAG,CAAC,KAAK,UAAW,OAEXA,EAAA,KAAK,IAAIA,EAAQ,EAAE,EACxB,IAAAC,EACDD,GACOC,EAAA,KAAK,MAAM,KAAK,IAAI,KAAK,IAAKD,CAAM,GAAK,IAAM,KAAK,KAAO,KAAK,EAErE,KAAK,gBACD,KAAA,cAAc,KAAK,EAAI,EAC5B,KAAK,cAAc,OAAO,CAAC,EAAE,MAAM,QAAU,QAG/C,KAAK,UAAU,OAAO,CAAC,EAAE,MAAM,QAAU,IAYjCC,EAAA,EAIV,MAAMC,EAAY,KAAK,UAAYD,EAAQ,GAAK,EAG3C,KAAA,UAAU,aAAaC,CAAS,EAClC,KAAK,YAAc,GAAKD,IAAU,GAC9B,KAAA,UAAU,SAAS,CAAC,EAI3B,KAAK,UAAYA,EAEjB,KAAK,UAAU,MAIjB,CAEO,MAAO,CACZ,OAAG,KAAK,YAAoB,KAAK,YAC1B,KAAK,YAAc,QAAQ,IAAI,CACpCE,EAAa,qBAAqB,CAChC,UAAW,KAAK,UAChB,KAAM,GACN,SAAU,GACV,MAAO,KAAK,KACZ,OAAQ,KAAK,IACZ,EAAA,0BAA0B,EAAE,KAAMC,IACnC,KAAK,cAAgBA,EAGjB,KAAK,WAAW,MAAM,QACxBA,EAAU,KAAK,EAGVD,EAAa,kBAAkBC,CAAS,EAChD,EAEDD,EAAa,qBAAqB,CAChC,UAAW,KAAK,UAChB,KAAM,GACN,SAAU,GACV,MAAO,KAAK,KACZ,OAAQ,KAAK,IACZ,EAAA,8BAA8B,EAAE,KAAME,IACvC,KAAK,UAAYA,EAEb,KAAK,WAAW,MAAM,SACxB,KAAK,UAAU,OAAO,CAAC,EAAE,MAAM,QAAU,QAGtC,KAAA,UAAU,iBAAiB,aAA8BC,GAAA,EAIxD,KAAK,UAAU,YAAc,GAAKA,GAAgB,KAAK,WACxD,KAAK,UAAU,YAAc,IAAMA,GAAgB,KAAK,aACpD,KAAA,UAAU,SAAS,CAAC,EACzB,KAAK,UAAU,SAGdA,IAAiB,GAAK,KAAK,YAAc,GAGvC,KAAK,gBACN,KAAK,cAAc,OAAO,CAAC,EAAE,MAAM,QAAU,GAC7C,KAAK,cAAc,OACnB,KAAK,UAAU,OAAO,CAAC,EAAE,MAAM,QAAU,OAE7C,CACD,EAGMH,EAAa,kBAAkBE,CAAU,EACjD,CAAA,CACF,CACH,CAEO,QAAS,CACX,KAAK,WAAW,KAAK,UAAU,SAC/B,KAAK,eAAe,KAAK,cAAc,QAC5C,CACF,CChJA,MAAqBE,UAAuBC,CAAW,CACrD,YAAmBC,EAGhB,CACK,MAAA,OAAO,OAAOA,EAAS,CAC3B,UAAW,EACZ,CAAA,CAAC,EANe,KAAA,QAAAA,EAQjB,MAAMX,EAAQ,KAAK,MACnBA,EAAM,KAAO,MACPA,EAAA,aAAa,WAAY,EAAE,EACjCA,EAAM,aAAe,MAErB,IAAIY,EAAa,EACjB,KAAK,MAAM,iBAAiB,QAAUX,GAAM,CACrC,KAAA,MAAM,UAAU,OAAO,OAAO,EACnC,KAAK,SAAS,EAER,MAAAY,EAAQ,KAAK,MAAM,QAAQ,MAAO,EAAE,EAAE,MAAM,EAAGF,EAAQ,MAAM,EACnE,KAAK,iBAAiBE,CAAK,EAErB,MAAAX,EAAS,KAAK,MAAM,OACvB,GAAAA,IAAWS,EAAQ,OACZA,EAAA,OAAO,KAAK,KAAK,UACjBT,IAAWU,EACnB,OAGWA,EAAAV,CAAA,CACd,CACH,CACF"}
\ No newline at end of file
+{"version":3,"file":"codeInputField-Ofayp2TX.js","sources":["../src/components/monkeys/tracking.ts","../src/components/codeInputField.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport InputField from '../inputField';\nimport lottieLoader from '../../lib/rlottie/lottieLoader';\nimport RLottiePlayer from '../../lib/rlottie/rlottiePlayer';\n\nexport default class TrackingMonkey {\n  public container: HTMLElement;\n\n  protected max = 45;\n  protected needFrame = 0;\n\n  protected animation: RLottiePlayer;\n  protected idleAnimation: RLottiePlayer;\n\n  protected loadPromise: Promise<any>;\n\n  constructor(protected inputField: InputField, protected size: number) {\n    this.container = document.createElement('div');\n    this.container.classList.add('media-sticker-wrapper');\n\n    const input = inputField.input;\n\n    input.addEventListener('blur', () => {\n      this.playAnimation(0);\n    });\n\n    input.addEventListener('input', (e) => {\n      this.playAnimation(inputField.value.length);\n    });\n\n    /* codeInput.addEventListener('focus', () => {\n      playAnimation(Math.max(codeInput.value.length, 1));\n    }); */\n  }\n\n  // 1st symbol = frame 15\n  // end symbol = frame 165\n  public playAnimation(length: number) {\n    if(!this.animation) return;\n\n    length = Math.min(length, 30);\n    let frame: number;\n    if(length) {\n      frame = Math.round(Math.min(this.max, length) * (165 / this.max) + 11.33);\n\n      if(this.idleAnimation) {\n        this.idleAnimation.stop(true);\n        this.idleAnimation.canvas[0].style.display = 'none';\n      }\n\n      this.animation.canvas[0].style.display = '';\n    } else {\n      /* const cb = (frameNo: number) => {\n        if(frameNo <= 1) { */\n      /* idleAnimation.play();\n          idleAnimation.canvas.style.display = '';\n          animation.canvas.style.display = 'none'; */\n      /*     animation.removeListener('enterFrame', cb);\n        }\n      };\n      animation.addListener('enterFrame', cb); */\n\n      frame = 0;\n    }\n    // animation.playSegments([1, 2]);\n\n    const direction = this.needFrame > frame ? -1 : 1;\n    // console.log('keydown', length, frame, direction);\n\n    this.animation.setDirection(direction);\n    if(this.needFrame !== 0 && frame === 0) {\n      this.animation.setSpeed(7);\n    }\n    /* let diff = Math.abs(needFrame - frame * direction);\n    if((diff / 20) > 1) animation.setSpeed(diff / 20 | 0); */\n    this.needFrame = frame;\n\n    this.animation.play();\n\n    /* animation.goToAndStop(15, true); */\n    // animation.goToAndStop(length / max * );\n  }\n\n  public load() {\n    if(this.loadPromise) return this.loadPromise;\n    return this.loadPromise = Promise.all([\n      lottieLoader.loadAnimationAsAsset({\n        container: this.container,\n        loop: true,\n        autoplay: true,\n        width: this.size,\n        height: this.size\n      }, 'TwoFactorSetupMonkeyIdle').then((animation) => {\n        this.idleAnimation = animation;\n\n        // ! animationIntersector will stop animation instantly\n        if(!this.inputField.value.length) {\n          animation.play();\n        }\n\n        return lottieLoader.waitForFirstFrame(animation);\n      }),\n\n      lottieLoader.loadAnimationAsAsset({\n        container: this.container,\n        loop: false,\n        autoplay: false,\n        width: this.size,\n        height: this.size\n      }, 'TwoFactorSetupMonkeyTracking').then((_animation) => {\n        this.animation = _animation;\n\n        if(!this.inputField.value.length) {\n          this.animation.canvas[0].style.display = 'none';\n        }\n\n        this.animation.addEventListener('enterFrame', currentFrame => {\n          // console.log('enterFrame', currentFrame, needFrame);\n          // let currentFrame = Math.round(e.currentTime);\n\n          if((this.animation.direction === 1 && currentFrame >= this.needFrame) ||\n            (this.animation.direction === -1 && currentFrame <= this.needFrame)) {\n            this.animation.setSpeed(1);\n            this.animation.pause();\n          }\n\n          if(currentFrame === 0 && this.needFrame === 0) {\n            // animation.curFrame = 0;\n\n            if(this.idleAnimation) {\n              this.idleAnimation.canvas[0].style.display = '';\n              this.idleAnimation.play();\n              this.animation.canvas[0].style.display = 'none';\n            }\n          }\n        });\n        // console.log(animation.getDuration(), animation.getDuration(true));\n\n        return lottieLoader.waitForFirstFrame(_animation);\n      })\n    ]);\n  }\n\n  public remove() {\n    if(this.animation) this.animation.remove();\n    if(this.idleAnimation) this.idleAnimation.remove();\n  }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport InputField, {InputFieldOptions} from './inputField';\n\nexport default class CodeInputField extends InputField {\n  constructor(public options: InputFieldOptions & {\n    length: number,\n    onFill: (code: string) => void\n  }) {\n    super(Object.assign(options, {\n      plainText: true\n    }));\n\n    const input = this.input as HTMLInputElement;\n    input.type = 'tel';\n    input.setAttribute('required', '');\n    input.autocomplete = 'off';\n\n    let lastLength = 0;\n    this.input.addEventListener('input', (e) => {\n      this.input.classList.remove('error');\n      this.setLabel();\n\n      const value = this.value.replace(/\\D/g, '').slice(0, options.length);\n      this.setValueSilently(value);\n\n      const length = this.value.length;\n      if(length === options.length) { // submit code\n        options.onFill(this.value);\n      } else if(length === lastLength) {\n        return;\n      }\n\n      lastLength = length;\n    });\n  }\n}\n"],"names":["TrackingMonkey","inputField","size","input","e","length","frame","direction","lottieLoader","animation","_animation","currentFrame","CodeInputField","InputField","options","lastLength","value"],"mappings":"uDAUA,MAAqBA,CAAe,CAWlC,YAAsBC,EAAkCC,EAAc,CAAhD,KAAA,WAAAD,EAAkC,KAAA,KAAAC,EARxD,KAAU,IAAM,GAChB,KAAU,UAAY,EAQf,KAAA,UAAY,SAAS,cAAc,KAAK,EACxC,KAAA,UAAU,UAAU,IAAI,uBAAuB,EAEpD,MAAMC,EAAQF,EAAW,MAEnBE,EAAA,iBAAiB,OAAQ,IAAM,CACnC,KAAK,cAAc,CAAC,CAAA,CACrB,EAEKA,EAAA,iBAAiB,QAAUC,GAAM,CAChC,KAAA,cAAcH,EAAW,MAAM,MAAM,CAAA,CAC3C,CAKH,CAIO,cAAcI,EAAgB,CACnC,GAAG,CAAC,KAAK,UAAW,OAEXA,EAAA,KAAK,IAAIA,EAAQ,EAAE,EACxB,IAAAC,EACDD,GACOC,EAAA,KAAK,MAAM,KAAK,IAAI,KAAK,IAAKD,CAAM,GAAK,IAAM,KAAK,KAAO,KAAK,EAErE,KAAK,gBACD,KAAA,cAAc,KAAK,EAAI,EAC5B,KAAK,cAAc,OAAO,CAAC,EAAE,MAAM,QAAU,QAG/C,KAAK,UAAU,OAAO,CAAC,EAAE,MAAM,QAAU,IAYjCC,EAAA,EAIV,MAAMC,EAAY,KAAK,UAAYD,EAAQ,GAAK,EAG3C,KAAA,UAAU,aAAaC,CAAS,EAClC,KAAK,YAAc,GAAKD,IAAU,GAC9B,KAAA,UAAU,SAAS,CAAC,EAI3B,KAAK,UAAYA,EAEjB,KAAK,UAAU,MAIjB,CAEO,MAAO,CACZ,OAAG,KAAK,YAAoB,KAAK,YAC1B,KAAK,YAAc,QAAQ,IAAI,CACpCE,EAAa,qBAAqB,CAChC,UAAW,KAAK,UAChB,KAAM,GACN,SAAU,GACV,MAAO,KAAK,KACZ,OAAQ,KAAK,IACZ,EAAA,0BAA0B,EAAE,KAAMC,IACnC,KAAK,cAAgBA,EAGjB,KAAK,WAAW,MAAM,QACxBA,EAAU,KAAK,EAGVD,EAAa,kBAAkBC,CAAS,EAChD,EAEDD,EAAa,qBAAqB,CAChC,UAAW,KAAK,UAChB,KAAM,GACN,SAAU,GACV,MAAO,KAAK,KACZ,OAAQ,KAAK,IACZ,EAAA,8BAA8B,EAAE,KAAME,IACvC,KAAK,UAAYA,EAEb,KAAK,WAAW,MAAM,SACxB,KAAK,UAAU,OAAO,CAAC,EAAE,MAAM,QAAU,QAGtC,KAAA,UAAU,iBAAiB,aAA8BC,GAAA,EAIxD,KAAK,UAAU,YAAc,GAAKA,GAAgB,KAAK,WACxD,KAAK,UAAU,YAAc,IAAMA,GAAgB,KAAK,aACpD,KAAA,UAAU,SAAS,CAAC,EACzB,KAAK,UAAU,SAGdA,IAAiB,GAAK,KAAK,YAAc,GAGvC,KAAK,gBACN,KAAK,cAAc,OAAO,CAAC,EAAE,MAAM,QAAU,GAC7C,KAAK,cAAc,OACnB,KAAK,UAAU,OAAO,CAAC,EAAE,MAAM,QAAU,OAE7C,CACD,EAGMH,EAAa,kBAAkBE,CAAU,EACjD,CAAA,CACF,CACH,CAEO,QAAS,CACX,KAAK,WAAW,KAAK,UAAU,SAC/B,KAAK,eAAe,KAAK,cAAc,QAC5C,CACF,CChJA,MAAqBE,UAAuBC,CAAW,CACrD,YAAmBC,EAGhB,CACK,MAAA,OAAO,OAAOA,EAAS,CAC3B,UAAW,EACZ,CAAA,CAAC,EANe,KAAA,QAAAA,EAQjB,MAAMX,EAAQ,KAAK,MACnBA,EAAM,KAAO,MACPA,EAAA,aAAa,WAAY,EAAE,EACjCA,EAAM,aAAe,MAErB,IAAIY,EAAa,EACjB,KAAK,MAAM,iBAAiB,QAAUX,GAAM,CACrC,KAAA,MAAM,UAAU,OAAO,OAAO,EACnC,KAAK,SAAS,EAER,MAAAY,EAAQ,KAAK,MAAM,QAAQ,MAAO,EAAE,EAAE,MAAM,EAAGF,EAAQ,MAAM,EACnE,KAAK,iBAAiBE,CAAK,EAErB,MAAAX,EAAS,KAAK,MAAM,OACvB,GAAAA,IAAWS,EAAQ,OACZA,EAAA,OAAO,KAAK,KAAK,UACjBT,IAAWU,EACnB,OAGWA,EAAAV,CAAA,CACd,CACH,CACF"}
\ No newline at end of file

--- public/countryInputField-tqY1KpER.js ---
@@ -1,2 +1,2 @@
-import{r as V}from"./button-aS2SE0kp.js";import{c1 as D,b as A,d as N,a as _,e as M,aL as R,ak as B,aC as K,r as F,i as b,a8 as S,aQ as O,z as x,c as j}from"./index-XZA1-3MU.js";import{s as z,j as H}from"./page-eb81Un_i.js";import{I as T,p as U,a2 as W,w as X,A as q}from"./wrapEmojiText-pejq-WF4.js";import{S as J}from"./scrollable-OU41biYL.js";function Q(d,e){const s=Array.isArray(e)?e:e.split(D);let t=d;for(const o of s)if(t=t?.[o],!t)break;return t}class ae{constructor(e={}){const s=this.label=document.createElement("label");s.classList.add("checkbox-field"),e.restriction&&!e.toggle&&s.classList.add("checkbox-field-restriction"),e.round&&s.classList.add("checkbox-field-round"),e.disabled&&this.toggleDisability(!0),this.listenerSetter=e.listenerSetter;const t=this.input=document.createElement("input");if(t.classList.add("checkbox-field-input"),t.type=e.asRadio?"radio":"checkbox",e.name&&(t[e.asRadio?"name":"id"]="input-"+e.name),e.checked&&(t.checked=!0),e.stateKey){let n=e.checked!==void 0;const r=()=>{if(!n)return;let i;e.stateValues?i=e.stateValues[t.checked?1:0]:(i=t.checked,e.stateValueReverse&&(i=!i)),_.managers.appStateManager.setByKey(e.stateKey,i)};!n&&A.getState().then(i=>{n=!0;const f=Q(i,e.stateKey);let a;e.stateValues?a=e.stateValues.indexOf(f)===1:(a=f,e.stateValueReverse&&(a=!a)),this.setValueSilently(a)}),e.listenerSetter?e.listenerSetter.add(t)("change",r):t.addEventListener("change",r)}let o;if(e.text?(o=this.span=document.createElement("span"),o.classList.add("checkbox-caption"),N(o,e.text,e.textArgs)):s.classList.add("checkbox-without-caption"),s.append(t),e.toggle){s.classList.add("checkbox-field-toggle"),e.restriction&&s.classList.add("checkbox-field-toggle-restriction");const n=document.createElement("div");n.classList.add("checkbox-toggle");const r=document.createElement("div");r.classList.add("checkbox-toggle-circle"),n.append(r),s.append(n)}else{const n=document.createElement("div");n.classList.add("checkbox-box");const r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.classList.add("checkbox-box-check"),r.setAttributeNS(null,"viewBox","0 0 24 24");const i=document.createElementNS("http://www.w3.org/2000/svg","use");i.setAttributeNS(null,"href","#check"),i.setAttributeNS(null,"x","-1"),r.append(i);const f=document.createElement("div");f.classList.add("checkbox-box-background");const a=document.createElement("div");a.classList.add("checkbox-box-border"),n.append(a,f,r),s.append(n)}o&&s.append(o),e.withRipple?(s.classList.add("checkbox-ripple","hover-effect"),V(s,void 0,void 0,!0)):e.withHover&&s.classList.add("hover-effect")}get checked(){return this.input.checked}set checked(e){this.setValueSilently(e),z(this.input,"change")}setValueSilently(e){this.input.checked=e}isDisabled(){return this.label.classList.contains("checkbox-disabled")}toggleDisability(e){return this.label.classList.toggle("checkbox-disabled",e),this.input.disabled=e,()=>this.toggleDisability(!e)}}const E=new Map;let L=0;const w=(d,e,s="")=>{s=e.country_code+s,L=Math.max(L,s.length),E.set(s,{country:d,code:e})};function G(d){d=d||"",E.size||M.countriesList.forEach(c=>{c.country_codes.forEach(l=>{l.prefixes?l.prefixes.forEach(h=>{w(c,l,h)}):w(c,l)})});let e=d.replace(/\D/g,"");const s=e.slice(0,L);let t;for(let c=s.length-1;c>=0&&(t=E.get(s.slice(0,c+1)),!t);--c);if(!t)return{formatted:e,country:void 0,code:void 0,leftPattern:""};const o=t.country,n=t.code.patterns||[],r=e.slice(t.code.country_code.length);let i="",f=0,a="";for(let c=n.length-1;c>=0;--c){i=n[c];const l=i.replace(/ /g,"");let h=0;for(let p=0,m=Math.min(r.length,l.length);p<m;++p)if(r[p]===l[p])h+=1.01;else if(l[p]==="X")++h;else{h=0;break}h>f&&(f=h,a=i)}i=a||i,i=i.replace(/\d/g,"X"),i=t.code.country_code+" "+i,i.split("").forEach((c,l)=>{c===" "&&e[l]!==" "&&e.length>l&&(e=e.slice(0,l)+" "+e.slice(l))});let u=i&&i.length>e.length?i.slice(e.length):"";return u&&(u=u.replace(/X/g,"")),{formatted:e,country:o,code:t.code,leftPattern:u}}class ie extends T{constructor(e={}){super({label:"Contacts.PhoneNumber.Placeholder",name:"phone",...e}),this.pasted=!1,this.lastValue="",this.container.classList.add("input-field-phone");const s=this.input;if(s instanceof HTMLInputElement)s.type="tel",s.autocomplete="rr55RandomRR55";else{s.inputMode="decimal";const t=window.devicePixelRatio;if(t>1){let n;B?n=t*-.16:K&&(n=0),s.style.setProperty("--letter-spacing",n+"px")}const o=this.setValueSilently.bind(this);this.setValueSilently=n=>{o(n),U(this.input,!0)}}s.addEventListener("input",()=>{s.classList.remove("error");const t=this.value;Math.abs(t.length-this.lastValue.length)>1&&!this.pasted&&R&&this.setValueSilently(this.lastValue+t),this.pasted=!1,this.setLabel();let n,r,i="";this.value.replace(/\++/,"+")==="+"?this.setValueSilently("+"):(n=G(this.value),r=n.formatted,n.country,i=n.leftPattern,n.code,this.setValueSilently(this.lastValue=r?"+"+r:"")),s.dataset.leftPattern=i,e.onInput&&e.onInput(n)}),s.addEventListener("paste",()=>{this.pasted=!0}),s.addEventListener("keypress",t=>{const o=t.key;if(/\D/.test(o)&&!(t.metaKey||t.ctrlKey)&&o!=="Backspace"&&!(o==="+"&&t.shiftKey))return t.preventDefault(),!1})}}let y;const P=()=>{y=M.countriesList.filter(d=>!d.pFlags?.hidden).sort((d,e)=>(d.name||d.default_name).localeCompare(e.name||e.default_name))};let v=()=>{v=void 0,P(),_.addEventListener("language_change",()=>{P()})};const I=new Set(["FT"]);function Y(d,e){return v?.(),d=d.toLowerCase(),y.filter(t=>{if(e&&I.has(t.iso2))return!1;const o=[t.name,t.default_name,t.iso2];return o.filter(Boolean).forEach(r=>{const i=r.split(" ").filter(f=>/\w/.test(f)).map(f=>f[0]).join("");i.length>1&&o.push(i)}),!!o.filter(Boolean).find(r=>r.toLowerCase().indexOf(d)!==-1)})}class ne extends T{constructor(e={}){super({label:"Country",name:F(),...e}),this.options=e,this.hidePicker=()=>{this.hideTimeout===void 0&&(this.selectWrapper.classList.remove("active"),this.hideTimeout=window.setTimeout(()=>{this.selectWrapper.classList.add("hide"),this.hideTimeout=void 0},200))},this.selectCountryByTarget=a=>{const u=a.querySelector("[data-default-name]").dataset.defaultName,l=a.querySelector(".phone-code")?.innerText,h=l&&l.replace(/\D/g,"");this.value=b(u),this.lastCountrySelected=y.find(p=>p.default_name===u),this.lastCountryCodeSelected=h&&this.lastCountrySelected.country_codes.find(p=>p.country_code===h),this.options.onCountryChange?.(this.lastCountrySelected,this.lastCountryCodeSelected),this.hidePicker()},v?.(),this.liMap=new Map,this.container.classList.add("input-select");const s=this.selectWrapper=document.createElement("div");s.classList.add("select-wrapper","z-depth-3","hide");const t=document.createElement("span");t.classList.add("arrow","arrow-down"),this.container.append(t);const o=document.createElement("ul");s.appendChild(o),new J(s);let n=()=>{n=null,y.forEach(a=>{if(e.noPhoneCodes&&I.has(a.iso2))return;const u=W(a.iso2),c=[];for(let l=0,h=Math.min(a.country_codes.length,e.noPhoneCodes?1:1/0);l<h;++l){const p=a.country_codes[l],m=document.createElement("li"),C=X(u);if(O){const g=document.createElement("span");x(g,C),m.append(g)}else x(m,C);const k=b(a.default_name);if(k.dataset.defaultName=a.default_name,m.append(k),!e.noPhoneCodes){const g=document.createElement("span");g.classList.add("phone-code"),g.innerText="+"+p.country_code,m.appendChild(g)}c.push(m),o.append(m)}this.liMap.set(a.iso2,c)}),o.addEventListener("mousedown",a=>{if(a.button!==0)return;const u=q(a.target,"LI");this.selectCountryByTarget(u)}),this.container.appendChild(s)};n(),this.input.addEventListener("focus",a=>{n?n():y.forEach(u=>{const c=this.liMap.get(u.iso2);c&&c.forEach(l=>l.style.display="")}),clearTimeout(this.hideTimeout),this.hideTimeout=void 0,s.classList.remove("hide"),s.offsetWidth,s.classList.add("active"),this.select(),H({container:S(this.container,"scrollable-y"),element:this.input,position:"start",margin:4}),setTimeout(()=>{r||(document.addEventListener("mousedown",i,{capture:!0}),r=!0)},0)});let r=!1;const i=a=>{S(a.target,"input-select")||a.target!==this.input&&(this.hidePicker(),document.removeEventListener("mousedown",i,{capture:!0}),r=!1)},f=a=>{const u=a.key;if(a.ctrlKey||u==="Control")return!1;const c=new Set(Y(this.value).map(l=>l.iso2));this.liMap.forEach((l,h)=>{l.forEach(p=>p.style.display=c.has(h)?"":"none")}),c.size?c.size===1&&u==="Enter"&&(j(a),this.selectCountryByTarget(this.liMap.get([...c][0])[0])):y.forEach(l=>{const h=this.liMap.get(l.iso2);h&&h.forEach(p=>p.style.display="")})};this.input.addEventListener("keyup",f),this.input.addEventListener("keydown",a=>{a.key==="Enter"&&f(a)}),t.addEventListener("mousedown",a=>{this.input.matches(":focus")?(this.hidePicker(),this.input.blur()):(a.cancelBubble=!0,a.preventDefault(),this.input.focus())})}getSelected(){return{country:this.lastCountrySelected,code:this.lastCountryCodeSelected}}selectCountryByIso2(e){this.selectCountryByTarget(this.liMap.get(e)[0])}override(e,s,t){this.setValueSilently(e?b(e.default_name):t),this.lastCountrySelected=e,this.lastCountryCodeSelected=s,this.options.onCountryChange?.(this.lastCountrySelected,this.lastCountryCodeSelected)}}export{ne as C,ie as T,ae as a,Y as b,G as f,Q as g};
-//# sourceMappingURL=countryInputField-Rr6PHiIn.js.map
+import{r as V}from"./button-Mm7TqKr1.js";import{c1 as D,b as A,d as N,a as _,e as M,aL as R,ak as B,aC as K,r as F,i as b,a8 as S,aQ as O,z as x,c as j}from"./index-M8z-nwNm.js";import{s as z,j as H}from"./page-kT6kVFv9.js";import{I as T,p as U,a2 as W,w as X,A as q}from"./wrapEmojiText-PAHdiQbe.js";import{S as J}from"./scrollable-ILmNatrX.js";function Q(d,e){const s=Array.isArray(e)?e:e.split(D);let t=d;for(const o of s)if(t=t?.[o],!t)break;return t}class ae{constructor(e={}){const s=this.label=document.createElement("label");s.classList.add("checkbox-field"),e.restriction&&!e.toggle&&s.classList.add("checkbox-field-restriction"),e.round&&s.classList.add("checkbox-field-round"),e.disabled&&this.toggleDisability(!0),this.listenerSetter=e.listenerSetter;const t=this.input=document.createElement("input");if(t.classList.add("checkbox-field-input"),t.type=e.asRadio?"radio":"checkbox",e.name&&(t[e.asRadio?"name":"id"]="input-"+e.name),e.checked&&(t.checked=!0),e.stateKey){let n=e.checked!==void 0;const r=()=>{if(!n)return;let i;e.stateValues?i=e.stateValues[t.checked?1:0]:(i=t.checked,e.stateValueReverse&&(i=!i)),_.managers.appStateManager.setByKey(e.stateKey,i)};!n&&A.getState().then(i=>{n=!0;const f=Q(i,e.stateKey);let a;e.stateValues?a=e.stateValues.indexOf(f)===1:(a=f,e.stateValueReverse&&(a=!a)),this.setValueSilently(a)}),e.listenerSetter?e.listenerSetter.add(t)("change",r):t.addEventListener("change",r)}let o;if(e.text?(o=this.span=document.createElement("span"),o.classList.add("checkbox-caption"),N(o,e.text,e.textArgs)):s.classList.add("checkbox-without-caption"),s.append(t),e.toggle){s.classList.add("checkbox-field-toggle"),e.restriction&&s.classList.add("checkbox-field-toggle-restriction");const n=document.createElement("div");n.classList.add("checkbox-toggle");const r=document.createElement("div");r.classList.add("checkbox-toggle-circle"),n.append(r),s.append(n)}else{const n=document.createElement("div");n.classList.add("checkbox-box");const r=document.createElementNS("http://www.w3.org/2000/svg","svg");r.classList.add("checkbox-box-check"),r.setAttributeNS(null,"viewBox","0 0 24 24");const i=document.createElementNS("http://www.w3.org/2000/svg","use");i.setAttributeNS(null,"href","#check"),i.setAttributeNS(null,"x","-1"),r.append(i);const f=document.createElement("div");f.classList.add("checkbox-box-background");const a=document.createElement("div");a.classList.add("checkbox-box-border"),n.append(a,f,r),s.append(n)}o&&s.append(o),e.withRipple?(s.classList.add("checkbox-ripple","hover-effect"),V(s,void 0,void 0,!0)):e.withHover&&s.classList.add("hover-effect")}get checked(){return this.input.checked}set checked(e){this.setValueSilently(e),z(this.input,"change")}setValueSilently(e){this.input.checked=e}isDisabled(){return this.label.classList.contains("checkbox-disabled")}toggleDisability(e){return this.label.classList.toggle("checkbox-disabled",e),this.input.disabled=e,()=>this.toggleDisability(!e)}}const E=new Map;let L=0;const w=(d,e,s="")=>{s=e.country_code+s,L=Math.max(L,s.length),E.set(s,{country:d,code:e})};function G(d){d=d||"",E.size||M.countriesList.forEach(c=>{c.country_codes.forEach(l=>{l.prefixes?l.prefixes.forEach(h=>{w(c,l,h)}):w(c,l)})});let e=d.replace(/\D/g,"");const s=e.slice(0,L);let t;for(let c=s.length-1;c>=0&&(t=E.get(s.slice(0,c+1)),!t);--c);if(!t)return{formatted:e,country:void 0,code:void 0,leftPattern:""};const o=t.country,n=t.code.patterns||[],r=e.slice(t.code.country_code.length);let i="",f=0,a="";for(let c=n.length-1;c>=0;--c){i=n[c];const l=i.replace(/ /g,"");let h=0;for(let p=0,m=Math.min(r.length,l.length);p<m;++p)if(r[p]===l[p])h+=1.01;else if(l[p]==="X")++h;else{h=0;break}h>f&&(f=h,a=i)}i=a||i,i=i.replace(/\d/g,"X"),i=t.code.country_code+" "+i,i.split("").forEach((c,l)=>{c===" "&&e[l]!==" "&&e.length>l&&(e=e.slice(0,l)+" "+e.slice(l))});let u=i&&i.length>e.length?i.slice(e.length):"";return u&&(u=u.replace(/X/g,"")),{formatted:e,country:o,code:t.code,leftPattern:u}}class ie extends T{constructor(e={}){super({label:"Contacts.PhoneNumber.Placeholder",name:"phone",...e}),this.pasted=!1,this.lastValue="",this.container.classList.add("input-field-phone");const s=this.input;if(s instanceof HTMLInputElement)s.type="tel",s.autocomplete="rr55RandomRR55";else{s.inputMode="decimal";const t=window.devicePixelRatio;if(t>1){let n;B?n=t*-.16:K&&(n=0),s.style.setProperty("--letter-spacing",n+"px")}const o=this.setValueSilently.bind(this);this.setValueSilently=n=>{o(n),U(this.input,!0)}}s.addEventListener("input",()=>{s.classList.remove("error");const t=this.value;Math.abs(t.length-this.lastValue.length)>1&&!this.pasted&&R&&this.setValueSilently(this.lastValue+t),this.pasted=!1,this.setLabel();let n,r,i="";this.value.replace(/\++/,"+")==="+"?this.setValueSilently("+"):(n=G(this.value),r=n.formatted,n.country,i=n.leftPattern,n.code,this.setValueSilently(this.lastValue=r?"+"+r:"")),s.dataset.leftPattern=i,e.onInput&&e.onInput(n)}),s.addEventListener("paste",()=>{this.pasted=!0}),s.addEventListener("keypress",t=>{const o=t.key;if(/\D/.test(o)&&!(t.metaKey||t.ctrlKey)&&o!=="Backspace"&&!(o==="+"&&t.shiftKey))return t.preventDefault(),!1})}}let y;const P=()=>{y=M.countriesList.filter(d=>!d.pFlags?.hidden).sort((d,e)=>(d.name||d.default_name).localeCompare(e.name||e.default_name))};let v=()=>{v=void 0,P(),_.addEventListener("language_change",()=>{P()})};const I=new Set(["FT"]);function Y(d,e){return v?.(),d=d.toLowerCase(),y.filter(t=>{if(e&&I.has(t.iso2))return!1;const o=[t.name,t.default_name,t.iso2];return o.filter(Boolean).forEach(r=>{const i=r.split(" ").filter(f=>/\w/.test(f)).map(f=>f[0]).join("");i.length>1&&o.push(i)}),!!o.filter(Boolean).find(r=>r.toLowerCase().indexOf(d)!==-1)})}class ne extends T{constructor(e={}){super({label:"Country",name:F(),...e}),this.options=e,this.hidePicker=()=>{this.hideTimeout===void 0&&(this.selectWrapper.classList.remove("active"),this.hideTimeout=window.setTimeout(()=>{this.selectWrapper.classList.add("hide"),this.hideTimeout=void 0},200))},this.selectCountryByTarget=a=>{const u=a.querySelector("[data-default-name]").dataset.defaultName,l=a.querySelector(".phone-code")?.innerText,h=l&&l.replace(/\D/g,"");this.value=b(u),this.lastCountrySelected=y.find(p=>p.default_name===u),this.lastCountryCodeSelected=h&&this.lastCountrySelected.country_codes.find(p=>p.country_code===h),this.options.onCountryChange?.(this.lastCountrySelected,this.lastCountryCodeSelected),this.hidePicker()},v?.(),this.liMap=new Map,this.container.classList.add("input-select");const s=this.selectWrapper=document.createElement("div");s.classList.add("select-wrapper","z-depth-3","hide");const t=document.createElement("span");t.classList.add("arrow","arrow-down"),this.container.append(t);const o=document.createElement("ul");s.appendChild(o),new J(s);let n=()=>{n=null,y.forEach(a=>{if(e.noPhoneCodes&&I.has(a.iso2))return;const u=W(a.iso2),c=[];for(let l=0,h=Math.min(a.country_codes.length,e.noPhoneCodes?1:1/0);l<h;++l){const p=a.country_codes[l],m=document.createElement("li"),C=X(u);if(O){const g=document.createElement("span");x(g,C),m.append(g)}else x(m,C);const k=b(a.default_name);if(k.dataset.defaultName=a.default_name,m.append(k),!e.noPhoneCodes){const g=document.createElement("span");g.classList.add("phone-code"),g.innerText="+"+p.country_code,m.appendChild(g)}c.push(m),o.append(m)}this.liMap.set(a.iso2,c)}),o.addEventListener("mousedown",a=>{if(a.button!==0)return;const u=q(a.target,"LI");this.selectCountryByTarget(u)}),this.container.appendChild(s)};n(),this.input.addEventListener("focus",a=>{n?n():y.forEach(u=>{const c=this.liMap.get(u.iso2);c&&c.forEach(l=>l.style.display="")}),clearTimeout(this.hideTimeout),this.hideTimeout=void 0,s.classList.remove("hide"),s.offsetWidth,s.classList.add("active"),this.select(),H({container:S(this.container,"scrollable-y"),element:this.input,position:"start",margin:4}),setTimeout(()=>{r||(document.addEventListener("mousedown",i,{capture:!0}),r=!0)},0)});let r=!1;const i=a=>{S(a.target,"input-select")||a.target!==this.input&&(this.hidePicker(),document.removeEventListener("mousedown",i,{capture:!0}),r=!1)},f=a=>{const u=a.key;if(a.ctrlKey||u==="Control")return!1;const c=new Set(Y(this.value).map(l=>l.iso2));this.liMap.forEach((l,h)=>{l.forEach(p=>p.style.display=c.has(h)?"":"none")}),c.size?c.size===1&&u==="Enter"&&(j(a),this.selectCountryByTarget(this.liMap.get([...c][0])[0])):y.forEach(l=>{const h=this.liMap.get(l.iso2);h&&h.forEach(p=>p.style.display="")})};this.input.addEventListener("keyup",f),this.input.addEventListener("keydown",a=>{a.key==="Enter"&&f(a)}),t.addEventListener("mousedown",a=>{this.input.matches(":focus")?(this.hidePicker(),this.input.blur()):(a.cancelBubble=!0,a.preventDefault(),this.input.focus())})}getSelected(){return{country:this.lastCountrySelected,code:this.lastCountryCodeSelected}}selectCountryByIso2(e){this.selectCountryByTarget(this.liMap.get(e)[0])}override(e,s,t){this.setValueSilently(e?b(e.default_name):t),this.lastCountrySelected=e,this.lastCountryCodeSelected=s,this.options.onCountryChange?.(this.lastCountrySelected,this.lastCountryCodeSelected)}}export{ne as C,ie as T,ae as a,Y as b,G as f,Q as g};
+//# sourceMappingURL=countryInputField-tqY1KpER.js.map

--- public/countryInputField-tqY1KpER.js.map ---
@@ -1 +1 @@
-{"version":3,"file":"countryInputField-Rr6PHiIn.js","sources":["../src/helpers/object/getDeepProperty.ts","../src/components/checkboxField.ts","../src/helpers/formatPhoneNumber.ts","../src/components/telInputField.ts","../src/components/countryInputField.ts"],"sourcesContent":["import {DEEP_PATH_JOINER} from './setDeepProperty';\n\nexport default function getDeepProperty(object: any, key: string | Array<string>) {\n  const splitted = Array.isArray(key) ? key : key.split(DEEP_PATH_JOINER);\n  let o: any = object;\n  for(const key of splitted) {\n    o = o?.[key];\n    if(!o) {\n      break;\n    }\n  }\n\n  return o;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type ListenerSetter from '../helpers/listenerSetter';\nimport ripple from './ripple';\nimport {LangPackKey, _i18n} from '../lib/langPack';\nimport getDeepProperty from '../helpers/object/getDeepProperty';\nimport rootScope from '../lib/rootScope';\nimport apiManagerProxy from '../lib/mtproto/mtprotoworker';\nimport simulateEvent from '../helpers/dom/dispatchEvent';\n\nexport type CheckboxFieldOptions = {\n  text?: LangPackKey,\n  textArgs?: any[],\n  name?: string,\n  round?: boolean,\n  toggle?: boolean,\n  stateKey?: string,\n  stateValues?: any[],\n  stateValueReverse?: boolean,\n  disabled?: boolean,\n  checked?: boolean,\n  restriction?: boolean,\n  withRipple?: boolean,\n  withHover?: boolean,\n  listenerSetter?: ListenerSetter,\n  asRadio?: boolean\n};\nexport default class CheckboxField {\n  public input: HTMLInputElement;\n  public label: HTMLLabelElement;\n  public span: HTMLSpanElement;\n  public listenerSetter: ListenerSetter;\n\n  constructor(options: CheckboxFieldOptions = {}) {\n    const label = this.label = document.createElement('label');\n    label.classList.add('checkbox-field');\n\n    if(options.restriction && !options.toggle) {\n      label.classList.add('checkbox-field-restriction');\n    }\n\n    if(options.round) {\n      label.classList.add('checkbox-field-round');\n    }\n\n    if(options.disabled) {\n      this.toggleDisability(true);\n    }\n\n    this.listenerSetter = options.listenerSetter;\n\n    const input = this.input = document.createElement('input');\n    input.classList.add('checkbox-field-input');\n    input.type = options.asRadio ? 'radio' : 'checkbox';\n    if(options.name) {\n      input[options.asRadio ? 'name' : 'id'] = 'input-' + options.name;\n    }\n\n    if(options.checked) {\n      input.checked = true;\n    }\n\n    if(options.stateKey) {\n      let loaded = options.checked !== undefined;\n      const onChange = () => {\n        if(!loaded) {\n          return;\n        }\n\n        let value: any;\n        if(options.stateValues) {\n          value = options.stateValues[input.checked ? 1 : 0];\n        } else {\n          value = input.checked;\n\n          if(options.stateValueReverse) {\n            value = !value;\n          }\n        }\n\n        rootScope.managers.appStateManager.setByKey(options.stateKey, value);\n      };\n\n      !loaded && apiManagerProxy.getState().then((state) => {\n        loaded = true;\n        const stateValue = getDeepProperty(state, options.stateKey);\n        let checked: boolean;\n        if(options.stateValues) {\n          checked = options.stateValues.indexOf(stateValue) === 1;\n        } else {\n          checked = stateValue;\n\n          if(options.stateValueReverse) {\n            checked = !checked;\n          }\n        }\n\n        this.setValueSilently(checked);\n      });\n\n      if(options.listenerSetter) options.listenerSetter.add(input)('change', onChange);\n      else input.addEventListener('change', onChange);\n    }\n\n    let span: HTMLSpanElement;\n    if(options.text) {\n      span = this.span = document.createElement('span');\n      span.classList.add('checkbox-caption');\n      _i18n(span, options.text, options.textArgs);\n    } else {\n      label.classList.add('checkbox-without-caption');\n    }\n\n    label.append(input);\n\n    if(options.toggle) {\n      label.classList.add('checkbox-field-toggle');\n\n      if(options.restriction) {\n        label.classList.add('checkbox-field-toggle-restriction');\n      }\n\n      const toggle = document.createElement('div');\n      toggle.classList.add('checkbox-toggle');\n      const circle = document.createElement('div');\n      circle.classList.add('checkbox-toggle-circle');\n      toggle.append(circle);\n      label.append(toggle);\n    } else {\n      const box = document.createElement('div');\n      box.classList.add('checkbox-box');\n\n      const checkSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n      checkSvg.classList.add('checkbox-box-check');\n      checkSvg.setAttributeNS(null, 'viewBox', '0 0 24 24');\n      const use = document.createElementNS('http://www.w3.org/2000/svg', 'use');\n      use.setAttributeNS(null, 'href', '#check');\n      use.setAttributeNS(null, 'x', '-1');\n      checkSvg.append(use);\n\n      const bg = document.createElement('div');\n      bg.classList.add('checkbox-box-background');\n\n      const border = document.createElement('div');\n      border.classList.add('checkbox-box-border');\n\n      box.append(border, bg, checkSvg);\n\n      label.append(box);\n    }\n\n    if(span) {\n      label.append(span);\n    }\n\n    if(options.withRipple) {\n      label.classList.add('checkbox-ripple', 'hover-effect');\n      ripple(label, undefined, undefined, true);\n      // label.prepend(input);\n    } else if(options.withHover) {\n      label.classList.add('hover-effect');\n    }\n  }\n\n  get checked() {\n    return this.input.checked;\n  }\n\n  set checked(checked: boolean) {\n    /* if(this.checked === checked) {\n      return;\n    } */\n\n    this.setValueSilently(checked);\n    simulateEvent(this.input, 'change');\n  }\n\n  public setValueSilently(checked: boolean) {\n    this.input.checked = checked;\n  }\n\n  public isDisabled() {\n    return this.label.classList.contains('checkbox-disabled');\n  }\n\n  public toggleDisability(disable: boolean) {\n    this.label.classList.toggle('checkbox-disabled', disable);\n    this.input.disabled = disable;\n    return () => this.toggleDisability(!disable);\n  }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {HelpCountry, HelpCountryCode} from '../layer';\nimport I18n from '../lib/langPack';\n\nlet sortedCountries: HelpCountry[];\ntype PrefixCountry = {country: HelpCountry, code: HelpCountryCode};\nconst prefixes: Map<string, PrefixCountry> = new Map();\nlet maxPrefixLength = 0;\nconst setPrefix = (country: HelpCountry, code: HelpCountryCode, prefix: string = '') => {\n  prefix = code.country_code + prefix;\n  /* if(prefixes.has(prefix)) {\n    console.error('asdasdasd', prefixes.get(prefix), country, code);\n  } */\n  maxPrefixLength = Math.max(maxPrefixLength, prefix.length);\n  prefixes.set(prefix, {country, code});\n};\n\nexport function formatPhoneNumber(originalStr: string): {\n  formatted: string,\n  country: HelpCountry,\n  code: HelpCountryCode,\n  leftPattern: string\n} {\n  originalStr = originalStr || '';\n\n  if(!prefixes.size) {\n    I18n.countriesList.forEach((country) => {\n      country.country_codes.forEach((code) => {\n        if(code.prefixes) {\n          code.prefixes.forEach((prefix) => {\n            setPrefix(country, code, prefix);\n          });\n        } else {\n          setPrefix(country, code);\n        }\n      });\n    });\n  }\n\n  // return {formatted: originalStr, country: undefined as any, leftPattern: ''};\n  let str = originalStr.replace(/\\D/g, '');\n  const phoneCode = str.slice(0, maxPrefixLength);\n\n  // //console.log('str', str, phoneCode);\n  // if(!sortedCountries) {\n  //   sortedCountries = I18n.countriesList.slice().sort((a, b) => b.country_codes[0].country_code.length - a.country_codes[0].country_code.length);\n  // }\n\n  // let country = sortedCountries.find((c) => {\n  //   return c.country_codes.find((c) => phoneCode.indexOf(c.replace(/\\D/g, '')) === 0);\n  // });\n\n  let prefixCountry: PrefixCountry;\n  for(let i = phoneCode.length - 1; i >= 0; --i) { // lookup for country by prefix\n    prefixCountry = prefixes.get(phoneCode.slice(0, i + 1));\n    if(prefixCountry) {\n      break;\n    }\n  }\n\n  if(!prefixCountry) {\n    return {\n      formatted: str,\n      country: undefined,\n      code: undefined,\n      leftPattern: ''\n    };\n  }\n\n  // country = /* PhoneCodesMain[country.phoneCode] ||  */country;\n  const country = prefixCountry.country;\n\n  const patterns = prefixCountry.code.patterns || [];\n  const searchForPattern = str.slice(prefixCountry.code.country_code.length); // splice country code\n  let pattern = '', mostMatchedPatternMatches = 0, mostMatchedPattern = '';\n  for(let i = patterns.length - 1; i >= 0; --i) {\n    pattern = patterns[i];\n\n    const _pattern = pattern.replace(/ /g, '');\n    let patternMatches = 0;\n    for(let k = 0, length = Math.min(searchForPattern.length, _pattern.length); k < length; ++k) {\n      if(searchForPattern[k] === _pattern[k]) {\n        patternMatches += 1.01;\n      } else if(_pattern[k] === 'X') {\n        ++patternMatches;\n      } else {\n        patternMatches = 0;\n        break;\n      }\n    }\n\n    if(patternMatches > mostMatchedPatternMatches) {\n      mostMatchedPatternMatches = patternMatches;\n      mostMatchedPattern = pattern;\n    }\n  }\n\n  pattern = mostMatchedPattern || pattern;\n  pattern = pattern.replace(/\\d/g, 'X');\n\n  pattern = prefixCountry.code.country_code + ' ' + pattern;\n  // let pattern = country.pattern || country.phoneCode;\n  pattern.split('').forEach((symbol, idx) => {\n    if(symbol === ' ' && str[idx] !== ' ' && str.length > idx) {\n      str = str.slice(0, idx) + ' ' + str.slice(idx);\n    }\n  });\n\n  /* if(country.pattern) {\n    str = str.slice(0, country.pattern.length);\n  } */\n\n  let leftPattern = pattern && pattern.length > str.length ? pattern.slice(str.length) : '';\n  if(leftPattern) {\n    /* const length = str.length;\n    leftPattern = leftPattern.split('').map((_, idx) => (length + idx).toString().slice(-1)).join(''); */\n    leftPattern = leftPattern.replace(/X/g, '');\n    // leftPattern = leftPattern.replace(/X/g, '0');\n  }\n\n  return {formatted: str, country, code: prefixCountry.code, leftPattern};\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport placeCaretAtEnd from '../helpers/dom/placeCaretAtEnd';\nimport {formatPhoneNumber} from '../helpers/formatPhoneNumber';\nimport {IS_APPLE, IS_ANDROID, IS_APPLE_MOBILE} from '../environment/userAgent';\nimport {HelpCountry, HelpCountryCode} from '../layer';\nimport InputField, {InputFieldOptions} from './inputField';\n\nexport default class TelInputField extends InputField {\n  private pasted = false;\n  public lastValue = '';\n\n  constructor(options: InputFieldOptions & {\n    onInput?: (formatted: ReturnType<typeof formatPhoneNumber>) => void\n  } = {}) {\n    super({\n      label: 'Contacts.PhoneNumber.Placeholder',\n      // plainText: true,\n      name: 'phone',\n      ...options\n    });\n\n    this.container.classList.add('input-field-phone');\n\n    const telEl = this.input;\n    if(telEl instanceof HTMLInputElement) {\n      telEl.type = 'tel';\n      telEl.autocomplete = 'rr55RandomRR55';\n    } else {\n      telEl.inputMode = 'decimal';\n\n      const pixelRatio = window.devicePixelRatio;\n      if(pixelRatio > 1) {\n        let letterSpacing: number;\n        if(IS_APPLE) {\n          letterSpacing = pixelRatio * -.16;\n        } else if(IS_ANDROID) {\n          letterSpacing = 0;\n        }\n\n        telEl.style.setProperty('--letter-spacing', letterSpacing + 'px');\n      }\n\n      const originalFunc = this.setValueSilently.bind(this);\n      this.setValueSilently = (value) => {\n        originalFunc(value);\n        placeCaretAtEnd(this.input, true);\n      };\n    }\n\n    telEl.addEventListener('input', () => {\n      // console.log('input', this.value);\n      telEl.classList.remove('error');\n\n      const value = this.value;\n      const diff = Math.abs(value.length - this.lastValue.length);\n      if(diff > 1 && !this.pasted && IS_APPLE_MOBILE) {\n        this.setValueSilently(this.lastValue + value);\n      }\n\n      this.pasted = false;\n\n      this.setLabel();\n\n      let formattedPhoneNumber: ReturnType<typeof formatPhoneNumber>;\n      let formatted: string, country: HelpCountry, countryCode: HelpCountryCode, leftPattern = '';\n      if(this.value.replace(/\\++/, '+') === '+') {\n        this.setValueSilently('+');\n      } else {\n        formattedPhoneNumber = formatPhoneNumber(this.value);\n        formatted = formattedPhoneNumber.formatted;\n        country = formattedPhoneNumber.country;\n        leftPattern = formattedPhoneNumber.leftPattern;\n        countryCode = formattedPhoneNumber.code;\n        this.setValueSilently(this.lastValue = formatted ? '+' + formatted : '');\n      }\n\n      telEl.dataset.leftPattern = leftPattern/* .replace(/X/g, '0') */;\n\n      // console.log(formatted, country);\n\n      options.onInput && options.onInput(formattedPhoneNumber);\n    });\n\n    telEl.addEventListener('paste', () => {\n      this.pasted = true;\n      // console.log('paste', telEl.value);\n    });\n\n    /* telEl.addEventListener('change', (e) => {\n      console.log('change', telEl.value);\n    }); */\n\n    telEl.addEventListener('keypress', (e) => {\n      // console.log('keypress', this.value);\n      const key = e.key;\n      if(/\\D/.test(key) && !(e.metaKey || e.ctrlKey) && key !== 'Backspace' && !(key === '+' && e.shiftKey/*  && !this.value */)) {\n        e.preventDefault();\n        return false;\n      }\n    });\n\n    /* telEl.addEventListener('focus', function(this: typeof telEl, e) {\n      this.removeAttribute('readonly'); // fix autocomplete\n    });*/\n  }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport IS_EMOJI_SUPPORTED from '../environment/emojiSupport';\nimport cancelEvent from '../helpers/dom/cancelEvent';\nimport findUpClassName from '../helpers/dom/findUpClassName';\nimport findUpTag from '../helpers/dom/findUpTag';\nimport setInnerHTML from '../helpers/dom/setInnerHTML';\nimport fastSmoothScroll from '../helpers/fastSmoothScroll';\nimport {randomLong} from '../helpers/random';\nimport {HelpCountry, HelpCountryCode} from '../layer';\nimport I18n, {i18n} from '../lib/langPack';\nimport wrapEmojiText from '../lib/richTextProcessor/wrapEmojiText';\nimport rootScope from '../lib/rootScope';\nimport {getCountryEmoji} from '../vendor/emoji';\nimport InputField, {InputFieldOptions} from './inputField';\nimport Scrollable from './scrollable';\n\nlet countries: HelpCountry.helpCountry[];\nconst setCountries = () => {\n  countries = I18n.countriesList\n  .filter((country) => !country.pFlags?.hidden)\n  .sort((a, b) => (a.name || a.default_name).localeCompare(b.name || b.default_name));\n};\n\nlet init = () => {\n  init = undefined;\n  setCountries();\n  rootScope.addEventListener('language_change', () => {\n    setCountries();\n  });\n};\n\nconst VIRTUAL_COUNTRIES = new Set(['FT']);\n\nexport function filterCountries(value: string, excludeVirtual?: boolean) {\n  init?.();\n\n  value = value.toLowerCase();\n  const filtered = countries.filter((c) => {\n    if(excludeVirtual && VIRTUAL_COUNTRIES.has(c.iso2)) {\n      return false;\n    }\n\n    const names = [\n      c.name,\n      c.default_name,\n      c.iso2\n    ];\n\n    names.filter(Boolean).forEach((name) => {\n      const abbr = name.split(' ').filter((word) => /\\w/.test(word)).map((word) => word[0]).join('');\n      if(abbr.length > 1) {\n        names.push(abbr);\n      }\n    });\n\n    const good = !!names.filter(Boolean).find((str) => str.toLowerCase().indexOf(value) !== -1)/*  === 0 */;// i.test(c.name);\n    return good;\n  });\n\n  return filtered;\n}\n\nexport function sortCountries(countries: HelpCountry.helpCountry[]) {\n  return countries.sort((a, b) => (a.name || a.default_name).localeCompare(b.name || b.default_name));\n}\n\nexport default class CountryInputField extends InputField {\n  private lastCountrySelected: HelpCountry;\n  private lastCountryCodeSelected: HelpCountryCode;\n\n  private hideTimeout: number;\n  private selectWrapper: HTMLElement;\n\n  private liMap: Map<string, HTMLLIElement[]>;\n\n  constructor(public options: InputFieldOptions & {\n    onCountryChange?: (country: HelpCountry.helpCountry, code: HelpCountryCode.helpCountryCode) => void,\n    noPhoneCodes?: boolean\n  } = {}) {\n    super({\n      label: 'Country',\n      name: randomLong(),\n      ...options\n    });\n\n    init?.();\n\n    this.liMap = new Map();\n\n    this.container.classList.add('input-select');\n\n    const selectWrapper = this.selectWrapper = document.createElement('div');\n    selectWrapper.classList.add('select-wrapper', 'z-depth-3', 'hide');\n\n    const arrowDown = document.createElement('span');\n    arrowDown.classList.add('arrow', 'arrow-down');\n    this.container.append(arrowDown);\n\n    const selectList = document.createElement('ul');\n    selectWrapper.appendChild(selectList);\n\n    const scroll = new Scrollable(selectWrapper);\n\n    let initSelect = () => {\n      initSelect = null;\n\n      countries.forEach((c) => {\n        if(options.noPhoneCodes && VIRTUAL_COUNTRIES.has(c.iso2)) {\n          return;\n        }\n\n        const emoji = getCountryEmoji(c.iso2);\n\n        const liArr: Array<HTMLLIElement> = [];\n        for(let i = 0, length = Math.min(c.country_codes.length, options.noPhoneCodes ? 1 : Infinity); i < length; ++i) {\n          const countryCode = c.country_codes[i];\n          const li = document.createElement('li');\n\n          const wrapped = wrapEmojiText(emoji);\n          if(IS_EMOJI_SUPPORTED) {\n            const spanEmoji = document.createElement('span');\n            setInnerHTML(spanEmoji, wrapped);\n            li.append(spanEmoji);\n          } else {\n            setInnerHTML(li, wrapped);\n          }\n\n          const el = i18n(c.default_name as any);\n          el.dataset.defaultName = c.default_name;\n          li.append(el);\n\n          if(!options.noPhoneCodes) {\n            const span = document.createElement('span');\n            span.classList.add('phone-code');\n            span.innerText = '+' + countryCode.country_code;\n            li.appendChild(span);\n          }\n\n          liArr.push(li);\n          selectList.append(li);\n        }\n\n        this.liMap.set(c.iso2, liArr);\n      });\n\n      selectList.addEventListener('mousedown', (e) => {\n        if(e.button !== 0) { // other buttons but left shall not pass\n          return;\n        }\n\n        const target = findUpTag(e.target, 'LI')\n        this.selectCountryByTarget(target);\n        // console.log('clicked', e, countryName, phoneCode);\n      });\n\n      this.container.appendChild(selectWrapper);\n    };\n\n    initSelect();\n\n    this.input.addEventListener('focus', (e) => {\n      if(initSelect) {\n        initSelect();\n      } else {\n        countries.forEach((c) => {\n          const arr = this.liMap.get(c.iso2);\n          if(!arr) return;\n          arr.forEach((li) => li.style.display = '');\n        });\n      }\n\n      clearTimeout(this.hideTimeout);\n      this.hideTimeout = undefined;\n\n      selectWrapper.classList.remove('hide');\n      void selectWrapper.offsetWidth; // reflow\n      selectWrapper.classList.add('active');\n\n      this.select();\n\n      fastSmoothScroll({\n        // container: page.pageEl.parentElement.parentElement,\n        container: findUpClassName(this.container, 'scrollable-y'),\n        element: this.input,\n        position: 'start',\n        margin: 4\n      });\n\n      setTimeout(() => {\n        if(!mouseDownHandlerAttached) {\n          document.addEventListener('mousedown', onMouseDown, {capture: true});\n          mouseDownHandlerAttached = true;\n        }\n      }, 0);\n    });\n\n    let mouseDownHandlerAttached = false;\n    const onMouseDown = (e: MouseEvent) => {\n      if(findUpClassName(e.target, 'input-select')) {\n        return;\n      }\n      if(e.target === this.input) {\n        return;\n      }\n\n      this.hidePicker();\n      document.removeEventListener('mousedown', onMouseDown, {capture: true});\n      mouseDownHandlerAttached = false;\n    };\n\n    /* false && this.input.addEventListener('blur', function(this: typeof this.input, e) {\n      hidePicker();\n\n      e.cancelBubble = true;\n    }, {capture: true}); */\n\n    const onKeyPress = (e: KeyboardEvent) => {\n      const key = e.key;\n      if(e.ctrlKey || key === 'Control') return false;\n\n      // let i = new RegExp('^' + this.value, 'i');\n      const filtered = new Set(filterCountries(this.value).map((c) => c.iso2));\n      this.liMap.forEach((arr, iso2) => {\n        arr.forEach((li) => li.style.display = filtered.has(iso2) ? '' : 'none');\n      });\n\n      //           \n      /* if(matches.length === 1 && matches[0].li.length === 1) {\n        if(matches[0].name === lastCountrySelected) return false;\n        //console.log('clicking', matches[0]);\n\n        var clickEvent = document.createEvent('MouseEvents');\n        clickEvent.initEvent('mousedown', true, true);\n        matches[0].li[0].dispatchEvent(clickEvent);\n        return false;\n      } else  */if(!filtered.size) {\n        countries.forEach((c) => {\n          const arr = this.liMap.get(c.iso2);\n          if(!arr) {\n            return;\n          }\n\n          arr.forEach((li) => li.style.display = '');\n        });\n      } else if(filtered.size === 1 && key === 'Enter') {\n        cancelEvent(e);\n        this.selectCountryByTarget(this.liMap.get([...filtered][0])[0]);\n      }\n    };\n\n    this.input.addEventListener('keyup', onKeyPress);\n    this.input.addEventListener('keydown', (e) => {\n      if(e.key === 'Enter') {\n        onKeyPress(e);\n      }\n    });\n\n    arrowDown.addEventListener('mousedown', (e) => {\n      if(this.input.matches(':focus')) {\n        this.hidePicker();\n        this.input.blur();\n      } else {\n        e.cancelBubble = true;\n        e.preventDefault();\n        this.input.focus();\n      }\n    });\n  }\n\n  public getSelected() {\n    return {country: this.lastCountrySelected, code: this.lastCountryCodeSelected};\n  }\n\n  public hidePicker = () => {\n    if(this.hideTimeout !== undefined) return;\n    this.selectWrapper.classList.remove('active');\n    this.hideTimeout = window.setTimeout(() => {\n      this.selectWrapper.classList.add('hide');\n      this.hideTimeout = undefined;\n    }, 200);\n  }\n\n  public selectCountryByTarget = (target: HTMLElement) => {\n    const defaultName = target.querySelector<HTMLElement>('[data-default-name]').dataset.defaultName;\n    const phoneCodeEl = target.querySelector<HTMLElement>('.phone-code');\n    const phoneCode = phoneCodeEl?.innerText;\n    const countryCode = phoneCode && phoneCode.replace(/\\D/g, '');\n\n    this.value = i18n(defaultName as any);\n    this.lastCountrySelected = countries.find((c) => c.default_name === defaultName);\n    this.lastCountryCodeSelected = countryCode && this.lastCountrySelected.country_codes.find((_countryCode) => _countryCode.country_code === countryCode);\n\n    this.options.onCountryChange?.(this.lastCountrySelected, this.lastCountryCodeSelected);\n    this.hidePicker();\n  }\n\n  public selectCountryByIso2(iso2: string) {\n    this.selectCountryByTarget(this.liMap.get(iso2)[0]);\n  }\n\n  public override(country: HelpCountry, code: HelpCountryCode, countryName?: string) {\n    this.setValueSilently(country ? i18n(country.default_name as any) : countryName);\n    this.lastCountrySelected = country;\n    this.lastCountryCodeSelected = code;\n    this.options.onCountryChange?.(this.lastCountrySelected, this.lastCountryCodeSelected);\n  }\n}\n"],"names":["getDeepProperty","object","key","splitted","DEEP_PATH_JOINER","o","CheckboxField","options","label","input","loaded","onChange","value","rootScope","apiManagerProxy","state","stateValue","checked","span","_i18n","toggle","circle","box","checkSvg","use","bg","border","ripple","simulateEvent","disable","prefixes","maxPrefixLength","setPrefix","country","code","prefix","formatPhoneNumber","originalStr","I18n","str","phoneCode","prefixCountry","i","patterns","searchForPattern","pattern","mostMatchedPatternMatches","mostMatchedPattern","_pattern","patternMatches","k","length","symbol","idx","leftPattern","TelInputField","InputField","telEl","pixelRatio","letterSpacing","IS_APPLE","IS_ANDROID","originalFunc","placeCaretAtEnd","IS_APPLE_MOBILE","formattedPhoneNumber","formatted","e","countries","setCountries","a","b","init","VIRTUAL_COUNTRIES","filterCountries","excludeVirtual","c","names","name","abbr","word","CountryInputField","randomLong","target","defaultName","countryCode","i18n","_countryCode","selectWrapper","arrowDown","selectList","Scrollable","initSelect","emoji","getCountryEmoji","liArr","li","wrapped","wrapEmojiText","IS_EMOJI_SUPPORTED","spanEmoji","setInnerHTML","el","findUpTag","arr","fastSmoothScroll","findUpClassName","mouseDownHandlerAttached","onMouseDown","onKeyPress","filtered","iso2","cancelEvent","countryName"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"countryInputField-tqY1KpER.js","sources":["../src/helpers/object/getDeepProperty.ts","../src/components/checkboxField.ts","../src/helpers/formatPhoneNumber.ts","../src/components/telInputField.ts","../src/components/countryInputField.ts"],"sourcesContent":["import {DEEP_PATH_JOINER} from './setDeepProperty';\n\nexport default function getDeepProperty(object: any, key: string | Array<string>) {\n  const splitted = Array.isArray(key) ? key : key.split(DEEP_PATH_JOINER);\n  let o: any = object;\n  for(const key of splitted) {\n    o = o?.[key];\n    if(!o) {\n      break;\n    }\n  }\n\n  return o;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type ListenerSetter from '../helpers/listenerSetter';\nimport ripple from './ripple';\nimport {LangPackKey, _i18n} from '../lib/langPack';\nimport getDeepProperty from '../helpers/object/getDeepProperty';\nimport rootScope from '../lib/rootScope';\nimport apiManagerProxy from '../lib/mtproto/mtprotoworker';\nimport simulateEvent from '../helpers/dom/dispatchEvent';\n\nexport type CheckboxFieldOptions = {\n  text?: LangPackKey,\n  textArgs?: any[],\n  name?: string,\n  round?: boolean,\n  toggle?: boolean,\n  stateKey?: string,\n  stateValues?: any[],\n  stateValueReverse?: boolean,\n  disabled?: boolean,\n  checked?: boolean,\n  restriction?: boolean,\n  withRipple?: boolean,\n  withHover?: boolean,\n  listenerSetter?: ListenerSetter,\n  asRadio?: boolean\n};\nexport default class CheckboxField {\n  public input: HTMLInputElement;\n  public label: HTMLLabelElement;\n  public span: HTMLSpanElement;\n  public listenerSetter: ListenerSetter;\n\n  constructor(options: CheckboxFieldOptions = {}) {\n    const label = this.label = document.createElement('label');\n    label.classList.add('checkbox-field');\n\n    if(options.restriction && !options.toggle) {\n      label.classList.add('checkbox-field-restriction');\n    }\n\n    if(options.round) {\n      label.classList.add('checkbox-field-round');\n    }\n\n    if(options.disabled) {\n      this.toggleDisability(true);\n    }\n\n    this.listenerSetter = options.listenerSetter;\n\n    const input = this.input = document.createElement('input');\n    input.classList.add('checkbox-field-input');\n    input.type = options.asRadio ? 'radio' : 'checkbox';\n    if(options.name) {\n      input[options.asRadio ? 'name' : 'id'] = 'input-' + options.name;\n    }\n\n    if(options.checked) {\n      input.checked = true;\n    }\n\n    if(options.stateKey) {\n      let loaded = options.checked !== undefined;\n      const onChange = () => {\n        if(!loaded) {\n          return;\n        }\n\n        let value: any;\n        if(options.stateValues) {\n          value = options.stateValues[input.checked ? 1 : 0];\n        } else {\n          value = input.checked;\n\n          if(options.stateValueReverse) {\n            value = !value;\n          }\n        }\n\n        rootScope.managers.appStateManager.setByKey(options.stateKey, value);\n      };\n\n      !loaded && apiManagerProxy.getState().then((state) => {\n        loaded = true;\n        const stateValue = getDeepProperty(state, options.stateKey);\n        let checked: boolean;\n        if(options.stateValues) {\n          checked = options.stateValues.indexOf(stateValue) === 1;\n        } else {\n          checked = stateValue;\n\n          if(options.stateValueReverse) {\n            checked = !checked;\n          }\n        }\n\n        this.setValueSilently(checked);\n      });\n\n      if(options.listenerSetter) options.listenerSetter.add(input)('change', onChange);\n      else input.addEventListener('change', onChange);\n    }\n\n    let span: HTMLSpanElement;\n    if(options.text) {\n      span = this.span = document.createElement('span');\n      span.classList.add('checkbox-caption');\n      _i18n(span, options.text, options.textArgs);\n    } else {\n      label.classList.add('checkbox-without-caption');\n    }\n\n    label.append(input);\n\n    if(options.toggle) {\n      label.classList.add('checkbox-field-toggle');\n\n      if(options.restriction) {\n        label.classList.add('checkbox-field-toggle-restriction');\n      }\n\n      const toggle = document.createElement('div');\n      toggle.classList.add('checkbox-toggle');\n      const circle = document.createElement('div');\n      circle.classList.add('checkbox-toggle-circle');\n      toggle.append(circle);\n      label.append(toggle);\n    } else {\n      const box = document.createElement('div');\n      box.classList.add('checkbox-box');\n\n      const checkSvg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');\n      checkSvg.classList.add('checkbox-box-check');\n      checkSvg.setAttributeNS(null, 'viewBox', '0 0 24 24');\n      const use = document.createElementNS('http://www.w3.org/2000/svg', 'use');\n      use.setAttributeNS(null, 'href', '#check');\n      use.setAttributeNS(null, 'x', '-1');\n      checkSvg.append(use);\n\n      const bg = document.createElement('div');\n      bg.classList.add('checkbox-box-background');\n\n      const border = document.createElement('div');\n      border.classList.add('checkbox-box-border');\n\n      box.append(border, bg, checkSvg);\n\n      label.append(box);\n    }\n\n    if(span) {\n      label.append(span);\n    }\n\n    if(options.withRipple) {\n      label.classList.add('checkbox-ripple', 'hover-effect');\n      ripple(label, undefined, undefined, true);\n      // label.prepend(input);\n    } else if(options.withHover) {\n      label.classList.add('hover-effect');\n    }\n  }\n\n  get checked() {\n    return this.input.checked;\n  }\n\n  set checked(checked: boolean) {\n    /* if(this.checked === checked) {\n      return;\n    } */\n\n    this.setValueSilently(checked);\n    simulateEvent(this.input, 'change');\n  }\n\n  public setValueSilently(checked: boolean) {\n    this.input.checked = checked;\n  }\n\n  public isDisabled() {\n    return this.label.classList.contains('checkbox-disabled');\n  }\n\n  public toggleDisability(disable: boolean) {\n    this.label.classList.toggle('checkbox-disabled', disable);\n    this.input.disabled = disable;\n    return () => this.toggleDisability(!disable);\n  }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {HelpCountry, HelpCountryCode} from '../layer';\nimport I18n from '../lib/langPack';\n\nlet sortedCountries: HelpCountry[];\ntype PrefixCountry = {country: HelpCountry, code: HelpCountryCode};\nconst prefixes: Map<string, PrefixCountry> = new Map();\nlet maxPrefixLength = 0;\nconst setPrefix = (country: HelpCountry, code: HelpCountryCode, prefix: string = '') => {\n  prefix = code.country_code + prefix;\n  /* if(prefixes.has(prefix)) {\n    console.error('asdasdasd', prefixes.get(prefix), country, code);\n  } */\n  maxPrefixLength = Math.max(maxPrefixLength, prefix.length);\n  prefixes.set(prefix, {country, code});\n};\n\nexport function formatPhoneNumber(originalStr: string): {\n  formatted: string,\n  country: HelpCountry,\n  code: HelpCountryCode,\n  leftPattern: string\n} {\n  originalStr = originalStr || '';\n\n  if(!prefixes.size) {\n    I18n.countriesList.forEach((country) => {\n      country.country_codes.forEach((code) => {\n        if(code.prefixes) {\n          code.prefixes.forEach((prefix) => {\n            setPrefix(country, code, prefix);\n          });\n        } else {\n          setPrefix(country, code);\n        }\n      });\n    });\n  }\n\n  // return {formatted: originalStr, country: undefined as any, leftPattern: ''};\n  let str = originalStr.replace(/\\D/g, '');\n  const phoneCode = str.slice(0, maxPrefixLength);\n\n  // //console.log('str', str, phoneCode);\n  // if(!sortedCountries) {\n  //   sortedCountries = I18n.countriesList.slice().sort((a, b) => b.country_codes[0].country_code.length - a.country_codes[0].country_code.length);\n  // }\n\n  // let country = sortedCountries.find((c) => {\n  //   return c.country_codes.find((c) => phoneCode.indexOf(c.replace(/\\D/g, '')) === 0);\n  // });\n\n  let prefixCountry: PrefixCountry;\n  for(let i = phoneCode.length - 1; i >= 0; --i) { // lookup for country by prefix\n    prefixCountry = prefixes.get(phoneCode.slice(0, i + 1));\n    if(prefixCountry) {\n      break;\n    }\n  }\n\n  if(!prefixCountry) {\n    return {\n      formatted: str,\n      country: undefined,\n      code: undefined,\n      leftPattern: ''\n    };\n  }\n\n  // country = /* PhoneCodesMain[country.phoneCode] ||  */country;\n  const country = prefixCountry.country;\n\n  const patterns = prefixCountry.code.patterns || [];\n  const searchForPattern = str.slice(prefixCountry.code.country_code.length); // splice country code\n  let pattern = '', mostMatchedPatternMatches = 0, mostMatchedPattern = '';\n  for(let i = patterns.length - 1; i >= 0; --i) {\n    pattern = patterns[i];\n\n    const _pattern = pattern.replace(/ /g, '');\n    let patternMatches = 0;\n    for(let k = 0, length = Math.min(searchForPattern.length, _pattern.length); k < length; ++k) {\n      if(searchForPattern[k] === _pattern[k]) {\n        patternMatches += 1.01;\n      } else if(_pattern[k] === 'X') {\n        ++patternMatches;\n      } else {\n        patternMatches = 0;\n        break;\n      }\n    }\n\n    if(patternMatches > mostMatchedPatternMatches) {\n      mostMatchedPatternMatches = patternMatches;\n      mostMatchedPattern = pattern;\n    }\n  }\n\n  pattern = mostMatchedPattern || pattern;\n  pattern = pattern.replace(/\\d/g, 'X');\n\n  pattern = prefixCountry.code.country_code + ' ' + pattern;\n  // let pattern = country.pattern || country.phoneCode;\n  pattern.split('').forEach((symbol, idx) => {\n    if(symbol === ' ' && str[idx] !== ' ' && str.length > idx) {\n      str = str.slice(0, idx) + ' ' + str.slice(idx);\n    }\n  });\n\n  /* if(country.pattern) {\n    str = str.slice(0, country.pattern.length);\n  } */\n\n  let leftPattern = pattern && pattern.length > str.length ? pattern.slice(str.length) : '';\n  if(leftPattern) {\n    /* const length = str.length;\n    leftPattern = leftPattern.split('').map((_, idx) => (length + idx).toString().slice(-1)).join(''); */\n    leftPattern = leftPattern.replace(/X/g, '');\n    // leftPattern = leftPattern.replace(/X/g, '0');\n  }\n\n  return {formatted: str, country, code: prefixCountry.code, leftPattern};\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport placeCaretAtEnd from '../helpers/dom/placeCaretAtEnd';\nimport {formatPhoneNumber} from '../helpers/formatPhoneNumber';\nimport {IS_APPLE, IS_ANDROID, IS_APPLE_MOBILE} from '../environment/userAgent';\nimport {HelpCountry, HelpCountryCode} from '../layer';\nimport InputField, {InputFieldOptions} from './inputField';\n\nexport default class TelInputField extends InputField {\n  private pasted = false;\n  public lastValue = '';\n\n  constructor(options: InputFieldOptions & {\n    onInput?: (formatted: ReturnType<typeof formatPhoneNumber>) => void\n  } = {}) {\n    super({\n      label: 'Contacts.PhoneNumber.Placeholder',\n      // plainText: true,\n      name: 'phone',\n      ...options\n    });\n\n    this.container.classList.add('input-field-phone');\n\n    const telEl = this.input;\n    if(telEl instanceof HTMLInputElement) {\n      telEl.type = 'tel';\n      telEl.autocomplete = 'rr55RandomRR55';\n    } else {\n      telEl.inputMode = 'decimal';\n\n      const pixelRatio = window.devicePixelRatio;\n      if(pixelRatio > 1) {\n        let letterSpacing: number;\n        if(IS_APPLE) {\n          letterSpacing = pixelRatio * -.16;\n        } else if(IS_ANDROID) {\n          letterSpacing = 0;\n        }\n\n        telEl.style.setProperty('--letter-spacing', letterSpacing + 'px');\n      }\n\n      const originalFunc = this.setValueSilently.bind(this);\n      this.setValueSilently = (value) => {\n        originalFunc(value);\n        placeCaretAtEnd(this.input, true);\n      };\n    }\n\n    telEl.addEventListener('input', () => {\n      // console.log('input', this.value);\n      telEl.classList.remove('error');\n\n      const value = this.value;\n      const diff = Math.abs(value.length - this.lastValue.length);\n      if(diff > 1 && !this.pasted && IS_APPLE_MOBILE) {\n        this.setValueSilently(this.lastValue + value);\n      }\n\n      this.pasted = false;\n\n      this.setLabel();\n\n      let formattedPhoneNumber: ReturnType<typeof formatPhoneNumber>;\n      let formatted: string, country: HelpCountry, countryCode: HelpCountryCode, leftPattern = '';\n      if(this.value.replace(/\\++/, '+') === '+') {\n        this.setValueSilently('+');\n      } else {\n        formattedPhoneNumber = formatPhoneNumber(this.value);\n        formatted = formattedPhoneNumber.formatted;\n        country = formattedPhoneNumber.country;\n        leftPattern = formattedPhoneNumber.leftPattern;\n        countryCode = formattedPhoneNumber.code;\n        this.setValueSilently(this.lastValue = formatted ? '+' + formatted : '');\n      }\n\n      telEl.dataset.leftPattern = leftPattern/* .replace(/X/g, '0') */;\n\n      // console.log(formatted, country);\n\n      options.onInput && options.onInput(formattedPhoneNumber);\n    });\n\n    telEl.addEventListener('paste', () => {\n      this.pasted = true;\n      // console.log('paste', telEl.value);\n    });\n\n    /* telEl.addEventListener('change', (e) => {\n      console.log('change', telEl.value);\n    }); */\n\n    telEl.addEventListener('keypress', (e) => {\n      // console.log('keypress', this.value);\n      const key = e.key;\n      if(/\\D/.test(key) && !(e.metaKey || e.ctrlKey) && key !== 'Backspace' && !(key === '+' && e.shiftKey/*  && !this.value */)) {\n        e.preventDefault();\n        return false;\n      }\n    });\n\n    /* telEl.addEventListener('focus', function(this: typeof telEl, e) {\n      this.removeAttribute('readonly'); // fix autocomplete\n    });*/\n  }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport IS_EMOJI_SUPPORTED from '../environment/emojiSupport';\nimport cancelEvent from '../helpers/dom/cancelEvent';\nimport findUpClassName from '../helpers/dom/findUpClassName';\nimport findUpTag from '../helpers/dom/findUpTag';\nimport setInnerHTML from '../helpers/dom/setInnerHTML';\nimport fastSmoothScroll from '../helpers/fastSmoothScroll';\nimport {randomLong} from '../helpers/random';\nimport {HelpCountry, HelpCountryCode} from '../layer';\nimport I18n, {i18n} from '../lib/langPack';\nimport wrapEmojiText from '../lib/richTextProcessor/wrapEmojiText';\nimport rootScope from '../lib/rootScope';\nimport {getCountryEmoji} from '../vendor/emoji';\nimport InputField, {InputFieldOptions} from './inputField';\nimport Scrollable from './scrollable';\n\nlet countries: HelpCountry.helpCountry[];\nconst setCountries = () => {\n  countries = I18n.countriesList\n  .filter((country) => !country.pFlags?.hidden)\n  .sort((a, b) => (a.name || a.default_name).localeCompare(b.name || b.default_name));\n};\n\nlet init = () => {\n  init = undefined;\n  setCountries();\n  rootScope.addEventListener('language_change', () => {\n    setCountries();\n  });\n};\n\nconst VIRTUAL_COUNTRIES = new Set(['FT']);\n\nexport function filterCountries(value: string, excludeVirtual?: boolean) {\n  init?.();\n\n  value = value.toLowerCase();\n  const filtered = countries.filter((c) => {\n    if(excludeVirtual && VIRTUAL_COUNTRIES.has(c.iso2)) {\n      return false;\n    }\n\n    const names = [\n      c.name,\n      c.default_name,\n      c.iso2\n    ];\n\n    names.filter(Boolean).forEach((name) => {\n      const abbr = name.split(' ').filter((word) => /\\w/.test(word)).map((word) => word[0]).join('');\n      if(abbr.length > 1) {\n        names.push(abbr);\n      }\n    });\n\n    const good = !!names.filter(Boolean).find((str) => str.toLowerCase().indexOf(value) !== -1)/*  === 0 */;// i.test(c.name);\n    return good;\n  });\n\n  return filtered;\n}\n\nexport function sortCountries(countries: HelpCountry.helpCountry[]) {\n  return countries.sort((a, b) => (a.name || a.default_name).localeCompare(b.name || b.default_name));\n}\n\nexport default class CountryInputField extends InputField {\n  private lastCountrySelected: HelpCountry;\n  private lastCountryCodeSelected: HelpCountryCode;\n\n  private hideTimeout: number;\n  private selectWrapper: HTMLElement;\n\n  private liMap: Map<string, HTMLLIElement[]>;\n\n  constructor(public options: InputFieldOptions & {\n    onCountryChange?: (country: HelpCountry.helpCountry, code: HelpCountryCode.helpCountryCode) => void,\n    noPhoneCodes?: boolean\n  } = {}) {\n    super({\n      label: 'Country',\n      name: randomLong(),\n      ...options\n    });\n\n    init?.();\n\n    this.liMap = new Map();\n\n    this.container.classList.add('input-select');\n\n    const selectWrapper = this.selectWrapper = document.createElement('div');\n    selectWrapper.classList.add('select-wrapper', 'z-depth-3', 'hide');\n\n    const arrowDown = document.createElement('span');\n    arrowDown.classList.add('arrow', 'arrow-down');\n    this.container.append(arrowDown);\n\n    const selectList = document.createElement('ul');\n    selectWrapper.appendChild(selectList);\n\n    const scroll = new Scrollable(selectWrapper);\n\n    let initSelect = () => {\n      initSelect = null;\n\n      countries.forEach((c) => {\n        if(options.noPhoneCodes && VIRTUAL_COUNTRIES.has(c.iso2)) {\n          return;\n        }\n\n        const emoji = getCountryEmoji(c.iso2);\n\n        const liArr: Array<HTMLLIElement> = [];\n        for(let i = 0, length = Math.min(c.country_codes.length, options.noPhoneCodes ? 1 : Infinity); i < length; ++i) {\n          const countryCode = c.country_codes[i];\n          const li = document.createElement('li');\n\n          const wrapped = wrapEmojiText(emoji);\n          if(IS_EMOJI_SUPPORTED) {\n            const spanEmoji = document.createElement('span');\n            setInnerHTML(spanEmoji, wrapped);\n            li.append(spanEmoji);\n          } else {\n            setInnerHTML(li, wrapped);\n          }\n\n          const el = i18n(c.default_name as any);\n          el.dataset.defaultName = c.default_name;\n          li.append(el);\n\n          if(!options.noPhoneCodes) {\n            const span = document.createElement('span');\n            span.classList.add('phone-code');\n            span.innerText = '+' + countryCode.country_code;\n            li.appendChild(span);\n          }\n\n          liArr.push(li);\n          selectList.append(li);\n        }\n\n        this.liMap.set(c.iso2, liArr);\n      });\n\n      selectList.addEventListener('mousedown', (e) => {\n        if(e.button !== 0) { // other buttons but left shall not pass\n          return;\n        }\n\n        const target = findUpTag(e.target, 'LI')\n        this.selectCountryByTarget(target);\n        // console.log('clicked', e, countryName, phoneCode);\n      });\n\n      this.container.appendChild(selectWrapper);\n    };\n\n    initSelect();\n\n    this.input.addEventListener('focus', (e) => {\n      if(initSelect) {\n        initSelect();\n      } else {\n        countries.forEach((c) => {\n          const arr = this.liMap.get(c.iso2);\n          if(!arr) return;\n          arr.forEach((li) => li.style.display = '');\n        });\n      }\n\n      clearTimeout(this.hideTimeout);\n      this.hideTimeout = undefined;\n\n      selectWrapper.classList.remove('hide');\n      void selectWrapper.offsetWidth; // reflow\n      selectWrapper.classList.add('active');\n\n      this.select();\n\n      fastSmoothScroll({\n        // container: page.pageEl.parentElement.parentElement,\n        container: findUpClassName(this.container, 'scrollable-y'),\n        element: this.input,\n        position: 'start',\n        margin: 4\n      });\n\n      setTimeout(() => {\n        if(!mouseDownHandlerAttached) {\n          document.addEventListener('mousedown', onMouseDown, {capture: true});\n          mouseDownHandlerAttached = true;\n        }\n      }, 0);\n    });\n\n    let mouseDownHandlerAttached = false;\n    const onMouseDown = (e: MouseEvent) => {\n      if(findUpClassName(e.target, 'input-select')) {\n        return;\n      }\n      if(e.target === this.input) {\n        return;\n      }\n\n      this.hidePicker();\n      document.removeEventListener('mousedown', onMouseDown, {capture: true});\n      mouseDownHandlerAttached = false;\n    };\n\n    /* false && this.input.addEventListener('blur', function(this: typeof this.input, e) {\n      hidePicker();\n\n      e.cancelBubble = true;\n    }, {capture: true}); */\n\n    const onKeyPress = (e: KeyboardEvent) => {\n      const key = e.key;\n      if(e.ctrlKey || key === 'Control') return false;\n\n      // let i = new RegExp('^' + this.value, 'i');\n      const filtered = new Set(filterCountries(this.value).map((c) => c.iso2));\n      this.liMap.forEach((arr, iso2) => {\n        arr.forEach((li) => li.style.display = filtered.has(iso2) ? '' : 'none');\n      });\n\n      //           \n      /* if(matches.length === 1 && matches[0].li.length === 1) {\n        if(matches[0].name === lastCountrySelected) return false;\n        //console.log('clicking', matches[0]);\n\n        var clickEvent = document.createEvent('MouseEvents');\n        clickEvent.initEvent('mousedown', true, true);\n        matches[0].li[0].dispatchEvent(clickEvent);\n        return false;\n      } else  */if(!filtered.size) {\n        countries.forEach((c) => {\n          const arr = this.liMap.get(c.iso2);\n          if(!arr) {\n            return;\n          }\n\n          arr.forEach((li) => li.style.display = '');\n        });\n      } else if(filtered.size === 1 && key === 'Enter') {\n        cancelEvent(e);\n        this.selectCountryByTarget(this.liMap.get([...filtered][0])[0]);\n      }\n    };\n\n    this.input.addEventListener('keyup', onKeyPress);\n    this.input.addEventListener('keydown', (e) => {\n      if(e.key === 'Enter') {\n        onKeyPress(e);\n      }\n    });\n\n    arrowDown.addEventListener('mousedown', (e) => {\n      if(this.input.matches(':focus')) {\n        this.hidePicker();\n        this.input.blur();\n      } else {\n        e.cancelBubble = true;\n        e.preventDefault();\n        this.input.focus();\n      }\n    });\n  }\n\n  public getSelected() {\n    return {country: this.lastCountrySelected, code: this.lastCountryCodeSelected};\n  }\n\n  public hidePicker = () => {\n    if(this.hideTimeout !== undefined) return;\n    this.selectWrapper.classList.remove('active');\n    this.hideTimeout = window.setTimeout(() => {\n      this.selectWrapper.classList.add('hide');\n      this.hideTimeout = undefined;\n    }, 200);\n  }\n\n  public selectCountryByTarget = (target: HTMLElement) => {\n    const defaultName = target.querySelector<HTMLElement>('[data-default-name]').dataset.defaultName;\n    const phoneCodeEl = target.querySelector<HTMLElement>('.phone-code');\n    const phoneCode = phoneCodeEl?.innerText;\n    const countryCode = phoneCode && phoneCode.replace(/\\D/g, '');\n\n    this.value = i18n(defaultName as any);\n    this.lastCountrySelected = countries.find((c) => c.default_name === defaultName);\n    this.lastCountryCodeSelected = countryCode && this.lastCountrySelected.country_codes.find((_countryCode) => _countryCode.country_code === countryCode);\n\n    this.options.onCountryChange?.(this.lastCountrySelected, this.lastCountryCodeSelected);\n    this.hidePicker();\n  }\n\n  public selectCountryByIso2(iso2: string) {\n    this.selectCountryByTarget(this.liMap.get(iso2)[0]);\n  }\n\n  public override(country: HelpCountry, code: HelpCountryCode, countryName?: string) {\n    this.setValueSilently(country ? i18n(country.default_name as any) : countryName);\n    this.lastCountrySelected = country;\n    this.lastCountryCodeSelected = code;\n    this.options.onCountryChange?.(this.lastCountrySelected, this.lastCountryCodeSelected);\n  }\n}\n"],"names":["getDeepProperty","object","key","splitted","DEEP_PATH_JOINER","o","CheckboxField","options","label","input","loaded","onChange","value","rootScope","apiManagerProxy","state","stateValue","checked","span","_i18n","toggle","circle","box","checkSvg","use","bg","border","ripple","simulateEvent","disable","prefixes","maxPrefixLength","setPrefix","country","code","prefix","formatPhoneNumber","originalStr","I18n","str","phoneCode","prefixCountry","i","patterns","searchForPattern","pattern","mostMatchedPatternMatches","mostMatchedPattern","_pattern","patternMatches","k","length","symbol","idx","leftPattern","TelInputField","InputField","telEl","pixelRatio","letterSpacing","IS_APPLE","IS_ANDROID","originalFunc","placeCaretAtEnd","IS_APPLE_MOBILE","formattedPhoneNumber","formatted","e","countries","setCountries","a","b","init","VIRTUAL_COUNTRIES","filterCountries","excludeVirtual","c","names","name","abbr","word","CountryInputField","randomLong","target","defaultName","countryCode","i18n","_countryCode","selectWrapper","arrowDown","selectList","Scrollable","initSelect","emoji","getCountryEmoji","liArr","li","wrapped","wrapEmojiText","IS_EMOJI_SUPPORTED","spanEmoji","setInnerHTML","el","findUpTag","arr","fastSmoothScroll","findUpClassName","mouseDownHandlerAttached","onMouseDown","onKeyPress","filtered","iso2","cancelEvent","countryName"],"mappings":"0VAEwB,SAAAA,EAAgBC,EAAaC,EAA6B,CAC1E,MAAAC,EAAW,MAAM,QAAQD,CAAG,EAAIA,EAAMA,EAAI,MAAME,CAAgB,EACtE,IAAIC,EAASJ,EACb,UAAUC,KAAOC,EAEf,GADAE,EAAIA,IAAIH,CAAG,EACR,CAACG,EACF,MAIG,OAAAA,CACT,CCkBA,MAAqBC,EAAc,CAMjC,YAAYC,EAAgC,GAAI,CAC9C,MAAMC,EAAQ,KAAK,MAAQ,SAAS,cAAc,OAAO,EACnDA,EAAA,UAAU,IAAI,gBAAgB,EAEjCD,EAAQ,aAAe,CAACA,EAAQ,QAC3BC,EAAA,UAAU,IAAI,4BAA4B,EAG/CD,EAAQ,OACHC,EAAA,UAAU,IAAI,sBAAsB,EAGzCD,EAAQ,UACT,KAAK,iBAAiB,EAAI,EAG5B,KAAK,eAAiBA,EAAQ,eAE9B,MAAME,EAAQ,KAAK,MAAQ,SAAS,cAAc,OAAO,EAWzD,GAVMA,EAAA,UAAU,IAAI,sBAAsB,EACpCA,EAAA,KAAOF,EAAQ,QAAU,QAAU,WACtCA,EAAQ,OACTE,EAAMF,EAAQ,QAAU,OAAS,IAAI,EAAI,SAAWA,EAAQ,MAG3DA,EAAQ,UACTE,EAAM,QAAU,IAGfF,EAAQ,SAAU,CACf,IAAAG,EAASH,EAAQ,UAAY,OACjC,MAAMI,EAAW,IAAM,CACrB,GAAG,CAACD,EACF,OAGE,IAAAE,EACDL,EAAQ,YACTK,EAAQL,EAAQ,YAAYE,EAAM,QAAU,EAAI,CAAC,GAEjDG,EAAQH,EAAM,QAEXF,EAAQ,oBACTK,EAAQ,CAACA,IAIbC,EAAU,SAAS,gBAAgB,SAASN,EAAQ,SAAUK,CAAK,CAAA,EAGrE,CAACF,GAAUI,EAAgB,SAAW,EAAA,KAAMC,GAAU,CAC3CL,EAAA,GACT,MAAMM,EAAahB,EAAgBe,EAAOR,EAAQ,QAAQ,EACtD,IAAAU,EACDV,EAAQ,YACTU,EAAUV,EAAQ,YAAY,QAAQS,CAAU,IAAM,GAE5CC,EAAAD,EAEPT,EAAQ,oBACTU,EAAU,CAACA,IAIf,KAAK,iBAAiBA,CAAO,CAAA,CAC9B,EAEEV,EAAQ,eAAgBA,EAAQ,eAAe,IAAIE,CAAK,EAAE,SAAUE,CAAQ,EACpEF,EAAA,iBAAiB,SAAUE,CAAQ,CAChD,CAEI,IAAAO,EAWJ,GAVGX,EAAQ,MACTW,EAAO,KAAK,KAAO,SAAS,cAAc,MAAM,EAC3CA,EAAA,UAAU,IAAI,kBAAkB,EACrCC,EAAMD,EAAMX,EAAQ,KAAMA,EAAQ,QAAQ,GAEpCC,EAAA,UAAU,IAAI,0BAA0B,EAGhDA,EAAM,OAAOC,CAAK,EAEfF,EAAQ,OAAQ,CACXC,EAAA,UAAU,IAAI,uBAAuB,EAExCD,EAAQ,aACHC,EAAA,UAAU,IAAI,mCAAmC,EAGnD,MAAAY,EAAS,SAAS,cAAc,KAAK,EACpCA,EAAA,UAAU,IAAI,iBAAiB,EAChC,MAAAC,EAAS,SAAS,cAAc,KAAK,EACpCA,EAAA,UAAU,IAAI,wBAAwB,EAC7CD,EAAO,OAAOC,CAAM,EACpBb,EAAM,OAAOY,CAAM,CAAA,KACd,CACC,MAAAE,EAAM,SAAS,cAAc,KAAK,EACpCA,EAAA,UAAU,IAAI,cAAc,EAEhC,MAAMC,EAAW,SAAS,gBAAgB,6BAA8B,KAAK,EACpEA,EAAA,UAAU,IAAI,oBAAoB,EAClCA,EAAA,eAAe,KAAM,UAAW,WAAW,EACpD,MAAMC,EAAM,SAAS,gBAAgB,6BAA8B,KAAK,EACpEA,EAAA,eAAe,KAAM,OAAQ,QAAQ,EACrCA,EAAA,eAAe,KAAM,IAAK,IAAI,EAClCD,EAAS,OAAOC,CAAG,EAEb,MAAAC,EAAK,SAAS,cAAc,KAAK,EACpCA,EAAA,UAAU,IAAI,yBAAyB,EAEpC,MAAAC,EAAS,SAAS,cAAc,KAAK,EACpCA,EAAA,UAAU,IAAI,qBAAqB,EAEtCJ,EAAA,OAAOI,EAAQD,EAAIF,CAAQ,EAE/Bf,EAAM,OAAOc,CAAG,CAClB,CAEGJ,GACDV,EAAM,OAAOU,CAAI,EAGhBX,EAAQ,YACHC,EAAA,UAAU,IAAI,kBAAmB,cAAc,EAC9CmB,EAAAnB,EAAO,OAAW,OAAW,EAAI,GAEhCD,EAAQ,WACVC,EAAA,UAAU,IAAI,cAAc,CAEtC,CAEA,IAAI,SAAU,CACZ,OAAO,KAAK,MAAM,OACpB,CAEA,IAAI,QAAQS,EAAkB,CAK5B,KAAK,iBAAiBA,CAAO,EACfW,EAAA,KAAK,MAAO,QAAQ,CACpC,CAEO,iBAAiBX,EAAkB,CACxC,KAAK,MAAM,QAAUA,CACvB,CAEO,YAAa,CAClB,OAAO,KAAK,MAAM,UAAU,SAAS,mBAAmB,CAC1D,CAEO,iBAAiBY,EAAkB,CACxC,YAAK,MAAM,UAAU,OAAO,oBAAqBA,CAAO,EACxD,KAAK,MAAM,SAAWA,EACf,IAAM,KAAK,iBAAiB,CAACA,CAAO,CAC7C,CACF,CCvLA,MAAMC,MAA2C,IACjD,IAAIC,EAAkB,EACtB,MAAMC,EAAY,CAACC,EAAsBC,EAAuBC,EAAiB,KAAO,CACtFA,EAASD,EAAK,aAAeC,EAI7BJ,EAAkB,KAAK,IAAIA,EAAiBI,EAAO,MAAM,EACzDL,EAAS,IAAIK,EAAQ,CAAC,QAAAF,EAAS,KAAAC,CAAK,CAAA,CACtC,EAEO,SAASE,EAAkBC,EAKhC,CACAA,EAAcA,GAAe,GAEzBP,EAAS,MACNQ,EAAA,cAAc,QAASL,GAAY,CACtCA,EAAQ,cAAc,QAASC,GAAS,CACnCA,EAAK,SACDA,EAAA,SAAS,QAASC,GAAW,CACtBF,EAAAA,EAASC,EAAMC,CAAM,CAAA,CAChC,EAEDH,EAAUC,EAASC,CAAI,CACzB,CACD,CAAA,CACF,EAIH,IAAIK,EAAMF,EAAY,QAAQ,MAAO,EAAE,EACvC,MAAMG,EAAYD,EAAI,MAAM,EAAGR,CAAe,EAW1C,IAAAU,EACJ,QAAQC,EAAIF,EAAU,OAAS,EAAGE,GAAK,IACrCD,EAAgBX,EAAS,IAAIU,EAAU,MAAM,EAAGE,EAAI,CAAC,CAAC,EACnD,CAAAD,GAFqC,EAAEC,EAE1C,CAKF,GAAG,CAACD,EACK,MAAA,CACL,UAAWF,EACX,QAAS,OACT,KAAM,OACN,YAAa,EAAA,EAKjB,MAAMN,EAAUQ,EAAc,QAExBE,EAAWF,EAAc,KAAK,UAAY,CAAA,EAC1CG,EAAmBL,EAAI,MAAME,EAAc,KAAK,aAAa,MAAM,EACzE,IAAII,EAAU,GAAIC,EAA4B,EAAGC,EAAqB,GACtE,QAAQL,EAAIC,EAAS,OAAS,EAAGD,GAAK,EAAG,EAAEA,EAAG,CAC5CG,EAAUF,EAASD,CAAC,EAEpB,MAAMM,EAAWH,EAAQ,QAAQ,KAAM,EAAE,EACzC,IAAII,EAAiB,EACrB,QAAQC,EAAI,EAAGC,EAAS,KAAK,IAAIP,EAAiB,OAAQI,EAAS,MAAM,EAAGE,EAAIC,EAAQ,EAAED,EACxF,GAAGN,EAAiBM,CAAC,IAAMF,EAASE,CAAC,EACjBD,GAAA,aACVD,EAASE,CAAC,IAAM,IACtB,EAAAD,MACG,CACYA,EAAA,EACjB,KACF,CAGCA,EAAiBH,IACUA,EAAAG,EACPF,EAAAF,EAEzB,CAEAA,EAAUE,GAAsBF,EACtBA,EAAAA,EAAQ,QAAQ,MAAO,GAAG,EAE1BA,EAAAJ,EAAc,KAAK,aAAe,IAAMI,EAElDA,EAAQ,MAAM,EAAE,EAAE,QAAQ,CAACO,EAAQC,IAAQ,CACtCD,IAAW,KAAOb,EAAIc,CAAG,IAAM,KAAOd,EAAI,OAASc,IAC9Cd,EAAAA,EAAI,MAAM,EAAGc,CAAG,EAAI,IAAMd,EAAI,MAAMc,CAAG,EAC/C,CACD,EAMG,IAAAC,EAAcT,GAAWA,EAAQ,OAASN,EAAI,OAASM,EAAQ,MAAMN,EAAI,MAAM,EAAI,GACvF,OAAGe,IAGaA,EAAAA,EAAY,QAAQ,KAAM,GAAG,GAItC,CAAC,UAAWf,EAAK,QAAAN,EAAS,KAAMQ,EAAc,KAAM,YAAAa,EAC7D,CClHA,MAAqBC,WAAsBC,CAAW,CAIpD,YAAYjD,EAER,GAAI,CACA,MAAA,CACJ,MAAO,mCAEP,KAAM,QACN,GAAGA,CAAA,CACJ,EAXH,KAAQ,OAAS,GACjB,KAAO,UAAY,GAYZ,KAAA,UAAU,UAAU,IAAI,mBAAmB,EAEhD,MAAMkD,EAAQ,KAAK,MACnB,GAAGA,aAAiB,iBAClBA,EAAM,KAAO,MACbA,EAAM,aAAe,qBAChB,CACLA,EAAM,UAAY,UAElB,MAAMC,EAAa,OAAO,iBAC1B,GAAGA,EAAa,EAAG,CACb,IAAAC,EACDC,EACDD,EAAgBD,EAAa,KACrBG,IACQF,EAAA,GAGlBF,EAAM,MAAM,YAAY,mBAAoBE,EAAgB,IAAI,CAClE,CAEA,MAAMG,EAAe,KAAK,iBAAiB,KAAK,IAAI,EAC/C,KAAA,iBAAoBlD,GAAU,CACjCkD,EAAalD,CAAK,EACFmD,EAAA,KAAK,MAAO,EAAI,CAAA,CAEpC,CAEMN,EAAA,iBAAiB,QAAS,IAAM,CAE9BA,EAAA,UAAU,OAAO,OAAO,EAE9B,MAAM7C,EAAQ,KAAK,MACN,KAAK,IAAIA,EAAM,OAAS,KAAK,UAAU,MAAM,EAChD,GAAK,CAAC,KAAK,QAAUoD,GACxB,KAAA,iBAAiB,KAAK,UAAYpD,CAAK,EAG9C,KAAK,OAAS,GAEd,KAAK,SAAS,EAEV,IAAAqD,EACAC,EAAuEZ,EAAc,GACtF,KAAK,MAAM,QAAQ,MAAO,GAAG,IAAM,IACpC,KAAK,iBAAiB,GAAG,GAEFW,EAAA7B,EAAkB,KAAK,KAAK,EACnD8B,EAAYD,EAAqB,UACvBA,EAAqB,QAC/BX,EAAcW,EAAqB,YACrBA,EAAqB,KACnC,KAAK,iBAAiB,KAAK,UAAYC,EAAY,IAAMA,EAAY,EAAE,GAGzET,EAAM,QAAQ,YAAcH,EAIpB/C,EAAA,SAAWA,EAAQ,QAAQ0D,CAAoB,CAAA,CACxD,EAEKR,EAAA,iBAAiB,QAAS,IAAM,CACpC,KAAK,OAAS,EAAA,CAEf,EAMKA,EAAA,iBAAiB,WAAaU,GAAM,CAExC,MAAMjE,EAAMiE,EAAE,IACd,GAAG,KAAK,KAAKjE,CAAG,GAAK,EAAEiE,EAAE,SAAWA,EAAE,UAAYjE,IAAQ,aAAe,EAAEA,IAAQ,KAAOiE,EAAE,UAC1F,OAAAA,EAAE,eAAe,EACV,EACT,CACD,CAKH,CACF,CCzFA,IAAIC,EACJ,MAAMC,EAAe,IAAM,CACbD,EAAA9B,EAAK,cAChB,OAAQL,GAAY,CAACA,EAAQ,QAAQ,MAAM,EAC3C,KAAK,CAACqC,EAAGC,KAAOD,EAAE,MAAQA,EAAE,cAAc,cAAcC,EAAE,MAAQA,EAAE,YAAY,CAAC,CACpF,EAEA,IAAIC,EAAO,IAAM,CACRA,EAAA,OACMH,IACHxD,EAAA,iBAAiB,kBAAmB,IAAM,CACrCwD,GAAA,CACd,CACH,EAEA,MAAMI,EAAoB,IAAI,IAAI,CAAC,IAAI,CAAC,EAExB,SAAAC,EAAgB9D,EAAe+D,EAA0B,CAChE,OAAAH,MAEP5D,EAAQA,EAAM,cACGwD,EAAU,OAAQQ,GAAM,CACvC,GAAGD,GAAkBF,EAAkB,IAAIG,EAAE,IAAI,EACxC,MAAA,GAGT,MAAMC,EAAQ,CACZD,EAAE,KACFA,EAAE,aACFA,EAAE,IAAA,EAGJ,OAAAC,EAAM,OAAO,OAAO,EAAE,QAASC,GAAS,CAChC,MAAAC,EAAOD,EAAK,MAAM,GAAG,EAAE,OAAQE,GAAS,KAAK,KAAKA,CAAI,CAAC,EAAE,IAAKA,GAASA,EAAK,CAAC,CAAC,EAAE,KAAK,EAAE,EAC1FD,EAAK,OAAS,GACfF,EAAM,KAAKE,CAAI,CACjB,CACD,EAEY,CAAC,CAACF,EAAM,OAAO,OAAO,EAAE,KAAMtC,GAAQA,EAAI,YAAY,EAAE,QAAQ3B,CAAK,IAAM,EAAE,CACnF,CACR,CAGH,CAMA,MAAqBqE,WAA0BzB,CAAW,CASxD,YAAmBjD,EAGf,GAAI,CACA,MAAA,CACJ,MAAO,UACP,KAAM2E,EAAW,EACjB,GAAG3E,CAAA,CACJ,EARgB,KAAA,QAAAA,EAsMnB,KAAO,WAAa,IAAM,CACrB,KAAK,cAAgB,SACnB,KAAA,cAAc,UAAU,OAAO,QAAQ,EACvC,KAAA,YAAc,OAAO,WAAW,IAAM,CACpC,KAAA,cAAc,UAAU,IAAI,MAAM,EACvC,KAAK,YAAc,QAClB,GAAG,EAAA,EAGD,KAAA,sBAAyB4E,GAAwB,CACtD,MAAMC,EAAcD,EAAO,cAA2B,qBAAqB,EAAE,QAAQ,YAE/E3C,EADc2C,EAAO,cAA2B,aAAa,GACpC,UACzBE,EAAc7C,GAAaA,EAAU,QAAQ,MAAO,EAAE,EAEvD,KAAA,MAAQ8C,EAAKF,CAAkB,EACpC,KAAK,oBAAsBhB,EAAU,KAAMQ,GAAMA,EAAE,eAAiBQ,CAAW,EAC1E,KAAA,wBAA0BC,GAAe,KAAK,oBAAoB,cAAc,KAAME,GAAiBA,EAAa,eAAiBF,CAAW,EAErJ,KAAK,QAAQ,kBAAkB,KAAK,oBAAqB,KAAK,uBAAuB,EACrF,KAAK,WAAW,CAAA,EAhNTb,MAEF,KAAA,UAAY,IAEZ,KAAA,UAAU,UAAU,IAAI,cAAc,EAE3C,MAAMgB,EAAgB,KAAK,cAAgB,SAAS,cAAc,KAAK,EACvEA,EAAc,UAAU,IAAI,iBAAkB,YAAa,MAAM,EAE3D,MAAAC,EAAY,SAAS,cAAc,MAAM,EACrCA,EAAA,UAAU,IAAI,QAAS,YAAY,EACxC,KAAA,UAAU,OAAOA,CAAS,EAEzB,MAAAC,EAAa,SAAS,cAAc,IAAI,EAC9CF,EAAc,YAAYE,CAAU,EAErB,IAAIC,EAAWH,CAAa,EAE3C,IAAII,EAAa,IAAM,CACRA,EAAA,KAEHxB,EAAA,QAASQ,GAAM,CACvB,GAAGrE,EAAQ,cAAgBkE,EAAkB,IAAIG,EAAE,IAAI,EACrD,OAGI,MAAAiB,EAAQC,EAAgBlB,EAAE,IAAI,EAE9BmB,EAA8B,CAAA,EACpC,QAAQrD,EAAI,EAAGS,EAAS,KAAK,IAAIyB,EAAE,cAAc,OAAQrE,EAAQ,aAAe,EAAI,GAAQ,EAAGmC,EAAIS,EAAQ,EAAET,EAAG,CACxG,MAAA2C,EAAcT,EAAE,cAAclC,CAAC,EAC/BsD,EAAK,SAAS,cAAc,IAAI,EAEhCC,EAAUC,EAAcL,CAAK,EACnC,GAAGM,EAAoB,CACf,MAAAC,EAAY,SAAS,cAAc,MAAM,EAC/CC,EAAaD,EAAWH,CAAO,EAC/BD,EAAG,OAAOI,CAAS,CAAA,MAEnBC,EAAaL,EAAIC,CAAO,EAGpB,MAAAK,EAAKhB,EAAKV,EAAE,YAAmB,EAIlC,GAHA0B,EAAA,QAAQ,YAAc1B,EAAE,aAC3BoB,EAAG,OAAOM,CAAE,EAET,CAAC/F,EAAQ,aAAc,CAClB,MAAAW,EAAO,SAAS,cAAc,MAAM,EACrCA,EAAA,UAAU,IAAI,YAAY,EAC1BA,EAAA,UAAY,IAAMmE,EAAY,aACnCW,EAAG,YAAY9E,CAAI,CACrB,CAEA6E,EAAM,KAAKC,CAAE,EACbN,EAAW,OAAOM,CAAE,CACtB,CAEA,KAAK,MAAM,IAAIpB,EAAE,KAAMmB,CAAK,CAAA,CAC7B,EAEUL,EAAA,iBAAiB,YAAcvB,GAAM,CAC3C,GAAAA,EAAE,SAAW,EACd,OAGF,MAAMgB,EAASoB,EAAUpC,EAAE,OAAQ,IAAI,EACvC,KAAK,sBAAsBgB,CAAM,CAAA,CAElC,EAEI,KAAA,UAAU,YAAYK,CAAa,CAAA,EAG/BI,IAEX,KAAK,MAAM,iBAAiB,QAAUzB,GAAM,CACvCyB,EACUA,IAEDxB,EAAA,QAASQ,GAAM,CACvB,MAAM4B,EAAM,KAAK,MAAM,IAAI5B,EAAE,IAAI,EAC7B4B,GACJA,EAAI,QAASR,GAAOA,EAAG,MAAM,QAAU,EAAE,CAAA,CAC1C,EAGH,aAAa,KAAK,WAAW,EAC7B,KAAK,YAAc,OAELR,EAAA,UAAU,OAAO,MAAM,EAChCA,EAAc,YACLA,EAAA,UAAU,IAAI,QAAQ,EAEpC,KAAK,OAAO,EAEKiB,EAAA,CAEf,UAAWC,EAAgB,KAAK,UAAW,cAAc,EACzD,QAAS,KAAK,MACd,SAAU,QACV,OAAQ,CAAA,CACT,EAED,WAAW,IAAM,CACXC,IACF,SAAS,iBAAiB,YAAaC,EAAa,CAAC,QAAS,GAAK,EACxCD,EAAA,KAE5B,CAAC,CAAA,CACL,EAED,IAAIA,EAA2B,GACzB,MAAAC,EAAezC,GAAkB,CAClCuC,EAAgBvC,EAAE,OAAQ,cAAc,GAGxCA,EAAE,SAAW,KAAK,QAIrB,KAAK,WAAW,EAChB,SAAS,oBAAoB,YAAayC,EAAa,CAAC,QAAS,GAAK,EAC3CD,EAAA,GAAA,EASvBE,EAAc1C,GAAqB,CACvC,MAAMjE,EAAMiE,EAAE,IACX,GAAAA,EAAE,SAAWjE,IAAQ,UAAkB,MAAA,GAG1C,MAAM4G,EAAW,IAAI,IAAIpC,EAAgB,KAAK,KAAK,EAAE,IAAKE,GAAMA,EAAE,IAAI,CAAC,EACvE,KAAK,MAAM,QAAQ,CAAC4B,EAAKO,IAAS,CAC5BP,EAAA,QAASR,GAAOA,EAAG,MAAM,QAAUc,EAAS,IAAIC,CAAI,EAAI,GAAK,MAAM,CAAA,CACxE,EAWaD,EAAS,KASbA,EAAS,OAAS,GAAK5G,IAAQ,UACvC8G,EAAY7C,CAAC,EACb,KAAK,sBAAsB,KAAK,MAAM,IAAI,CAAC,GAAG2C,CAAQ,EAAE,CAAC,CAAC,EAAE,CAAC,CAAC,GAVpD1C,EAAA,QAASQ,GAAM,CACvB,MAAM4B,EAAM,KAAK,MAAM,IAAI5B,EAAE,IAAI,EAC7B4B,GAIJA,EAAI,QAASR,GAAOA,EAAG,MAAM,QAAU,EAAE,CAAA,CAC1C,CAIH,EAGG,KAAA,MAAM,iBAAiB,QAASa,CAAU,EAC/C,KAAK,MAAM,iBAAiB,UAAY1C,GAAM,CACzCA,EAAE,MAAQ,SACX0C,EAAW1C,CAAC,CACd,CACD,EAESsB,EAAA,iBAAiB,YAActB,GAAM,CAC1C,KAAK,MAAM,QAAQ,QAAQ,GAC5B,KAAK,WAAW,EAChB,KAAK,MAAM,SAEXA,EAAE,aAAe,GACjBA,EAAE,eAAe,EACjB,KAAK,MAAM,QACb,CACD,CACH,CAEO,aAAc,CACnB,MAAO,CAAC,QAAS,KAAK,oBAAqB,KAAM,KAAK,wBACxD,CAyBO,oBAAoB4C,EAAc,CACvC,KAAK,sBAAsB,KAAK,MAAM,IAAIA,CAAI,EAAE,CAAC,CAAC,CACpD,CAEO,SAAS9E,EAAsBC,EAAuB+E,EAAsB,CACjF,KAAK,iBAAiBhF,EAAUqD,EAAKrD,EAAQ,YAAmB,EAAIgF,CAAW,EAC/E,KAAK,oBAAsBhF,EAC3B,KAAK,wBAA0BC,EAC/B,KAAK,QAAQ,kBAAkB,KAAK,oBAAqB,KAAK,uBAAuB,CACvF,CACF"}
\ No newline at end of file

--- public/htmlToSpan-BQ96zqgl.js ---
@@ -1,2 +1,2 @@
-import{c as l}from"./index-XZA1-3MU.js";import{I as n}from"./button-aS2SE0kp.js";import{I as d,l as o}from"./wrapEmojiText-pejq-WF4.js";class h{constructor(i,e){this.container=i,this.input=e,this.passwordVisible=!1,this.onVisibilityClick=r=>{l(r),this.passwordVisible=!this.passwordVisible,this.toggleVisible.replaceChildren(n(this.passwordVisible?"eye2":"eye1")),this.input.type=this.passwordVisible?"text":"password",this.onVisibilityClickAdditional?.()},e.type="password",e.setAttribute("required",""),e.name="notsearch_password",e.autocomplete="off";const s=document.createElement("input");s.classList.add("stealthy"),s.tabIndex=-1,s.type="password",e.parentElement.prepend(s),e.parentElement.insertBefore(s.cloneNode(),e.nextSibling);const a=this.toggleVisible=document.createElement("span");a.classList.add("toggle-visible"),a.append(n("eye1")),i.classList.add("input-field-password"),i.append(a),a.addEventListener("click",this.onVisibilityClick),a.addEventListener("touchend",this.onVisibilityClick)}}class u extends d{constructor(i={}){super({plainText:!0,allowStartingSpace:!0,...i}),this.helpers=new h(this.container,this.input)}}class w{constructor(i,e){this.passwordInputField=i,this.size=e,this.needFrame=0,this.container=document.createElement("div"),this.container.classList.add("media-sticker-wrapper")}load(){return this.loadPromise?this.loadPromise:this.loadPromise=o.loadAnimationAsAsset({container:this.container,loop:!1,autoplay:!1,width:this.size,height:this.size,noCache:!0},"TwoFactorSetupMonkeyPeek").then(i=>(this.animation=i,this.animation.addEventListener("enterFrame",e=>{(this.animation.direction===1&&e>=this.needFrame||this.animation.direction===-1&&e<=this.needFrame)&&(this.animation.setSpeed(1),this.animation.pause())}),this.passwordInputField.helpers.onVisibilityClickAdditional=()=>{this.passwordInputField.helpers.passwordVisible?(this.animation.setDirection(1),this.animation.curFrame=0,this.needFrame=16,this.animation.play()):(this.animation.setDirection(-1),this.animation.curFrame=16,this.needFrame=0,this.animation.play())},o.waitForFirstFrame(i)))}remove(){this.animation&&this.animation.remove()}}function b(t){const i=document.createElement("span");return typeof t=="string"?i.innerHTML=t:i.append(t),i}export{u as P,w as a,h as b,b as h};
-//# sourceMappingURL=htmlToSpan-52gQDcFu.js.map
+import{c as l}from"./index-M8z-nwNm.js";import{I as n}from"./button-Mm7TqKr1.js";import{I as d,l as o}from"./wrapEmojiText-PAHdiQbe.js";class h{constructor(i,e){this.container=i,this.input=e,this.passwordVisible=!1,this.onVisibilityClick=r=>{l(r),this.passwordVisible=!this.passwordVisible,this.toggleVisible.replaceChildren(n(this.passwordVisible?"eye2":"eye1")),this.input.type=this.passwordVisible?"text":"password",this.onVisibilityClickAdditional?.()},e.type="password",e.setAttribute("required",""),e.name="notsearch_password",e.autocomplete="off";const s=document.createElement("input");s.classList.add("stealthy"),s.tabIndex=-1,s.type="password",e.parentElement.prepend(s),e.parentElement.insertBefore(s.cloneNode(),e.nextSibling);const a=this.toggleVisible=document.createElement("span");a.classList.add("toggle-visible"),a.append(n("eye1")),i.classList.add("input-field-password"),i.append(a),a.addEventListener("click",this.onVisibilityClick),a.addEventListener("touchend",this.onVisibilityClick)}}class u extends d{constructor(i={}){super({plainText:!0,allowStartingSpace:!0,...i}),this.helpers=new h(this.container,this.input)}}class w{constructor(i,e){this.passwordInputField=i,this.size=e,this.needFrame=0,this.container=document.createElement("div"),this.container.classList.add("media-sticker-wrapper")}load(){return this.loadPromise?this.loadPromise:this.loadPromise=o.loadAnimationAsAsset({container:this.container,loop:!1,autoplay:!1,width:this.size,height:this.size,noCache:!0},"TwoFactorSetupMonkeyPeek").then(i=>(this.animation=i,this.animation.addEventListener("enterFrame",e=>{(this.animation.direction===1&&e>=this.needFrame||this.animation.direction===-1&&e<=this.needFrame)&&(this.animation.setSpeed(1),this.animation.pause())}),this.passwordInputField.helpers.onVisibilityClickAdditional=()=>{this.passwordInputField.helpers.passwordVisible?(this.animation.setDirection(1),this.animation.curFrame=0,this.needFrame=16,this.animation.play()):(this.animation.setDirection(-1),this.animation.curFrame=16,this.needFrame=0,this.animation.play())},o.waitForFirstFrame(i)))}remove(){this.animation&&this.animation.remove()}}function b(t){const i=document.createElement("span");return typeof t=="string"?i.innerHTML=t:i.append(t),i}export{u as P,w as a,h as b,b as h};
+//# sourceMappingURL=htmlToSpan-BQ96zqgl.js.map

--- public/htmlToSpan-BQ96zqgl.js.map ---
@@ -1 +1 @@
-{"version":3,"file":"htmlToSpan-52gQDcFu.js","sources":["../src/components/passwordInputField.ts","../src/components/monkeys/password.ts","../src/helpers/dom/htmlToSpan.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport cancelEvent from '../helpers/dom/cancelEvent';\nimport Icon from './icon';\nimport InputField, {InputFieldOptions} from './inputField';\n\nexport class PasswordInputHelpers {\n  public passwordVisible = false;\n  public toggleVisible: HTMLElement;\n  public onVisibilityClickAdditional: () => void;\n\n  constructor(public container: HTMLElement, public input: HTMLInputElement) {\n    input.type = 'password';\n    input.setAttribute('required', '');\n    input.name = 'notsearch_password';\n    input.autocomplete = 'off';\n\n    // * https://stackoverflow.com/a/35949954/6758968\n    const stealthy = document.createElement('input');\n    stealthy.classList.add('stealthy');\n    stealthy.tabIndex = -1;\n    stealthy.type = 'password';\n    input.parentElement.prepend(stealthy);\n    input.parentElement.insertBefore(stealthy.cloneNode(), input.nextSibling);\n\n    /* if(IS_SAFARI && !IS_MOBILE_SAFARI) {\n      input.setAttribute('readonly', '');\n      input.addEventListener('focus', () => {\n        input.removeAttribute('readonly');\n      }, {once: true});\n    } */\n\n    const toggleVisible = this.toggleVisible = document.createElement('span');\n    toggleVisible.classList.add('toggle-visible');\n    toggleVisible.append(Icon('eye1'));\n\n    container.classList.add('input-field-password');\n    container.append(toggleVisible);\n\n    toggleVisible.addEventListener('click', this.onVisibilityClick);\n    toggleVisible.addEventListener('touchend', this.onVisibilityClick);\n  }\n\n  public onVisibilityClick = (e: Event) => {\n    cancelEvent(e);\n    this.passwordVisible = !this.passwordVisible;\n\n    this.toggleVisible.replaceChildren(Icon(this.passwordVisible ? 'eye2' : 'eye1'));\n    (this.input as HTMLInputElement).type = this.passwordVisible ? 'text' : 'password';\n    this.onVisibilityClickAdditional?.();\n  };\n}\n\nexport default class PasswordInputField extends InputField {\n  public helpers: PasswordInputHelpers;\n\n  constructor(options: InputFieldOptions = {}) {\n    super({\n      plainText: true,\n      allowStartingSpace: true,\n      ...options\n    });\n\n    this.helpers = new PasswordInputHelpers(this.container, this.input as HTMLInputElement);\n  }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport lottieLoader, {LottieLoader} from '../../lib/rlottie/lottieLoader';\nimport RLottiePlayer from '../../lib/rlottie/rlottiePlayer';\nimport PasswordInputField from '../passwordInputField';\n\nexport default class PasswordMonkey {\n  public container: HTMLElement;\n  public animation: RLottiePlayer;\n  public needFrame = 0;\n  protected loadPromise: ReturnType<LottieLoader['waitForFirstFrame']>;\n\n  constructor(protected passwordInputField: PasswordInputField, protected size: number) {\n    this.container = document.createElement('div');\n    this.container.classList.add('media-sticker-wrapper');\n  }\n\n  public load() {\n    if(this.loadPromise) return this.loadPromise;\n    return this.loadPromise = lottieLoader.loadAnimationAsAsset({\n      container: this.container,\n      loop: false,\n      autoplay: false,\n      width: this.size,\n      height: this.size,\n      noCache: true\n    // }, 'assets/img/TwoFactorSetupMonkeyClose.tgs').then((_animation) => {\n    }, 'TwoFactorSetupMonkeyPeek').then((_animation) => {\n      // return;\n      this.animation = _animation;\n      this.animation.addEventListener('enterFrame', currentFrame => {\n        // console.log('enterFrame', currentFrame, this.needFrame);\n\n        if((this.animation.direction === 1 && currentFrame >= this.needFrame) ||\n          (this.animation.direction === -1 && currentFrame <= this.needFrame)) {\n          this.animation.setSpeed(1);\n          this.animation.pause();\n        }\n      });\n\n      this.passwordInputField.helpers.onVisibilityClickAdditional = () => {\n        if(this.passwordInputField.helpers.passwordVisible) {\n          this.animation.setDirection(1);\n          this.animation.curFrame = 0;\n          this.needFrame = 16;\n          this.animation.play();\n        } else {\n          this.animation.setDirection(-1);\n          this.animation.curFrame = 16;\n          this.needFrame = 0;\n          this.animation.play();\n        }\n      };\n\n      return lottieLoader.waitForFirstFrame(_animation);\n    });\n  }\n\n  public remove() {\n    if(this.animation) {\n      this.animation.remove();\n    }\n  }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nexport default function htmlToSpan(html: string | DocumentFragment) {\n  const span = document.createElement('span');\n  if(typeof(html) === 'string') span.innerHTML = html;\n  else span.append(html);\n  return span;\n}\n"],"names":["PasswordInputHelpers","container","input","e","cancelEvent","Icon","stealthy","toggleVisible","PasswordInputField","InputField","options","PasswordMonkey","passwordInputField","size","lottieLoader","_animation","currentFrame","htmlToSpan","html","span"],"mappings":"wIAUO,MAAMA,CAAqB,CAKhC,YAAmBC,EAA+BC,EAAyB,CAAxD,KAAA,UAAAD,EAA+B,KAAA,MAAAC,EAJlD,KAAO,gBAAkB,GAoClB,KAAA,kBAAqBC,GAAa,CACvCC,EAAYD,CAAC,EACR,KAAA,gBAAkB,CAAC,KAAK,gBAE7B,KAAK,cAAc,gBAAgBE,EAAK,KAAK,gBAAkB,OAAS,MAAM,CAAC,EAC9E,KAAK,MAA2B,KAAO,KAAK,gBAAkB,OAAS,WACxE,KAAK,8BAA8B,CAAA,EArCnCH,EAAM,KAAO,WACPA,EAAA,aAAa,WAAY,EAAE,EACjCA,EAAM,KAAO,qBACbA,EAAM,aAAe,MAGf,MAAAI,EAAW,SAAS,cAAc,OAAO,EACtCA,EAAA,UAAU,IAAI,UAAU,EACjCA,EAAS,SAAW,GACpBA,EAAS,KAAO,WACVJ,EAAA,cAAc,QAAQI,CAAQ,EACpCJ,EAAM,cAAc,aAAaI,EAAS,YAAaJ,EAAM,WAAW,EASxE,MAAMK,EAAgB,KAAK,cAAgB,SAAS,cAAc,MAAM,EAC1DA,EAAA,UAAU,IAAI,gBAAgB,EAC9BA,EAAA,OAAOF,EAAK,MAAM,CAAC,EAEvBJ,EAAA,UAAU,IAAI,sBAAsB,EAC9CA,EAAU,OAAOM,CAAa,EAEhBA,EAAA,iBAAiB,QAAS,KAAK,iBAAiB,EAChDA,EAAA,iBAAiB,WAAY,KAAK,iBAAiB,CACnE,CAUF,CAEA,MAAqBC,UAA2BC,CAAW,CAGzD,YAAYC,EAA6B,GAAI,CACrC,MAAA,CACJ,UAAW,GACX,mBAAoB,GACpB,GAAGA,CAAA,CACJ,EAED,KAAK,QAAU,IAAIV,EAAqB,KAAK,UAAW,KAAK,KAAyB,CACxF,CACF,CC3DA,MAAqBW,CAAe,CAMlC,YAAsBC,EAAkDC,EAAc,CAAhE,KAAA,mBAAAD,EAAkD,KAAA,KAAAC,EAHxE,KAAO,UAAY,EAIZ,KAAA,UAAY,SAAS,cAAc,KAAK,EACxC,KAAA,UAAU,UAAU,IAAI,uBAAuB,CACtD,CAEO,MAAO,CACZ,OAAG,KAAK,YAAoB,KAAK,YAC1B,KAAK,YAAcC,EAAa,qBAAqB,CAC1D,UAAW,KAAK,UAChB,KAAM,GACN,SAAU,GACV,MAAO,KAAK,KACZ,OAAQ,KAAK,KACb,QAAS,EAER,EAAA,0BAA0B,EAAE,KAAMC,IAEnC,KAAK,UAAYA,EACZ,KAAA,UAAU,iBAAiB,aAA8BC,GAAA,EAGxD,KAAK,UAAU,YAAc,GAAKA,GAAgB,KAAK,WACxD,KAAK,UAAU,YAAc,IAAMA,GAAgB,KAAK,aACpD,KAAA,UAAU,SAAS,CAAC,EACzB,KAAK,UAAU,QACjB,CACD,EAEI,KAAA,mBAAmB,QAAQ,4BAA8B,IAAM,CAC/D,KAAK,mBAAmB,QAAQ,iBAC5B,KAAA,UAAU,aAAa,CAAC,EAC7B,KAAK,UAAU,SAAW,EAC1B,KAAK,UAAY,GACjB,KAAK,UAAU,SAEV,KAAA,UAAU,aAAa,EAAE,EAC9B,KAAK,UAAU,SAAW,GAC1B,KAAK,UAAY,EACjB,KAAK,UAAU,OACjB,EAGKF,EAAa,kBAAkBC,CAAU,EACjD,CACH,CAEO,QAAS,CACX,KAAK,WACN,KAAK,UAAU,QAEnB,CACF,CC7DA,SAAwBE,EAAWC,EAAiC,CAC5D,MAAAC,EAAO,SAAS,cAAc,MAAM,EAC1C,OAAG,OAAOD,GAAU,SAAUC,EAAK,UAAYD,EAC1CC,EAAK,OAAOD,CAAI,EACdC,CACT"}
\ No newline at end of file
+{"version":3,"file":"htmlToSpan-BQ96zqgl.js","sources":["../src/components/passwordInputField.ts","../src/components/monkeys/password.ts","../src/helpers/dom/htmlToSpan.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport cancelEvent from '../helpers/dom/cancelEvent';\nimport Icon from './icon';\nimport InputField, {InputFieldOptions} from './inputField';\n\nexport class PasswordInputHelpers {\n  public passwordVisible = false;\n  public toggleVisible: HTMLElement;\n  public onVisibilityClickAdditional: () => void;\n\n  constructor(public container: HTMLElement, public input: HTMLInputElement) {\n    input.type = 'password';\n    input.setAttribute('required', '');\n    input.name = 'notsearch_password';\n    input.autocomplete = 'off';\n\n    // * https://stackoverflow.com/a/35949954/6758968\n    const stealthy = document.createElement('input');\n    stealthy.classList.add('stealthy');\n    stealthy.tabIndex = -1;\n    stealthy.type = 'password';\n    input.parentElement.prepend(stealthy);\n    input.parentElement.insertBefore(stealthy.cloneNode(), input.nextSibling);\n\n    /* if(IS_SAFARI && !IS_MOBILE_SAFARI) {\n      input.setAttribute('readonly', '');\n      input.addEventListener('focus', () => {\n        input.removeAttribute('readonly');\n      }, {once: true});\n    } */\n\n    const toggleVisible = this.toggleVisible = document.createElement('span');\n    toggleVisible.classList.add('toggle-visible');\n    toggleVisible.append(Icon('eye1'));\n\n    container.classList.add('input-field-password');\n    container.append(toggleVisible);\n\n    toggleVisible.addEventListener('click', this.onVisibilityClick);\n    toggleVisible.addEventListener('touchend', this.onVisibilityClick);\n  }\n\n  public onVisibilityClick = (e: Event) => {\n    cancelEvent(e);\n    this.passwordVisible = !this.passwordVisible;\n\n    this.toggleVisible.replaceChildren(Icon(this.passwordVisible ? 'eye2' : 'eye1'));\n    (this.input as HTMLInputElement).type = this.passwordVisible ? 'text' : 'password';\n    this.onVisibilityClickAdditional?.();\n  };\n}\n\nexport default class PasswordInputField extends InputField {\n  public helpers: PasswordInputHelpers;\n\n  constructor(options: InputFieldOptions = {}) {\n    super({\n      plainText: true,\n      allowStartingSpace: true,\n      ...options\n    });\n\n    this.helpers = new PasswordInputHelpers(this.container, this.input as HTMLInputElement);\n  }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport lottieLoader, {LottieLoader} from '../../lib/rlottie/lottieLoader';\nimport RLottiePlayer from '../../lib/rlottie/rlottiePlayer';\nimport PasswordInputField from '../passwordInputField';\n\nexport default class PasswordMonkey {\n  public container: HTMLElement;\n  public animation: RLottiePlayer;\n  public needFrame = 0;\n  protected loadPromise: ReturnType<LottieLoader['waitForFirstFrame']>;\n\n  constructor(protected passwordInputField: PasswordInputField, protected size: number) {\n    this.container = document.createElement('div');\n    this.container.classList.add('media-sticker-wrapper');\n  }\n\n  public load() {\n    if(this.loadPromise) return this.loadPromise;\n    return this.loadPromise = lottieLoader.loadAnimationAsAsset({\n      container: this.container,\n      loop: false,\n      autoplay: false,\n      width: this.size,\n      height: this.size,\n      noCache: true\n    // }, 'assets/img/TwoFactorSetupMonkeyClose.tgs').then((_animation) => {\n    }, 'TwoFactorSetupMonkeyPeek').then((_animation) => {\n      // return;\n      this.animation = _animation;\n      this.animation.addEventListener('enterFrame', currentFrame => {\n        // console.log('enterFrame', currentFrame, this.needFrame);\n\n        if((this.animation.direction === 1 && currentFrame >= this.needFrame) ||\n          (this.animation.direction === -1 && currentFrame <= this.needFrame)) {\n          this.animation.setSpeed(1);\n          this.animation.pause();\n        }\n      });\n\n      this.passwordInputField.helpers.onVisibilityClickAdditional = () => {\n        if(this.passwordInputField.helpers.passwordVisible) {\n          this.animation.setDirection(1);\n          this.animation.curFrame = 0;\n          this.needFrame = 16;\n          this.animation.play();\n        } else {\n          this.animation.setDirection(-1);\n          this.animation.curFrame = 16;\n          this.needFrame = 0;\n          this.animation.play();\n        }\n      };\n\n      return lottieLoader.waitForFirstFrame(_animation);\n    });\n  }\n\n  public remove() {\n    if(this.animation) {\n      this.animation.remove();\n    }\n  }\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nexport default function htmlToSpan(html: string | DocumentFragment) {\n  const span = document.createElement('span');\n  if(typeof(html) === 'string') span.innerHTML = html;\n  else span.append(html);\n  return span;\n}\n"],"names":["PasswordInputHelpers","container","input","e","cancelEvent","Icon","stealthy","toggleVisible","PasswordInputField","InputField","options","PasswordMonkey","passwordInputField","size","lottieLoader","_animation","currentFrame","htmlToSpan","html","span"],"mappings":"wIAUO,MAAMA,CAAqB,CAKhC,YAAmBC,EAA+BC,EAAyB,CAAxD,KAAA,UAAAD,EAA+B,KAAA,MAAAC,EAJlD,KAAO,gBAAkB,GAoClB,KAAA,kBAAqBC,GAAa,CACvCC,EAAYD,CAAC,EACR,KAAA,gBAAkB,CAAC,KAAK,gBAE7B,KAAK,cAAc,gBAAgBE,EAAK,KAAK,gBAAkB,OAAS,MAAM,CAAC,EAC9E,KAAK,MAA2B,KAAO,KAAK,gBAAkB,OAAS,WACxE,KAAK,8BAA8B,CAAA,EArCnCH,EAAM,KAAO,WACPA,EAAA,aAAa,WAAY,EAAE,EACjCA,EAAM,KAAO,qBACbA,EAAM,aAAe,MAGf,MAAAI,EAAW,SAAS,cAAc,OAAO,EACtCA,EAAA,UAAU,IAAI,UAAU,EACjCA,EAAS,SAAW,GACpBA,EAAS,KAAO,WACVJ,EAAA,cAAc,QAAQI,CAAQ,EACpCJ,EAAM,cAAc,aAAaI,EAAS,YAAaJ,EAAM,WAAW,EASxE,MAAMK,EAAgB,KAAK,cAAgB,SAAS,cAAc,MAAM,EAC1DA,EAAA,UAAU,IAAI,gBAAgB,EAC9BA,EAAA,OAAOF,EAAK,MAAM,CAAC,EAEvBJ,EAAA,UAAU,IAAI,sBAAsB,EAC9CA,EAAU,OAAOM,CAAa,EAEhBA,EAAA,iBAAiB,QAAS,KAAK,iBAAiB,EAChDA,EAAA,iBAAiB,WAAY,KAAK,iBAAiB,CACnE,CAUF,CAEA,MAAqBC,UAA2BC,CAAW,CAGzD,YAAYC,EAA6B,GAAI,CACrC,MAAA,CACJ,UAAW,GACX,mBAAoB,GACpB,GAAGA,CAAA,CACJ,EAED,KAAK,QAAU,IAAIV,EAAqB,KAAK,UAAW,KAAK,KAAyB,CACxF,CACF,CC3DA,MAAqBW,CAAe,CAMlC,YAAsBC,EAAkDC,EAAc,CAAhE,KAAA,mBAAAD,EAAkD,KAAA,KAAAC,EAHxE,KAAO,UAAY,EAIZ,KAAA,UAAY,SAAS,cAAc,KAAK,EACxC,KAAA,UAAU,UAAU,IAAI,uBAAuB,CACtD,CAEO,MAAO,CACZ,OAAG,KAAK,YAAoB,KAAK,YAC1B,KAAK,YAAcC,EAAa,qBAAqB,CAC1D,UAAW,KAAK,UAChB,KAAM,GACN,SAAU,GACV,MAAO,KAAK,KACZ,OAAQ,KAAK,KACb,QAAS,EAER,EAAA,0BAA0B,EAAE,KAAMC,IAEnC,KAAK,UAAYA,EACZ,KAAA,UAAU,iBAAiB,aAA8BC,GAAA,EAGxD,KAAK,UAAU,YAAc,GAAKA,GAAgB,KAAK,WACxD,KAAK,UAAU,YAAc,IAAMA,GAAgB,KAAK,aACpD,KAAA,UAAU,SAAS,CAAC,EACzB,KAAK,UAAU,QACjB,CACD,EAEI,KAAA,mBAAmB,QAAQ,4BAA8B,IAAM,CAC/D,KAAK,mBAAmB,QAAQ,iBAC5B,KAAA,UAAU,aAAa,CAAC,EAC7B,KAAK,UAAU,SAAW,EAC1B,KAAK,UAAY,GACjB,KAAK,UAAU,SAEV,KAAA,UAAU,aAAa,EAAE,EAC9B,KAAK,UAAU,SAAW,GAC1B,KAAK,UAAY,EACjB,KAAK,UAAU,OACjB,EAGKF,EAAa,kBAAkBC,CAAU,EACjD,CACH,CAEO,QAAS,CACX,KAAK,WACN,KAAK,UAAU,QAEnB,CACF,CC7DA,SAAwBE,EAAWC,EAAiC,CAC5D,MAAAC,EAAO,SAAS,cAAc,MAAM,EAC1C,OAAG,OAAOD,GAAU,SAAUC,EAAK,UAAYD,EAC1CC,EAAK,OAAOD,CAAI,EACdC,CACT"}
\ No newline at end of file

--- public/index.html ---
@@ -41,7 +41,7 @@
     <link rel="canonical" href="https://web.telegram.org/">
 
     <link rel="manifest" id="manifest">
-    <script type="module" crossorigin src="./index-XZA1-3MU.js"></script>
+    <script type="module" crossorigin src="./index-M8z-nwNm.js"></script>
     <link rel="stylesheet" crossorigin href="./index-pzR5gIOz.css">
   </head>
   <body class="animation-level-2">

--- public/loginPage-0kq1JorQ.js ---
@@ -1,2 +1,2 @@
-import{i as t}from"./index-XZA1-3MU.js";class n{constructor(e){this.element=document.body.querySelector("."+e.className),this.container=document.createElement("div"),this.container.className="container center-align",this.imageDiv=document.createElement("div"),this.imageDiv.className="auth-image",this.title=document.createElement("h4"),e.titleLangKey&&this.title.append(t(e.titleLangKey)),this.subtitle=document.createElement("p"),this.subtitle.className="subtitle",e.subtitleLangKey&&this.subtitle.append(t(e.subtitleLangKey)),this.container.append(this.imageDiv,this.title,this.subtitle),e.withInputWrapper&&(this.inputWrapper=document.createElement("div"),this.inputWrapper.className="input-wrapper",this.container.append(this.inputWrapper)),this.element.append(this.container)}}export{n as L};
-//# sourceMappingURL=loginPage-EKVIJLjo.js.map
+import{i as t}from"./index-M8z-nwNm.js";class n{constructor(e){this.element=document.body.querySelector("."+e.className),this.container=document.createElement("div"),this.container.className="container center-align",this.imageDiv=document.createElement("div"),this.imageDiv.className="auth-image",this.title=document.createElement("h4"),e.titleLangKey&&this.title.append(t(e.titleLangKey)),this.subtitle=document.createElement("p"),this.subtitle.className="subtitle",e.subtitleLangKey&&this.subtitle.append(t(e.subtitleLangKey)),this.container.append(this.imageDiv,this.title,this.subtitle),e.withInputWrapper&&(this.inputWrapper=document.createElement("div"),this.inputWrapper.className="input-wrapper",this.container.append(this.inputWrapper)),this.element.append(this.container)}}export{n as L};
+//# sourceMappingURL=loginPage-0kq1JorQ.js.map

--- public/loginPage-0kq1JorQ.js.map ---
@@ -1 +1 @@
-{"version":3,"file":"loginPage-EKVIJLjo.js","sources":["../src/pages/loginPage.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {LangPackKey, i18n} from '../lib/langPack';\n\nexport default class LoginPage {\n  public element: HTMLElement;\n  public container: HTMLElement;\n  public imageDiv: HTMLElement;\n  public inputWrapper: HTMLElement;\n  public title: HTMLElement;\n  public subtitle: HTMLParagraphElement;\n\n  constructor(options: {\n    className: string,\n    withInputWrapper?: boolean,\n    titleLangKey?: LangPackKey,\n    subtitleLangKey?: LangPackKey,\n  }) {\n    this.element = document.body.querySelector('.' + options.className) as HTMLDivElement;\n    // this.element = document.createElement('div');\n    // this.element.className = 'page-' + options.className;\n\n    this.container = document.createElement('div');\n    this.container.className = 'container center-align';\n\n    this.imageDiv = document.createElement('div');\n    this.imageDiv.className = 'auth-image';\n\n    this.title = document.createElement('h4');\n    if(options.titleLangKey) {\n      this.title.append(i18n(options.titleLangKey));\n    }\n\n    this.subtitle = document.createElement('p');\n    this.subtitle.className = 'subtitle';\n    if(options.subtitleLangKey) {\n      this.subtitle.append(i18n(options.subtitleLangKey));\n    }\n\n    this.container.append(this.imageDiv, this.title, this.subtitle);\n\n    if(options.withInputWrapper) {\n      this.inputWrapper = document.createElement('div');\n      this.inputWrapper.className = 'input-wrapper';\n      this.container.append(this.inputWrapper);\n    }\n\n    this.element.append(this.container);\n  }\n}\n"],"names":["LoginPage","options","i18n"],"mappings":"wCAQA,MAAqBA,CAAU,CAQ7B,YAAYC,EAKT,CACD,KAAK,QAAU,SAAS,KAAK,cAAc,IAAMA,EAAQ,SAAS,EAI7D,KAAA,UAAY,SAAS,cAAc,KAAK,EAC7C,KAAK,UAAU,UAAY,yBAEtB,KAAA,SAAW,SAAS,cAAc,KAAK,EAC5C,KAAK,SAAS,UAAY,aAErB,KAAA,MAAQ,SAAS,cAAc,IAAI,EACrCA,EAAQ,cACT,KAAK,MAAM,OAAOC,EAAKD,EAAQ,YAAY,CAAC,EAGzC,KAAA,SAAW,SAAS,cAAc,GAAG,EAC1C,KAAK,SAAS,UAAY,WACvBA,EAAQ,iBACT,KAAK,SAAS,OAAOC,EAAKD,EAAQ,eAAe,CAAC,EAGpD,KAAK,UAAU,OAAO,KAAK,SAAU,KAAK,MAAO,KAAK,QAAQ,EAE3DA,EAAQ,mBACJ,KAAA,aAAe,SAAS,cAAc,KAAK,EAChD,KAAK,aAAa,UAAY,gBACzB,KAAA,UAAU,OAAO,KAAK,YAAY,GAGpC,KAAA,QAAQ,OAAO,KAAK,SAAS,CACpC,CACF"}
\ No newline at end of file
+{"version":3,"file":"loginPage-0kq1JorQ.js","sources":["../src/pages/loginPage.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {LangPackKey, i18n} from '../lib/langPack';\n\nexport default class LoginPage {\n  public element: HTMLElement;\n  public container: HTMLElement;\n  public imageDiv: HTMLElement;\n  public inputWrapper: HTMLElement;\n  public title: HTMLElement;\n  public subtitle: HTMLParagraphElement;\n\n  constructor(options: {\n    className: string,\n    withInputWrapper?: boolean,\n    titleLangKey?: LangPackKey,\n    subtitleLangKey?: LangPackKey,\n  }) {\n    this.element = document.body.querySelector('.' + options.className) as HTMLDivElement;\n    // this.element = document.createElement('div');\n    // this.element.className = 'page-' + options.className;\n\n    this.container = document.createElement('div');\n    this.container.className = 'container center-align';\n\n    this.imageDiv = document.createElement('div');\n    this.imageDiv.className = 'auth-image';\n\n    this.title = document.createElement('h4');\n    if(options.titleLangKey) {\n      this.title.append(i18n(options.titleLangKey));\n    }\n\n    this.subtitle = document.createElement('p');\n    this.subtitle.className = 'subtitle';\n    if(options.subtitleLangKey) {\n      this.subtitle.append(i18n(options.subtitleLangKey));\n    }\n\n    this.container.append(this.imageDiv, this.title, this.subtitle);\n\n    if(options.withInputWrapper) {\n      this.inputWrapper = document.createElement('div');\n      this.inputWrapper.className = 'input-wrapper';\n      this.container.append(this.inputWrapper);\n    }\n\n    this.element.append(this.container);\n  }\n}\n"],"names":["LoginPage","options","i18n"],"mappings":"wCAQA,MAAqBA,CAAU,CAQ7B,YAAYC,EAKT,CACD,KAAK,QAAU,SAAS,KAAK,cAAc,IAAMA,EAAQ,SAAS,EAI7D,KAAA,UAAY,SAAS,cAAc,KAAK,EAC7C,KAAK,UAAU,UAAY,yBAEtB,KAAA,SAAW,SAAS,cAAc,KAAK,EAC5C,KAAK,SAAS,UAAY,aAErB,KAAA,MAAQ,SAAS,cAAc,IAAI,EACrCA,EAAQ,cACT,KAAK,MAAM,OAAOC,EAAKD,EAAQ,YAAY,CAAC,EAGzC,KAAA,SAAW,SAAS,cAAc,GAAG,EAC1C,KAAK,SAAS,UAAY,WACvBA,EAAQ,iBACT,KAAK,SAAS,OAAOC,EAAKD,EAAQ,eAAe,CAAC,EAGpD,KAAK,UAAU,OAAO,KAAK,SAAU,KAAK,MAAO,KAAK,QAAQ,EAE3DA,EAAQ,mBACJ,KAAA,aAAe,SAAS,cAAc,KAAK,EAChD,KAAK,aAAa,UAAY,gBACzB,KAAA,UAAU,OAAO,KAAK,YAAY,GAGpC,KAAA,QAAQ,OAAO,KAAK,SAAS,CACpC,CACF"}
\ No newline at end of file

--- public/page-kT6kVFv9.js ---
@@ -1,2 +1,2 @@
-import{E as fe,h as U,D as C,p as de,c as ue,j,e as me,k as F,n as he,I as ve,M as ge}from"./index-XZA1-3MU.js";const A=new fe,z="start",K="end";let W=!1,M=U(),N=0;M.resolve();const H=console.log.bind(console.log,"[HEAVY-ANIMATION]:");function G(e,t){W||(M=U(),A.dispatchEvent(z),W=!0,C&&H("start")),++N,C&&H("attach promise, length:",N,t);const s=[t!==void 0?de(t):void 0,e.finally(()=>{})].filter(Boolean),a=performance.now(),n=M;return Promise.race(s).then(()=>{M!==n||M.isFulfilled||(--N,C&&H("promise end, length:",N,performance.now()-a),N<=0&&ee())}),M}window.dispatchHeavyAnimationEvent=G;function ee(){M.isFulfilled||(W=!1,N=0,A.dispatchEvent(K),M.resolve(),C&&H("end"))}function xe(){ee()}function Be(){return M}function Fe(e,t,s){W&&e();const a=s?s.add(A):A.addEventListener.bind(A),n=s?s.removeManual.bind(s,A):A.removeEventListener.bind(A);return a(z,e),a(K,t),()=>{n(K,t),n(z,e)}}function _(e,t){if(!e?.parentNode)return-1;if(t)return Array.from(e.parentNode.childNodes).indexOf(e);let s=0;for(;(e=e.previousElementSibling)!==null;)++s;return s}function k(e,t){return me.isRTL&&(e=-e),`translate3d(${e}px, ${t}px, 0)`}const ye={callback:(e,t,s)=>{const a=t.getBoundingClientRect().width,n=[e,t];return s&&n.reverse(),n[0].style.filter="brightness(80%)",n[0].style.transform=k(-a*.25,0),n[1].style.transform=k(a,0),e.classList.add("active"),e.offsetWidth,e.style.transform="",e.style.filter="",()=>{t.style.transform=t.style.filter=""}},animateFirst:!1},Ee={callback:(e,t,s)=>{const a=t.getBoundingClientRect().width,n=[e,t];return s&&n.reverse(),n[0].style.transform=k(-a,0),n[1].style.transform=k(a,0),e.classList.add("active"),e.offsetWidth,e.style.transform="",()=>{t.style.transform=""}},animateFirst:!1},we={callback:(e,t,s)=>{const a=t.getBoundingClientRect().width,n=[e,t],v=["slide-right","slide-left"];return s&&(n.reverse(),v.reverse()),n[0].style.transform=k(-a,0),n[1].style.transform=k(a,0),e.classList.add("active",v[0]),t.classList.add(v[1]),e.offsetWidth,e.style.transform="",e.classList.remove(v[0]),()=>{t.style.transform="",t.classList.remove(v[1])}},animateFirst:!1},Le={navigation:ye,premiumTabs:we,tabs:Ee},Te=e=>{let{content:t,type:s,transitionTime:a,onTransitionEnd:n,onTransitionStart:v,isHeavy:h=!0,once:w=!1,withAnimationListener:I=!0,listenerSetter:S,animateFirst:L=!1}=e;const{callback:P,animateFirst:y}=Le[s]||{};t.dataset.animation=s,y!==void 0&&(L=y);const r=new Map;let i,f=null;if(I){const o=P?"transitionend":"animationend",g=l=>{ue(l),!(l.target.parentElement!==t||(r.get(l.target)?.(),l.target!==f))&&(!i&&h||(i&&(i.resolve(),i=void 0),n?.(m.prevId()),t.classList.remove("animating","backwards","disable-hover"),w&&(S?S.removeManual(t,o,g):t.removeEventListener(o,g),f=i=void 0,r.clear())))};S?S.add(t)(o,g):t.addEventListener(o,g)}function m(o,g=!0,l){l&&(f=l),o instanceof HTMLElement&&(o=_(o));const E=m.prevId();if(o===E)return!1;v?.(o);const d=t.children[o];if((!j.isAvailable("animations")||E===-1&&!L)&&(g=!1),!I){const u=t.dataset.timeout;u!==void 0&&clearTimeout(+u),delete t.dataset.timeout}if(!g){f?f.classList.remove("active","to","from"):d&&r.get(d)?.(),d&&(d.classList.remove("to","from"),d.classList.add("active")),t.classList.remove("animating","backwards","disable-hover"),f=d,n?.(o);return}I||(t.dataset.timeout=""+window.setTimeout(()=>{d.classList.remove("to"),f&&f.classList.remove("from"),t.classList.remove("animating","backwards","disable-hover"),delete t.dataset.timeout},a)),f&&(f.classList.remove("to"),f.classList.add("from")),t.classList.add("animating");const p=E<o;t.classList.toggle("backwards",!p);let D;if(d&&(P?D=P(d,f,p):d.classList.add("active"),d.classList.remove("from"),d.classList.add("to")),d){const u=d.dataset.transitionTimeout;u&&clearTimeout(+u),r.set(d,()=>{d.classList.remove("to"),r.delete(d)})}if(f){let u;const T=f,c=()=>{clearTimeout(u),T.classList.remove("active","from"),D?.(),r.delete(T)};d?(u=window.setTimeout(c,a+100),r.set(T,c)):(u=window.setTimeout(c,a),r.set(T,()=>{clearTimeout(u),r.delete(T)})),T.dataset.transitionTimeout=""+u,h&&(i||(i=U()),G(i,a*2))}f=d}return m.prevId=()=>f?_(f):-1,m.getFrom=()=>f,m.setFrom=o=>f=o,m},q=new Map;function Se(e){x(e);const t={isCancelled:!1,deferred:U()};return q.set(e,t),t.deferred.then(()=>{te(e)===t&&q.delete(e)}),t}function te(e){return q.get(e)}function x(e){const t=te(e);t&&(t.isCancelled=!0,t.deferred.resolve())}function se(e,t,s){return s||(s=Se(t)),F(()=>{s.isCancelled||(e()?se(e,t,s):s.deferred.resolve())}),s.deferred}function Me(e){F(()=>{e()&&Me(e)})}function be(e){return!!e?.isConnected}const Z=250,Ae=600,ne=1500,Ie=500;var ie=(e=>(e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Static=2]="Static",e))(ie||{});function Pe(e){if(e.margin??(e.margin=0),e.maxDistance??(e.maxDistance=ne),e.axis??(e.axis="y"),(!j.isAvailable("animations")||e.forceDuration===0)&&(e.forceDirection=2),e.forceDirection===2)return e.forceDuration=0,V(e);const t=he().then(()=>V(e));return e.axis==="y"?G(t):t}function V(e){const{element:t,container:s,getNormalSize:a,getElementPosition:n,transitionFunction:v,axis:h,margin:w,position:I,forceDirection:S,maxDistance:L,forceDuration:P}=e;if(!be(t))return x(s),Promise.resolve();const y=h==="y"?"top":"left",r=h==="y"?"bottom":"right",i=h==="y"?"height":"width",f=h==="y"?"scrollHeight":"scrollWidth",m=h==="y"?"scrollHeight":"offsetWidth",o=h==="y"?"scrollTop":"scrollLeft",g=t.getBoundingClientRect(),l=s.getBoundingClientRect?s.getBoundingClientRect():document.body.getBoundingClientRect(),E=g[y]-l[y],d=n?n({elementRect:g,containerRect:l,elementPosition:E}):E,p=t[m],D=a?a({rect:l}):l[i];let u=s[o];const T=s[f];let c;switch(I){case"start":c=d-w;break;case"end":c=g[r]-l[r]+w;break;case"nearest":case"center":if(p<D)c=d+p/2-D/2;else{if(e.fallbackToElementStartWhenCentering&&e.fallbackToElementStartWhenCentering!==t)return e.element=e.fallbackToElementStartWhenCentering,e.position="start",V(e);c=d-w}break}if(Math.abs(c-(w||0))<1)return x(s),Promise.resolve();let R;if(h==="y"&&S===void 0&&(c>L?(R=u+=c-L,c=L):c<-L&&(R=u+=c+L,c=-L)),c<0){const b=-u;c=Math.max(c,b)}else if(c>0){const b=T-(u+D);c=Math.min(c,b)}const J=u+c,X=Math.abs(c),O=P??Z+X/ne*(Ae-Z),re=Date.now(),oe=v??(X<Ie?De:pe),Q=()=>O?Math.min((Date.now()-re)/O,1):1,Y=()=>{R!==void 0&&(s[o]=R,R=void 0);const b=Q(),le=oe(b),ce=c*(1-le);return s[o]=Math.round(J-ce),b<1};if(!O||!c)return x(s),Y(),Promise.resolve();if(e.startCallback){const b=T-Math.round(J+s[h==="y"?"offsetHeight":"offsetWidth"]);e.startCallback({scrollSize:T,scrollPosition:u,distanceToEnd:b,path:c,duration:O,containerRect:l,elementRect:g,getProgress:Q})}return se(Y,s)}function pe(e){return 1-(1-e)**5}function De(e){return 1-(1-e)**3.5}function Ne(e,t){if(!e)return null;if(e.parentElement===t)return e;for(;e.parentElement;)if(e=e.parentElement,e.parentElement===t)return e;return null}function ke(e,t){const s=new Event(t,{bubbles:!0,cancelable:!0});e.dispatchEvent(s)}let $;document.addEventListener("mousedown",e=>{$=e.target,$?.closest("[cancel-mouse-down]")&&e.preventDefault()});function Re(e){if(e.isTrusted&&e.type==="click"&&e.target!==$)return!0}const B=ve?"mousedown":"click";function _e(e,t,s={}){const a=s.listenerSetter?s.listenerSetter.add(e):e.addEventListener.bind(e),n=s.listenerSetter?s.listenerSetter.removeManual.bind(s.listenerSetter,e):e.removeEventListener.bind(e);if(s.touchMouseDown=!0,s.cancelMouseDown&&e.setAttribute("cancel-mouse-down",""),B==="click"&&!s.ignoreMove){const v=t;t=h=>{Re(h)||v(h)}}return a(B,t,s),()=>n(B,t,s)}function We(e){ke(e,B)}function Oe(e,t,s,a,n=200,v,h){const w=Te({content:t,type:e||t.dataset.animation==="tabs"?"tabs":"navigation",transitionTime:n,onTransitionEnd:a,listenerSetter:h});if(!e)return w;const I=new Proxy(w,{apply:(y,r,i)=>{const f=i[1]!==void 0?i[1]:!0;let m,o;i[0]instanceof HTMLElement?(m=_(i[0]),o=i[0]):(m=+i[0],o=e.querySelector(`[data-tab="${m}"]`)||e.children[m]),S(o,m,f)}}),S=async(y,r,i=!0)=>{const f=t.children[r];if(s){const l=s(r,f,i),E=l instanceof Promise?await l:l;if(E!==void 0&&!E)return}v&&v.scrollIntoViewNew({element:y.parentElement.children[r],position:"center",forceDirection:i?void 0:ie.Static,forceDuration:n,axis:"x"}),j.isAvailable("animations")||(i=!1);const m=w.prevId();if(y.classList.contains("active")||r===m)return!1;const o=i?F:l=>l(),g=e.querySelector(P.toLowerCase()+".active");g&&o(()=>{g.classList.remove("active")}),L&&m!==-1&&i&&o(()=>{const l=y.querySelector("i"),E=y.parentElement.children[m].querySelector("i");E.classList.remove("animate"),l.classList.remove("animate");const d=E.parentElement.parentElement.offsetLeft-l.parentElement.parentElement.offsetLeft,p=E.clientWidth/l.clientWidth;l.style.transform=`translate3d(${d}px, 0, 0) scale3d(${p}, 1, 1)`,F(()=>{l.classList.add("animate"),l.style.transform="none"})}),o(()=>{y.classList.add("active")}),w(r,i)},L=!e.classList.contains("no-stripe"),P=e.firstElementChild.tagName;return _e(e,y=>{let r=y.target;if(r=Ne(r,e),!r)return!1;let i;if(r.dataset.tab){if(i=+r.dataset.tab,i===-1)return!1}else i=_(r);S(r,i)},{listenerSetter:h}),I}class Ce{constructor(){this.pageId=-1,this.pagesDiv=document.getElementById("auth-pages"),this.scrollableDiv=this.pagesDiv.querySelector(".scrollable"),this.selectTab=Oe(null,this.scrollableDiv.querySelector(".tabs-container"),null,()=>{this.page?.onShown&&this.page.onShown()})}setPage(t){if(t.isAuthPage){this.pagesDiv.style.display="";const s=_(t.pageEl);if(this.pageId===s)return;this.selectTab(s),this.pageId=s,this.scrollableDiv&&Pe({container:this.scrollableDiv,element:this.scrollableDiv.firstElementChild,position:"start"})}else this.pagesDiv.style.display="none",t.pageEl.style.display="",this.pageId=-1;this.page=t}}const ae=new Ce;ge.pagesManager=ae;class Ue{constructor(t,s,a,n,v){this.isAuthPage=s,this.onFirstMount=a,this.onMount=n,this.onShown=v,this.installed=!1,this.pageEl=document.body.querySelector("."+t)}async mount(...t){if(this.onMount){const s=this.onMount(...t);s instanceof Promise&&await s}if(!this.installed){if(this.onFirstMount)try{const s=this.onFirstMount(...t);s instanceof Promise&&await s}catch(s){console.error("PAGE MOUNT ERROR:",s)}this.installed=!0}ae.setPage(this)}}export{B as C,ie as F,Ue as P,Te as T,_e as a,se as b,Me as c,We as d,Oe as e,Ne as f,Be as g,Re as h,be as i,Pe as j,x as k,G as l,xe as m,ke as s,Fe as u,_ as w};
-//# sourceMappingURL=page-eb81Un_i.js.map
+import{E as fe,h as U,D as C,p as de,c as ue,j,e as me,k as F,n as he,I as ve,M as ge}from"./index-M8z-nwNm.js";const A=new fe,z="start",K="end";let W=!1,M=U(),N=0;M.resolve();const H=console.log.bind(console.log,"[HEAVY-ANIMATION]:");function G(e,t){W||(M=U(),A.dispatchEvent(z),W=!0,C&&H("start")),++N,C&&H("attach promise, length:",N,t);const s=[t!==void 0?de(t):void 0,e.finally(()=>{})].filter(Boolean),a=performance.now(),n=M;return Promise.race(s).then(()=>{M!==n||M.isFulfilled||(--N,C&&H("promise end, length:",N,performance.now()-a),N<=0&&ee())}),M}window.dispatchHeavyAnimationEvent=G;function ee(){M.isFulfilled||(W=!1,N=0,A.dispatchEvent(K),M.resolve(),C&&H("end"))}function xe(){ee()}function Be(){return M}function Fe(e,t,s){W&&e();const a=s?s.add(A):A.addEventListener.bind(A),n=s?s.removeManual.bind(s,A):A.removeEventListener.bind(A);return a(z,e),a(K,t),()=>{n(K,t),n(z,e)}}function _(e,t){if(!e?.parentNode)return-1;if(t)return Array.from(e.parentNode.childNodes).indexOf(e);let s=0;for(;(e=e.previousElementSibling)!==null;)++s;return s}function k(e,t){return me.isRTL&&(e=-e),`translate3d(${e}px, ${t}px, 0)`}const ye={callback:(e,t,s)=>{const a=t.getBoundingClientRect().width,n=[e,t];return s&&n.reverse(),n[0].style.filter="brightness(80%)",n[0].style.transform=k(-a*.25,0),n[1].style.transform=k(a,0),e.classList.add("active"),e.offsetWidth,e.style.transform="",e.style.filter="",()=>{t.style.transform=t.style.filter=""}},animateFirst:!1},Ee={callback:(e,t,s)=>{const a=t.getBoundingClientRect().width,n=[e,t];return s&&n.reverse(),n[0].style.transform=k(-a,0),n[1].style.transform=k(a,0),e.classList.add("active"),e.offsetWidth,e.style.transform="",()=>{t.style.transform=""}},animateFirst:!1},we={callback:(e,t,s)=>{const a=t.getBoundingClientRect().width,n=[e,t],v=["slide-right","slide-left"];return s&&(n.reverse(),v.reverse()),n[0].style.transform=k(-a,0),n[1].style.transform=k(a,0),e.classList.add("active",v[0]),t.classList.add(v[1]),e.offsetWidth,e.style.transform="",e.classList.remove(v[0]),()=>{t.style.transform="",t.classList.remove(v[1])}},animateFirst:!1},Le={navigation:ye,premiumTabs:we,tabs:Ee},Te=e=>{let{content:t,type:s,transitionTime:a,onTransitionEnd:n,onTransitionStart:v,isHeavy:h=!0,once:w=!1,withAnimationListener:I=!0,listenerSetter:S,animateFirst:L=!1}=e;const{callback:P,animateFirst:y}=Le[s]||{};t.dataset.animation=s,y!==void 0&&(L=y);const r=new Map;let i,f=null;if(I){const o=P?"transitionend":"animationend",g=l=>{ue(l),!(l.target.parentElement!==t||(r.get(l.target)?.(),l.target!==f))&&(!i&&h||(i&&(i.resolve(),i=void 0),n?.(m.prevId()),t.classList.remove("animating","backwards","disable-hover"),w&&(S?S.removeManual(t,o,g):t.removeEventListener(o,g),f=i=void 0,r.clear())))};S?S.add(t)(o,g):t.addEventListener(o,g)}function m(o,g=!0,l){l&&(f=l),o instanceof HTMLElement&&(o=_(o));const E=m.prevId();if(o===E)return!1;v?.(o);const d=t.children[o];if((!j.isAvailable("animations")||E===-1&&!L)&&(g=!1),!I){const u=t.dataset.timeout;u!==void 0&&clearTimeout(+u),delete t.dataset.timeout}if(!g){f?f.classList.remove("active","to","from"):d&&r.get(d)?.(),d&&(d.classList.remove("to","from"),d.classList.add("active")),t.classList.remove("animating","backwards","disable-hover"),f=d,n?.(o);return}I||(t.dataset.timeout=""+window.setTimeout(()=>{d.classList.remove("to"),f&&f.classList.remove("from"),t.classList.remove("animating","backwards","disable-hover"),delete t.dataset.timeout},a)),f&&(f.classList.remove("to"),f.classList.add("from")),t.classList.add("animating");const p=E<o;t.classList.toggle("backwards",!p);let D;if(d&&(P?D=P(d,f,p):d.classList.add("active"),d.classList.remove("from"),d.classList.add("to")),d){const u=d.dataset.transitionTimeout;u&&clearTimeout(+u),r.set(d,()=>{d.classList.remove("to"),r.delete(d)})}if(f){let u;const T=f,c=()=>{clearTimeout(u),T.classList.remove("active","from"),D?.(),r.delete(T)};d?(u=window.setTimeout(c,a+100),r.set(T,c)):(u=window.setTimeout(c,a),r.set(T,()=>{clearTimeout(u),r.delete(T)})),T.dataset.transitionTimeout=""+u,h&&(i||(i=U()),G(i,a*2))}f=d}return m.prevId=()=>f?_(f):-1,m.getFrom=()=>f,m.setFrom=o=>f=o,m},q=new Map;function Se(e){x(e);const t={isCancelled:!1,deferred:U()};return q.set(e,t),t.deferred.then(()=>{te(e)===t&&q.delete(e)}),t}function te(e){return q.get(e)}function x(e){const t=te(e);t&&(t.isCancelled=!0,t.deferred.resolve())}function se(e,t,s){return s||(s=Se(t)),F(()=>{s.isCancelled||(e()?se(e,t,s):s.deferred.resolve())}),s.deferred}function Me(e){F(()=>{e()&&Me(e)})}function be(e){return!!e?.isConnected}const Z=250,Ae=600,ne=1500,Ie=500;var ie=(e=>(e[e.Up=0]="Up",e[e.Down=1]="Down",e[e.Static=2]="Static",e))(ie||{});function Pe(e){if(e.margin??(e.margin=0),e.maxDistance??(e.maxDistance=ne),e.axis??(e.axis="y"),(!j.isAvailable("animations")||e.forceDuration===0)&&(e.forceDirection=2),e.forceDirection===2)return e.forceDuration=0,V(e);const t=he().then(()=>V(e));return e.axis==="y"?G(t):t}function V(e){const{element:t,container:s,getNormalSize:a,getElementPosition:n,transitionFunction:v,axis:h,margin:w,position:I,forceDirection:S,maxDistance:L,forceDuration:P}=e;if(!be(t))return x(s),Promise.resolve();const y=h==="y"?"top":"left",r=h==="y"?"bottom":"right",i=h==="y"?"height":"width",f=h==="y"?"scrollHeight":"scrollWidth",m=h==="y"?"scrollHeight":"offsetWidth",o=h==="y"?"scrollTop":"scrollLeft",g=t.getBoundingClientRect(),l=s.getBoundingClientRect?s.getBoundingClientRect():document.body.getBoundingClientRect(),E=g[y]-l[y],d=n?n({elementRect:g,containerRect:l,elementPosition:E}):E,p=t[m],D=a?a({rect:l}):l[i];let u=s[o];const T=s[f];let c;switch(I){case"start":c=d-w;break;case"end":c=g[r]-l[r]+w;break;case"nearest":case"center":if(p<D)c=d+p/2-D/2;else{if(e.fallbackToElementStartWhenCentering&&e.fallbackToElementStartWhenCentering!==t)return e.element=e.fallbackToElementStartWhenCentering,e.position="start",V(e);c=d-w}break}if(Math.abs(c-(w||0))<1)return x(s),Promise.resolve();let R;if(h==="y"&&S===void 0&&(c>L?(R=u+=c-L,c=L):c<-L&&(R=u+=c+L,c=-L)),c<0){const b=-u;c=Math.max(c,b)}else if(c>0){const b=T-(u+D);c=Math.min(c,b)}const J=u+c,X=Math.abs(c),O=P??Z+X/ne*(Ae-Z),re=Date.now(),oe=v??(X<Ie?De:pe),Q=()=>O?Math.min((Date.now()-re)/O,1):1,Y=()=>{R!==void 0&&(s[o]=R,R=void 0);const b=Q(),le=oe(b),ce=c*(1-le);return s[o]=Math.round(J-ce),b<1};if(!O||!c)return x(s),Y(),Promise.resolve();if(e.startCallback){const b=T-Math.round(J+s[h==="y"?"offsetHeight":"offsetWidth"]);e.startCallback({scrollSize:T,scrollPosition:u,distanceToEnd:b,path:c,duration:O,containerRect:l,elementRect:g,getProgress:Q})}return se(Y,s)}function pe(e){return 1-(1-e)**5}function De(e){return 1-(1-e)**3.5}function Ne(e,t){if(!e)return null;if(e.parentElement===t)return e;for(;e.parentElement;)if(e=e.parentElement,e.parentElement===t)return e;return null}function ke(e,t){const s=new Event(t,{bubbles:!0,cancelable:!0});e.dispatchEvent(s)}let $;document.addEventListener("mousedown",e=>{$=e.target,$?.closest("[cancel-mouse-down]")&&e.preventDefault()});function Re(e){if(e.isTrusted&&e.type==="click"&&e.target!==$)return!0}const B=ve?"mousedown":"click";function _e(e,t,s={}){const a=s.listenerSetter?s.listenerSetter.add(e):e.addEventListener.bind(e),n=s.listenerSetter?s.listenerSetter.removeManual.bind(s.listenerSetter,e):e.removeEventListener.bind(e);if(s.touchMouseDown=!0,s.cancelMouseDown&&e.setAttribute("cancel-mouse-down",""),B==="click"&&!s.ignoreMove){const v=t;t=h=>{Re(h)||v(h)}}return a(B,t,s),()=>n(B,t,s)}function We(e){ke(e,B)}function Oe(e,t,s,a,n=200,v,h){const w=Te({content:t,type:e||t.dataset.animation==="tabs"?"tabs":"navigation",transitionTime:n,onTransitionEnd:a,listenerSetter:h});if(!e)return w;const I=new Proxy(w,{apply:(y,r,i)=>{const f=i[1]!==void 0?i[1]:!0;let m,o;i[0]instanceof HTMLElement?(m=_(i[0]),o=i[0]):(m=+i[0],o=e.querySelector(`[data-tab="${m}"]`)||e.children[m]),S(o,m,f)}}),S=async(y,r,i=!0)=>{const f=t.children[r];if(s){const l=s(r,f,i),E=l instanceof Promise?await l:l;if(E!==void 0&&!E)return}v&&v.scrollIntoViewNew({element:y.parentElement.children[r],position:"center",forceDirection:i?void 0:ie.Static,forceDuration:n,axis:"x"}),j.isAvailable("animations")||(i=!1);const m=w.prevId();if(y.classList.contains("active")||r===m)return!1;const o=i?F:l=>l(),g=e.querySelector(P.toLowerCase()+".active");g&&o(()=>{g.classList.remove("active")}),L&&m!==-1&&i&&o(()=>{const l=y.querySelector("i"),E=y.parentElement.children[m].querySelector("i");E.classList.remove("animate"),l.classList.remove("animate");const d=E.parentElement.parentElement.offsetLeft-l.parentElement.parentElement.offsetLeft,p=E.clientWidth/l.clientWidth;l.style.transform=`translate3d(${d}px, 0, 0) scale3d(${p}, 1, 1)`,F(()=>{l.classList.add("animate"),l.style.transform="none"})}),o(()=>{y.classList.add("active")}),w(r,i)},L=!e.classList.contains("no-stripe"),P=e.firstElementChild.tagName;return _e(e,y=>{let r=y.target;if(r=Ne(r,e),!r)return!1;let i;if(r.dataset.tab){if(i=+r.dataset.tab,i===-1)return!1}else i=_(r);S(r,i)},{listenerSetter:h}),I}class Ce{constructor(){this.pageId=-1,this.pagesDiv=document.getElementById("auth-pages"),this.scrollableDiv=this.pagesDiv.querySelector(".scrollable"),this.selectTab=Oe(null,this.scrollableDiv.querySelector(".tabs-container"),null,()=>{this.page?.onShown&&this.page.onShown()})}setPage(t){if(t.isAuthPage){this.pagesDiv.style.display="";const s=_(t.pageEl);if(this.pageId===s)return;this.selectTab(s),this.pageId=s,this.scrollableDiv&&Pe({container:this.scrollableDiv,element:this.scrollableDiv.firstElementChild,position:"start"})}else this.pagesDiv.style.display="none",t.pageEl.style.display="",this.pageId=-1;this.page=t}}const ae=new Ce;ge.pagesManager=ae;class Ue{constructor(t,s,a,n,v){this.isAuthPage=s,this.onFirstMount=a,this.onMount=n,this.onShown=v,this.installed=!1,this.pageEl=document.body.querySelector("."+t)}async mount(...t){if(this.onMount){const s=this.onMount(...t);s instanceof Promise&&await s}if(!this.installed){if(this.onFirstMount)try{const s=this.onFirstMount(...t);s instanceof Promise&&await s}catch(s){console.error("PAGE MOUNT ERROR:",s)}this.installed=!0}ae.setPage(this)}}export{B as C,ie as F,Ue as P,Te as T,_e as a,se as b,Me as c,We as d,Oe as e,Ne as f,Be as g,Re as h,be as i,Pe as j,x as k,G as l,xe as m,ke as s,Fe as u,_ as w};
+//# sourceMappingURL=page-kT6kVFv9.js.map

--- public/pageAuthCode-tLfkajQz.js ---
@@ -1,8 +1,8 @@
-import{r as y,i as h,a as _,_ as d,m as f}from"./index-XZA1-3MU.js";import{P as S,a as v}from"./page-eb81Un_i.js";import T from"./pageSignIn-pfbmi0Ny.js";import{C as k,T as I}from"./codeInputField-H0ySI27M.js";import{s as A,r as E,l as g}from"./wrapEmojiText-pejq-WF4.js";import{I as D}from"./button-aS2SE0kp.js";import"./putPreloader--f-Xu9AG.js";import"./countryInputField-Rr6PHiIn.js";import"./scrollable-OU41biYL.js";import"./pageSignQR-bI2rYqWN.js";import"./textToSvgURL-Z4O-nL1S.js";let r=null,c=null,C=null,o,n,l,u;const b=()=>{setTimeout(()=>{l?.remove(),u?.remove()},300)},L=t=>{o.setAttribute("disabled","true");const s={phone_number:r.phone_number,phone_code_hash:r.phone_code_hash,phone_code:t};_.managers.apiManager.invokeApi("auth.signIn",s,{ignoreErrors:!0}).then(async e=>{switch(e._){case"auth.authorization":await _.managers.apiManager.setUser(e.user),d(()=>import("./pageIm-2VO8DGq9.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(a=>{a.default.mount()}),b();break;case"auth.authorizationSignUpRequired":d(()=>import("./pageSignUp-4OqqTrno.js"),__vite__mapDeps([4,1,2,5,3,6,7,8,9,10]),import.meta.url).then(a=>{a.default.mount({phone_number:r.phone_number,phone_code_hash:r.phone_code_hash})}),b();break}}).catch(async e=>{let a=!1;switch(e.type){case"SESSION_PASSWORD_NEEDED":a=!0,e.handled=!0,await(await d(()=>import("./pagePassword-wGJb-e9C.js"),__vite__mapDeps([11,1,2,10,3,7,12,6,5]),import.meta.url)).default.mount(),setTimeout(()=>{o.value=""},300);break;case"PHONE_CODE_EXPIRED":o.classList.add("error"),E(n.label,h("PHONE_CODE_EXPIRED"));break;case"PHONE_CODE_EMPTY":case"PHONE_CODE_INVALID":o.classList.add("error"),E(n.label,h("PHONE_CODE_INVALID"));break;default:n.label.innerText=e.type;break}a||n.select(),o.removeAttribute("disabled")})},O=()=>{p.pageEl.querySelector(".input-wrapper").append(n.container);const t=p.pageEl.querySelector(".phone-edit");t.append(D("edit")),v(t,()=>T.mount())},P=()=>{const t=p.pageEl.querySelector(".auth-image"),s=f.isMobile?100:166;if(r.type._==="auth.sentCodeTypeFragmentSms"){t.firstElementChild&&(l?.remove(),l=void 0,t.replaceChildren());const e=document.createElement("div");return e.classList.add("media-sticker-wrapper"),t.append(e),g.loadAnimationAsAsset({container:e,loop:!0,autoplay:!0,width:s,height:s},"jolly_roger").then(a=>(u=a,g.waitForFirstFrame(a))).then(()=>{})}else return t.firstElementChild&&(u?.remove(),u=void 0,t.replaceChildren()),l=new I(n,s),t.append(l.container),l.load()},p=new S("page-authCode",!0,O,t=>{if(r=t,!c)c=p.pageEl.getElementsByClassName("phone")[0],C=p.pageEl.getElementsByClassName("sent-type")[0];else{o.value="";const i=document.createEvent("HTMLEvents");i.initEvent("input",!1,!0),o.dispatchEvent(i)}const s=r.type.length;n||(n=new k({label:"Code",name:y(),length:s,onFill:i=>{L(i)}}),o=n.input),n.options.length=s,c.innerText=r.phone_number;let e,a;const m=r.type;switch(m._){case"auth.sentCodeTypeSms":e="Login.Code.SentSms";break;case"auth.sentCodeTypeApp":e="Login.Code.SentInApp";break;case"auth.sentCodeTypeCall":e="Login.Code.SentCall";break;case"auth.sentCodeTypeFragmentSms":e="PhoneNumber.Code.Fragment.Info";const i=document.createElement("a");A(i),i.href=m.url,a=[i];break;default:e="Login.Code.SentUnknown",a=[m._];break}return E(C,h(e,a)),_.managers.appStateManager.pushToState("authState",{_:"authStateAuthCode",sentCode:t}),P().catch(()=>{})},()=>{o.focus()});export{p as default};
-//# sourceMappingURL=pageAuthCode-B0HhyDcO.js.map
+import{r as y,i as h,a as _,_ as d,m as f}from"./index-M8z-nwNm.js";import{P as S,a as v}from"./page-kT6kVFv9.js";import T from"./pageSignIn-N45VQ3GF.js";import{C as k,T as I}from"./codeInputField-Ofayp2TX.js";import{s as A,r as E,l as g}from"./wrapEmojiText-PAHdiQbe.js";import{I as D}from"./button-Mm7TqKr1.js";import"./putPreloader-jxB4tqkF.js";import"./countryInputField-tqY1KpER.js";import"./scrollable-ILmNatrX.js";import"./pageSignQR-VxURk7YO.js";import"./textToSvgURL-Z4O-nL1S.js";let r=null,c=null,C=null,o,n,l,u;const b=()=>{setTimeout(()=>{l?.remove(),u?.remove()},300)},L=t=>{o.setAttribute("disabled","true");const s={phone_number:r.phone_number,phone_code_hash:r.phone_code_hash,phone_code:t};_.managers.apiManager.invokeApi("auth.signIn",s,{ignoreErrors:!0}).then(async e=>{switch(e._){case"auth.authorization":await _.managers.apiManager.setUser(e.user),d(()=>import("./pageIm-wngHxkKH.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(a=>{a.default.mount()}),b();break;case"auth.authorizationSignUpRequired":d(()=>import("./pageSignUp-fAex3eRP.js"),__vite__mapDeps([4,1,2,5,3,6,7,8,9,10]),import.meta.url).then(a=>{a.default.mount({phone_number:r.phone_number,phone_code_hash:r.phone_code_hash})}),b();break}}).catch(async e=>{let a=!1;switch(e.type){case"SESSION_PASSWORD_NEEDED":a=!0,e.handled=!0,await(await d(()=>import("./pagePassword-q_GU3dwQ.js"),__vite__mapDeps([11,1,2,10,3,7,12,6,5]),import.meta.url)).default.mount(),setTimeout(()=>{o.value=""},300);break;case"PHONE_CODE_EXPIRED":o.classList.add("error"),E(n.label,h("PHONE_CODE_EXPIRED"));break;case"PHONE_CODE_EMPTY":case"PHONE_CODE_INVALID":o.classList.add("error"),E(n.label,h("PHONE_CODE_INVALID"));break;default:n.label.innerText=e.type;break}a||n.select(),o.removeAttribute("disabled")})},O=()=>{p.pageEl.querySelector(".input-wrapper").append(n.container);const t=p.pageEl.querySelector(".phone-edit");t.append(D("edit")),v(t,()=>T.mount())},P=()=>{const t=p.pageEl.querySelector(".auth-image"),s=f.isMobile?100:166;if(r.type._==="auth.sentCodeTypeFragmentSms"){t.firstElementChild&&(l?.remove(),l=void 0,t.replaceChildren());const e=document.createElement("div");return e.classList.add("media-sticker-wrapper"),t.append(e),g.loadAnimationAsAsset({container:e,loop:!0,autoplay:!0,width:s,height:s},"jolly_roger").then(a=>(u=a,g.waitForFirstFrame(a))).then(()=>{})}else return t.firstElementChild&&(u?.remove(),u=void 0,t.replaceChildren()),l=new I(n,s),t.append(l.container),l.load()},p=new S("page-authCode",!0,O,t=>{if(r=t,!c)c=p.pageEl.getElementsByClassName("phone")[0],C=p.pageEl.getElementsByClassName("sent-type")[0];else{o.value="";const i=document.createEvent("HTMLEvents");i.initEvent("input",!1,!0),o.dispatchEvent(i)}const s=r.type.length;n||(n=new k({label:"Code",name:y(),length:s,onFill:i=>{L(i)}}),o=n.input),n.options.length=s,c.innerText=r.phone_number;let e,a;const m=r.type;switch(m._){case"auth.sentCodeTypeSms":e="Login.Code.SentSms";break;case"auth.sentCodeTypeApp":e="Login.Code.SentInApp";break;case"auth.sentCodeTypeCall":e="Login.Code.SentCall";break;case"auth.sentCodeTypeFragmentSms":e="PhoneNumber.Code.Fragment.Info";const i=document.createElement("a");A(i),i.href=m.url,a=[i];break;default:e="Login.Code.SentUnknown",a=[m._];break}return E(C,h(e,a)),_.managers.appStateManager.pushToState("authState",{_:"authStateAuthCode",sentCode:t}),P().catch(()=>{})},()=>{o.focus()});export{p as default};
+//# sourceMappingURL=pageAuthCode-tLfkajQz.js.map
 function __vite__mapDeps(indexes) {
   if (!__vite__mapDeps.viteFileDeps) {
-    __vite__mapDeps.viteFileDeps = ["./pageIm-2VO8DGq9.js","./index-XZA1-3MU.js","./index-pzR5gIOz.css","./page-eb81Un_i.js","./pageSignUp-4OqqTrno.js","./loginPage-EKVIJLjo.js","./wrapEmojiText-pejq-WF4.js","./button-aS2SE0kp.js","./avatar-ohgkiWHW.js","./scrollable-OU41biYL.js","./putPreloader--f-Xu9AG.js","./pagePassword-wGJb-e9C.js","./htmlToSpan-52gQDcFu.js"]
+    __vite__mapDeps.viteFileDeps = ["./pageIm-wngHxkKH.js","./index-M8z-nwNm.js","./index-pzR5gIOz.css","./page-kT6kVFv9.js","./pageSignUp-fAex3eRP.js","./loginPage-0kq1JorQ.js","./wrapEmojiText-PAHdiQbe.js","./button-Mm7TqKr1.js","./avatar-HalcuPNE.js","./scrollable-ILmNatrX.js","./putPreloader-jxB4tqkF.js","./pagePassword-q_GU3dwQ.js","./htmlToSpan-BQ96zqgl.js"]
   }
   return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
 }
\ No newline at end of file

--- public/pageAuthCode-tLfkajQz.js.map ---
@@ -1 +1 @@
-{"version":3,"mappings":"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","names":["authSentCode","headerElement","sentTypeElement","codeInput","codeInputField","monkey","player","cleanup","submitCode","code","params","rootScope","response","__vitePreload","m","err","good","replaceContent","i18n","onFirstMount","page","editButton","Icon","attachClickEvent","pageSignIn","getAnimation","imageDiv","size","mediaSizes","container","lottieLoader","animation","TrackingMonkey","Page","_authCode","evt","CODE_LENGTH","CodeInputField","randomLong","key","args","authSentCodeType","a","setBlankToAnchor"],"sources":["../src/pages/pageAuthCode.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport mediaSizes from '../helpers/mediaSizes';\nimport {AuthSentCode, AuthSentCodeType, AuthSignIn} from '../layer';\nimport Page from './page';\nimport pageSignIn from './pageSignIn';\nimport TrackingMonkey from '../components/monkeys/tracking';\nimport CodeInputField from '../components/codeInputField';\nimport {i18n, LangPackKey} from '../lib/langPack';\nimport {randomLong} from '../helpers/random';\nimport replaceContent from '../helpers/dom/replaceContent';\nimport rootScope from '../lib/rootScope';\nimport lottieLoader from '../lib/rlottie/lottieLoader';\nimport RLottiePlayer from '../lib/rlottie/rlottiePlayer';\nimport setBlankToAnchor from '../lib/richTextProcessor/setBlankToAnchor';\nimport {attachClickEvent} from '../helpers/dom/clickEvent';\nimport Icon from '../components/icon';\n\nlet authSentCode: AuthSentCode.authSentCode = null;\n\nlet headerElement: HTMLHeadElement = null;\nlet sentTypeElement: HTMLParagraphElement = null;\nlet codeInput: HTMLInputElement, codeInputField: CodeInputField;\nlet monkey: TrackingMonkey, player: RLottiePlayer;\n\nconst cleanup = () => {\n  setTimeout(() => {\n    monkey?.remove();\n    player?.remove();\n  }, 300);\n};\n\nconst submitCode = (code: string) => {\n  codeInput.setAttribute('disabled', 'true');\n\n  const params: AuthSignIn = {\n    phone_number: authSentCode.phone_number,\n    phone_code_hash: authSentCode.phone_code_hash,\n    phone_code: code\n  };\n\n  // console.log('invoking auth.signIn with params:', params);\n\n  rootScope.managers.apiManager.invokeApi('auth.signIn', params, {ignoreErrors: true})\n  .then(async(response) => {\n    // console.log('auth.signIn response:', response);\n\n    switch(response._) {\n      case 'auth.authorization':\n        await rootScope.managers.apiManager.setUser(response.user);\n\n        import('./pageIm').then((m) => {\n          m.default.mount();\n        });\n        cleanup();\n        break;\n      case 'auth.authorizationSignUpRequired':\n        // console.log('Registration needed!');\n\n        import('./pageSignUp').then((m) => {\n          m.default.mount({\n            'phone_number': authSentCode.phone_number,\n            'phone_code_hash': authSentCode.phone_code_hash\n          });\n        });\n\n        cleanup();\n        break;\n      /* default:\n        codeInput.innerText = response._;\n        break; */\n    }\n  }).catch(async(err) => {\n    let good = false;\n    switch(err.type) {\n      case 'SESSION_PASSWORD_NEEDED':\n        // console.warn('pageAuthCode: SESSION_PASSWORD_NEEDED');\n        good = true;\n        err.handled = true;\n        await (await import('./pagePassword')).default.mount(); // lol\n        setTimeout(() => {\n          codeInput.value = '';\n        }, 300);\n        break;\n      case 'PHONE_CODE_EXPIRED':\n        codeInput.classList.add('error');\n        replaceContent(codeInputField.label, i18n('PHONE_CODE_EXPIRED'));\n        break;\n      case 'PHONE_CODE_EMPTY':\n      case 'PHONE_CODE_INVALID':\n        codeInput.classList.add('error');\n        replaceContent(codeInputField.label, i18n('PHONE_CODE_INVALID'));\n        break;\n      default:\n        codeInputField.label.innerText = err.type;\n        break;\n    }\n\n    if(!good) {\n      codeInputField.select();\n    }\n\n    codeInput.removeAttribute('disabled');\n  });\n};\n\nconst onFirstMount = () => {\n  page.pageEl.querySelector('.input-wrapper').append(codeInputField.container);\n\n  const editButton = page.pageEl.querySelector('.phone-edit') as HTMLElement;\n  editButton.append(Icon('edit'));\n  attachClickEvent(editButton, () => {\n    return pageSignIn.mount();\n  });\n};\n\nconst getAnimation = () => {\n  const imageDiv = page.pageEl.querySelector('.auth-image') as HTMLDivElement;\n  const size = mediaSizes.isMobile ? 100 : 166;\n  if(authSentCode.type._ === 'auth.sentCodeTypeFragmentSms') {\n    if(imageDiv.firstElementChild) {\n      monkey?.remove();\n      monkey = undefined;\n      imageDiv.replaceChildren();\n    }\n\n    const container = document.createElement('div');\n    container.classList.add('media-sticker-wrapper');\n    imageDiv.append(container);\n    return lottieLoader.loadAnimationAsAsset({\n      container: container,\n      loop: true,\n      autoplay: true,\n      width: size,\n      height: size\n    }, 'jolly_roger').then((animation) => {\n      player = animation;\n      return lottieLoader.waitForFirstFrame(animation);\n    }).then(() => {});\n  } else {\n    if(imageDiv.firstElementChild) {\n      player?.remove();\n      player = undefined;\n      imageDiv.replaceChildren();\n    }\n\n    monkey = new TrackingMonkey(codeInputField, size);\n    imageDiv.append(monkey.container);\n    return monkey.load();\n  }\n};\n\nconst page = new Page('page-authCode', true, onFirstMount, (_authCode: typeof authSentCode) => {\n  authSentCode = _authCode;\n\n  if(!headerElement) {\n    headerElement = page.pageEl.getElementsByClassName('phone')[0] as HTMLHeadElement;\n    sentTypeElement = page.pageEl.getElementsByClassName('sent-type')[0] as HTMLParagraphElement;\n  } else {\n    codeInput.value = '';\n\n    const evt = document.createEvent('HTMLEvents');\n    evt.initEvent('input', false, true);\n    codeInput.dispatchEvent(evt);\n  }\n\n  const CODE_LENGTH = (authSentCode.type as AuthSentCodeType.authSentCodeTypeApp).length;\n  if(!codeInputField) {\n    codeInputField = new CodeInputField({\n      label: 'Code',\n      name: randomLong(),\n      length: CODE_LENGTH,\n      onFill: (code) => {\n        submitCode(code);\n      }\n    });\n\n    codeInput = codeInputField.input as HTMLInputElement;\n  }\n\n  codeInputField.options.length = CODE_LENGTH;\n\n  headerElement.innerText = authSentCode.phone_number;\n  let key: LangPackKey, args: any[];\n  const authSentCodeType = authSentCode.type;\n  switch(authSentCodeType._) {\n    case 'auth.sentCodeTypeSms':\n      key = 'Login.Code.SentSms';\n      break;\n    case 'auth.sentCodeTypeApp':\n      key = 'Login.Code.SentInApp';\n      break;\n    case 'auth.sentCodeTypeCall':\n      key = 'Login.Code.SentCall';\n      break;\n    case 'auth.sentCodeTypeFragmentSms':\n      key = 'PhoneNumber.Code.Fragment.Info';\n      const a = document.createElement('a');\n      setBlankToAnchor(a);\n      a.href = authSentCodeType.url;\n      args = [a];\n      break;\n    default:\n      key = 'Login.Code.SentUnknown';\n      args = [authSentCodeType._];\n      break;\n  }\n\n  replaceContent(sentTypeElement, i18n(key, args));\n\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStateAuthCode', sentCode: _authCode});\n\n  return getAnimation().catch(() => {});\n}, () => {\n  codeInput.focus();\n});\n\nexport default page;\n"],"file":"pageAuthCode-B0HhyDcO.js"}
\ No newline at end of file
+{"version":3,"mappings":"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","names":["authSentCode","headerElement","sentTypeElement","codeInput","codeInputField","monkey","player","cleanup","submitCode","code","params","rootScope","response","__vitePreload","m","err","good","replaceContent","i18n","onFirstMount","page","editButton","Icon","attachClickEvent","pageSignIn","getAnimation","imageDiv","size","mediaSizes","container","lottieLoader","animation","TrackingMonkey","Page","_authCode","evt","CODE_LENGTH","CodeInputField","randomLong","key","args","authSentCodeType","a","setBlankToAnchor"],"sources":["../src/pages/pageAuthCode.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport mediaSizes from '../helpers/mediaSizes';\nimport {AuthSentCode, AuthSentCodeType, AuthSignIn} from '../layer';\nimport Page from './page';\nimport pageSignIn from './pageSignIn';\nimport TrackingMonkey from '../components/monkeys/tracking';\nimport CodeInputField from '../components/codeInputField';\nimport {i18n, LangPackKey} from '../lib/langPack';\nimport {randomLong} from '../helpers/random';\nimport replaceContent from '../helpers/dom/replaceContent';\nimport rootScope from '../lib/rootScope';\nimport lottieLoader from '../lib/rlottie/lottieLoader';\nimport RLottiePlayer from '../lib/rlottie/rlottiePlayer';\nimport setBlankToAnchor from '../lib/richTextProcessor/setBlankToAnchor';\nimport {attachClickEvent} from '../helpers/dom/clickEvent';\nimport Icon from '../components/icon';\n\nlet authSentCode: AuthSentCode.authSentCode = null;\n\nlet headerElement: HTMLHeadElement = null;\nlet sentTypeElement: HTMLParagraphElement = null;\nlet codeInput: HTMLInputElement, codeInputField: CodeInputField;\nlet monkey: TrackingMonkey, player: RLottiePlayer;\n\nconst cleanup = () => {\n  setTimeout(() => {\n    monkey?.remove();\n    player?.remove();\n  }, 300);\n};\n\nconst submitCode = (code: string) => {\n  codeInput.setAttribute('disabled', 'true');\n\n  const params: AuthSignIn = {\n    phone_number: authSentCode.phone_number,\n    phone_code_hash: authSentCode.phone_code_hash,\n    phone_code: code\n  };\n\n  // console.log('invoking auth.signIn with params:', params);\n\n  rootScope.managers.apiManager.invokeApi('auth.signIn', params, {ignoreErrors: true})\n  .then(async(response) => {\n    // console.log('auth.signIn response:', response);\n\n    switch(response._) {\n      case 'auth.authorization':\n        await rootScope.managers.apiManager.setUser(response.user);\n\n        import('./pageIm').then((m) => {\n          m.default.mount();\n        });\n        cleanup();\n        break;\n      case 'auth.authorizationSignUpRequired':\n        // console.log('Registration needed!');\n\n        import('./pageSignUp').then((m) => {\n          m.default.mount({\n            'phone_number': authSentCode.phone_number,\n            'phone_code_hash': authSentCode.phone_code_hash\n          });\n        });\n\n        cleanup();\n        break;\n      /* default:\n        codeInput.innerText = response._;\n        break; */\n    }\n  }).catch(async(err) => {\n    let good = false;\n    switch(err.type) {\n      case 'SESSION_PASSWORD_NEEDED':\n        // console.warn('pageAuthCode: SESSION_PASSWORD_NEEDED');\n        good = true;\n        err.handled = true;\n        await (await import('./pagePassword')).default.mount(); // lol\n        setTimeout(() => {\n          codeInput.value = '';\n        }, 300);\n        break;\n      case 'PHONE_CODE_EXPIRED':\n        codeInput.classList.add('error');\n        replaceContent(codeInputField.label, i18n('PHONE_CODE_EXPIRED'));\n        break;\n      case 'PHONE_CODE_EMPTY':\n      case 'PHONE_CODE_INVALID':\n        codeInput.classList.add('error');\n        replaceContent(codeInputField.label, i18n('PHONE_CODE_INVALID'));\n        break;\n      default:\n        codeInputField.label.innerText = err.type;\n        break;\n    }\n\n    if(!good) {\n      codeInputField.select();\n    }\n\n    codeInput.removeAttribute('disabled');\n  });\n};\n\nconst onFirstMount = () => {\n  page.pageEl.querySelector('.input-wrapper').append(codeInputField.container);\n\n  const editButton = page.pageEl.querySelector('.phone-edit') as HTMLElement;\n  editButton.append(Icon('edit'));\n  attachClickEvent(editButton, () => {\n    return pageSignIn.mount();\n  });\n};\n\nconst getAnimation = () => {\n  const imageDiv = page.pageEl.querySelector('.auth-image') as HTMLDivElement;\n  const size = mediaSizes.isMobile ? 100 : 166;\n  if(authSentCode.type._ === 'auth.sentCodeTypeFragmentSms') {\n    if(imageDiv.firstElementChild) {\n      monkey?.remove();\n      monkey = undefined;\n      imageDiv.replaceChildren();\n    }\n\n    const container = document.createElement('div');\n    container.classList.add('media-sticker-wrapper');\n    imageDiv.append(container);\n    return lottieLoader.loadAnimationAsAsset({\n      container: container,\n      loop: true,\n      autoplay: true,\n      width: size,\n      height: size\n    }, 'jolly_roger').then((animation) => {\n      player = animation;\n      return lottieLoader.waitForFirstFrame(animation);\n    }).then(() => {});\n  } else {\n    if(imageDiv.firstElementChild) {\n      player?.remove();\n      player = undefined;\n      imageDiv.replaceChildren();\n    }\n\n    monkey = new TrackingMonkey(codeInputField, size);\n    imageDiv.append(monkey.container);\n    return monkey.load();\n  }\n};\n\nconst page = new Page('page-authCode', true, onFirstMount, (_authCode: typeof authSentCode) => {\n  authSentCode = _authCode;\n\n  if(!headerElement) {\n    headerElement = page.pageEl.getElementsByClassName('phone')[0] as HTMLHeadElement;\n    sentTypeElement = page.pageEl.getElementsByClassName('sent-type')[0] as HTMLParagraphElement;\n  } else {\n    codeInput.value = '';\n\n    const evt = document.createEvent('HTMLEvents');\n    evt.initEvent('input', false, true);\n    codeInput.dispatchEvent(evt);\n  }\n\n  const CODE_LENGTH = (authSentCode.type as AuthSentCodeType.authSentCodeTypeApp).length;\n  if(!codeInputField) {\n    codeInputField = new CodeInputField({\n      label: 'Code',\n      name: randomLong(),\n      length: CODE_LENGTH,\n      onFill: (code) => {\n        submitCode(code);\n      }\n    });\n\n    codeInput = codeInputField.input as HTMLInputElement;\n  }\n\n  codeInputField.options.length = CODE_LENGTH;\n\n  headerElement.innerText = authSentCode.phone_number;\n  let key: LangPackKey, args: any[];\n  const authSentCodeType = authSentCode.type;\n  switch(authSentCodeType._) {\n    case 'auth.sentCodeTypeSms':\n      key = 'Login.Code.SentSms';\n      break;\n    case 'auth.sentCodeTypeApp':\n      key = 'Login.Code.SentInApp';\n      break;\n    case 'auth.sentCodeTypeCall':\n      key = 'Login.Code.SentCall';\n      break;\n    case 'auth.sentCodeTypeFragmentSms':\n      key = 'PhoneNumber.Code.Fragment.Info';\n      const a = document.createElement('a');\n      setBlankToAnchor(a);\n      a.href = authSentCodeType.url;\n      args = [a];\n      break;\n    default:\n      key = 'Login.Code.SentUnknown';\n      args = [authSentCodeType._];\n      break;\n  }\n\n  replaceContent(sentTypeElement, i18n(key, args));\n\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStateAuthCode', sentCode: _authCode});\n\n  return getAnimation().catch(() => {});\n}, () => {\n  codeInput.focus();\n});\n\nexport default page;\n"],"file":"pageAuthCode-tLfkajQz.js"}
\ No newline at end of file

--- public/pageIm-wngHxkKH.js ---
@@ -1,8 +1,8 @@
-import{a as o,e as t,g as r,_ as a,l as s}from"./index-XZA1-3MU.js";import{P as l}from"./page-eb81Un_i.js";const n=()=>(o.managers.appStateManager.pushToState("authState",{_:"authStateSignedIn"}),t.requestedServerLanguage||t.getCacheLangPack().then(e=>{e.local&&t.getLangPack(e.lang_code)}),i.pageEl.style.display="",r(),Promise.all([a(()=>import("./appDialogsManager-aLs9GOvc.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url),s(),"requestVideoFrameCallback"in HTMLVideoElement.prototype?Promise.resolve():a(()=>import("./requestVideoFrameCallbackPolyfill-GsYXQx88.js"),__vite__mapDeps([]),import.meta.url)]).then(([e])=>{e.default.start(),setTimeout(()=>{document.getElementById("auth-pages").remove()},1e3)})),i=new l("page-chats",!1,n);export{i as default};
-//# sourceMappingURL=pageIm-2VO8DGq9.js.map
+import{a as o,e as t,g as r,_ as a,l as s}from"./index-M8z-nwNm.js";import{P as l}from"./page-kT6kVFv9.js";const n=()=>(o.managers.appStateManager.pushToState("authState",{_:"authStateSignedIn"}),t.requestedServerLanguage||t.getCacheLangPack().then(e=>{e.local&&t.getLangPack(e.lang_code)}),i.pageEl.style.display="",r(),Promise.all([a(()=>import("./appDialogsManager-lzhZi3nI.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13]),import.meta.url),s(),"requestVideoFrameCallback"in HTMLVideoElement.prototype?Promise.resolve():a(()=>import("./requestVideoFrameCallbackPolyfill-GsYXQx88.js"),__vite__mapDeps([]),import.meta.url)]).then(([e])=>{e.default.start(),setTimeout(()=>{document.getElementById("auth-pages").remove()},1e3)})),i=new l("page-chats",!1,n);export{i as default};
+//# sourceMappingURL=pageIm-wngHxkKH.js.map
 function __vite__mapDeps(indexes) {
   if (!__vite__mapDeps.viteFileDeps) {
-    __vite__mapDeps.viteFileDeps = ["./appDialogsManager-aLs9GOvc.js","./avatar-ohgkiWHW.js","./button-aS2SE0kp.js","./index-XZA1-3MU.js","./index-pzR5gIOz.css","./page-eb81Un_i.js","./wrapEmojiText-pejq-WF4.js","./scrollable-OU41biYL.js","./putPreloader--f-Xu9AG.js","./htmlToSpan-52gQDcFu.js","./countryInputField-Rr6PHiIn.js","./textToSvgURL-Z4O-nL1S.js","./codeInputField-H0ySI27M.js","./appDialogsManager-6QNcK96s.css"]
+    __vite__mapDeps.viteFileDeps = ["./appDialogsManager-lzhZi3nI.js","./avatar-HalcuPNE.js","./button-Mm7TqKr1.js","./index-M8z-nwNm.js","./index-pzR5gIOz.css","./page-kT6kVFv9.js","./wrapEmojiText-PAHdiQbe.js","./scrollable-ILmNatrX.js","./putPreloader-jxB4tqkF.js","./htmlToSpan-BQ96zqgl.js","./countryInputField-tqY1KpER.js","./textToSvgURL-Z4O-nL1S.js","./codeInputField-Ofayp2TX.js","./appDialogsManager-6QNcK96s.css"]
   }
   return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
 }
\ No newline at end of file

--- public/pageIm-wngHxkKH.js.map ---
@@ -1 +1 @@
-{"version":3,"mappings":"2GAYA,MAAMA,EAAe,KACnBC,EAAU,SAAS,gBAAgB,YAAY,YAAa,CAAC,EAAG,oBAAoB,EAIhFC,EAAK,yBACPA,EAAK,iBAAiB,EAAE,KAAMC,GAAa,CACtCA,EAAS,OACLD,EAAA,YAAYC,EAAS,SAAS,CACrC,CACD,EAGEC,EAAA,OAAO,MAAM,QAAU,GAEVC,IAEX,QAAQ,IAAI,CAAAC,EAAA,IACjB,OAAO,iCAAsC,sEAC7CC,EAAU,EACV,8BAA+B,iBAAiB,UAAY,QAAQ,QAAQ,EAAID,EAAA,WAAO,iDAAkD,sCAC1I,GAAE,KAAK,CAAC,CAACE,CAAiB,IAAM,CAC/BA,EAAkB,QAAQ,QAC1B,WAAW,IAAM,CACN,wBAAe,YAAY,EAAE,OAAO,GAC5C,GAAG,EACP,GAGGJ,EAAO,IAAIK,EAAK,aAAc,GAAOT,CAAY","names":["onFirstMount","rootScope","I18n","langPack","page","blurActiveElement","__vitePreload","loadFonts","appDialogsManager","Page"],"sources":["../src/pages/pageIm.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport blurActiveElement from '../helpers/dom/blurActiveElement';\nimport loadFonts from '../helpers/dom/loadFonts';\nimport I18n from '../lib/langPack';\nimport rootScope from '../lib/rootScope';\nimport Page from './page';\n\nconst onFirstMount = () => {\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStateSignedIn'});\n  // ! TOO SLOW\n  /* appStateManager.saveState(); */\n\n  if(!I18n.requestedServerLanguage) {\n    I18n.getCacheLangPack().then((langPack) => {\n      if(langPack.local) {\n        I18n.getLangPack(langPack.lang_code);\n      }\n    });\n  }\n\n  page.pageEl.style.display = '';\n\n  blurActiveElement();\n\n  return Promise.all([\n    import('../lib/appManagers/appDialogsManager'),\n    loadFonts()/* .then(() => new Promise((resolve) => window.requestAnimationFrame(resolve))) */,\n    'requestVideoFrameCallback' in HTMLVideoElement.prototype ? Promise.resolve() : import('../helpers/dom/requestVideoFrameCallbackPolyfill')\n  ]).then(([appDialogsManager]) => {\n    appDialogsManager.default.start();\n    setTimeout(() => {\n      document.getElementById('auth-pages').remove();\n    }, 1e3);\n  });\n};\n\nconst page = new Page('page-chats', false, onFirstMount);\nexport default page;\n"],"file":"pageIm-2VO8DGq9.js"}
\ No newline at end of file
+{"version":3,"mappings":"2GAYA,MAAMA,EAAe,KACnBC,EAAU,SAAS,gBAAgB,YAAY,YAAa,CAAC,EAAG,oBAAoB,EAIhFC,EAAK,yBACPA,EAAK,iBAAiB,EAAE,KAAMC,GAAa,CACtCA,EAAS,OACLD,EAAA,YAAYC,EAAS,SAAS,CACrC,CACD,EAGEC,EAAA,OAAO,MAAM,QAAU,GAEVC,IAEX,QAAQ,IAAI,CAAAC,EAAA,IACjB,OAAO,iCAAsC,sEAC7CC,EAAU,EACV,8BAA+B,iBAAiB,UAAY,QAAQ,QAAQ,EAAID,EAAA,WAAO,iDAAkD,sCAC1I,GAAE,KAAK,CAAC,CAACE,CAAiB,IAAM,CAC/BA,EAAkB,QAAQ,QAC1B,WAAW,IAAM,CACN,wBAAe,YAAY,EAAE,OAAO,GAC5C,GAAG,EACP,GAGGJ,EAAO,IAAIK,EAAK,aAAc,GAAOT,CAAY","names":["onFirstMount","rootScope","I18n","langPack","page","blurActiveElement","__vitePreload","loadFonts","appDialogsManager","Page"],"sources":["../src/pages/pageIm.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport blurActiveElement from '../helpers/dom/blurActiveElement';\nimport loadFonts from '../helpers/dom/loadFonts';\nimport I18n from '../lib/langPack';\nimport rootScope from '../lib/rootScope';\nimport Page from './page';\n\nconst onFirstMount = () => {\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStateSignedIn'});\n  // ! TOO SLOW\n  /* appStateManager.saveState(); */\n\n  if(!I18n.requestedServerLanguage) {\n    I18n.getCacheLangPack().then((langPack) => {\n      if(langPack.local) {\n        I18n.getLangPack(langPack.lang_code);\n      }\n    });\n  }\n\n  page.pageEl.style.display = '';\n\n  blurActiveElement();\n\n  return Promise.all([\n    import('../lib/appManagers/appDialogsManager'),\n    loadFonts()/* .then(() => new Promise((resolve) => window.requestAnimationFrame(resolve))) */,\n    'requestVideoFrameCallback' in HTMLVideoElement.prototype ? Promise.resolve() : import('../helpers/dom/requestVideoFrameCallbackPolyfill')\n  ]).then(([appDialogsManager]) => {\n    appDialogsManager.default.start();\n    setTimeout(() => {\n      document.getElementById('auth-pages').remove();\n    }, 1e3);\n  });\n};\n\nconst page = new Page('page-chats', false, onFirstMount);\nexport default page;\n"],"file":"pageIm-wngHxkKH.js"}
\ No newline at end of file

--- public/pagePassword-q_GU3dwQ.js ---
@@ -1,8 +1,8 @@
-import{a as u,e as b,m as v,c as y,_ as S}from"./index-XZA1-3MU.js";import{p as L}from"./putPreloader--f-Xu9AG.js";import{P,a as k}from"./page-eb81Un_i.js";import{B as I}from"./button-aS2SE0kp.js";import{P as _,a as E,h as M}from"./htmlToSpan-52gQDcFu.js";import{L as x}from"./loginPage-EKVIJLjo.js";import{r as N,w as A,t as D}from"./wrapEmojiText-pejq-WF4.js";let t;const T=()=>{const d=new x({className:"page-password",withInputWrapper:!0,titleLangKey:"Login.Password.Title",subtitleLangKey:"Login.Password.Subtitle"}),a=I("btn-primary btn-color-primary"),s=new b.IntlElement({key:"Login.Next"});a.append(s.element);const e=new _({label:"LoginPassword",name:"password"});t=e.input,d.inputWrapper.append(e.container,a);let l;const p=()=>(l||(l=window.setInterval(p,1e4)),u.managers.passwordManager.getState().then(r=>{n=r,n.hint?N(e.label,M(A(n.hint))):e.setLabel()}));let n;const m=r=>{if(r&&y(r),!t.value.length){t.classList.add("error");return}const h=D([t,a],!0),c=t.value;s.update({key:"PleaseWait"});const g=L(a);e.setValueSilently(""+Math.random()),e.setValueSilently(c),u.managers.passwordManager.check(c,n).then(i=>{switch(i._){case"auth.authorization":clearInterval(l),S(()=>import("./pageIm-2VO8DGq9.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(f=>{f.default.mount()}),o&&o.remove();break;default:a.removeAttribute("disabled"),s.update({key:i._}),g.remove();break}}).catch(i=>{switch(h(),e.input.classList.add("error"),i.type){default:s.update({key:"PASSWORD_HASH_INVALID"}),t.select();break}g.remove(),p()})};k(a,m),t.addEventListener("keypress",function(r){if(this.classList.remove("error"),s.update({key:"Login.Next"}),r.key==="Enter")return m()});const w=v.isMobile?100:166,o=new E(e,w);return d.imageDiv.append(o.container),Promise.all([o.load(),p()])},K=new P("page-password",!0,T,null,()=>{t.focus(),u.managers.appStateManager.pushToState("authState",{_:"authStatePassword"})});export{K as default};
-//# sourceMappingURL=pagePassword-wGJb-e9C.js.map
+import{a as u,e as b,m as v,c as y,_ as S}from"./index-M8z-nwNm.js";import{p as L}from"./putPreloader-jxB4tqkF.js";import{P,a as k}from"./page-kT6kVFv9.js";import{B as I}from"./button-Mm7TqKr1.js";import{P as _,a as E,h as M}from"./htmlToSpan-BQ96zqgl.js";import{L as x}from"./loginPage-0kq1JorQ.js";import{r as N,w as A,t as D}from"./wrapEmojiText-PAHdiQbe.js";let t;const T=()=>{const d=new x({className:"page-password",withInputWrapper:!0,titleLangKey:"Login.Password.Title",subtitleLangKey:"Login.Password.Subtitle"}),a=I("btn-primary btn-color-primary"),s=new b.IntlElement({key:"Login.Next"});a.append(s.element);const e=new _({label:"LoginPassword",name:"password"});t=e.input,d.inputWrapper.append(e.container,a);let l;const p=()=>(l||(l=window.setInterval(p,1e4)),u.managers.passwordManager.getState().then(r=>{n=r,n.hint?N(e.label,M(A(n.hint))):e.setLabel()}));let n;const m=r=>{if(r&&y(r),!t.value.length){t.classList.add("error");return}const h=D([t,a],!0),c=t.value;s.update({key:"PleaseWait"});const g=L(a);e.setValueSilently(""+Math.random()),e.setValueSilently(c),u.managers.passwordManager.check(c,n).then(i=>{switch(i._){case"auth.authorization":clearInterval(l),S(()=>import("./pageIm-wngHxkKH.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(f=>{f.default.mount()}),o&&o.remove();break;default:a.removeAttribute("disabled"),s.update({key:i._}),g.remove();break}}).catch(i=>{switch(h(),e.input.classList.add("error"),i.type){default:s.update({key:"PASSWORD_HASH_INVALID"}),t.select();break}g.remove(),p()})};k(a,m),t.addEventListener("keypress",function(r){if(this.classList.remove("error"),s.update({key:"Login.Next"}),r.key==="Enter")return m()});const w=v.isMobile?100:166,o=new E(e,w);return d.imageDiv.append(o.container),Promise.all([o.load(),p()])},K=new P("page-password",!0,T,null,()=>{t.focus(),u.managers.appStateManager.pushToState("authState",{_:"authStatePassword"})});export{K as default};
+//# sourceMappingURL=pagePassword-q_GU3dwQ.js.map
 function __vite__mapDeps(indexes) {
   if (!__vite__mapDeps.viteFileDeps) {
-    __vite__mapDeps.viteFileDeps = ["./pageIm-2VO8DGq9.js","./index-XZA1-3MU.js","./index-pzR5gIOz.css","./page-eb81Un_i.js"]
+    __vite__mapDeps.viteFileDeps = ["./pageIm-wngHxkKH.js","./index-M8z-nwNm.js","./index-pzR5gIOz.css","./page-kT6kVFv9.js"]
   }
   return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
 }
\ No newline at end of file

--- public/pagePassword-q_GU3dwQ.js.map ---
@@ -1 +1 @@
-{"version":3,"mappings":"0WAwBA,IAAIA,EAEJ,MAAMC,EAAe,IAAoB,CACjCC,QAAO,IAAIC,EAAU,CACzB,UAAW,gBACX,iBAAkB,GAClB,aAAc,uBACd,gBAAiB,0BAClB,EAEKC,EAAUC,EAAO,+BAA+B,EAChDC,EAAc,IAAIC,EAAK,YAAY,CAAC,IAAK,aAAa,EAEpDH,EAAA,OAAOE,EAAY,OAAO,EAE5B,MAAAE,EAAqB,IAAIC,EAAmB,CAChD,MAAO,gBACP,KAAM,WACP,EAEDT,EAAgBQ,EAAmB,MAEnCN,EAAK,aAAa,OAAOM,EAAmB,UAAWJ,CAAO,EAE1D,IAAAM,EAEJ,MAAMC,EAAW,KAEXD,IACiBA,EAAA,OAAO,YAAYC,EAAU,GAAI,GAGtCC,EAAU,SAAS,gBAAgB,SAAS,EAAE,KAAMC,GAAW,CACrEC,EAAAD,EAELC,EAAM,KACPC,EAAeP,EAAmB,MAAOQ,EAAWC,EAAcH,EAAM,IAAI,CAAC,CAAC,EAE9EN,EAAmB,SAAS,CAC9B,CACD,GAGC,IAAAM,EAEE,MAAAI,EAAYC,GAAc,CAK3B,GAJAA,GACDC,EAAYD,CAAC,EAGZ,CAACnB,EAAc,MAAM,OAAQ,CAChBA,EAAA,UAAU,IAAI,OAAO,EACnC,MACF,CAEA,MAAMqB,EAASC,EAAiB,CAACtB,EAAeI,CAAO,EAAG,EAAI,EACxDmB,EAAQvB,EAAc,MAE5BM,EAAY,OAAO,CAAC,IAAK,YAAa,GAChC,MAAAkB,EAAYC,EAAarB,CAAO,EAEtCI,EAAmB,iBAAiB,GAAK,KAAK,OAAQ,GACtDA,EAAmB,iBAAiBe,CAAK,EAE/BX,EAAA,SAAS,gBAAgB,MAAMW,EAAOT,CAAK,EAAE,KAAMY,GAAa,CAGxE,OAAOA,EAAS,EAAG,CACjB,IAAK,qBACH,cAAchB,CAAgB,EAC9BiB,EAAA,WAAO,sBAAU,8CAAE,KAAMC,GAAM,CAC7BA,EAAE,QAAQ,OAAM,CACjB,EACEC,GAAQA,EAAO,OAAO,EACzB,MACF,QACEzB,EAAQ,gBAAgB,UAAU,EAClCE,EAAY,OAAO,CAAC,IAAKoB,EAAS,CAAS,GAC3CF,EAAU,OAAO,EACjB,KACJ,EACD,EAAE,MAAOM,GAAa,CAIrB,OAHOT,IACYb,EAAA,MAAM,UAAU,IAAI,OAAO,EAEvCsB,EAAI,KAAM,CACf,QAEExB,EAAY,OAAO,CAAC,IAAK,uBAAwB,GACjDN,EAAc,OAAO,EACrB,KACJ,CAEAwB,EAAU,OAAO,EAERb,GAAA,CACV,GAGHoB,EAAiB3B,EAASc,CAAQ,EAEpBlB,EAAA,iBAAiB,WAAY,SAAemB,EAAG,CAIxD,GAHE,eAAU,OAAO,OAAO,EAC7Bb,EAAY,OAAO,CAAC,IAAK,YAAa,GAEnCa,EAAE,MAAQ,QACX,OAAOD,EAAS,CAClB,CACD,EAEK,MAAAc,EAAOC,EAAW,SAAW,IAAM,IACnCJ,EAAS,IAAIK,EAAe1B,EAAoBwB,CAAI,EAC1D9B,SAAK,SAAS,OAAO2B,EAAO,SAAS,EAC9B,QAAQ,IAAI,CACjBA,EAAO,KAAK,EACZlB,EAAS,EACV,CACH,EAEMT,EAAO,IAAIiC,EAAK,gBAAiB,GAAMlC,EAAc,KAAM,IAAM,CAErED,EAAc,MAAM,EAGpBY,EAAU,SAAS,gBAAgB,YAAY,YAAa,CAAC,EAAG,oBAAoB,CACtF,CAAC","names":["passwordInput","onFirstMount","page","LoginPage","btnNext","Button","btnNextI18n","I18n","passwordInputField","PasswordInputField","getStateInterval","getState","rootScope","_state","state","replaceContent","htmlToSpan","wrapEmojiText","onSubmit","e","cancelEvent","toggle","toggleDisability","value","preloader","putPreloader","response","__vitePreload","m","monkey","err","attachClickEvent","size","mediaSizes","PasswordMonkey","Page"],"sources":["../src/pages/pagePassword.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {putPreloader} from '../components/putPreloader';\nimport mediaSizes from '../helpers/mediaSizes';\nimport {AccountPassword} from '../layer';\nimport Page from './page';\nimport Button from '../components/button';\nimport PasswordInputField from '../components/passwordInputField';\nimport PasswordMonkey from '../components/monkeys/password';\nimport I18n from '../lib/langPack';\nimport LoginPage from './loginPage';\nimport cancelEvent from '../helpers/dom/cancelEvent';\nimport {attachClickEvent} from '../helpers/dom/clickEvent';\nimport htmlToSpan from '../helpers/dom/htmlToSpan';\nimport replaceContent from '../helpers/dom/replaceContent';\nimport toggleDisability from '../helpers/dom/toggleDisability';\nimport wrapEmojiText from '../lib/richTextProcessor/wrapEmojiText';\nimport rootScope from '../lib/rootScope';\n\nconst TEST = false;\nlet passwordInput: HTMLInputElement;\n\nconst onFirstMount = (): Promise<any> => {\n  const page = new LoginPage({\n    className: 'page-password',\n    withInputWrapper: true,\n    titleLangKey: 'Login.Password.Title',\n    subtitleLangKey: 'Login.Password.Subtitle'\n  });\n\n  const btnNext = Button('btn-primary btn-color-primary');\n  const btnNextI18n = new I18n.IntlElement({key: 'Login.Next'});\n\n  btnNext.append(btnNextI18n.element);\n\n  const passwordInputField = new PasswordInputField({\n    label: 'LoginPassword',\n    name: 'password'\n  });\n\n  passwordInput = passwordInputField.input as HTMLInputElement;\n\n  page.inputWrapper.append(passwordInputField.container, btnNext);\n\n  let getStateInterval: number;\n\n  const getState = () => {\n    // * just to check session relevance\n    if(!getStateInterval) {\n      getStateInterval = window.setInterval(getState, 10e3);\n    }\n\n    return !TEST && rootScope.managers.passwordManager.getState().then((_state) => {\n      state = _state;\n\n      if(state.hint) {\n        replaceContent(passwordInputField.label, htmlToSpan(wrapEmojiText(state.hint)));\n      } else {\n        passwordInputField.setLabel();\n      }\n    });\n  };\n\n  let state: AccountPassword;\n\n  const onSubmit = (e?: Event) => {\n    if(e) {\n      cancelEvent(e);\n    }\n\n    if(!passwordInput.value.length) {\n      passwordInput.classList.add('error');\n      return;\n    }\n\n    const toggle = toggleDisability([passwordInput, btnNext], true);\n    const value = passwordInput.value;\n\n    btnNextI18n.update({key: 'PleaseWait'});\n    const preloader = putPreloader(btnNext);\n\n    passwordInputField.setValueSilently('' + Math.random()); // prevent saving suggestion\n    passwordInputField.setValueSilently(value); // prevent saving suggestion\n\n    rootScope.managers.passwordManager.check(value, state).then((response) => {\n      // console.log('passwordManager response:', response);\n\n      switch(response._) {\n        case 'auth.authorization':\n          clearInterval(getStateInterval);\n          import('./pageIm').then((m) => {\n            m.default.mount();\n          });\n          if(monkey) monkey.remove();\n          break;\n        default:\n          btnNext.removeAttribute('disabled');\n          btnNextI18n.update({key: response._ as any});\n          preloader.remove();\n          break;\n      }\n    }).catch((err: any) => {\n      toggle();\n      passwordInputField.input.classList.add('error');\n\n      switch(err.type) {\n        default:\n          // btnNext.innerText = err.type;\n          btnNextI18n.update({key: 'PASSWORD_HASH_INVALID'});\n          passwordInput.select();\n          break;\n      }\n\n      preloader.remove();\n\n      getState();\n    });\n  };\n\n  attachClickEvent(btnNext, onSubmit);\n\n  passwordInput.addEventListener('keypress', function(this, e) {\n    this.classList.remove('error');\n    btnNextI18n.update({key: 'Login.Next'});\n\n    if(e.key === 'Enter') {\n      return onSubmit();\n    }\n  });\n\n  const size = mediaSizes.isMobile ? 100 : 166;\n  const monkey = new PasswordMonkey(passwordInputField, size);\n  page.imageDiv.append(monkey.container);\n  return Promise.all([\n    monkey.load(),\n    getState()\n  ]);\n};\n\nconst page = new Page('page-password', true, onFirstMount, null, () => {\n  // if(!isAppleMobile) {\n  passwordInput.focus();\n  // }\n\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStatePassword'});\n});\n\nexport default page;\n"],"file":"pagePassword-wGJb-e9C.js"}
\ No newline at end of file
+{"version":3,"mappings":"0WAwBA,IAAIA,EAEJ,MAAMC,EAAe,IAAoB,CACjCC,QAAO,IAAIC,EAAU,CACzB,UAAW,gBACX,iBAAkB,GAClB,aAAc,uBACd,gBAAiB,0BAClB,EAEKC,EAAUC,EAAO,+BAA+B,EAChDC,EAAc,IAAIC,EAAK,YAAY,CAAC,IAAK,aAAa,EAEpDH,EAAA,OAAOE,EAAY,OAAO,EAE5B,MAAAE,EAAqB,IAAIC,EAAmB,CAChD,MAAO,gBACP,KAAM,WACP,EAEDT,EAAgBQ,EAAmB,MAEnCN,EAAK,aAAa,OAAOM,EAAmB,UAAWJ,CAAO,EAE1D,IAAAM,EAEJ,MAAMC,EAAW,KAEXD,IACiBA,EAAA,OAAO,YAAYC,EAAU,GAAI,GAGtCC,EAAU,SAAS,gBAAgB,SAAS,EAAE,KAAMC,GAAW,CACrEC,EAAAD,EAELC,EAAM,KACPC,EAAeP,EAAmB,MAAOQ,EAAWC,EAAcH,EAAM,IAAI,CAAC,CAAC,EAE9EN,EAAmB,SAAS,CAC9B,CACD,GAGC,IAAAM,EAEE,MAAAI,EAAYC,GAAc,CAK3B,GAJAA,GACDC,EAAYD,CAAC,EAGZ,CAACnB,EAAc,MAAM,OAAQ,CAChBA,EAAA,UAAU,IAAI,OAAO,EACnC,MACF,CAEA,MAAMqB,EAASC,EAAiB,CAACtB,EAAeI,CAAO,EAAG,EAAI,EACxDmB,EAAQvB,EAAc,MAE5BM,EAAY,OAAO,CAAC,IAAK,YAAa,GAChC,MAAAkB,EAAYC,EAAarB,CAAO,EAEtCI,EAAmB,iBAAiB,GAAK,KAAK,OAAQ,GACtDA,EAAmB,iBAAiBe,CAAK,EAE/BX,EAAA,SAAS,gBAAgB,MAAMW,EAAOT,CAAK,EAAE,KAAMY,GAAa,CAGxE,OAAOA,EAAS,EAAG,CACjB,IAAK,qBACH,cAAchB,CAAgB,EAC9BiB,EAAA,WAAO,sBAAU,8CAAE,KAAMC,GAAM,CAC7BA,EAAE,QAAQ,OAAM,CACjB,EACEC,GAAQA,EAAO,OAAO,EACzB,MACF,QACEzB,EAAQ,gBAAgB,UAAU,EAClCE,EAAY,OAAO,CAAC,IAAKoB,EAAS,CAAS,GAC3CF,EAAU,OAAO,EACjB,KACJ,EACD,EAAE,MAAOM,GAAa,CAIrB,OAHOT,IACYb,EAAA,MAAM,UAAU,IAAI,OAAO,EAEvCsB,EAAI,KAAM,CACf,QAEExB,EAAY,OAAO,CAAC,IAAK,uBAAwB,GACjDN,EAAc,OAAO,EACrB,KACJ,CAEAwB,EAAU,OAAO,EAERb,GAAA,CACV,GAGHoB,EAAiB3B,EAASc,CAAQ,EAEpBlB,EAAA,iBAAiB,WAAY,SAAemB,EAAG,CAIxD,GAHE,eAAU,OAAO,OAAO,EAC7Bb,EAAY,OAAO,CAAC,IAAK,YAAa,GAEnCa,EAAE,MAAQ,QACX,OAAOD,EAAS,CAClB,CACD,EAEK,MAAAc,EAAOC,EAAW,SAAW,IAAM,IACnCJ,EAAS,IAAIK,EAAe1B,EAAoBwB,CAAI,EAC1D9B,SAAK,SAAS,OAAO2B,EAAO,SAAS,EAC9B,QAAQ,IAAI,CACjBA,EAAO,KAAK,EACZlB,EAAS,EACV,CACH,EAEMT,EAAO,IAAIiC,EAAK,gBAAiB,GAAMlC,EAAc,KAAM,IAAM,CAErED,EAAc,MAAM,EAGpBY,EAAU,SAAS,gBAAgB,YAAY,YAAa,CAAC,EAAG,oBAAoB,CACtF,CAAC","names":["passwordInput","onFirstMount","page","LoginPage","btnNext","Button","btnNextI18n","I18n","passwordInputField","PasswordInputField","getStateInterval","getState","rootScope","_state","state","replaceContent","htmlToSpan","wrapEmojiText","onSubmit","e","cancelEvent","toggle","toggleDisability","value","preloader","putPreloader","response","__vitePreload","m","monkey","err","attachClickEvent","size","mediaSizes","PasswordMonkey","Page"],"sources":["../src/pages/pagePassword.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {putPreloader} from '../components/putPreloader';\nimport mediaSizes from '../helpers/mediaSizes';\nimport {AccountPassword} from '../layer';\nimport Page from './page';\nimport Button from '../components/button';\nimport PasswordInputField from '../components/passwordInputField';\nimport PasswordMonkey from '../components/monkeys/password';\nimport I18n from '../lib/langPack';\nimport LoginPage from './loginPage';\nimport cancelEvent from '../helpers/dom/cancelEvent';\nimport {attachClickEvent} from '../helpers/dom/clickEvent';\nimport htmlToSpan from '../helpers/dom/htmlToSpan';\nimport replaceContent from '../helpers/dom/replaceContent';\nimport toggleDisability from '../helpers/dom/toggleDisability';\nimport wrapEmojiText from '../lib/richTextProcessor/wrapEmojiText';\nimport rootScope from '../lib/rootScope';\n\nconst TEST = false;\nlet passwordInput: HTMLInputElement;\n\nconst onFirstMount = (): Promise<any> => {\n  const page = new LoginPage({\n    className: 'page-password',\n    withInputWrapper: true,\n    titleLangKey: 'Login.Password.Title',\n    subtitleLangKey: 'Login.Password.Subtitle'\n  });\n\n  const btnNext = Button('btn-primary btn-color-primary');\n  const btnNextI18n = new I18n.IntlElement({key: 'Login.Next'});\n\n  btnNext.append(btnNextI18n.element);\n\n  const passwordInputField = new PasswordInputField({\n    label: 'LoginPassword',\n    name: 'password'\n  });\n\n  passwordInput = passwordInputField.input as HTMLInputElement;\n\n  page.inputWrapper.append(passwordInputField.container, btnNext);\n\n  let getStateInterval: number;\n\n  const getState = () => {\n    // * just to check session relevance\n    if(!getStateInterval) {\n      getStateInterval = window.setInterval(getState, 10e3);\n    }\n\n    return !TEST && rootScope.managers.passwordManager.getState().then((_state) => {\n      state = _state;\n\n      if(state.hint) {\n        replaceContent(passwordInputField.label, htmlToSpan(wrapEmojiText(state.hint)));\n      } else {\n        passwordInputField.setLabel();\n      }\n    });\n  };\n\n  let state: AccountPassword;\n\n  const onSubmit = (e?: Event) => {\n    if(e) {\n      cancelEvent(e);\n    }\n\n    if(!passwordInput.value.length) {\n      passwordInput.classList.add('error');\n      return;\n    }\n\n    const toggle = toggleDisability([passwordInput, btnNext], true);\n    const value = passwordInput.value;\n\n    btnNextI18n.update({key: 'PleaseWait'});\n    const preloader = putPreloader(btnNext);\n\n    passwordInputField.setValueSilently('' + Math.random()); // prevent saving suggestion\n    passwordInputField.setValueSilently(value); // prevent saving suggestion\n\n    rootScope.managers.passwordManager.check(value, state).then((response) => {\n      // console.log('passwordManager response:', response);\n\n      switch(response._) {\n        case 'auth.authorization':\n          clearInterval(getStateInterval);\n          import('./pageIm').then((m) => {\n            m.default.mount();\n          });\n          if(monkey) monkey.remove();\n          break;\n        default:\n          btnNext.removeAttribute('disabled');\n          btnNextI18n.update({key: response._ as any});\n          preloader.remove();\n          break;\n      }\n    }).catch((err: any) => {\n      toggle();\n      passwordInputField.input.classList.add('error');\n\n      switch(err.type) {\n        default:\n          // btnNext.innerText = err.type;\n          btnNextI18n.update({key: 'PASSWORD_HASH_INVALID'});\n          passwordInput.select();\n          break;\n      }\n\n      preloader.remove();\n\n      getState();\n    });\n  };\n\n  attachClickEvent(btnNext, onSubmit);\n\n  passwordInput.addEventListener('keypress', function(this, e) {\n    this.classList.remove('error');\n    btnNextI18n.update({key: 'Login.Next'});\n\n    if(e.key === 'Enter') {\n      return onSubmit();\n    }\n  });\n\n  const size = mediaSizes.isMobile ? 100 : 166;\n  const monkey = new PasswordMonkey(passwordInputField, size);\n  page.imageDiv.append(monkey.container);\n  return Promise.all([\n    monkey.load(),\n    getState()\n  ]);\n};\n\nconst page = new Page('page-password', true, onFirstMount, null, () => {\n  // if(!isAppleMobile) {\n  passwordInput.focus();\n  // }\n\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStatePassword'});\n});\n\nexport default page;\n"],"file":"pagePassword-q_GU3dwQ.js"}
\ No newline at end of file

--- public/pageSignImport-Dsp43SYx.js ---
@@ -1,8 +1,8 @@
-import{a as o,A as s,_ as r,S as m}from"./index-XZA1-3MU.js";import{p as h}from"./putPreloader--f-Xu9AG.js";import{P as d}from"./page-eb81Un_i.js";let i;const g=async()=>{const{dcId:e,token:u,tgAddr:n}=i;let a;try{o.managers.apiManager.setBaseDcId(e);const t=await o.managers.apiManager.invokeApi("auth.importWebTokenAuthorization",{api_id:s.id,api_hash:s.hash,web_auth_token:u},{dcId:e,ignoreErrors:!0});t._==="auth.authorization"&&(await o.managers.apiManager.setUser(t.user),a=r(()=>import("./pageIm-2VO8DGq9.js"),__vite__mapDeps([0,1,2,3]),import.meta.url))}catch(t){switch(t.type){case"SESSION_PASSWORD_NEEDED":{t.handled=!0,a=r(()=>import("./pagePassword-wGJb-e9C.js"),__vite__mapDeps([4,1,2,5,3,6,7,8,9]),import.meta.url);break}default:{console.error("authorization import error:",t);const p=m.authState._;p==="authStateSignIn"?a=r(()=>import("./pageSignIn-pfbmi0Ny.js"),__vite__mapDeps([10,1,2,5,3,11,6,8,12,13,14]),import.meta.url):p==="authStateSignQr"&&(a=r(()=>import("./pageSignQR-bI2rYqWN.js").then(_=>_.a),__vite__mapDeps([13,1,2,3,6,5,14]),import.meta.url));break}}}location.hash=n?.trim()?"#?tgaddr="+encodeURIComponent(n):"",a&&a.then(t=>t.default.mount())},l=new d("page-signImport",!0,()=>{h(l.pageEl.firstElementChild,!0),g()},e=>{i=e,o.managers.appStateManager.pushToState("authState",{_:"authStateSignImport",data:i})});export{l as default};
-//# sourceMappingURL=pageSignImport-NTw9ODN7.js.map
+import{a as o,A as s,_ as r,S as m}from"./index-M8z-nwNm.js";import{p as h}from"./putPreloader-jxB4tqkF.js";import{P as d}from"./page-kT6kVFv9.js";let i;const g=async()=>{const{dcId:e,token:u,tgAddr:n}=i;let a;try{o.managers.apiManager.setBaseDcId(e);const t=await o.managers.apiManager.invokeApi("auth.importWebTokenAuthorization",{api_id:s.id,api_hash:s.hash,web_auth_token:u},{dcId:e,ignoreErrors:!0});t._==="auth.authorization"&&(await o.managers.apiManager.setUser(t.user),a=r(()=>import("./pageIm-wngHxkKH.js"),__vite__mapDeps([0,1,2,3]),import.meta.url))}catch(t){switch(t.type){case"SESSION_PASSWORD_NEEDED":{t.handled=!0,a=r(()=>import("./pagePassword-q_GU3dwQ.js"),__vite__mapDeps([4,1,2,5,3,6,7,8,9]),import.meta.url);break}default:{console.error("authorization import error:",t);const p=m.authState._;p==="authStateSignIn"?a=r(()=>import("./pageSignIn-N45VQ3GF.js"),__vite__mapDeps([10,1,2,5,3,11,6,8,12,13,14]),import.meta.url):p==="authStateSignQr"&&(a=r(()=>import("./pageSignQR-VxURk7YO.js").then(_=>_.a),__vite__mapDeps([13,1,2,3,6,5,14]),import.meta.url));break}}}location.hash=n?.trim()?"#?tgaddr="+encodeURIComponent(n):"",a&&a.then(t=>t.default.mount())},l=new d("page-signImport",!0,()=>{h(l.pageEl.firstElementChild,!0),g()},e=>{i=e,o.managers.appStateManager.pushToState("authState",{_:"authStateSignImport",data:i})});export{l as default};
+//# sourceMappingURL=pageSignImport-Dsp43SYx.js.map
 function __vite__mapDeps(indexes) {
   if (!__vite__mapDeps.viteFileDeps) {
-    __vite__mapDeps.viteFileDeps = ["./pageIm-2VO8DGq9.js","./index-XZA1-3MU.js","./index-pzR5gIOz.css","./page-eb81Un_i.js","./pagePassword-wGJb-e9C.js","./putPreloader--f-Xu9AG.js","./button-aS2SE0kp.js","./htmlToSpan-52gQDcFu.js","./wrapEmojiText-pejq-WF4.js","./loginPage-EKVIJLjo.js","./pageSignIn-pfbmi0Ny.js","./countryInputField-Rr6PHiIn.js","./scrollable-OU41biYL.js","./pageSignQR-bI2rYqWN.js","./textToSvgURL-Z4O-nL1S.js"]
+    __vite__mapDeps.viteFileDeps = ["./pageIm-wngHxkKH.js","./index-M8z-nwNm.js","./index-pzR5gIOz.css","./page-kT6kVFv9.js","./pagePassword-q_GU3dwQ.js","./putPreloader-jxB4tqkF.js","./button-Mm7TqKr1.js","./htmlToSpan-BQ96zqgl.js","./wrapEmojiText-PAHdiQbe.js","./loginPage-0kq1JorQ.js","./pageSignIn-N45VQ3GF.js","./countryInputField-tqY1KpER.js","./scrollable-ILmNatrX.js","./pageSignQR-VxURk7YO.js","./textToSvgURL-Z4O-nL1S.js"]
   }
   return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
 }
\ No newline at end of file

--- public/pageSignImport-Dsp43SYx.js.map ---
@@ -1 +1 @@
-{"version":3,"mappings":"mJAaA,IAAIA,EAEJ,MAAMC,EAAiB,SAAW,CAChC,KAAM,CAAC,KAAAC,EAAM,MAAAC,EAAO,OAAAC,CAAA,EAAUJ,EAC1B,IAAAK,EACA,IACQC,EAAA,SAAS,WAAW,YAAYJ,CAAI,EAC9C,MAAMK,EAAgB,MAAMD,EAAU,SAAS,WAAW,UAAU,mCAAoC,CACtG,OAAQE,EAAI,GACZ,SAAUA,EAAI,KACd,eAAgBL,CACf,GAAC,KAAAD,EAAM,aAAc,EAAK,GAE1BK,EAAc,IAAM,uBACrB,MAAMD,EAAU,SAAS,WAAW,QAAQC,EAAc,IAAI,EAC9DF,EAAiBI,EAAA,WAAO,sBAAU,qDAG9BC,EAAK,CACX,OAAQA,EAAiB,KAAM,CAC7B,IAAK,0BAA2B,CAC7BA,EAAiB,QAAU,GAC5BL,EAAiBI,EAAA,WAAO,4BAAgB,wDACxC,KACF,CAEA,QAAS,CACC,cAAM,8BAA+BC,CAAG,EAC1C,MAAAC,EAAeC,EAAW,UAAU,EACvCD,IAAiB,kBAAmBN,EAAAI,EAAA,IAAiB,OAAO,0BAAc,iEACrEE,IAAiB,oBAAmBN,EAAAI,EAAA,IAAiB,OAAO,0BAAc,OAAAI,KAAA,wDAClF,KACF,CACF,CACF,CAEA,SAAS,KAAOT,GAAQ,OAAS,YAAc,mBAAmBA,CAAM,EAAI,GACzEC,GACDA,EAAe,KAAMS,GAAMA,EAAE,QAAQ,OAAO,CAEhD,EAEMC,EAAO,IAAIC,EAAK,kBAAmB,GAAM,IAAM,CACtCC,EAAAF,EAAK,OAAO,kBAAmB,EAAI,EACjCd,GACjB,EAAIiB,GAAuB,CAClBlB,EAAAkB,EACGZ,EAAA,SAAS,gBAAgB,YAAY,YAAa,CAAC,EAAG,sBAAuB,KAAAN,EAAK,CAC9F,CAAC","names":["data","importWebToken","dcId","token","tgAddr","mountPageAfter","rootScope","authorization","App","__vitePreload","err","defaultState","STATE_INIT","n","m","page","Page","putPreloader","_data"],"sources":["../src/pages/pageSignImport.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {putPreloader} from '../components/putPreloader';\nimport App from '../config/app';\nimport {STATE_INIT} from '../config/state';\nimport rootScope from '../lib/rootScope';\nimport {AuthState} from '../types';\nimport Page from './page';\n\nlet data: AuthState.signImport['data'];\n\nconst importWebToken = async() => {\n  const {dcId, token, tgAddr} = data;\n  let mountPageAfter: Promise<{default: Page}>;\n  try {\n    rootScope.managers.apiManager.setBaseDcId(dcId);\n    const authorization = await rootScope.managers.apiManager.invokeApi('auth.importWebTokenAuthorization', {\n      api_id: App.id,\n      api_hash: App.hash,\n      web_auth_token: token\n    }, {dcId, ignoreErrors: true});\n\n    if(authorization._ === 'auth.authorization') {\n      await rootScope.managers.apiManager.setUser(authorization.user);\n      mountPageAfter = import('./pageIm');\n      // return;\n    }\n  } catch(err) {\n    switch((err as ApiError).type) {\n      case 'SESSION_PASSWORD_NEEDED': {\n        (err as ApiError).handled = true;\n        mountPageAfter = import('./pagePassword');\n        break;\n      }\n\n      default: {\n        console.error('authorization import error:', err);\n        const defaultState = STATE_INIT.authState._;\n        if(defaultState === 'authStateSignIn') mountPageAfter = import('./pageSignIn');\n        else if(defaultState === 'authStateSignQr') mountPageAfter = import('./pageSignQR');\n        break;\n      }\n    }\n  }\n\n  location.hash = tgAddr?.trim() ? '#?tgaddr=' + encodeURIComponent(tgAddr) : '';\n  if(mountPageAfter) {\n    mountPageAfter.then((m) => m.default.mount());\n  }\n};\n\nconst page = new Page('page-signImport', true, () => {\n  putPreloader(page.pageEl.firstElementChild, true);\n  importWebToken();\n}, (_data: typeof data) => {\n  data = _data;\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStateSignImport', data});\n});\n\nexport default page;\n"],"file":"pageSignImport-NTw9ODN7.js"}
\ No newline at end of file
+{"version":3,"mappings":"mJAaA,IAAIA,EAEJ,MAAMC,EAAiB,SAAW,CAChC,KAAM,CAAC,KAAAC,EAAM,MAAAC,EAAO,OAAAC,CAAA,EAAUJ,EAC1B,IAAAK,EACA,IACQC,EAAA,SAAS,WAAW,YAAYJ,CAAI,EAC9C,MAAMK,EAAgB,MAAMD,EAAU,SAAS,WAAW,UAAU,mCAAoC,CACtG,OAAQE,EAAI,GACZ,SAAUA,EAAI,KACd,eAAgBL,CACf,GAAC,KAAAD,EAAM,aAAc,EAAK,GAE1BK,EAAc,IAAM,uBACrB,MAAMD,EAAU,SAAS,WAAW,QAAQC,EAAc,IAAI,EAC9DF,EAAiBI,EAAA,WAAO,sBAAU,qDAG9BC,EAAK,CACX,OAAQA,EAAiB,KAAM,CAC7B,IAAK,0BAA2B,CAC7BA,EAAiB,QAAU,GAC5BL,EAAiBI,EAAA,WAAO,4BAAgB,wDACxC,KACF,CAEA,QAAS,CACC,cAAM,8BAA+BC,CAAG,EAC1C,MAAAC,EAAeC,EAAW,UAAU,EACvCD,IAAiB,kBAAmBN,EAAAI,EAAA,IAAiB,OAAO,0BAAc,iEACrEE,IAAiB,oBAAmBN,EAAAI,EAAA,IAAiB,OAAO,0BAAc,OAAAI,KAAA,wDAClF,KACF,CACF,CACF,CAEA,SAAS,KAAOT,GAAQ,OAAS,YAAc,mBAAmBA,CAAM,EAAI,GACzEC,GACDA,EAAe,KAAMS,GAAMA,EAAE,QAAQ,OAAO,CAEhD,EAEMC,EAAO,IAAIC,EAAK,kBAAmB,GAAM,IAAM,CACtCC,EAAAF,EAAK,OAAO,kBAAmB,EAAI,EACjCd,GACjB,EAAIiB,GAAuB,CAClBlB,EAAAkB,EACGZ,EAAA,SAAS,gBAAgB,YAAY,YAAa,CAAC,EAAG,sBAAuB,KAAAN,EAAK,CAC9F,CAAC","names":["data","importWebToken","dcId","token","tgAddr","mountPageAfter","rootScope","authorization","App","__vitePreload","err","defaultState","STATE_INIT","n","m","page","Page","putPreloader","_data"],"sources":["../src/pages/pageSignImport.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {putPreloader} from '../components/putPreloader';\nimport App from '../config/app';\nimport {STATE_INIT} from '../config/state';\nimport rootScope from '../lib/rootScope';\nimport {AuthState} from '../types';\nimport Page from './page';\n\nlet data: AuthState.signImport['data'];\n\nconst importWebToken = async() => {\n  const {dcId, token, tgAddr} = data;\n  let mountPageAfter: Promise<{default: Page}>;\n  try {\n    rootScope.managers.apiManager.setBaseDcId(dcId);\n    const authorization = await rootScope.managers.apiManager.invokeApi('auth.importWebTokenAuthorization', {\n      api_id: App.id,\n      api_hash: App.hash,\n      web_auth_token: token\n    }, {dcId, ignoreErrors: true});\n\n    if(authorization._ === 'auth.authorization') {\n      await rootScope.managers.apiManager.setUser(authorization.user);\n      mountPageAfter = import('./pageIm');\n      // return;\n    }\n  } catch(err) {\n    switch((err as ApiError).type) {\n      case 'SESSION_PASSWORD_NEEDED': {\n        (err as ApiError).handled = true;\n        mountPageAfter = import('./pagePassword');\n        break;\n      }\n\n      default: {\n        console.error('authorization import error:', err);\n        const defaultState = STATE_INIT.authState._;\n        if(defaultState === 'authStateSignIn') mountPageAfter = import('./pageSignIn');\n        else if(defaultState === 'authStateSignQr') mountPageAfter = import('./pageSignQR');\n        break;\n      }\n    }\n  }\n\n  location.hash = tgAddr?.trim() ? '#?tgaddr=' + encodeURIComponent(tgAddr) : '';\n  if(mountPageAfter) {\n    mountPageAfter.then((m) => m.default.mount());\n  }\n};\n\nconst page = new Page('page-signImport', true, () => {\n  putPreloader(page.pageEl.firstElementChild, true);\n  importWebToken();\n}, (_data: typeof data) => {\n  data = _data;\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStateSignImport', data});\n});\n\nexport default page;\n"],"file":"pageSignImport-Dsp43SYx.js"}
\ No newline at end of file

--- public/pageSignIn-N45VQ3GF.js ---
@@ -1,8 +1,8 @@
-import{a as s,b as L,s as E,c as A,i as m,A as C,_ as I,d as x,I as N,e as M,f as F}from"./index-XZA1-3MU.js";import{p as O}from"./putPreloader--f-Xu9AG.js";import{P as V,a as B}from"./page-eb81Un_i.js";import{C as U,T as W,a as z}from"./countryInputField-Rr6PHiIn.js";import{B as P,r as H}from"./button-aS2SE0kp.js";import{p as K,l as Q,t as $,r as h}from"./wrapEmojiText-pejq-WF4.js";import{p as j,g as q}from"./pageSignQR-bI2rYqWN.js";import"./scrollable-OU41biYL.js";import"./textToSvgURL-Z4O-nL1S.js";let a=null,l;const D=()=>{const g=document.createElement("div");g.classList.add("input-wrapper");let y,k;const d=new U({onCountryChange:(e,t)=>{y=e,k=t,t&&(i.value=i.lastValue="+"+t.country_code,setTimeout(()=>{u.focus(),K(u,!0)},0))}}),i=new W({onInput:e=>{Q.loadLottieWorkers();const{country:t,code:o}=e||{},n=t?t.name||t.default_name:"";n!==d.value&&(!y||!t||!o||y!==t&&k.country_code!==o.country_code)&&d.override(t,o,n),t||i.value.length-1>1?a.style.visibility="":a.style.visibility="hidden"}}),u=i.input;u.addEventListener("keypress",e=>{if(!a.style.visibility&&e.key==="Enter")return S()});const c=new z({text:"Login.KeepSigned",name:"keepSession",withRipple:!0,checked:!0});c.input.addEventListener("change",()=>{const e=c.checked;s.managers.appStateManager.pushToState("keepSigned",e),L.toggleStorages(e,!0)}),L.getState().then(e=>{E.isAvailable()?c.checked=e.keepSigned:(c.checked=!1,c.label.classList.add("checkbox-disabled"))}),a=P("btn-primary btn-color-primary",{text:"Login.Next"}),a.style.visibility="hidden";const S=e=>{e&&A(e);const t=$([a,l],!0);h(a,m("PleaseWait")),O(a);const o=i.value;s.managers.apiManager.invokeApi("auth.sendCode",{phone_number:o,api_id:C.id,api_hash:C.hash,settings:{_:"codeSettings",pFlags:{}}}).then(async n=>{if(n._==="auth.sentCodeSuccess"){const{authorization:r}=n;r._==="auth.authorization"&&(await s.managers.apiManager.setUser(r.user),I(()=>import("./pageIm-2VO8DGq9.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(b=>{b.default.mount()}))}I(()=>import("./pageAuthCode-B0HhyDcO.js"),__vite__mapDeps([4,1,2,3,5,6,7,8,9,10,11,12]),import.meta.url).then(r=>r.default.mount(Object.assign(n,{phone_number:o})))}).catch(n=>{switch(t(),n.type){case"PHONE_NUMBER_INVALID":i.setError(),h(i.label,m("Login.PhoneLabelInvalid")),u.classList.add("error"),h(a,m("Login.Next"));break;default:console.error("auth.sendCode error:",n),a.innerText=n.type;break}})};B(a,S),l=P("btn-primary btn-secondary btn-primary-transparent primary",{text:"Login.QR.Login"}),l.addEventListener("click",()=>{j.mount()}),g.append(d.container,i.container,c.label,a,l);const _=document.createElement("h4");_.classList.add("text-center"),x(_,"Login.Title");const f=document.createElement("div");f.classList.add("subtitle","text-center"),x(f,"Login.StartText"),R.pageEl.querySelector(".container").append(_,f,g);const T=()=>{s.managers.apiManager.invokeApi("help.getNearestDc").then(e=>{const t=E.getFromCache("langPack");t&&!t.countries?.hash&&M.getLangPack(t.lang_code).then(()=>{i.simulateInputEvent()});const o=new Set([1,2,3,4,5]),n=[e.this_dc];let r;return e.nearest_dc!==e.this_dc&&(r=s.managers.apiManager.getNetworkerVoid(e.nearest_dc).then(()=>{n.push(e.nearest_dc)})),(r||Promise.resolve()).then(()=>{n.forEach(p=>{o.delete(p)});const b=[...o],v=async()=>{const p=b.shift();if(!p)return;const w=`dc${p}_auth_key`;if(await F.get(w))return v();setTimeout(()=>{s.managers.apiManager.getNetworkerVoid(p).finally(v)},3e3)};v()}),e}).then(e=>{!d.value.length&&!i.value.length&&d.selectCountryByIso2(e.country)})};N||setTimeout(()=>{u.focus()},0),q(g),T()},R=new V("page-sign",!0,D,()=>{a&&(h(a,m("Login.Next")),H(a,void 0,void 0,!0),a.removeAttribute("disabled")),l&&l.removeAttribute("disabled"),s.managers.appStateManager.pushToState("authState",{_:"authStateSignIn"})});export{R as default};
-//# sourceMappingURL=pageSignIn-pfbmi0Ny.js.map
+import{a as s,b as L,s as E,c as A,i as m,A as C,_ as I,d as x,I as N,e as M,f as F}from"./index-M8z-nwNm.js";import{p as O}from"./putPreloader-jxB4tqkF.js";import{P as V,a as B}from"./page-kT6kVFv9.js";import{C as U,T as W,a as z}from"./countryInputField-tqY1KpER.js";import{B as P,r as H}from"./button-Mm7TqKr1.js";import{p as K,l as Q,t as $,r as h}from"./wrapEmojiText-PAHdiQbe.js";import{p as j,g as q}from"./pageSignQR-VxURk7YO.js";import"./scrollable-ILmNatrX.js";import"./textToSvgURL-Z4O-nL1S.js";let a=null,l;const D=()=>{const g=document.createElement("div");g.classList.add("input-wrapper");let y,k;const d=new U({onCountryChange:(e,t)=>{y=e,k=t,t&&(i.value=i.lastValue="+"+t.country_code,setTimeout(()=>{u.focus(),K(u,!0)},0))}}),i=new W({onInput:e=>{Q.loadLottieWorkers();const{country:t,code:o}=e||{},n=t?t.name||t.default_name:"";n!==d.value&&(!y||!t||!o||y!==t&&k.country_code!==o.country_code)&&d.override(t,o,n),t||i.value.length-1>1?a.style.visibility="":a.style.visibility="hidden"}}),u=i.input;u.addEventListener("keypress",e=>{if(!a.style.visibility&&e.key==="Enter")return S()});const c=new z({text:"Login.KeepSigned",name:"keepSession",withRipple:!0,checked:!0});c.input.addEventListener("change",()=>{const e=c.checked;s.managers.appStateManager.pushToState("keepSigned",e),L.toggleStorages(e,!0)}),L.getState().then(e=>{E.isAvailable()?c.checked=e.keepSigned:(c.checked=!1,c.label.classList.add("checkbox-disabled"))}),a=P("btn-primary btn-color-primary",{text:"Login.Next"}),a.style.visibility="hidden";const S=e=>{e&&A(e);const t=$([a,l],!0);h(a,m("PleaseWait")),O(a);const o=i.value;s.managers.apiManager.invokeApi("auth.sendCode",{phone_number:o,api_id:C.id,api_hash:C.hash,settings:{_:"codeSettings",pFlags:{}}}).then(async n=>{if(n._==="auth.sentCodeSuccess"){const{authorization:r}=n;r._==="auth.authorization"&&(await s.managers.apiManager.setUser(r.user),I(()=>import("./pageIm-wngHxkKH.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(b=>{b.default.mount()}))}I(()=>import("./pageAuthCode-tLfkajQz.js"),__vite__mapDeps([4,1,2,3,5,6,7,8,9,10,11,12]),import.meta.url).then(r=>r.default.mount(Object.assign(n,{phone_number:o})))}).catch(n=>{switch(t(),n.type){case"PHONE_NUMBER_INVALID":i.setError(),h(i.label,m("Login.PhoneLabelInvalid")),u.classList.add("error"),h(a,m("Login.Next"));break;default:console.error("auth.sendCode error:",n),a.innerText=n.type;break}})};B(a,S),l=P("btn-primary btn-secondary btn-primary-transparent primary",{text:"Login.QR.Login"}),l.addEventListener("click",()=>{j.mount()}),g.append(d.container,i.container,c.label,a,l);const _=document.createElement("h4");_.classList.add("text-center"),x(_,"Login.Title");const f=document.createElement("div");f.classList.add("subtitle","text-center"),x(f,"Login.StartText"),R.pageEl.querySelector(".container").append(_,f,g);const T=()=>{s.managers.apiManager.invokeApi("help.getNearestDc").then(e=>{const t=E.getFromCache("langPack");t&&!t.countries?.hash&&M.getLangPack(t.lang_code).then(()=>{i.simulateInputEvent()});const o=new Set([1,2,3,4,5]),n=[e.this_dc];let r;return e.nearest_dc!==e.this_dc&&(r=s.managers.apiManager.getNetworkerVoid(e.nearest_dc).then(()=>{n.push(e.nearest_dc)})),(r||Promise.resolve()).then(()=>{n.forEach(p=>{o.delete(p)});const b=[...o],v=async()=>{const p=b.shift();if(!p)return;const w=`dc${p}_auth_key`;if(await F.get(w))return v();setTimeout(()=>{s.managers.apiManager.getNetworkerVoid(p).finally(v)},3e3)};v()}),e}).then(e=>{!d.value.length&&!i.value.length&&d.selectCountryByIso2(e.country)})};N||setTimeout(()=>{u.focus()},0),q(g),T()},R=new V("page-sign",!0,D,()=>{a&&(h(a,m("Login.Next")),H(a,void 0,void 0,!0),a.removeAttribute("disabled")),l&&l.removeAttribute("disabled"),s.managers.appStateManager.pushToState("authState",{_:"authStateSignIn"})});export{R as default};
+//# sourceMappingURL=pageSignIn-N45VQ3GF.js.map
 function __vite__mapDeps(indexes) {
   if (!__vite__mapDeps.viteFileDeps) {
-    __vite__mapDeps.viteFileDeps = ["./pageIm-2VO8DGq9.js","./index-XZA1-3MU.js","./index-pzR5gIOz.css","./page-eb81Un_i.js","./pageAuthCode-B0HhyDcO.js","./codeInputField-H0ySI27M.js","./wrapEmojiText-pejq-WF4.js","./button-aS2SE0kp.js","./putPreloader--f-Xu9AG.js","./countryInputField-Rr6PHiIn.js","./scrollable-OU41biYL.js","./pageSignQR-bI2rYqWN.js","./textToSvgURL-Z4O-nL1S.js"]
+    __vite__mapDeps.viteFileDeps = ["./pageIm-wngHxkKH.js","./index-M8z-nwNm.js","./index-pzR5gIOz.css","./page-kT6kVFv9.js","./pageAuthCode-tLfkajQz.js","./codeInputField-Ofayp2TX.js","./wrapEmojiText-PAHdiQbe.js","./button-Mm7TqKr1.js","./putPreloader-jxB4tqkF.js","./countryInputField-tqY1KpER.js","./scrollable-ILmNatrX.js","./pageSignQR-VxURk7YO.js","./textToSvgURL-Z4O-nL1S.js"]
   }
   return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
 }
\ No newline at end of file

--- public/pageSignIn-N45VQ3GF.js.map ---
@@ -1 +1 @@
-{"version":3,"mappings":"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","names":["btnNext","btnQr","onFirstMount","inputWrapper","lastCountrySelected","lastCountryCodeSelected","countryInputField","CountryInputField","country","code","telInputField","telEl","placeCaretAtEnd","TelInputField","formatted","lottieLoader","countryName","onSubmit","signedCheckboxField","CheckboxField","keepSigned","rootScope","apiManagerProxy","state","stateStorage","Button","cancelEvent","toggle","toggleDisability","replaceContent","i18n","putPreloader","phone_number","App","authorization","__vitePreload","m","err","attachClickEvent","pageSignQR","h4","_i18n","subtitle","page","tryAgain","nearestDcResult","langPack","I18n","dcs","done","promise","dcId","_dcs","g","dbKey","sessionStorage","IS_TOUCH_SUPPORTED","getLanguageChangeButton","Page","ripple"],"sources":["../src/pages/pageSignIn.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {putPreloader} from '../components/putPreloader';\nimport Page from './page';\nimport CheckboxField from '../components/checkboxField';\nimport Button from '../components/button';\nimport IS_TOUCH_SUPPORTED from '../environment/touchSupport';\nimport App from '../config/app';\nimport I18n, {_i18n, i18n} from '../lib/langPack';\nimport lottieLoader from '../lib/rlottie/lottieLoader';\nimport ripple from '../components/ripple';\nimport pageSignQR from './pageSignQR';\nimport getLanguageChangeButton from '../components/languageChangeButton';\nimport cancelEvent from '../helpers/dom/cancelEvent';\nimport {attachClickEvent} from '../helpers/dom/clickEvent';\nimport replaceContent from '../helpers/dom/replaceContent';\nimport toggleDisability from '../helpers/dom/toggleDisability';\nimport sessionStorage from '../lib/sessionStorage';\nimport {DcAuthKey} from '../types';\nimport placeCaretAtEnd from '../helpers/dom/placeCaretAtEnd';\nimport {HelpCountry, HelpCountryCode} from '../layer';\nimport stateStorage from '../lib/stateStorage';\nimport rootScope from '../lib/rootScope';\nimport TelInputField from '../components/telInputField';\nimport apiManagerProxy from '../lib/mtproto/mtprotoworker';\nimport CountryInputField from '../components/countryInputField';\n\n// import _countries from '../countries_pretty.json';\nlet btnNext: HTMLButtonElement = null, btnQr: HTMLButtonElement;\n\nconst onFirstMount = () => {\n  /* if(Modes.test) {\n    Countries.push({\n      _: 'help.country',\n      default_name: 'Test Country',\n      country_codes: [{\n        _: 'help.countryCode',\n        country_code: '999 66',\n        patterns: ['999 66 XXX XX']\n      }],\n      iso2: 'KK'\n    });\n\n    console.log('Added test country to list!');\n  } */\n\n  // const countries: Country[] = _countries.default.filter((c) => c.emoji);\n  // const countries: Country[] = Countries.filter((c) => c.emoji).sort((a, b) => a.name.localeCompare(b.name));\n  // const countries = I18n.countriesList.filter((country) => !country.pFlags?.hidden);\n\n  const inputWrapper = document.createElement('div');\n  inputWrapper.classList.add('input-wrapper');\n\n  let lastCountrySelected: HelpCountry, lastCountryCodeSelected: HelpCountryCode;\n  const countryInputField = new CountryInputField({\n    onCountryChange: (country, code) => {\n      lastCountrySelected = country, lastCountryCodeSelected = code;\n\n      if(!code) {\n        return;\n      }\n\n      telInputField.value = telInputField.lastValue = '+' + code.country_code;\n      setTimeout(() => {\n        telEl.focus();\n        placeCaretAtEnd(telEl, true);\n      }, 0);\n    }\n  });\n\n  const telInputField = new TelInputField({\n    onInput: (formatted) => {\n      lottieLoader.loadLottieWorkers();\n\n      const {country, code} = formatted || {};\n      const countryName = country ? country.name || country.default_name : ''/* 'Unknown' */;\n      if(countryName !== countryInputField.value && (\n        !lastCountrySelected ||\n          !country ||\n          !code || (\n          lastCountrySelected !== country &&\n            lastCountryCodeSelected.country_code !== code.country_code\n        )\n      )\n      ) {\n        countryInputField.override(country, code, countryName);\n      }\n\n      // if(country && (telInputField.value.length - 1) >= (country.pattern ? country.pattern.length : 9)) {\n      if(country || (telInputField.value.length - 1) > 1) {\n        btnNext.style.visibility = '';\n      } else {\n        btnNext.style.visibility = 'hidden';\n      }\n    }\n  });\n\n  const telEl = telInputField.input;\n\n  telEl.addEventListener('keypress', (e) => {\n    // console.log('keypress', this.value);\n    if(!btnNext.style.visibility &&/* this.value.length >= 9 && */ e.key === 'Enter') {\n      return onSubmit();\n    }\n  });\n\n  /* telEl.addEventListener('focus', function(this: typeof telEl, e) {\n    this.removeAttribute('readonly'); // fix autocomplete\n  });*/\n\n  const signedCheckboxField = new CheckboxField({\n    text: 'Login.KeepSigned',\n    name: 'keepSession',\n    withRipple: true,\n    checked: true\n  });\n\n  signedCheckboxField.input.addEventListener('change', () => {\n    const keepSigned = signedCheckboxField.checked;\n    rootScope.managers.appStateManager.pushToState('keepSigned', keepSigned);\n\n    apiManagerProxy.toggleStorages(keepSigned, true);\n  });\n\n  apiManagerProxy.getState().then((state) => {\n    if(!stateStorage.isAvailable()) {\n      signedCheckboxField.checked = false;\n      signedCheckboxField.label.classList.add('checkbox-disabled');\n    } else {\n      signedCheckboxField.checked = state.keepSigned;\n    }\n  });\n\n  btnNext = Button('btn-primary btn-color-primary', {text: 'Login.Next'});\n  btnNext.style.visibility = 'hidden';\n\n  const onSubmit = (e?: Event) => {\n    if(e) {\n      cancelEvent(e);\n    }\n\n    const toggle = toggleDisability([/* telEl, countryInput,  */btnNext, btnQr], true);\n\n    replaceContent(btnNext, i18n('PleaseWait'));\n    putPreloader(btnNext);\n\n    // return;\n\n    const phone_number = telInputField.value;\n    rootScope.managers.apiManager.invokeApi('auth.sendCode', {\n      phone_number: phone_number,\n      api_id: App.id,\n      api_hash: App.hash,\n      settings: {\n        _: 'codeSettings', // that's how we sending Type\n        pFlags: {}\n      }\n      // lang_code: navigator.language || 'en'\n    }).then(async(code) => {\n      // console.log('got code', code);\n\n      if(code._ === 'auth.sentCodeSuccess') {\n        const {authorization} = code;\n        if(authorization._ === 'auth.authorization') {\n          await rootScope.managers.apiManager.setUser(authorization.user);\n\n          import('./pageIm').then((m) => {\n            m.default.mount();\n          });\n        }\n      }\n\n      import('./pageAuthCode').then((m) => m.default.mount(Object.assign(code, {phone_number: phone_number})));\n    }).catch((err) => {\n      toggle();\n\n      switch(err.type) {\n        case 'PHONE_NUMBER_INVALID':\n          telInputField.setError();\n          replaceContent(telInputField.label, i18n('Login.PhoneLabelInvalid'));\n          telEl.classList.add('error');\n          replaceContent(btnNext, i18n('Login.Next'));\n          break;\n        default:\n          console.error('auth.sendCode error:', err);\n          btnNext.innerText = err.type;\n          break;\n      }\n    });\n  };\n\n  attachClickEvent(btnNext, onSubmit);\n\n  btnQr = Button('btn-primary btn-secondary btn-primary-transparent primary', {text: 'Login.QR.Login'});\n\n  const qrMounted = false;\n  btnQr.addEventListener('click', () => {\n    pageSignQR.mount();\n    /* const promise = import('./pageSignQR');\n    btnQr.disabled = true;\n\n    let preloaderDiv: HTMLElement;\n    if(!qrMounted) {\n      preloaderDiv = putPreloader(btnQr);\n      qrMounted = true;\n    }\n\n    promise.then((module) => {\n      module.default.mount();\n\n      setTimeout(() => {\n        btnQr.removeAttribute('disabled');\n        if(preloaderDiv) {\n          preloaderDiv.remove();\n        }\n      }, 200);\n    }); */\n  });\n\n  inputWrapper.append(countryInputField.container, telInputField.container, signedCheckboxField.label, btnNext, btnQr);\n\n  const h4 = document.createElement('h4');\n  h4.classList.add('text-center');\n  _i18n(h4, 'Login.Title');\n\n  const subtitle = document.createElement('div');\n  subtitle.classList.add('subtitle', 'text-center');\n  _i18n(subtitle, 'Login.StartText');\n\n  page.pageEl.querySelector('.container').append(h4, subtitle, inputWrapper);\n\n  const tryAgain = () => {\n    rootScope.managers.apiManager.invokeApi('help.getNearestDc').then((nearestDcResult) => {\n      const langPack = stateStorage.getFromCache('langPack');\n      if(langPack && !langPack.countries?.hash) {\n        I18n.getLangPack(langPack.lang_code).then(() => {\n          telInputField.simulateInputEvent();\n        });\n      }\n\n      const dcs = new Set([1, 2, 3, 4, 5]);\n      const done: number[] = [nearestDcResult.this_dc];\n\n      let promise: Promise<any>;\n      if(nearestDcResult.nearest_dc !== nearestDcResult.this_dc) {\n        promise = rootScope.managers.apiManager.getNetworkerVoid(nearestDcResult.nearest_dc).then(() => {\n          done.push(nearestDcResult.nearest_dc);\n        });\n      }\n\n      (promise || Promise.resolve()).then(() => {\n        done.forEach((dcId) => {\n          dcs.delete(dcId);\n        });\n\n        const _dcs = [...dcs];\n        const g = async(): Promise<void> => {\n          const dcId = _dcs.shift();\n          if(!dcId) return;\n\n          const dbKey: DcAuthKey = `dc${dcId}_auth_key` as any;\n          const key = await sessionStorage.get(dbKey);\n          if(key) {\n            return g();\n          }\n\n          setTimeout(() => { // *     ,      \n            rootScope.managers.apiManager.getNetworkerVoid(dcId/* , {fileDownload: true} */).finally(g);\n          }, /* done.includes(dcId) ? 0 :  */3000);\n        };\n\n        g();\n      });\n\n      return nearestDcResult;\n    }).then((nearestDcResult) => {\n      if(!countryInputField.value.length && !telInputField.value.length) {\n        countryInputField.selectCountryByIso2(nearestDcResult.country);\n      }\n\n      // console.log('woohoo', nearestDcResult, country);\n    })// .catch(tryAgain);\n  };\n\n  if(!IS_TOUCH_SUPPORTED) {\n    setTimeout(() => {\n      telEl.focus();\n    }, 0);\n  }\n\n  getLanguageChangeButton(inputWrapper);\n\n  tryAgain();\n};\n\nconst page = new Page('page-sign', true, onFirstMount, () => {\n  if(btnNext) {\n    replaceContent(btnNext, i18n('Login.Next'));\n    ripple(btnNext, undefined, undefined, true);\n    btnNext.removeAttribute('disabled');\n  }\n\n  if(btnQr) {\n    btnQr.removeAttribute('disabled');\n  }\n\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStateSignIn'});\n});\n\nexport default page;\n"],"file":"pageSignIn-pfbmi0Ny.js"}
\ No newline at end of file
+{"version":3,"mappings":"0fAgCA,IAAIA,EAA6B,KAAMC,EAEvC,MAAMC,EAAe,IAAM,CAoBnB,MAAAC,EAAe,SAAS,cAAc,KAAK,EACpCA,EAAA,UAAU,IAAI,eAAe,EAE1C,IAAIC,EAAkCC,EAChC,MAAAC,EAAoB,IAAIC,EAAkB,CAC9C,gBAAiB,CAACC,EAASC,IAAS,CAClCL,EAAsBI,EAASH,EAA0BI,EAErDA,IAIJC,EAAc,MAAQA,EAAc,UAAY,IAAMD,EAAK,aAC3D,WAAW,IAAM,CACfE,EAAM,MAAM,EACZC,EAAgBD,EAAO,EAAI,GAC1B,CAAC,EACN,EACD,EAEKD,EAAgB,IAAIG,EAAc,CACtC,QAAUC,GAAc,CACtBC,EAAa,kBAAkB,EAE/B,KAAM,CAAC,QAAAP,EAAS,KAAAC,GAAQK,GAAa,GAC/BE,EAAcR,EAAUA,EAAQ,MAAQA,EAAQ,aAAe,GAClEQ,IAAgBV,EAAkB,QACnC,CAACF,GACC,CAACI,GACD,CAACC,GACDL,IAAwBI,GACtBH,EAAwB,eAAiBI,EAAK,eAIhCH,EAAA,SAASE,EAASC,EAAMO,CAAW,EAIpDR,GAAYE,EAAc,MAAM,OAAS,EAAK,EAC/CV,EAAQ,MAAM,WAAa,GAE3BA,EAAQ,MAAM,WAAa,QAE/B,EACD,EAEKW,EAAQD,EAAc,MAEtBC,EAAA,iBAAiB,WAAa,GAAM,CAErC,IAACX,EAAQ,MAAM,YAA6C,EAAE,MAAQ,QACvE,OAAOiB,EAAS,CAClB,CACD,EAMK,MAAAC,EAAsB,IAAIC,EAAc,CAC5C,KAAM,mBACN,KAAM,cACN,WAAY,GACZ,QAAS,GACV,EAEmBD,EAAA,MAAM,iBAAiB,SAAU,IAAM,CACzD,MAAME,EAAaF,EAAoB,QACvCG,EAAU,SAAS,gBAAgB,YAAY,aAAcD,CAAU,EAEvDE,EAAA,eAAeF,EAAY,EAAI,EAChD,EAEDE,EAAgB,SAAS,EAAE,KAAMC,GAAU,CACrCC,EAAa,cAIfN,EAAoB,QAAUK,EAAM,YAHpCL,EAAoB,QAAU,GACVA,EAAA,MAAM,UAAU,IAAI,mBAAmB,EAG7D,CACD,EAEDlB,EAAUyB,EAAO,gCAAiC,CAAC,KAAM,YAAa,GACtEzB,EAAQ,MAAM,WAAa,SAErB,MAAAiB,EAAY,GAAc,CAC3B,GACDS,EAAY,CAAC,EAGf,MAAMC,EAASC,EAAiB,CAA4B5B,EAASC,GAAQ,EAAI,EAElE4B,EAAA7B,EAAS8B,EAAK,YAAY,CAAC,EAC1CC,EAAa/B,CAAO,EAIpB,MAAMgC,EAAetB,EAAc,MACzBW,EAAA,SAAS,WAAW,UAAU,gBAAiB,CACvD,aAAAW,EACA,OAAQC,EAAI,GACZ,SAAUA,EAAI,KACd,SAAU,CACR,EAAG,eACH,OAAQ,CAAC,CACX,EAED,EAAE,KAAK,MAAMxB,GAAS,CAGlB,GAAAA,EAAK,IAAM,uBAAwB,CAC9B,MAAC,cAAAyB,CAAiB,EAAAzB,EACrByB,EAAc,IAAM,uBACrB,MAAMb,EAAU,SAAS,WAAW,QAAQa,EAAc,IAAI,EAE9DC,EAAA,WAAO,sBAAU,8CAAE,KAAMC,GAAM,CAC7BA,EAAE,QAAQ,OAAM,CACjB,EAEL,OAEA,OAAO,4BAAgB,iEAAE,KAAMA,GAAMA,EAAE,QAAQ,MAAM,OAAO,OAAO3B,EAAM,CAAC,aAAAuB,EAA2B,CAAC,CAAC,EACxG,EAAE,MAAOK,GAAQ,CAGhB,OAFOV,IAEAU,EAAI,KAAM,CACf,IAAK,uBACH3B,EAAc,SAAS,EACvBmB,EAAenB,EAAc,MAAOoB,EAAK,yBAAyB,CAAC,EAC7DnB,EAAA,UAAU,IAAI,OAAO,EACZkB,EAAA7B,EAAS8B,EAAK,YAAY,CAAC,EAC1C,MACF,QACU,cAAM,uBAAwBO,CAAG,EACzCrC,EAAQ,UAAYqC,EAAI,KACxB,KACJ,EACD,GAGHC,EAAiBtC,EAASiB,CAAQ,EAElChB,EAAQwB,EAAO,4DAA6D,CAAC,KAAM,gBAAiB,GAG9FxB,EAAA,iBAAiB,QAAS,IAAM,CACpCsC,EAAW,MAAM,EAoBlB,EAEYpC,EAAA,OAAOG,EAAkB,UAAWI,EAAc,UAAWQ,EAAoB,MAAOlB,EAASC,CAAK,EAE7G,MAAAuC,EAAK,SAAS,cAAc,IAAI,EACnCA,EAAA,UAAU,IAAI,aAAa,EAC9BC,EAAMD,EAAI,aAAa,EAEjB,MAAAE,EAAW,SAAS,cAAc,KAAK,EACpCA,EAAA,UAAU,IAAI,WAAY,aAAa,EAChDD,EAAMC,EAAU,iBAAiB,EAEjCC,EAAK,OAAO,cAAc,YAAY,EAAE,OAAOH,EAAIE,EAAUvC,CAAY,EAEzE,MAAMyC,EAAW,IAAM,CACrBvB,EAAU,SAAS,WAAW,UAAU,mBAAmB,EAAE,KAAMwB,GAAoB,CAC/E,MAAAC,EAAWtB,EAAa,aAAa,UAAU,EAClDsB,GAAY,CAACA,EAAS,WAAW,MAClCC,EAAK,YAAYD,EAAS,SAAS,EAAE,KAAK,IAAM,CAC9CpC,EAAc,mBAAmB,EAClC,EAGG,MAAAsC,MAAU,IAAI,CAAC,EAAG,EAAG,EAAG,EAAG,CAAC,CAAC,EAC7BC,EAAiB,CAACJ,EAAgB,OAAO,EAE3C,IAAAK,EACD,OAAAL,EAAgB,aAAeA,EAAgB,UACtCK,EAAA7B,EAAU,SAAS,WAAW,iBAAiBwB,EAAgB,UAAU,EAAE,KAAK,IAAM,CACzFI,EAAA,KAAKJ,EAAgB,UAAU,EACrC,IAGFK,GAAW,QAAQ,QAAQ,GAAG,KAAK,IAAM,CACnCD,EAAA,QAASE,GAAS,CACrBH,EAAI,OAAOG,CAAI,EAChB,EAEK,MAAAC,EAAO,CAAC,GAAGJ,CAAG,EACdK,EAAI,SAA0B,CAC5B,MAAAF,EAAOC,EAAK,QAClB,GAAG,CAACD,EAAM,OAEJ,MAAAG,EAAmB,KAAKH,CAAI,YAElC,GADY,MAAMI,EAAe,IAAID,CAAK,EAExC,OAAOD,EAAE,EAGX,WAAW,IAAM,CACfhC,EAAU,SAAS,WAAW,iBAAiB8B,CAAA,EAAkC,QAAQE,CAAC,CAC5F,EAAmC,IAAI,EAGvCA,GAAA,CACH,EAEMR,CAAA,CACR,EAAE,KAAMA,GAAoB,CACxB,CAACvC,EAAkB,MAAM,QAAU,CAACI,EAAc,MAAM,QACvCJ,EAAA,oBAAoBuC,EAAgB,OAAO,CAC/D,CAGD,GAGCW,GACF,WAAW,IAAM,CACf7C,EAAM,MAAM,GACX,CAAC,EAGN8C,EAAwBtD,CAAY,EAE3ByC,GACX,EAEMD,EAAO,IAAIe,EAAK,YAAa,GAAMxD,EAAc,IAAM,CACxDF,IACc6B,EAAA7B,EAAS8B,EAAK,YAAY,CAAC,EACnC6B,EAAA3D,EAAS,OAAW,OAAW,EAAI,EAC1CA,EAAQ,gBAAgB,UAAU,GAGjCC,GACDA,EAAM,gBAAgB,UAAU,EAGlCoB,EAAU,SAAS,gBAAgB,YAAY,YAAa,CAAC,EAAG,kBAAkB,CACpF,CAAC","names":["btnNext","btnQr","onFirstMount","inputWrapper","lastCountrySelected","lastCountryCodeSelected","countryInputField","CountryInputField","country","code","telInputField","telEl","placeCaretAtEnd","TelInputField","formatted","lottieLoader","countryName","onSubmit","signedCheckboxField","CheckboxField","keepSigned","rootScope","apiManagerProxy","state","stateStorage","Button","cancelEvent","toggle","toggleDisability","replaceContent","i18n","putPreloader","phone_number","App","authorization","__vitePreload","m","err","attachClickEvent","pageSignQR","h4","_i18n","subtitle","page","tryAgain","nearestDcResult","langPack","I18n","dcs","done","promise","dcId","_dcs","g","dbKey","sessionStorage","IS_TOUCH_SUPPORTED","getLanguageChangeButton","Page","ripple"],"sources":["../src/pages/pageSignIn.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {putPreloader} from '../components/putPreloader';\nimport Page from './page';\nimport CheckboxField from '../components/checkboxField';\nimport Button from '../components/button';\nimport IS_TOUCH_SUPPORTED from '../environment/touchSupport';\nimport App from '../config/app';\nimport I18n, {_i18n, i18n} from '../lib/langPack';\nimport lottieLoader from '../lib/rlottie/lottieLoader';\nimport ripple from '../components/ripple';\nimport pageSignQR from './pageSignQR';\nimport getLanguageChangeButton from '../components/languageChangeButton';\nimport cancelEvent from '../helpers/dom/cancelEvent';\nimport {attachClickEvent} from '../helpers/dom/clickEvent';\nimport replaceContent from '../helpers/dom/replaceContent';\nimport toggleDisability from '../helpers/dom/toggleDisability';\nimport sessionStorage from '../lib/sessionStorage';\nimport {DcAuthKey} from '../types';\nimport placeCaretAtEnd from '../helpers/dom/placeCaretAtEnd';\nimport {HelpCountry, HelpCountryCode} from '../layer';\nimport stateStorage from '../lib/stateStorage';\nimport rootScope from '../lib/rootScope';\nimport TelInputField from '../components/telInputField';\nimport apiManagerProxy from '../lib/mtproto/mtprotoworker';\nimport CountryInputField from '../components/countryInputField';\n\n// import _countries from '../countries_pretty.json';\nlet btnNext: HTMLButtonElement = null, btnQr: HTMLButtonElement;\n\nconst onFirstMount = () => {\n  /* if(Modes.test) {\n    Countries.push({\n      _: 'help.country',\n      default_name: 'Test Country',\n      country_codes: [{\n        _: 'help.countryCode',\n        country_code: '999 66',\n        patterns: ['999 66 XXX XX']\n      }],\n      iso2: 'KK'\n    });\n\n    console.log('Added test country to list!');\n  } */\n\n  // const countries: Country[] = _countries.default.filter((c) => c.emoji);\n  // const countries: Country[] = Countries.filter((c) => c.emoji).sort((a, b) => a.name.localeCompare(b.name));\n  // const countries = I18n.countriesList.filter((country) => !country.pFlags?.hidden);\n\n  const inputWrapper = document.createElement('div');\n  inputWrapper.classList.add('input-wrapper');\n\n  let lastCountrySelected: HelpCountry, lastCountryCodeSelected: HelpCountryCode;\n  const countryInputField = new CountryInputField({\n    onCountryChange: (country, code) => {\n      lastCountrySelected = country, lastCountryCodeSelected = code;\n\n      if(!code) {\n        return;\n      }\n\n      telInputField.value = telInputField.lastValue = '+' + code.country_code;\n      setTimeout(() => {\n        telEl.focus();\n        placeCaretAtEnd(telEl, true);\n      }, 0);\n    }\n  });\n\n  const telInputField = new TelInputField({\n    onInput: (formatted) => {\n      lottieLoader.loadLottieWorkers();\n\n      const {country, code} = formatted || {};\n      const countryName = country ? country.name || country.default_name : ''/* 'Unknown' */;\n      if(countryName !== countryInputField.value && (\n        !lastCountrySelected ||\n          !country ||\n          !code || (\n          lastCountrySelected !== country &&\n            lastCountryCodeSelected.country_code !== code.country_code\n        )\n      )\n      ) {\n        countryInputField.override(country, code, countryName);\n      }\n\n      // if(country && (telInputField.value.length - 1) >= (country.pattern ? country.pattern.length : 9)) {\n      if(country || (telInputField.value.length - 1) > 1) {\n        btnNext.style.visibility = '';\n      } else {\n        btnNext.style.visibility = 'hidden';\n      }\n    }\n  });\n\n  const telEl = telInputField.input;\n\n  telEl.addEventListener('keypress', (e) => {\n    // console.log('keypress', this.value);\n    if(!btnNext.style.visibility &&/* this.value.length >= 9 && */ e.key === 'Enter') {\n      return onSubmit();\n    }\n  });\n\n  /* telEl.addEventListener('focus', function(this: typeof telEl, e) {\n    this.removeAttribute('readonly'); // fix autocomplete\n  });*/\n\n  const signedCheckboxField = new CheckboxField({\n    text: 'Login.KeepSigned',\n    name: 'keepSession',\n    withRipple: true,\n    checked: true\n  });\n\n  signedCheckboxField.input.addEventListener('change', () => {\n    const keepSigned = signedCheckboxField.checked;\n    rootScope.managers.appStateManager.pushToState('keepSigned', keepSigned);\n\n    apiManagerProxy.toggleStorages(keepSigned, true);\n  });\n\n  apiManagerProxy.getState().then((state) => {\n    if(!stateStorage.isAvailable()) {\n      signedCheckboxField.checked = false;\n      signedCheckboxField.label.classList.add('checkbox-disabled');\n    } else {\n      signedCheckboxField.checked = state.keepSigned;\n    }\n  });\n\n  btnNext = Button('btn-primary btn-color-primary', {text: 'Login.Next'});\n  btnNext.style.visibility = 'hidden';\n\n  const onSubmit = (e?: Event) => {\n    if(e) {\n      cancelEvent(e);\n    }\n\n    const toggle = toggleDisability([/* telEl, countryInput,  */btnNext, btnQr], true);\n\n    replaceContent(btnNext, i18n('PleaseWait'));\n    putPreloader(btnNext);\n\n    // return;\n\n    const phone_number = telInputField.value;\n    rootScope.managers.apiManager.invokeApi('auth.sendCode', {\n      phone_number: phone_number,\n      api_id: App.id,\n      api_hash: App.hash,\n      settings: {\n        _: 'codeSettings', // that's how we sending Type\n        pFlags: {}\n      }\n      // lang_code: navigator.language || 'en'\n    }).then(async(code) => {\n      // console.log('got code', code);\n\n      if(code._ === 'auth.sentCodeSuccess') {\n        const {authorization} = code;\n        if(authorization._ === 'auth.authorization') {\n          await rootScope.managers.apiManager.setUser(authorization.user);\n\n          import('./pageIm').then((m) => {\n            m.default.mount();\n          });\n        }\n      }\n\n      import('./pageAuthCode').then((m) => m.default.mount(Object.assign(code, {phone_number: phone_number})));\n    }).catch((err) => {\n      toggle();\n\n      switch(err.type) {\n        case 'PHONE_NUMBER_INVALID':\n          telInputField.setError();\n          replaceContent(telInputField.label, i18n('Login.PhoneLabelInvalid'));\n          telEl.classList.add('error');\n          replaceContent(btnNext, i18n('Login.Next'));\n          break;\n        default:\n          console.error('auth.sendCode error:', err);\n          btnNext.innerText = err.type;\n          break;\n      }\n    });\n  };\n\n  attachClickEvent(btnNext, onSubmit);\n\n  btnQr = Button('btn-primary btn-secondary btn-primary-transparent primary', {text: 'Login.QR.Login'});\n\n  const qrMounted = false;\n  btnQr.addEventListener('click', () => {\n    pageSignQR.mount();\n    /* const promise = import('./pageSignQR');\n    btnQr.disabled = true;\n\n    let preloaderDiv: HTMLElement;\n    if(!qrMounted) {\n      preloaderDiv = putPreloader(btnQr);\n      qrMounted = true;\n    }\n\n    promise.then((module) => {\n      module.default.mount();\n\n      setTimeout(() => {\n        btnQr.removeAttribute('disabled');\n        if(preloaderDiv) {\n          preloaderDiv.remove();\n        }\n      }, 200);\n    }); */\n  });\n\n  inputWrapper.append(countryInputField.container, telInputField.container, signedCheckboxField.label, btnNext, btnQr);\n\n  const h4 = document.createElement('h4');\n  h4.classList.add('text-center');\n  _i18n(h4, 'Login.Title');\n\n  const subtitle = document.createElement('div');\n  subtitle.classList.add('subtitle', 'text-center');\n  _i18n(subtitle, 'Login.StartText');\n\n  page.pageEl.querySelector('.container').append(h4, subtitle, inputWrapper);\n\n  const tryAgain = () => {\n    rootScope.managers.apiManager.invokeApi('help.getNearestDc').then((nearestDcResult) => {\n      const langPack = stateStorage.getFromCache('langPack');\n      if(langPack && !langPack.countries?.hash) {\n        I18n.getLangPack(langPack.lang_code).then(() => {\n          telInputField.simulateInputEvent();\n        });\n      }\n\n      const dcs = new Set([1, 2, 3, 4, 5]);\n      const done: number[] = [nearestDcResult.this_dc];\n\n      let promise: Promise<any>;\n      if(nearestDcResult.nearest_dc !== nearestDcResult.this_dc) {\n        promise = rootScope.managers.apiManager.getNetworkerVoid(nearestDcResult.nearest_dc).then(() => {\n          done.push(nearestDcResult.nearest_dc);\n        });\n      }\n\n      (promise || Promise.resolve()).then(() => {\n        done.forEach((dcId) => {\n          dcs.delete(dcId);\n        });\n\n        const _dcs = [...dcs];\n        const g = async(): Promise<void> => {\n          const dcId = _dcs.shift();\n          if(!dcId) return;\n\n          const dbKey: DcAuthKey = `dc${dcId}_auth_key` as any;\n          const key = await sessionStorage.get(dbKey);\n          if(key) {\n            return g();\n          }\n\n          setTimeout(() => { // *     ,      \n            rootScope.managers.apiManager.getNetworkerVoid(dcId/* , {fileDownload: true} */).finally(g);\n          }, /* done.includes(dcId) ? 0 :  */3000);\n        };\n\n        g();\n      });\n\n      return nearestDcResult;\n    }).then((nearestDcResult) => {\n      if(!countryInputField.value.length && !telInputField.value.length) {\n        countryInputField.selectCountryByIso2(nearestDcResult.country);\n      }\n\n      // console.log('woohoo', nearestDcResult, country);\n    })// .catch(tryAgain);\n  };\n\n  if(!IS_TOUCH_SUPPORTED) {\n    setTimeout(() => {\n      telEl.focus();\n    }, 0);\n  }\n\n  getLanguageChangeButton(inputWrapper);\n\n  tryAgain();\n};\n\nconst page = new Page('page-sign', true, onFirstMount, () => {\n  if(btnNext) {\n    replaceContent(btnNext, i18n('Login.Next'));\n    ripple(btnNext, undefined, undefined, true);\n    btnNext.removeAttribute('disabled');\n  }\n\n  if(btnQr) {\n    btnQr.removeAttribute('disabled');\n  }\n\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStateSignIn'});\n});\n\nexport default page;\n"],"file":"pageSignIn-N45VQ3GF.js"}
\ No newline at end of file

--- public/pageSignQR-VxURk7YO.js ---
@@ -1,8 +1,8 @@
-import{e as d,l as Q,a as l,c as V,d as $,i as F,_ as y,A as P,p as C}from"./index-XZA1-3MU.js";import{a as z,P as H}from"./page-eb81Un_i.js";import{B as R}from"./button-aS2SE0kp.js";import{p as O}from"./putPreloader--f-Xu9AG.js";import{b as N,t as j}from"./textToSvgURL-Z4O-nL1S.js";let T=!1;function W(){return S||(S=l.managers.apiManager.getConfig().then(e=>e.suggested_lang_code!==d.lastRequestedLangCode?Promise.all([e,d.getStrings(e.suggested_lang_code,["Login.ContinueOnLanguage"]),d.getCacheLangPack()]):[]))}let S;function G(e){T||W().then(([a,c])=>{if(!a)return;const s=[];c.forEach(i=>{const g=d.strings.get(i.key);g&&(s.push(g),d.strings.set(i.key,i))});const o="Login.ContinueOnLanguage",r=R("btn-primary btn-secondary btn-primary-transparent primary",{text:o});r.lastElementChild.classList.remove("i18n"),Q({text:[d.format(o,!0)]}).then(()=>{window.requestAnimationFrame(()=>{e.append(r)})}),l.addEventListener("language_change",()=>{r.remove()},{once:!0}),s.forEach(i=>{d.strings.set(i.key,i)}),z(r,i=>{V(i),T=!0,r.disabled=!0,O(r),d.getLangPack(a.suggested_lang_code)})})}function J(e,a){return a?e.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""):e.replace(/-/g,"+").replace(/_/g,"/")}function K(e){let a,c="";for(let s=e.length,o=0,r=0;r<s;++r)a=r%3,o|=e[r]<<(16>>>a&24),(a===2||s-r===1)&&(c+=String.fromCharCode(E(o>>>18&63),E(o>>>12&63),E(o>>>6&63),E(o&63)),o=0);return c.replace(/A(?=A$|$)/g,"=")}function E(e){return e<26?e+65:e<52?e+71:e<62?e-4:e===62?43:e===63?47:65}const b=3,X=async()=>{const a=A.pageEl.querySelector(".auth-image");let c=O(a,!0);const s=document.createElement("div");s.classList.add("input-wrapper");const o=R("btn-primary btn-secondary btn-primary-transparent primary",{text:"Login.QR.Cancel"});s.append(o),G(s);const r=a.parentElement,i=document.createElement("h4");$(i,"Login.QR.Title");const g=document.createElement("ol");g.classList.add("qr-description"),["Login.QR.Help1","Login.QR.Help2","Login.QR.Help3"].forEach(u=>{const t=document.createElement("li");t.append(F(u)),g.append(t)}),r.append(i,g,s),o.addEventListener("click",()=>{y(()=>import("./pageSignIn-pfbmi0Ny.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url).then(u=>u.default.mount()),m=!0});const x=(await Promise.all([y(()=>import("./qr-code-styling-ogpV7fl-.js").then(u=>u.q),__vite__mapDeps([10,11]),import.meta.url)]))[0].default;let m=!1;l.addEventListener("user_auth",()=>{m=!0,h=null},{once:!0});const L={ignoreErrors:!0};let k;const I=async u=>{try{let t=await l.managers.apiManager.invokeApi("auth.exportLoginToken",{api_id:P.id,api_hash:P.hash,except_ids:[]},{ignoreErrors:!0});if(t._==="auth.loginTokenMigrateTo"&&(L.dcId||(L.dcId=t.dc_id,l.managers.apiManager.setBaseDcId(t.dc_id)),t=await l.managers.apiManager.invokeApi("auth.importLoginToken",{token:t.token},L)),t._==="auth.loginTokenSuccess"){const p=t.authorization;return await l.managers.apiManager.setUser(p.user),y(()=>import("./pageIm-2VO8DGq9.js"),__vite__mapDeps([12,1,2,4]),import.meta.url).then(f=>f.default.mount()),!0}if(!k||!N(k,t.token)){k=t.token;const p=K(t.token),f="tg://login?token="+J(p,!0),w=window.getComputedStyle(document.documentElement),q=w.getPropertyValue("--surface-color").trim(),B=w.getPropertyValue("--primary-text-color").trim(),D=w.getPropertyValue("--primary-color").trim(),M=await fetch("assets/img/logo_padded.svg").then(n=>n.text()).then(n=>(n=n.replace(/(fill:).+?(;)/,`$1${D}$2`),j(n))),_=new x({width:240*window.devicePixelRatio,height:240*window.devicePixelRatio,data:f,image:M,dotsOptions:{color:B,type:"rounded"},cornersSquareOptions:{type:"extra-rounded"},imageOptions:{imageSize:1,margin:0},backgroundOptions:{color:q},qrOptions:{errorCorrectionLevel:"L"}});_.append(a),a.lastChild.classList.add("qr-canvas");let v;_._drawingPromise?v=_._drawingPromise:v=Promise.race([C(1e3),new Promise(n=>{_._canvas._image.addEventListener("load",()=>{window.requestAnimationFrame(()=>n())},{once:!0})})]),await v.then(()=>{if(c){c.style.animation="hide-icon .4s forwards";const n=a.children[1];n.style.display="none",n.style.animation="grow-icon .4s forwards",setTimeout(()=>{n.style.display=""},150),setTimeout(()=>{n.style.animation=""},500),c=void 0}else Array.from(a.children).slice(0,-1).forEach(n=>{n.remove()})})}if(u){const p=Date.now()/1e3,f=t.expires-p-await l.managers.timeManager.getServerTimeOffset();await C(f>b?1e3*b:1e3*f|0)}}catch(t){switch(t.type){case"SESSION_PASSWORD_NEEDED":t.handled=!0,y(()=>import("./pagePassword-wGJb-e9C.js"),__vite__mapDeps([13,1,2,3,4,6,14,7,15]),import.meta.url).then(p=>p.default.mount()),m=!0,h=null;break;default:console.error("pageSignQR: default error:",t),m=!0;break}return!0}return!1};return async()=>{m=!1;do if(m||await I(!0))break;while(!0)}};let h;const A=new H("page-signQR",!0,()=>h,()=>{h||(h=X()),h.then(e=>{e()}),l.managers.appStateManager.pushToState("authState",{_:"authStateSignQr"})}),re=Object.freeze(Object.defineProperty({__proto__:null,default:A},Symbol.toStringTag,{value:"Module"}));export{re as a,G as g,A as p};
-//# sourceMappingURL=pageSignQR-bI2rYqWN.js.map
+import{e as d,l as Q,a as l,c as V,d as $,i as F,_ as y,A as P,p as C}from"./index-M8z-nwNm.js";import{a as z,P as H}from"./page-kT6kVFv9.js";import{B as R}from"./button-Mm7TqKr1.js";import{p as O}from"./putPreloader-jxB4tqkF.js";import{b as N,t as j}from"./textToSvgURL-Z4O-nL1S.js";let T=!1;function W(){return S||(S=l.managers.apiManager.getConfig().then(e=>e.suggested_lang_code!==d.lastRequestedLangCode?Promise.all([e,d.getStrings(e.suggested_lang_code,["Login.ContinueOnLanguage"]),d.getCacheLangPack()]):[]))}let S;function G(e){T||W().then(([a,c])=>{if(!a)return;const s=[];c.forEach(i=>{const g=d.strings.get(i.key);g&&(s.push(g),d.strings.set(i.key,i))});const o="Login.ContinueOnLanguage",r=R("btn-primary btn-secondary btn-primary-transparent primary",{text:o});r.lastElementChild.classList.remove("i18n"),Q({text:[d.format(o,!0)]}).then(()=>{window.requestAnimationFrame(()=>{e.append(r)})}),l.addEventListener("language_change",()=>{r.remove()},{once:!0}),s.forEach(i=>{d.strings.set(i.key,i)}),z(r,i=>{V(i),T=!0,r.disabled=!0,O(r),d.getLangPack(a.suggested_lang_code)})})}function J(e,a){return a?e.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""):e.replace(/-/g,"+").replace(/_/g,"/")}function K(e){let a,c="";for(let s=e.length,o=0,r=0;r<s;++r)a=r%3,o|=e[r]<<(16>>>a&24),(a===2||s-r===1)&&(c+=String.fromCharCode(E(o>>>18&63),E(o>>>12&63),E(o>>>6&63),E(o&63)),o=0);return c.replace(/A(?=A$|$)/g,"=")}function E(e){return e<26?e+65:e<52?e+71:e<62?e-4:e===62?43:e===63?47:65}const b=3,X=async()=>{const a=A.pageEl.querySelector(".auth-image");let c=O(a,!0);const s=document.createElement("div");s.classList.add("input-wrapper");const o=R("btn-primary btn-secondary btn-primary-transparent primary",{text:"Login.QR.Cancel"});s.append(o),G(s);const r=a.parentElement,i=document.createElement("h4");$(i,"Login.QR.Title");const g=document.createElement("ol");g.classList.add("qr-description"),["Login.QR.Help1","Login.QR.Help2","Login.QR.Help3"].forEach(u=>{const t=document.createElement("li");t.append(F(u)),g.append(t)}),r.append(i,g,s),o.addEventListener("click",()=>{y(()=>import("./pageSignIn-N45VQ3GF.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9]),import.meta.url).then(u=>u.default.mount()),m=!0});const x=(await Promise.all([y(()=>import("./qr-code-styling-ogpV7fl-.js").then(u=>u.q),__vite__mapDeps([10,11]),import.meta.url)]))[0].default;let m=!1;l.addEventListener("user_auth",()=>{m=!0,h=null},{once:!0});const L={ignoreErrors:!0};let k;const I=async u=>{try{let t=await l.managers.apiManager.invokeApi("auth.exportLoginToken",{api_id:P.id,api_hash:P.hash,except_ids:[]},{ignoreErrors:!0});if(t._==="auth.loginTokenMigrateTo"&&(L.dcId||(L.dcId=t.dc_id,l.managers.apiManager.setBaseDcId(t.dc_id)),t=await l.managers.apiManager.invokeApi("auth.importLoginToken",{token:t.token},L)),t._==="auth.loginTokenSuccess"){const p=t.authorization;return await l.managers.apiManager.setUser(p.user),y(()=>import("./pageIm-wngHxkKH.js"),__vite__mapDeps([12,1,2,4]),import.meta.url).then(f=>f.default.mount()),!0}if(!k||!N(k,t.token)){k=t.token;const p=K(t.token),f="tg://login?token="+J(p,!0),w=window.getComputedStyle(document.documentElement),q=w.getPropertyValue("--surface-color").trim(),B=w.getPropertyValue("--primary-text-color").trim(),D=w.getPropertyValue("--primary-color").trim(),M=await fetch("assets/img/logo_padded.svg").then(n=>n.text()).then(n=>(n=n.replace(/(fill:).+?(;)/,`$1${D}$2`),j(n))),_=new x({width:240*window.devicePixelRatio,height:240*window.devicePixelRatio,data:f,image:M,dotsOptions:{color:B,type:"rounded"},cornersSquareOptions:{type:"extra-rounded"},imageOptions:{imageSize:1,margin:0},backgroundOptions:{color:q},qrOptions:{errorCorrectionLevel:"L"}});_.append(a),a.lastChild.classList.add("qr-canvas");let v;_._drawingPromise?v=_._drawingPromise:v=Promise.race([C(1e3),new Promise(n=>{_._canvas._image.addEventListener("load",()=>{window.requestAnimationFrame(()=>n())},{once:!0})})]),await v.then(()=>{if(c){c.style.animation="hide-icon .4s forwards";const n=a.children[1];n.style.display="none",n.style.animation="grow-icon .4s forwards",setTimeout(()=>{n.style.display=""},150),setTimeout(()=>{n.style.animation=""},500),c=void 0}else Array.from(a.children).slice(0,-1).forEach(n=>{n.remove()})})}if(u){const p=Date.now()/1e3,f=t.expires-p-await l.managers.timeManager.getServerTimeOffset();await C(f>b?1e3*b:1e3*f|0)}}catch(t){switch(t.type){case"SESSION_PASSWORD_NEEDED":t.handled=!0,y(()=>import("./pagePassword-q_GU3dwQ.js"),__vite__mapDeps([13,1,2,3,4,6,14,7,15]),import.meta.url).then(p=>p.default.mount()),m=!0,h=null;break;default:console.error("pageSignQR: default error:",t),m=!0;break}return!0}return!1};return async()=>{m=!1;do if(m||await I(!0))break;while(!0)}};let h;const A=new H("page-signQR",!0,()=>h,()=>{h||(h=X()),h.then(e=>{e()}),l.managers.appStateManager.pushToState("authState",{_:"authStateSignQr"})}),re=Object.freeze(Object.defineProperty({__proto__:null,default:A},Symbol.toStringTag,{value:"Module"}));export{re as a,G as g,A as p};
+//# sourceMappingURL=pageSignQR-VxURk7YO.js.map
 function __vite__mapDeps(indexes) {
   if (!__vite__mapDeps.viteFileDeps) {
-    __vite__mapDeps.viteFileDeps = ["./pageSignIn-pfbmi0Ny.js","./index-XZA1-3MU.js","./index-pzR5gIOz.css","./putPreloader--f-Xu9AG.js","./page-eb81Un_i.js","./countryInputField-Rr6PHiIn.js","./button-aS2SE0kp.js","./wrapEmojiText-pejq-WF4.js","./scrollable-OU41biYL.js","./textToSvgURL-Z4O-nL1S.js","./qr-code-styling-ogpV7fl-.js","./_commonjsHelpers-5-cIlDoe.js","./pageIm-2VO8DGq9.js","./pagePassword-wGJb-e9C.js","./htmlToSpan-52gQDcFu.js","./loginPage-EKVIJLjo.js"]
+    __vite__mapDeps.viteFileDeps = ["./pageSignIn-N45VQ3GF.js","./index-M8z-nwNm.js","./index-pzR5gIOz.css","./putPreloader-jxB4tqkF.js","./page-kT6kVFv9.js","./countryInputField-tqY1KpER.js","./button-Mm7TqKr1.js","./wrapEmojiText-PAHdiQbe.js","./scrollable-ILmNatrX.js","./textToSvgURL-Z4O-nL1S.js","./qr-code-styling-ogpV7fl-.js","./_commonjsHelpers-5-cIlDoe.js","./pageIm-wngHxkKH.js","./pagePassword-q_GU3dwQ.js","./htmlToSpan-BQ96zqgl.js","./loginPage-0kq1JorQ.js"]
   }
   return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
 }
\ No newline at end of file

--- public/pageSignQR-VxURk7YO.js.map ---
@@ -1 +1 @@
-{"version":3,"mappings":"4RAeA,IAAIA,EAAM,GAEV,SAASC,GAA6F,CACjG,OAAAC,IACIA,EAAgBC,EAAU,SAAS,WAAW,YAAY,KAAMC,GAClEA,EAAO,sBAAwBC,EAAK,sBAG9B,QAAQ,IAAI,CACjBD,EACAC,EAAK,WAAWD,EAAO,oBAAqB,CAAC,0BAA0B,CAAC,EACxEC,EAAK,iBAAiB,EACvB,EAEM,EAEV,EACH,CAEA,IAAIH,EAEJ,SAAwBI,EAAwBC,EAAuB,CAClEP,GACHC,IAAU,KAAK,CAAC,CAACG,EAAQI,CAAO,IAAM,CACpC,GAAG,CAACJ,EACF,OAGF,MAAMK,EAA2B,GACzBD,EAAA,QAASE,GAAW,CAC1B,MAAMC,EAAeN,EAAK,QAAQ,IAAIK,EAAO,GAAkB,EAC3DC,IAIJF,EAAO,KAAKE,CAAY,EACxBN,EAAK,QAAQ,IAAIK,EAAO,IAAoBA,CAAM,GACnD,EAED,MAAME,EAAmB,2BACnBC,EAAoBC,EAAO,4DAA6D,CAAC,KAAMF,EAAI,EACvFC,EAAA,iBAAiB,UAAU,OAAO,MAAM,EAC1DE,EAAU,CAAC,KAAM,CAACV,EAAK,OAAOO,EAAK,EAAI,CAAC,CAAC,CAAC,EAAE,KAAK,IAAM,CACrD,OAAO,sBAAsB,IAAM,CACjCL,EAAS,OAAOM,CAAiB,EAClC,EACF,EAESV,EAAA,iBAAiB,kBAAmB,IAAM,CAClDU,EAAkB,OAAO,GACxB,CAAC,KAAM,GAAK,EAERJ,EAAA,QAASC,GAAW,CACzBL,EAAK,QAAQ,IAAIK,EAAO,IAAoBA,CAAM,EACnD,EAEgBM,EAAAH,EAAoBI,GAAM,CACzCC,EAAYD,CAAC,EAEPjB,EAAA,GAENa,EAAkB,SAAW,GAC7BM,EAAaN,CAAiB,EAEzBR,EAAA,YAAYD,EAAO,mBAAmB,EAC5C,EACF,CACH,CClFwB,SAAAgB,EAAgBC,EAAaC,EAAgB,CACnE,OAAGA,EACMD,EAAI,QAAQ,MAAO,GAAG,EAAE,QAAQ,MAAO,GAAG,EAAE,QAAQ,OAAQ,EAAE,EAE9DA,EAAI,QAAQ,KAAM,GAAG,EAAE,QAAQ,KAAM,GAAG,CAEnD,CCNA,SAAwBE,EAAcC,EAA8B,CAC9D,IAAAC,EACAC,EAAS,GAEL,QAAAC,EAAOH,EAAM,OAAQI,EAAU,EAAGC,EAAO,EAAGA,EAAOF,EAAM,EAAEE,EACjEJ,EAAOI,EAAO,EACdD,GAAWJ,EAAMK,CAAI,IAAM,KAAOJ,EAAO,KACtCA,IAAS,GAAKE,EAAOE,IAAS,KAC/BH,GAAU,OAAO,aACfI,EAAcF,IAAY,GAAK,EAAE,EACjCE,EAAcF,IAAY,GAAK,EAAE,EACjCE,EAAcF,IAAY,EAAI,EAAE,EAChCE,EAAcF,EAAU,EAAE,GAElBA,EAAA,GAIP,OAAAF,EAAO,QAAQ,aAAc,GAAG,CACzC,CAEO,SAASI,EAAcC,EAAgB,CAC5C,OAAOA,EAAS,GACdA,EAAS,GACTA,EAAS,GACPA,EAAS,GACTA,EAAS,GACPA,EAAS,EACTA,IAAW,GACT,GACAA,IAAW,GACT,GACA,EACZ,CCZA,MAAMC,EAAiB,EAEjBC,EAAe,SAAW,CAExB,MAAAC,EADcC,EAAK,OACI,cAAc,aAAa,EAEpD,IAAAC,EAAYjB,EAAae,EAAU,EAAI,EAErC,MAAAG,EAAe,SAAS,cAAc,KAAK,EACpCA,EAAA,UAAU,IAAI,eAAe,EAE1C,MAAMC,EAAUxB,EAAO,4DAA6D,CAAC,KAAM,kBAAkB,EAC7GuB,EAAa,OAAOC,CAAO,EAE3BhC,EAAwB+B,CAAY,EAEpC,MAAME,EAAYL,EAAS,cAErBM,EAAK,SAAS,cAAc,IAAI,EACtCC,EAAMD,EAAI,gBAAgB,EAEpB,MAAAE,EAAW,SAAS,cAAc,IAAI,EACnCA,EAAA,UAAU,IAAI,gBAAgB,EACtC,CAAC,iBAAkB,iBAAkB,gBAAgB,EAAoB,QAAS9B,GAAQ,CACnF,MAAA+B,EAAK,SAAS,cAAc,IAAI,EACnCA,EAAA,OAAOC,EAAKhC,CAAG,CAAC,EACnB8B,EAAS,OAAOC,CAAE,EACnB,EAESJ,EAAA,OAAOC,EAAIE,EAAUL,CAAY,EAEnCC,EAAA,iBAAiB,QAAS,IAAM,CAC/BO,EAAA,qCAAc,0DAAE,KAAMC,GAAMA,EAAE,QAAQ,OAAO,EAC7CC,EAAA,GACR,EAKK,MAAAC,GAHU,MAAM,QAAQ,IAAI,CAChCH,EAAA,WAAO,+BAAwB,OAAAI,KAAA,6CAChC,GAC6B,CAAC,EAAE,QAEjC,IAAIF,EAAO,GACD5C,EAAA,iBAAiB,YAAa,IAAM,CACrC4C,EAAA,GACS7C,EAAA,MACf,CAAC,KAAM,GAAK,EAET,MAAAgD,EAA6C,CAAC,aAAc,IAC9D,IAAAC,EAEE,MAAAC,EAAU,MAAMC,GAAoB,CACpC,IACF,IAAIC,EAAa,MAAMnD,EAAU,SAAS,WAAW,UAAU,wBAAyB,CACtF,OAAQoD,EAAI,GACZ,SAAUA,EAAI,KACd,WAAY,CAAC,GACZ,CAAC,aAAc,GAAK,EAcpB,GAZAD,EAAW,IAAM,6BACdJ,EAAQ,OACVA,EAAQ,KAAOI,EAAW,MAC1BnD,EAAU,SAAS,WAAW,YAAYmD,EAAW,KAAK,GAI5DA,EAAa,MAAMnD,EAAU,SAAS,WAAW,UAAU,wBAAyB,CAClF,MAAOmD,EAAW,OACjBJ,CAAO,GAGTI,EAAW,IAAM,yBAA0B,CAC5C,MAAME,EAAgBF,EAAW,cACjC,aAAMnD,EAAU,SAAS,WAAW,QAAQqD,EAAc,IAAI,EACvDX,EAAA,iCAAU,+CAAE,KAAMC,GAAMA,EAAE,QAAQ,OAAO,EACzC,EACT,CAMA,GAAG,CAACK,GAAa,CAACM,EAASN,EAAWG,EAAW,KAAK,EAAG,CACvDH,EAAYG,EAAW,MAEjB,MAAAI,EAAUnC,EAAc+B,EAAW,KAAK,EACxCK,EAAM,oBAAsBvC,EAAgBsC,EAAS,EAAI,EAEzDE,EAAQ,OAAO,iBAAiB,SAAS,eAAe,EACxDC,EAAeD,EAAM,iBAAiB,iBAAiB,EAAE,KAAK,EAC9DE,EAAYF,EAAM,iBAAiB,sBAAsB,EAAE,KAAK,EAChEG,EAAeH,EAAM,iBAAiB,iBAAiB,EAAE,KAAK,EAE9DI,EAAU,MAAM,MAAM,4BAA4B,EACvD,KAAMC,GAAQA,EAAI,KAAM,GACxB,KAAMC,IACLA,EAAOA,EAAK,QAAQ,gBAAiB,KAAKH,CAAY,IAAI,EACnDI,EAAaD,CAAI,EACzB,EAEKE,EAAS,IAAIpB,EAAc,CAC/B,MAAO,IAAM,OAAO,iBACpB,OAAQ,IAAM,OAAO,iBACrB,KAAMW,EACN,MAAOK,EACP,YAAa,CACX,MAAOF,EACP,KAAM,SACR,EACA,qBAAsB,CACpB,KAAM,eACR,EACA,aAAc,CACZ,UAAW,EACX,OAAQ,CACV,EACA,kBAAmB,CACjB,MAAOD,CACT,EACA,UAAW,CACT,qBAAsB,GACxB,EACD,EAEDO,EAAO,OAAOlC,CAAQ,EACrBA,EAAS,UAAgC,UAAU,IAAI,WAAW,EAE/D,IAAAmC,EACDD,EAAO,gBACRC,EAAUD,EAAO,gBAEjBC,EAAU,QAAQ,KAAK,CACrBC,EAAM,GAAI,EACV,IAAI,QAAeC,GAAY,CAC7BH,EAAO,QAAQ,OAAO,iBAAiB,OAAQ,IAAM,CAC5C,6BAAsB,IAAMG,EAAA,CAAS,GAC3C,CAAC,KAAM,GAAK,EAChB,EACF,EAIG,MAAAF,EAAQ,KAAK,IAAM,CACvB,GAAGjC,EAAW,CACZA,EAAU,MAAM,UAAY,yBAEtB,MAAAoC,EAAItC,EAAS,SAAS,CAAC,EAC7BsC,EAAE,MAAM,QAAU,OAClBA,EAAE,MAAM,UAAY,yBACpB,WAAW,IAAM,CACfA,EAAE,MAAM,QAAU,IACjB,GAAG,EAEN,WAAW,IAAM,CACfA,EAAE,MAAM,UAAY,IACnB,GAAG,EACMpC,EAAA,YAEN,WAAKF,EAAS,QAAQ,EAAE,MAAM,EAAG,EAAE,EAAE,QAASuC,GAAO,CACzDA,EAAG,OAAO,EACX,CACH,CACD,CACH,CAEA,GAAGpB,EAAQ,CACH,MAAAqB,EAAY,KAAK,MAAQ,IACzBC,EAAOrB,EAAW,QAAUoB,EAAY,MAAMvE,EAAU,SAAS,YAAY,sBAEnF,MAAMmE,EAAMK,EAAO3C,EAAiB,IAAMA,EAAiB,IAAM2C,EAAO,CAAC,CAC3E,QACMC,EAAK,CACX,OAAQA,EAAiB,KAAM,CAC7B,IAAK,0BACFA,EAAiB,QAAU,GACrB/B,EAAA,uCAAgB,2DAAE,KAAMC,GAAMA,EAAE,QAAQ,OAAO,EAC/CC,EAAA,GACS7C,EAAA,KAChB,MACF,QACU,cAAM,6BAA8B0E,CAAG,EACxC7B,EAAA,GACP,KACJ,CAEO,QACT,CAEO,UAKT,MAAO,UAAW,CACTA,EAAA,GAEJ,EAMD,IALGA,GAIe,MAAMK,EAAQ,EAAI,EAElC,YAEI,IAEZ,EAEA,IAAIlD,EACJ,MAAMiC,EAAO,IAAI0C,EAAK,cAAe,GAAM,IAClC3E,EACN,IAAM,CAEHA,IAAeA,EAAgB+B,EAAa,GAClC/B,EAAA,KAAM4E,GAAS,CACtBA,GAAA,CACN,EAED3E,EAAU,SAAS,gBAAgB,YAAY,YAAa,CAAC,EAAG,kBAAkB,CACpF,CAAC","names":["set","getLang","cachedPromise","rootScope","config","I18n","getLanguageChangeButton","appendTo","strings","backup","string","backupString","key","btnChangeLanguage","Button","loadFonts","attachClickEvent","e","cancelEvent","putPreloader","fixBase64String","str","toUrl","bytesToBase64","bytes","mod3","result","nLen","nUint24","nIdx","uint6ToBase64","nUint6","FETCH_INTERVAL","onFirstMount","imageDiv","page","preloader","inputWrapper","btnBack","container","h4","_i18n","helpList","li","i18n","__vitePreload","m","stop","QRCodeStyling","n","options","prevToken","iterate","isLoop","loginToken","App","authorization","bytesCmp","encoded","url","style","surfaceColor","textColor","primaryColor","logoUrl","res","text","textToSvgURL","qrCode","promise","pause","resolve","c","el","timestamp","diff","err","Page","func"],"sources":["../src/components/languageChangeButton.ts","../src/helpers/fixBase64String.ts","../src/helpers/bytes/bytesToBase64.ts","../src/pages/pageSignQR.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport cancelEvent from '../helpers/dom/cancelEvent';\nimport {attachClickEvent} from '../helpers/dom/clickEvent';\nimport loadFonts from '../helpers/dom/loadFonts';\nimport {Config, LangPackDifference, LangPackString} from '../layer';\nimport I18n, {LangPackKey} from '../lib/langPack';\nimport rootScope from '../lib/rootScope';\nimport Button from './button';\nimport {putPreloader} from './putPreloader';\n\nlet set = false;\n\nfunction getLang(): Promise<[Config.config, LangPackString[], LangPackDifference.langPackDifference]> {\n  if(cachedPromise) return cachedPromise;\n  return cachedPromise = rootScope.managers.apiManager.getConfig().then((config) => {\n    if(config.suggested_lang_code !== I18n.lastRequestedLangCode) {\n      // I18n.loadLangPack(config.suggested_lang_code);\n\n      return Promise.all([\n        config,\n        I18n.getStrings(config.suggested_lang_code, ['Login.ContinueOnLanguage']),\n        I18n.getCacheLangPack()\n      ]);\n    } else {\n      return [] as any;\n    }\n  });\n}\n\nlet cachedPromise: ReturnType<typeof getLang>;\n\nexport default function getLanguageChangeButton(appendTo: HTMLElement) {\n  if(set) return;\n  getLang().then(([config, strings]) => {\n    if(!config) {\n      return;\n    }\n\n    const backup: LangPackString[] = [];\n    strings.forEach((string) => {\n      const backupString = I18n.strings.get(string.key as LangPackKey);\n      if(!backupString) {\n        return;\n      }\n\n      backup.push(backupString);\n      I18n.strings.set(string.key as LangPackKey, string);\n    });\n\n    const key: LangPackKey = 'Login.ContinueOnLanguage';\n    const btnChangeLanguage = Button('btn-primary btn-secondary btn-primary-transparent primary', {text: key});\n    btnChangeLanguage.lastElementChild.classList.remove('i18n'); // prevent changing language\n    loadFonts({text: [I18n.format(key, true)]}).then(() => {\n      window.requestAnimationFrame(() => {\n        appendTo.append(btnChangeLanguage);\n      });\n    });\n\n    rootScope.addEventListener('language_change', () => {\n      btnChangeLanguage.remove();\n    }, {once: true});\n\n    backup.forEach((string) => {\n      I18n.strings.set(string.key as LangPackKey, string);\n    });\n\n    attachClickEvent(btnChangeLanguage, (e) => {\n      cancelEvent(e);\n\n      set = true;\n\n      btnChangeLanguage.disabled = true;\n      putPreloader(btnChangeLanguage);\n\n      I18n.getLangPack(config.suggested_lang_code);\n    });\n  });\n}\n","export default function fixBase64String(str: string, toUrl: boolean) {\n  if(toUrl) {\n    return str.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/\\=+$/, '');\n  } else {\n    return str.replace(/-/g, '+').replace(/_/g, '/');\n  }\n}\n","export default function bytesToBase64(bytes: number[] | Uint8Array) {\n  let mod3: number;\n  let result = '';\n\n  for(let nLen = bytes.length, nUint24 = 0, nIdx = 0; nIdx < nLen; ++nIdx) {\n    mod3 = nIdx % 3;\n    nUint24 |= bytes[nIdx] << (16 >>> mod3 & 24);\n    if(mod3 === 2 || nLen - nIdx === 1) {\n      result += String.fromCharCode(\n        uint6ToBase64(nUint24 >>> 18 & 63),\n        uint6ToBase64(nUint24 >>> 12 & 63),\n        uint6ToBase64(nUint24 >>> 6 & 63),\n        uint6ToBase64(nUint24 & 63)\n      );\n      nUint24 = 0;\n    }\n  }\n\n  return result.replace(/A(?=A$|$)/g, '=');\n}\n\nexport function uint6ToBase64(nUint6: number) {\n  return nUint6 < 26 ?\n    nUint6 + 65 :\n    nUint6 < 52 ?\n      nUint6 + 71 :\n      nUint6 < 62 ?\n        nUint6 - 4 :\n        nUint6 === 62 ?\n          43 :\n          nUint6 === 63 ?\n            47 :\n            65;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type {DcId} from '../types';\nimport Page from './page';\nimport {AuthAuthorization, AuthLoginToken} from '../layer';\nimport App from '../config/app';\nimport Button from '../components/button';\nimport {_i18n, i18n, LangPackKey} from '../lib/langPack';\nimport rootScope from '../lib/rootScope';\nimport {putPreloader} from '../components/putPreloader';\nimport getLanguageChangeButton from '../components/languageChangeButton';\nimport pause from '../helpers/schedulers/pause';\nimport fixBase64String from '../helpers/fixBase64String';\nimport bytesCmp from '../helpers/bytes/bytesCmp';\nimport bytesToBase64 from '../helpers/bytes/bytesToBase64';\nimport textToSvgURL from '../helpers/textToSvgURL';\n\nconst FETCH_INTERVAL = 3;\n\nconst onFirstMount = async() => {\n  const pageElement = page.pageEl;\n  const imageDiv = pageElement.querySelector('.auth-image') as HTMLDivElement;\n\n  let preloader = putPreloader(imageDiv, true);\n\n  const inputWrapper = document.createElement('div');\n  inputWrapper.classList.add('input-wrapper');\n\n  const btnBack = Button('btn-primary btn-secondary btn-primary-transparent primary', {text: 'Login.QR.Cancel'});\n  inputWrapper.append(btnBack);\n\n  getLanguageChangeButton(inputWrapper);\n\n  const container = imageDiv.parentElement;\n\n  const h4 = document.createElement('h4');\n  _i18n(h4, 'Login.QR.Title');\n\n  const helpList = document.createElement('ol');\n  helpList.classList.add('qr-description');\n  (['Login.QR.Help1', 'Login.QR.Help2', 'Login.QR.Help3'] as LangPackKey[]).forEach((key) => {\n    const li = document.createElement('li');\n    li.append(i18n(key));\n    helpList.append(li);\n  });\n\n  container.append(h4, helpList, inputWrapper);\n\n  btnBack.addEventListener('click', () => {\n    import('./pageSignIn').then((m) => m.default.mount());\n    stop = true;\n  });\n\n  const results = await Promise.all([\n    import('qr-code-styling' as any)\n  ]);\n  const QRCodeStyling = results[0].default;\n\n  let stop = false;\n  rootScope.addEventListener('user_auth', () => {\n    stop = true;\n    cachedPromise = null;\n  }, {once: true});\n\n  const options: {dcId?: DcId, ignoreErrors: true} = {ignoreErrors: true};\n  let prevToken: Uint8Array | number[];\n\n  const iterate = async(isLoop: boolean) => {\n    try {\n      let loginToken = await rootScope.managers.apiManager.invokeApi('auth.exportLoginToken', {\n        api_id: App.id,\n        api_hash: App.hash,\n        except_ids: []\n      }, {ignoreErrors: true});\n\n      if(loginToken._ === 'auth.loginTokenMigrateTo') {\n        if(!options.dcId) {\n          options.dcId = loginToken.dc_id as DcId;\n          rootScope.managers.apiManager.setBaseDcId(loginToken.dc_id);\n          // continue;\n        }\n\n        loginToken = await rootScope.managers.apiManager.invokeApi('auth.importLoginToken', {\n          token: loginToken.token\n        }, options) as AuthLoginToken.authLoginToken;\n      }\n\n      if(loginToken._ === 'auth.loginTokenSuccess') {\n        const authorization = loginToken.authorization as any as AuthAuthorization.authAuthorization;\n        await rootScope.managers.apiManager.setUser(authorization.user);\n        import('./pageIm').then((m) => m.default.mount());\n        return true;\n      }\n\n      /* // to base64\n      var decoder = new TextDecoder('utf8');\n      var b64encoded = btoa(String.fromCharCode.apply(null, [...loginToken.token])); */\n\n      if(!prevToken || !bytesCmp(prevToken, loginToken.token)) {\n        prevToken = loginToken.token;\n\n        const encoded = bytesToBase64(loginToken.token);\n        const url = 'tg://login?token=' + fixBase64String(encoded, true);\n\n        const style = window.getComputedStyle(document.documentElement);\n        const surfaceColor = style.getPropertyValue('--surface-color').trim();\n        const textColor = style.getPropertyValue('--primary-text-color').trim();\n        const primaryColor = style.getPropertyValue('--primary-color').trim();\n\n        const logoUrl = await fetch('assets/img/logo_padded.svg')\n        .then((res) => res.text())\n        .then((text) => {\n          text = text.replace(/(fill:).+?(;)/, `$1${primaryColor}$2`);\n          return textToSvgURL(text);\n        });\n\n        const qrCode = new QRCodeStyling({\n          width: 240 * window.devicePixelRatio,\n          height: 240 * window.devicePixelRatio,\n          data: url,\n          image: logoUrl,\n          dotsOptions: {\n            color: textColor,\n            type: 'rounded'\n          },\n          cornersSquareOptions: {\n            type: 'extra-rounded'\n          },\n          imageOptions: {\n            imageSize: 1,\n            margin: 0\n          },\n          backgroundOptions: {\n            color: surfaceColor\n          },\n          qrOptions: {\n            errorCorrectionLevel: 'L'\n          }\n        });\n\n        qrCode.append(imageDiv);\n        (imageDiv.lastChild as HTMLCanvasElement).classList.add('qr-canvas');\n\n        let promise: Promise<void>;\n        if(qrCode._drawingPromise) {\n          promise = qrCode._drawingPromise;\n        } else {\n          promise = Promise.race([\n            pause(1000),\n            new Promise<void>((resolve) => {\n              qrCode._canvas._image.addEventListener('load', () => {\n                window.requestAnimationFrame(() => resolve());\n              }, {once: true});\n            })\n          ]);\n        }\n\n        // *  ,      \n        await promise.then(() => {\n          if(preloader) {\n            preloader.style.animation = 'hide-icon .4s forwards';\n\n            const c = imageDiv.children[1] as HTMLElement;\n            c.style.display = 'none';\n            c.style.animation = 'grow-icon .4s forwards';\n            setTimeout(() => {\n              c.style.display = '';\n            }, 150);\n\n            setTimeout(() => {\n              c.style.animation = '';\n            }, 500);\n            preloader = undefined;\n          } else {\n            Array.from(imageDiv.children).slice(0, -1).forEach((el) => {\n              el.remove();\n            });\n          }\n        });\n      }\n\n      if(isLoop) {\n        const timestamp = Date.now() / 1000;\n        const diff = loginToken.expires - timestamp - await rootScope.managers.timeManager.getServerTimeOffset();\n\n        await pause(diff > FETCH_INTERVAL ? 1e3 * FETCH_INTERVAL : 1e3 * diff | 0);\n      }\n    } catch(err) {\n      switch((err as ApiError).type) {\n        case 'SESSION_PASSWORD_NEEDED':\n          (err as ApiError).handled = true;\n          import('./pagePassword').then((m) => m.default.mount());\n          stop = true;\n          cachedPromise = null;\n          break;\n        default:\n          console.error('pageSignQR: default error:', err);\n          stop = true;\n          break;\n      }\n\n      return true;\n    }\n\n    return false;\n  };\n\n  // await iterate(false);\n\n  return async() => {\n    stop = false;\n\n    do {\n      if(stop) {\n        break;\n      }\n\n      const needBreak = await iterate(true);\n      if(needBreak) {\n        break;\n      }\n    } while(true);\n  };\n};\n\nlet cachedPromise: Promise<() => Promise<void>>;\nconst page = new Page('page-signQR', true, () => {\n  return cachedPromise;\n}, () => {\n  // console.log('onMount');\n  if(!cachedPromise) cachedPromise = onFirstMount();\n  cachedPromise.then((func) => {\n    func();\n  });\n\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStateSignQr'});\n});\n\nexport default page;\n"],"file":"pageSignQR-bI2rYqWN.js"}
\ No newline at end of file
+{"version":3,"mappings":"4RAeA,IAAIA,EAAM,GAEV,SAASC,GAA6F,CACjG,OAAAC,IACIA,EAAgBC,EAAU,SAAS,WAAW,YAAY,KAAMC,GAClEA,EAAO,sBAAwBC,EAAK,sBAG9B,QAAQ,IAAI,CACjBD,EACAC,EAAK,WAAWD,EAAO,oBAAqB,CAAC,0BAA0B,CAAC,EACxEC,EAAK,iBAAiB,EACvB,EAEM,EAEV,EACH,CAEA,IAAIH,EAEJ,SAAwBI,EAAwBC,EAAuB,CAClEP,GACHC,IAAU,KAAK,CAAC,CAACG,EAAQI,CAAO,IAAM,CACpC,GAAG,CAACJ,EACF,OAGF,MAAMK,EAA2B,GACzBD,EAAA,QAASE,GAAW,CAC1B,MAAMC,EAAeN,EAAK,QAAQ,IAAIK,EAAO,GAAkB,EAC3DC,IAIJF,EAAO,KAAKE,CAAY,EACxBN,EAAK,QAAQ,IAAIK,EAAO,IAAoBA,CAAM,GACnD,EAED,MAAME,EAAmB,2BACnBC,EAAoBC,EAAO,4DAA6D,CAAC,KAAMF,EAAI,EACvFC,EAAA,iBAAiB,UAAU,OAAO,MAAM,EAC1DE,EAAU,CAAC,KAAM,CAACV,EAAK,OAAOO,EAAK,EAAI,CAAC,CAAC,CAAC,EAAE,KAAK,IAAM,CACrD,OAAO,sBAAsB,IAAM,CACjCL,EAAS,OAAOM,CAAiB,EAClC,EACF,EAESV,EAAA,iBAAiB,kBAAmB,IAAM,CAClDU,EAAkB,OAAO,GACxB,CAAC,KAAM,GAAK,EAERJ,EAAA,QAASC,GAAW,CACzBL,EAAK,QAAQ,IAAIK,EAAO,IAAoBA,CAAM,EACnD,EAEgBM,EAAAH,EAAoBI,GAAM,CACzCC,EAAYD,CAAC,EAEPjB,EAAA,GAENa,EAAkB,SAAW,GAC7BM,EAAaN,CAAiB,EAEzBR,EAAA,YAAYD,EAAO,mBAAmB,EAC5C,EACF,CACH,CClFwB,SAAAgB,EAAgBC,EAAaC,EAAgB,CACnE,OAAGA,EACMD,EAAI,QAAQ,MAAO,GAAG,EAAE,QAAQ,MAAO,GAAG,EAAE,QAAQ,OAAQ,EAAE,EAE9DA,EAAI,QAAQ,KAAM,GAAG,EAAE,QAAQ,KAAM,GAAG,CAEnD,CCNA,SAAwBE,EAAcC,EAA8B,CAC9D,IAAAC,EACAC,EAAS,GAEL,QAAAC,EAAOH,EAAM,OAAQI,EAAU,EAAGC,EAAO,EAAGA,EAAOF,EAAM,EAAEE,EACjEJ,EAAOI,EAAO,EACdD,GAAWJ,EAAMK,CAAI,IAAM,KAAOJ,EAAO,KACtCA,IAAS,GAAKE,EAAOE,IAAS,KAC/BH,GAAU,OAAO,aACfI,EAAcF,IAAY,GAAK,EAAE,EACjCE,EAAcF,IAAY,GAAK,EAAE,EACjCE,EAAcF,IAAY,EAAI,EAAE,EAChCE,EAAcF,EAAU,EAAE,GAElBA,EAAA,GAIP,OAAAF,EAAO,QAAQ,aAAc,GAAG,CACzC,CAEO,SAASI,EAAcC,EAAgB,CAC5C,OAAOA,EAAS,GACdA,EAAS,GACTA,EAAS,GACPA,EAAS,GACTA,EAAS,GACPA,EAAS,EACTA,IAAW,GACT,GACAA,IAAW,GACT,GACA,EACZ,CCZA,MAAMC,EAAiB,EAEjBC,EAAe,SAAW,CAExB,MAAAC,EADcC,EAAK,OACI,cAAc,aAAa,EAEpD,IAAAC,EAAYjB,EAAae,EAAU,EAAI,EAErC,MAAAG,EAAe,SAAS,cAAc,KAAK,EACpCA,EAAA,UAAU,IAAI,eAAe,EAE1C,MAAMC,EAAUxB,EAAO,4DAA6D,CAAC,KAAM,kBAAkB,EAC7GuB,EAAa,OAAOC,CAAO,EAE3BhC,EAAwB+B,CAAY,EAEpC,MAAME,EAAYL,EAAS,cAErBM,EAAK,SAAS,cAAc,IAAI,EACtCC,EAAMD,EAAI,gBAAgB,EAEpB,MAAAE,EAAW,SAAS,cAAc,IAAI,EACnCA,EAAA,UAAU,IAAI,gBAAgB,EACtC,CAAC,iBAAkB,iBAAkB,gBAAgB,EAAoB,QAAS9B,GAAQ,CACnF,MAAA+B,EAAK,SAAS,cAAc,IAAI,EACnCA,EAAA,OAAOC,EAAKhC,CAAG,CAAC,EACnB8B,EAAS,OAAOC,CAAE,EACnB,EAESJ,EAAA,OAAOC,EAAIE,EAAUL,CAAY,EAEnCC,EAAA,iBAAiB,QAAS,IAAM,CAC/BO,EAAA,qCAAc,0DAAE,KAAMC,GAAMA,EAAE,QAAQ,OAAO,EAC7CC,EAAA,GACR,EAKK,MAAAC,GAHU,MAAM,QAAQ,IAAI,CAChCH,EAAA,WAAO,+BAAwB,OAAAI,KAAA,6CAChC,GAC6B,CAAC,EAAE,QAEjC,IAAIF,EAAO,GACD5C,EAAA,iBAAiB,YAAa,IAAM,CACrC4C,EAAA,GACS7C,EAAA,MACf,CAAC,KAAM,GAAK,EAET,MAAAgD,EAA6C,CAAC,aAAc,IAC9D,IAAAC,EAEE,MAAAC,EAAU,MAAMC,GAAoB,CACpC,IACF,IAAIC,EAAa,MAAMnD,EAAU,SAAS,WAAW,UAAU,wBAAyB,CACtF,OAAQoD,EAAI,GACZ,SAAUA,EAAI,KACd,WAAY,CAAC,GACZ,CAAC,aAAc,GAAK,EAcpB,GAZAD,EAAW,IAAM,6BACdJ,EAAQ,OACVA,EAAQ,KAAOI,EAAW,MAC1BnD,EAAU,SAAS,WAAW,YAAYmD,EAAW,KAAK,GAI5DA,EAAa,MAAMnD,EAAU,SAAS,WAAW,UAAU,wBAAyB,CAClF,MAAOmD,EAAW,OACjBJ,CAAO,GAGTI,EAAW,IAAM,yBAA0B,CAC5C,MAAME,EAAgBF,EAAW,cACjC,aAAMnD,EAAU,SAAS,WAAW,QAAQqD,EAAc,IAAI,EACvDX,EAAA,iCAAU,+CAAE,KAAMC,GAAMA,EAAE,QAAQ,OAAO,EACzC,EACT,CAMA,GAAG,CAACK,GAAa,CAACM,EAASN,EAAWG,EAAW,KAAK,EAAG,CACvDH,EAAYG,EAAW,MAEjB,MAAAI,EAAUnC,EAAc+B,EAAW,KAAK,EACxCK,EAAM,oBAAsBvC,EAAgBsC,EAAS,EAAI,EAEzDE,EAAQ,OAAO,iBAAiB,SAAS,eAAe,EACxDC,EAAeD,EAAM,iBAAiB,iBAAiB,EAAE,KAAK,EAC9DE,EAAYF,EAAM,iBAAiB,sBAAsB,EAAE,KAAK,EAChEG,EAAeH,EAAM,iBAAiB,iBAAiB,EAAE,KAAK,EAE9DI,EAAU,MAAM,MAAM,4BAA4B,EACvD,KAAMC,GAAQA,EAAI,KAAM,GACxB,KAAMC,IACLA,EAAOA,EAAK,QAAQ,gBAAiB,KAAKH,CAAY,IAAI,EACnDI,EAAaD,CAAI,EACzB,EAEKE,EAAS,IAAIpB,EAAc,CAC/B,MAAO,IAAM,OAAO,iBACpB,OAAQ,IAAM,OAAO,iBACrB,KAAMW,EACN,MAAOK,EACP,YAAa,CACX,MAAOF,EACP,KAAM,SACR,EACA,qBAAsB,CACpB,KAAM,eACR,EACA,aAAc,CACZ,UAAW,EACX,OAAQ,CACV,EACA,kBAAmB,CACjB,MAAOD,CACT,EACA,UAAW,CACT,qBAAsB,GACxB,EACD,EAEDO,EAAO,OAAOlC,CAAQ,EACrBA,EAAS,UAAgC,UAAU,IAAI,WAAW,EAE/D,IAAAmC,EACDD,EAAO,gBACRC,EAAUD,EAAO,gBAEjBC,EAAU,QAAQ,KAAK,CACrBC,EAAM,GAAI,EACV,IAAI,QAAeC,GAAY,CAC7BH,EAAO,QAAQ,OAAO,iBAAiB,OAAQ,IAAM,CAC5C,6BAAsB,IAAMG,EAAA,CAAS,GAC3C,CAAC,KAAM,GAAK,EAChB,EACF,EAIG,MAAAF,EAAQ,KAAK,IAAM,CACvB,GAAGjC,EAAW,CACZA,EAAU,MAAM,UAAY,yBAEtB,MAAAoC,EAAItC,EAAS,SAAS,CAAC,EAC7BsC,EAAE,MAAM,QAAU,OAClBA,EAAE,MAAM,UAAY,yBACpB,WAAW,IAAM,CACfA,EAAE,MAAM,QAAU,IACjB,GAAG,EAEN,WAAW,IAAM,CACfA,EAAE,MAAM,UAAY,IACnB,GAAG,EACMpC,EAAA,YAEN,WAAKF,EAAS,QAAQ,EAAE,MAAM,EAAG,EAAE,EAAE,QAASuC,GAAO,CACzDA,EAAG,OAAO,EACX,CACH,CACD,CACH,CAEA,GAAGpB,EAAQ,CACH,MAAAqB,EAAY,KAAK,MAAQ,IACzBC,EAAOrB,EAAW,QAAUoB,EAAY,MAAMvE,EAAU,SAAS,YAAY,sBAEnF,MAAMmE,EAAMK,EAAO3C,EAAiB,IAAMA,EAAiB,IAAM2C,EAAO,CAAC,CAC3E,QACMC,EAAK,CACX,OAAQA,EAAiB,KAAM,CAC7B,IAAK,0BACFA,EAAiB,QAAU,GACrB/B,EAAA,uCAAgB,2DAAE,KAAMC,GAAMA,EAAE,QAAQ,OAAO,EAC/CC,EAAA,GACS7C,EAAA,KAChB,MACF,QACU,cAAM,6BAA8B0E,CAAG,EACxC7B,EAAA,GACP,KACJ,CAEO,QACT,CAEO,UAKT,MAAO,UAAW,CACTA,EAAA,GAEJ,EAMD,IALGA,GAIe,MAAMK,EAAQ,EAAI,EAElC,YAEI,IAEZ,EAEA,IAAIlD,EACJ,MAAMiC,EAAO,IAAI0C,EAAK,cAAe,GAAM,IAClC3E,EACN,IAAM,CAEHA,IAAeA,EAAgB+B,EAAa,GAClC/B,EAAA,KAAM4E,GAAS,CACtBA,GAAA,CACN,EAED3E,EAAU,SAAS,gBAAgB,YAAY,YAAa,CAAC,EAAG,kBAAkB,CACpF,CAAC","names":["set","getLang","cachedPromise","rootScope","config","I18n","getLanguageChangeButton","appendTo","strings","backup","string","backupString","key","btnChangeLanguage","Button","loadFonts","attachClickEvent","e","cancelEvent","putPreloader","fixBase64String","str","toUrl","bytesToBase64","bytes","mod3","result","nLen","nUint24","nIdx","uint6ToBase64","nUint6","FETCH_INTERVAL","onFirstMount","imageDiv","page","preloader","inputWrapper","btnBack","container","h4","_i18n","helpList","li","i18n","__vitePreload","m","stop","QRCodeStyling","n","options","prevToken","iterate","isLoop","loginToken","App","authorization","bytesCmp","encoded","url","style","surfaceColor","textColor","primaryColor","logoUrl","res","text","textToSvgURL","qrCode","promise","pause","resolve","c","el","timestamp","diff","err","Page","func"],"sources":["../src/components/languageChangeButton.ts","../src/helpers/fixBase64String.ts","../src/helpers/bytes/bytesToBase64.ts","../src/pages/pageSignQR.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport cancelEvent from '../helpers/dom/cancelEvent';\nimport {attachClickEvent} from '../helpers/dom/clickEvent';\nimport loadFonts from '../helpers/dom/loadFonts';\nimport {Config, LangPackDifference, LangPackString} from '../layer';\nimport I18n, {LangPackKey} from '../lib/langPack';\nimport rootScope from '../lib/rootScope';\nimport Button from './button';\nimport {putPreloader} from './putPreloader';\n\nlet set = false;\n\nfunction getLang(): Promise<[Config.config, LangPackString[], LangPackDifference.langPackDifference]> {\n  if(cachedPromise) return cachedPromise;\n  return cachedPromise = rootScope.managers.apiManager.getConfig().then((config) => {\n    if(config.suggested_lang_code !== I18n.lastRequestedLangCode) {\n      // I18n.loadLangPack(config.suggested_lang_code);\n\n      return Promise.all([\n        config,\n        I18n.getStrings(config.suggested_lang_code, ['Login.ContinueOnLanguage']),\n        I18n.getCacheLangPack()\n      ]);\n    } else {\n      return [] as any;\n    }\n  });\n}\n\nlet cachedPromise: ReturnType<typeof getLang>;\n\nexport default function getLanguageChangeButton(appendTo: HTMLElement) {\n  if(set) return;\n  getLang().then(([config, strings]) => {\n    if(!config) {\n      return;\n    }\n\n    const backup: LangPackString[] = [];\n    strings.forEach((string) => {\n      const backupString = I18n.strings.get(string.key as LangPackKey);\n      if(!backupString) {\n        return;\n      }\n\n      backup.push(backupString);\n      I18n.strings.set(string.key as LangPackKey, string);\n    });\n\n    const key: LangPackKey = 'Login.ContinueOnLanguage';\n    const btnChangeLanguage = Button('btn-primary btn-secondary btn-primary-transparent primary', {text: key});\n    btnChangeLanguage.lastElementChild.classList.remove('i18n'); // prevent changing language\n    loadFonts({text: [I18n.format(key, true)]}).then(() => {\n      window.requestAnimationFrame(() => {\n        appendTo.append(btnChangeLanguage);\n      });\n    });\n\n    rootScope.addEventListener('language_change', () => {\n      btnChangeLanguage.remove();\n    }, {once: true});\n\n    backup.forEach((string) => {\n      I18n.strings.set(string.key as LangPackKey, string);\n    });\n\n    attachClickEvent(btnChangeLanguage, (e) => {\n      cancelEvent(e);\n\n      set = true;\n\n      btnChangeLanguage.disabled = true;\n      putPreloader(btnChangeLanguage);\n\n      I18n.getLangPack(config.suggested_lang_code);\n    });\n  });\n}\n","export default function fixBase64String(str: string, toUrl: boolean) {\n  if(toUrl) {\n    return str.replace(/\\+/g, '-').replace(/\\//g, '_').replace(/\\=+$/, '');\n  } else {\n    return str.replace(/-/g, '+').replace(/_/g, '/');\n  }\n}\n","export default function bytesToBase64(bytes: number[] | Uint8Array) {\n  let mod3: number;\n  let result = '';\n\n  for(let nLen = bytes.length, nUint24 = 0, nIdx = 0; nIdx < nLen; ++nIdx) {\n    mod3 = nIdx % 3;\n    nUint24 |= bytes[nIdx] << (16 >>> mod3 & 24);\n    if(mod3 === 2 || nLen - nIdx === 1) {\n      result += String.fromCharCode(\n        uint6ToBase64(nUint24 >>> 18 & 63),\n        uint6ToBase64(nUint24 >>> 12 & 63),\n        uint6ToBase64(nUint24 >>> 6 & 63),\n        uint6ToBase64(nUint24 & 63)\n      );\n      nUint24 = 0;\n    }\n  }\n\n  return result.replace(/A(?=A$|$)/g, '=');\n}\n\nexport function uint6ToBase64(nUint6: number) {\n  return nUint6 < 26 ?\n    nUint6 + 65 :\n    nUint6 < 52 ?\n      nUint6 + 71 :\n      nUint6 < 62 ?\n        nUint6 - 4 :\n        nUint6 === 62 ?\n          43 :\n          nUint6 === 63 ?\n            47 :\n            65;\n}\n","/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type {DcId} from '../types';\nimport Page from './page';\nimport {AuthAuthorization, AuthLoginToken} from '../layer';\nimport App from '../config/app';\nimport Button from '../components/button';\nimport {_i18n, i18n, LangPackKey} from '../lib/langPack';\nimport rootScope from '../lib/rootScope';\nimport {putPreloader} from '../components/putPreloader';\nimport getLanguageChangeButton from '../components/languageChangeButton';\nimport pause from '../helpers/schedulers/pause';\nimport fixBase64String from '../helpers/fixBase64String';\nimport bytesCmp from '../helpers/bytes/bytesCmp';\nimport bytesToBase64 from '../helpers/bytes/bytesToBase64';\nimport textToSvgURL from '../helpers/textToSvgURL';\n\nconst FETCH_INTERVAL = 3;\n\nconst onFirstMount = async() => {\n  const pageElement = page.pageEl;\n  const imageDiv = pageElement.querySelector('.auth-image') as HTMLDivElement;\n\n  let preloader = putPreloader(imageDiv, true);\n\n  const inputWrapper = document.createElement('div');\n  inputWrapper.classList.add('input-wrapper');\n\n  const btnBack = Button('btn-primary btn-secondary btn-primary-transparent primary', {text: 'Login.QR.Cancel'});\n  inputWrapper.append(btnBack);\n\n  getLanguageChangeButton(inputWrapper);\n\n  const container = imageDiv.parentElement;\n\n  const h4 = document.createElement('h4');\n  _i18n(h4, 'Login.QR.Title');\n\n  const helpList = document.createElement('ol');\n  helpList.classList.add('qr-description');\n  (['Login.QR.Help1', 'Login.QR.Help2', 'Login.QR.Help3'] as LangPackKey[]).forEach((key) => {\n    const li = document.createElement('li');\n    li.append(i18n(key));\n    helpList.append(li);\n  });\n\n  container.append(h4, helpList, inputWrapper);\n\n  btnBack.addEventListener('click', () => {\n    import('./pageSignIn').then((m) => m.default.mount());\n    stop = true;\n  });\n\n  const results = await Promise.all([\n    import('qr-code-styling' as any)\n  ]);\n  const QRCodeStyling = results[0].default;\n\n  let stop = false;\n  rootScope.addEventListener('user_auth', () => {\n    stop = true;\n    cachedPromise = null;\n  }, {once: true});\n\n  const options: {dcId?: DcId, ignoreErrors: true} = {ignoreErrors: true};\n  let prevToken: Uint8Array | number[];\n\n  const iterate = async(isLoop: boolean) => {\n    try {\n      let loginToken = await rootScope.managers.apiManager.invokeApi('auth.exportLoginToken', {\n        api_id: App.id,\n        api_hash: App.hash,\n        except_ids: []\n      }, {ignoreErrors: true});\n\n      if(loginToken._ === 'auth.loginTokenMigrateTo') {\n        if(!options.dcId) {\n          options.dcId = loginToken.dc_id as DcId;\n          rootScope.managers.apiManager.setBaseDcId(loginToken.dc_id);\n          // continue;\n        }\n\n        loginToken = await rootScope.managers.apiManager.invokeApi('auth.importLoginToken', {\n          token: loginToken.token\n        }, options) as AuthLoginToken.authLoginToken;\n      }\n\n      if(loginToken._ === 'auth.loginTokenSuccess') {\n        const authorization = loginToken.authorization as any as AuthAuthorization.authAuthorization;\n        await rootScope.managers.apiManager.setUser(authorization.user);\n        import('./pageIm').then((m) => m.default.mount());\n        return true;\n      }\n\n      /* // to base64\n      var decoder = new TextDecoder('utf8');\n      var b64encoded = btoa(String.fromCharCode.apply(null, [...loginToken.token])); */\n\n      if(!prevToken || !bytesCmp(prevToken, loginToken.token)) {\n        prevToken = loginToken.token;\n\n        const encoded = bytesToBase64(loginToken.token);\n        const url = 'tg://login?token=' + fixBase64String(encoded, true);\n\n        const style = window.getComputedStyle(document.documentElement);\n        const surfaceColor = style.getPropertyValue('--surface-color').trim();\n        const textColor = style.getPropertyValue('--primary-text-color').trim();\n        const primaryColor = style.getPropertyValue('--primary-color').trim();\n\n        const logoUrl = await fetch('assets/img/logo_padded.svg')\n        .then((res) => res.text())\n        .then((text) => {\n          text = text.replace(/(fill:).+?(;)/, `$1${primaryColor}$2`);\n          return textToSvgURL(text);\n        });\n\n        const qrCode = new QRCodeStyling({\n          width: 240 * window.devicePixelRatio,\n          height: 240 * window.devicePixelRatio,\n          data: url,\n          image: logoUrl,\n          dotsOptions: {\n            color: textColor,\n            type: 'rounded'\n          },\n          cornersSquareOptions: {\n            type: 'extra-rounded'\n          },\n          imageOptions: {\n            imageSize: 1,\n            margin: 0\n          },\n          backgroundOptions: {\n            color: surfaceColor\n          },\n          qrOptions: {\n            errorCorrectionLevel: 'L'\n          }\n        });\n\n        qrCode.append(imageDiv);\n        (imageDiv.lastChild as HTMLCanvasElement).classList.add('qr-canvas');\n\n        let promise: Promise<void>;\n        if(qrCode._drawingPromise) {\n          promise = qrCode._drawingPromise;\n        } else {\n          promise = Promise.race([\n            pause(1000),\n            new Promise<void>((resolve) => {\n              qrCode._canvas._image.addEventListener('load', () => {\n                window.requestAnimationFrame(() => resolve());\n              }, {once: true});\n            })\n          ]);\n        }\n\n        // *  ,      \n        await promise.then(() => {\n          if(preloader) {\n            preloader.style.animation = 'hide-icon .4s forwards';\n\n            const c = imageDiv.children[1] as HTMLElement;\n            c.style.display = 'none';\n            c.style.animation = 'grow-icon .4s forwards';\n            setTimeout(() => {\n              c.style.display = '';\n            }, 150);\n\n            setTimeout(() => {\n              c.style.animation = '';\n            }, 500);\n            preloader = undefined;\n          } else {\n            Array.from(imageDiv.children).slice(0, -1).forEach((el) => {\n              el.remove();\n            });\n          }\n        });\n      }\n\n      if(isLoop) {\n        const timestamp = Date.now() / 1000;\n        const diff = loginToken.expires - timestamp - await rootScope.managers.timeManager.getServerTimeOffset();\n\n        await pause(diff > FETCH_INTERVAL ? 1e3 * FETCH_INTERVAL : 1e3 * diff | 0);\n      }\n    } catch(err) {\n      switch((err as ApiError).type) {\n        case 'SESSION_PASSWORD_NEEDED':\n          (err as ApiError).handled = true;\n          import('./pagePassword').then((m) => m.default.mount());\n          stop = true;\n          cachedPromise = null;\n          break;\n        default:\n          console.error('pageSignQR: default error:', err);\n          stop = true;\n          break;\n      }\n\n      return true;\n    }\n\n    return false;\n  };\n\n  // await iterate(false);\n\n  return async() => {\n    stop = false;\n\n    do {\n      if(stop) {\n        break;\n      }\n\n      const needBreak = await iterate(true);\n      if(needBreak) {\n        break;\n      }\n    } while(true);\n  };\n};\n\nlet cachedPromise: Promise<() => Promise<void>>;\nconst page = new Page('page-signQR', true, () => {\n  return cachedPromise;\n}, () => {\n  // console.log('onMount');\n  if(!cachedPromise) cachedPromise = onFirstMount();\n  cachedPromise.then((func) => {\n    func();\n  });\n\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStateSignQr'});\n});\n\nexport default page;\n"],"file":"pageSignQR-VxURk7YO.js"}
\ No newline at end of file

--- public/pageSignUp-fAex3eRP.js ---
@@ -1,8 +1,8 @@
-import{a as m,e as P,_ as w,g as y,i as I}from"./index-XZA1-3MU.js";import{L as E}from"./loginPage-EKVIJLjo.js";import{P as N}from"./page-eb81Un_i.js";import{I as v,r as f,w as k}from"./wrapEmojiText-pejq-WF4.js";import{P as A,a as S}from"./avatar-ohgkiWHW.js";import{I as F,B as M}from"./button-aS2SE0kp.js";import{p as U}from"./putPreloader--f-Xu9AG.js";import"./scrollable-OU41biYL.js";let d=null;const x=async()=>{const e=new E({className:"page-signUp",withInputWrapper:!0,titleLangKey:"YourName",subtitleLangKey:"Login.Register.Subtitle"});e.imageDiv.classList.add("avatar-edit"),e.title.classList.add("fullName");const o=document.createElement("canvas");o.id="canvas-avatar",o.className="avatar-edit-canvas";const b=F("cameraadd","avatar-edit-icon");e.imageDiv.append(o,b);let u;e.imageDiv.addEventListener("click",()=>{A.createPopup(S).open(o,a=>{u=a})});const g=a=>{const n=t.value||"",i=s.value||"",l=n||i?(n+" "+i).trim():"";l?f(e.title,k(l)):f(e.title,I("YourName"))},L=()=>new Promise((a,n)=>{if(!u)return a();u().then(i=>{m.managers.appProfileManager.uploadProfilePhoto(i).then(a,n)},n)}),t=new v({label:"FirstName",maxLength:70}),s=new v({label:"LastName",maxLength:64}),c=M("btn-primary btn-color-primary"),p=new P.IntlElement({key:"StartMessaging"});return c.append(p.element),e.inputWrapper.append(t.container,s.container,c),t.input.addEventListener("input",g),s.input.addEventListener("input",g),c.addEventListener("click",function(a){if(t.input.classList.contains("error")||s.input.classList.contains("error"))return!1;if(!t.value.length)return t.input.classList.add("error"),!1;this.disabled=!0;const n=t.value.trim(),i=s.value.trim(),l={phone_number:d.phone_number,phone_code_hash:d.phone_code_hash,first_name:n,last_name:i};p.update({key:"PleaseWait"});const h=U(this);m.managers.apiManager.invokeApi("auth.signUp",l).then(async r=>{switch(r._){case"auth.authorization":await m.managers.apiManager.setUser(r.user),L().finally(()=>{w(()=>import("./pageIm-2VO8DGq9.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(_=>{_.default.mount()})});break;default:p.update({key:r._}),this.removeAttribute("disabled"),h.remove();break}}).catch(r=>{switch(this.removeAttribute("disabled"),h.remove(),r.type){default:p.update({key:r.type});break}})}),y(),new Promise(a=>{window.requestAnimationFrame(a)})},q=new N("page-signUp",!0,x,e=>{d=e,m.managers.appStateManager.pushToState("authState",{_:"authStateSignUp",authCode:e})});export{q as default};
-//# sourceMappingURL=pageSignUp-4OqqTrno.js.map
+import{a as m,e as P,_ as w,g as y,i as I}from"./index-M8z-nwNm.js";import{L as E}from"./loginPage-0kq1JorQ.js";import{P as N}from"./page-kT6kVFv9.js";import{I as v,r as f,w as k}from"./wrapEmojiText-PAHdiQbe.js";import{P as A,a as S}from"./avatar-HalcuPNE.js";import{I as F,B as M}from"./button-Mm7TqKr1.js";import{p as U}from"./putPreloader-jxB4tqkF.js";import"./scrollable-ILmNatrX.js";let d=null;const x=async()=>{const e=new E({className:"page-signUp",withInputWrapper:!0,titleLangKey:"YourName",subtitleLangKey:"Login.Register.Subtitle"});e.imageDiv.classList.add("avatar-edit"),e.title.classList.add("fullName");const o=document.createElement("canvas");o.id="canvas-avatar",o.className="avatar-edit-canvas";const b=F("cameraadd","avatar-edit-icon");e.imageDiv.append(o,b);let u;e.imageDiv.addEventListener("click",()=>{A.createPopup(S).open(o,a=>{u=a})});const g=a=>{const n=t.value||"",i=s.value||"",l=n||i?(n+" "+i).trim():"";l?f(e.title,k(l)):f(e.title,I("YourName"))},L=()=>new Promise((a,n)=>{if(!u)return a();u().then(i=>{m.managers.appProfileManager.uploadProfilePhoto(i).then(a,n)},n)}),t=new v({label:"FirstName",maxLength:70}),s=new v({label:"LastName",maxLength:64}),c=M("btn-primary btn-color-primary"),p=new P.IntlElement({key:"StartMessaging"});return c.append(p.element),e.inputWrapper.append(t.container,s.container,c),t.input.addEventListener("input",g),s.input.addEventListener("input",g),c.addEventListener("click",function(a){if(t.input.classList.contains("error")||s.input.classList.contains("error"))return!1;if(!t.value.length)return t.input.classList.add("error"),!1;this.disabled=!0;const n=t.value.trim(),i=s.value.trim(),l={phone_number:d.phone_number,phone_code_hash:d.phone_code_hash,first_name:n,last_name:i};p.update({key:"PleaseWait"});const h=U(this);m.managers.apiManager.invokeApi("auth.signUp",l).then(async r=>{switch(r._){case"auth.authorization":await m.managers.apiManager.setUser(r.user),L().finally(()=>{w(()=>import("./pageIm-wngHxkKH.js"),__vite__mapDeps([0,1,2,3]),import.meta.url).then(_=>{_.default.mount()})});break;default:p.update({key:r._}),this.removeAttribute("disabled"),h.remove();break}}).catch(r=>{switch(this.removeAttribute("disabled"),h.remove(),r.type){default:p.update({key:r.type});break}})}),y(),new Promise(a=>{window.requestAnimationFrame(a)})},q=new N("page-signUp",!0,x,e=>{d=e,m.managers.appStateManager.pushToState("authState",{_:"authStateSignUp",authCode:e})});export{q as default};
+//# sourceMappingURL=pageSignUp-fAex3eRP.js.map
 function __vite__mapDeps(indexes) {
   if (!__vite__mapDeps.viteFileDeps) {
-    __vite__mapDeps.viteFileDeps = ["./pageIm-2VO8DGq9.js","./index-XZA1-3MU.js","./index-pzR5gIOz.css","./page-eb81Un_i.js"]
+    __vite__mapDeps.viteFileDeps = ["./pageIm-wngHxkKH.js","./index-M8z-nwNm.js","./index-pzR5gIOz.css","./page-kT6kVFv9.js"]
   }
   return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
 }
\ No newline at end of file

--- public/pageSignUp-fAex3eRP.js.map ---
@@ -1 +1 @@
-{"version":3,"mappings":"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","names":["authCode","onFirstMount","page","LoginPage","avatarPreview","addIco","Icon","uploadAvatar","PopupElement","PopupAvatar","_uploadAvatar","handleInput","e","name","nameInputField","lastName","lastNameInputField","fullName","replaceContent","wrapEmojiText","i18n","sendAvatar","resolve","reject","inputFile","rootScope","InputField","btnSignUp","Button","btnI18n","I18n","params","preloader","putPreloader","response","__vitePreload","m","err","blurActiveElement","Page","_authCode"],"sources":["../src/pages/pageSignUp.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type {CancellablePromise} from '../helpers/cancellablePromise';\nimport type {InputFile} from '../layer';\nimport type {AuthState} from '../types';\nimport LoginPage from './loginPage';\nimport Page from './page';\nimport blurActiveElement from '../helpers/dom/blurActiveElement';\nimport rootScope from '../lib/rootScope';\nimport InputField from '../components/inputField';\nimport PopupElement from '../components/popups';\nimport PopupAvatar from '../components/popups/avatar';\nimport replaceContent from '../helpers/dom/replaceContent';\nimport I18n, {i18n} from '../lib/langPack';\nimport wrapEmojiText from '../lib/richTextProcessor/wrapEmojiText';\nimport Button from '../components/button';\nimport {putPreloader} from '../components/putPreloader';\nimport Icon from '../components/icon';\n\nlet authCode: AuthState.signUp['authCode'] = null;\n\nconst onFirstMount = async() => {\n  const page = new LoginPage({\n    className: 'page-signUp',\n    withInputWrapper: true,\n    titleLangKey: 'YourName',\n    subtitleLangKey: 'Login.Register.Subtitle'\n  });\n\n  page.imageDiv.classList.add('avatar-edit');\n\n  page.title.classList.add('fullName');\n\n  const avatarPreview = document.createElement('canvas');\n  avatarPreview.id = 'canvas-avatar';\n  avatarPreview.className = 'avatar-edit-canvas';\n\n  const addIco = Icon('cameraadd', 'avatar-edit-icon');\n  page.imageDiv.append(avatarPreview, addIco);\n\n  let uploadAvatar: () => CancellablePromise<InputFile>;\n  page.imageDiv.addEventListener('click', () => {\n    PopupElement.createPopup(PopupAvatar).open(avatarPreview, (_uploadAvatar) => {\n      uploadAvatar = _uploadAvatar;\n    });\n  });\n\n  const handleInput = (e: Event) => {\n    const name = nameInputField.value || '';\n    const lastName = lastNameInputField.value || '';\n\n    const fullName = name || lastName ?\n      (name + ' ' + lastName).trim() :\n      '';\n\n    if(fullName) replaceContent(page.title, wrapEmojiText(fullName));\n    else replaceContent(page.title, i18n('YourName'));\n  };\n\n  const sendAvatar = () => new Promise<void>((resolve, reject) => {\n    if(!uploadAvatar) {\n      // console.log('User has not selected avatar');\n      return resolve();\n    }\n\n    // console.log('invoking uploadFile...');\n    uploadAvatar().then((inputFile) => {\n      // console.log('uploaded smthn', inputFile);\n\n      rootScope.managers.appProfileManager.uploadProfilePhoto(inputFile).then(resolve, reject);\n    }, reject);\n  });\n\n  const nameInputField = new InputField({\n    label: 'FirstName',\n    maxLength: 70\n  });\n\n  const lastNameInputField = new InputField({\n    label: 'LastName',\n    maxLength: 64\n  });\n\n  const btnSignUp = Button('btn-primary btn-color-primary');\n  const btnI18n = new I18n.IntlElement({key: 'StartMessaging'});\n  btnSignUp.append(btnI18n.element);\n\n  page.inputWrapper.append(nameInputField.container, lastNameInputField.container, btnSignUp);\n\n  nameInputField.input.addEventListener('input', handleInput);\n  lastNameInputField.input.addEventListener('input', handleInput);\n\n  btnSignUp.addEventListener('click', function(this: typeof btnSignUp, e) {\n    if(nameInputField.input.classList.contains('error') || lastNameInputField.input.classList.contains('error')) {\n      return false;\n    }\n\n    if(!nameInputField.value.length) {\n      nameInputField.input.classList.add('error');\n      return false;\n    }\n\n    this.disabled = true;\n\n    const name = nameInputField.value.trim();\n    const lastName = lastNameInputField.value.trim();\n\n    const params = {\n      phone_number: authCode.phone_number,\n      phone_code_hash: authCode.phone_code_hash,\n      first_name: name,\n      last_name: lastName\n    };\n\n    // console.log('invoking auth.signUp with params:', params);\n\n    btnI18n.update({key: 'PleaseWait'});\n    const preloader = putPreloader(this);\n\n    rootScope.managers.apiManager.invokeApi('auth.signUp', params)\n    .then(async(response) => {\n      // console.log('auth.signUp response:', response);\n\n      switch(response._) {\n        case 'auth.authorization': // success\n          await rootScope.managers.apiManager.setUser(response.user);\n\n          sendAvatar().finally(() => {\n            import('./pageIm').then((m) => {\n              m.default.mount();\n            });\n          });\n\n          break;\n        default:\n          btnI18n.update({key: response._ as any});\n          this.removeAttribute('disabled');\n          preloader.remove();\n          break;\n      }\n\n      /* (document.body.getElementsByClassName('page-sign')[0] as HTMLDivElement).style.display = 'none';\n      pageAuthCode(Object.assign(code, {phoneNumber})); */\n    }).catch((err) => {\n      this.removeAttribute('disabled');\n      preloader.remove();\n\n      switch(err.type) {\n        default:\n          btnI18n.update({key: err.type});\n          break;\n      }\n    });\n  });\n\n  blurActiveElement();\n  return new Promise((resolve) => {\n    window.requestAnimationFrame(resolve);\n  });\n};\n\nconst page = new Page('page-signUp', true, onFirstMount, (_authCode: typeof authCode) => {\n  authCode = _authCode;\n\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStateSignUp', authCode: _authCode});\n});\n\nexport default page;\n"],"file":"pageSignUp-4OqqTrno.js"}
\ No newline at end of file
+{"version":3,"mappings":"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","names":["authCode","onFirstMount","page","LoginPage","avatarPreview","addIco","Icon","uploadAvatar","PopupElement","PopupAvatar","_uploadAvatar","handleInput","e","name","nameInputField","lastName","lastNameInputField","fullName","replaceContent","wrapEmojiText","i18n","sendAvatar","resolve","reject","inputFile","rootScope","InputField","btnSignUp","Button","btnI18n","I18n","params","preloader","putPreloader","response","__vitePreload","m","err","blurActiveElement","Page","_authCode"],"sources":["../src/pages/pageSignUp.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport type {CancellablePromise} from '../helpers/cancellablePromise';\nimport type {InputFile} from '../layer';\nimport type {AuthState} from '../types';\nimport LoginPage from './loginPage';\nimport Page from './page';\nimport blurActiveElement from '../helpers/dom/blurActiveElement';\nimport rootScope from '../lib/rootScope';\nimport InputField from '../components/inputField';\nimport PopupElement from '../components/popups';\nimport PopupAvatar from '../components/popups/avatar';\nimport replaceContent from '../helpers/dom/replaceContent';\nimport I18n, {i18n} from '../lib/langPack';\nimport wrapEmojiText from '../lib/richTextProcessor/wrapEmojiText';\nimport Button from '../components/button';\nimport {putPreloader} from '../components/putPreloader';\nimport Icon from '../components/icon';\n\nlet authCode: AuthState.signUp['authCode'] = null;\n\nconst onFirstMount = async() => {\n  const page = new LoginPage({\n    className: 'page-signUp',\n    withInputWrapper: true,\n    titleLangKey: 'YourName',\n    subtitleLangKey: 'Login.Register.Subtitle'\n  });\n\n  page.imageDiv.classList.add('avatar-edit');\n\n  page.title.classList.add('fullName');\n\n  const avatarPreview = document.createElement('canvas');\n  avatarPreview.id = 'canvas-avatar';\n  avatarPreview.className = 'avatar-edit-canvas';\n\n  const addIco = Icon('cameraadd', 'avatar-edit-icon');\n  page.imageDiv.append(avatarPreview, addIco);\n\n  let uploadAvatar: () => CancellablePromise<InputFile>;\n  page.imageDiv.addEventListener('click', () => {\n    PopupElement.createPopup(PopupAvatar).open(avatarPreview, (_uploadAvatar) => {\n      uploadAvatar = _uploadAvatar;\n    });\n  });\n\n  const handleInput = (e: Event) => {\n    const name = nameInputField.value || '';\n    const lastName = lastNameInputField.value || '';\n\n    const fullName = name || lastName ?\n      (name + ' ' + lastName).trim() :\n      '';\n\n    if(fullName) replaceContent(page.title, wrapEmojiText(fullName));\n    else replaceContent(page.title, i18n('YourName'));\n  };\n\n  const sendAvatar = () => new Promise<void>((resolve, reject) => {\n    if(!uploadAvatar) {\n      // console.log('User has not selected avatar');\n      return resolve();\n    }\n\n    // console.log('invoking uploadFile...');\n    uploadAvatar().then((inputFile) => {\n      // console.log('uploaded smthn', inputFile);\n\n      rootScope.managers.appProfileManager.uploadProfilePhoto(inputFile).then(resolve, reject);\n    }, reject);\n  });\n\n  const nameInputField = new InputField({\n    label: 'FirstName',\n    maxLength: 70\n  });\n\n  const lastNameInputField = new InputField({\n    label: 'LastName',\n    maxLength: 64\n  });\n\n  const btnSignUp = Button('btn-primary btn-color-primary');\n  const btnI18n = new I18n.IntlElement({key: 'StartMessaging'});\n  btnSignUp.append(btnI18n.element);\n\n  page.inputWrapper.append(nameInputField.container, lastNameInputField.container, btnSignUp);\n\n  nameInputField.input.addEventListener('input', handleInput);\n  lastNameInputField.input.addEventListener('input', handleInput);\n\n  btnSignUp.addEventListener('click', function(this: typeof btnSignUp, e) {\n    if(nameInputField.input.classList.contains('error') || lastNameInputField.input.classList.contains('error')) {\n      return false;\n    }\n\n    if(!nameInputField.value.length) {\n      nameInputField.input.classList.add('error');\n      return false;\n    }\n\n    this.disabled = true;\n\n    const name = nameInputField.value.trim();\n    const lastName = lastNameInputField.value.trim();\n\n    const params = {\n      phone_number: authCode.phone_number,\n      phone_code_hash: authCode.phone_code_hash,\n      first_name: name,\n      last_name: lastName\n    };\n\n    // console.log('invoking auth.signUp with params:', params);\n\n    btnI18n.update({key: 'PleaseWait'});\n    const preloader = putPreloader(this);\n\n    rootScope.managers.apiManager.invokeApi('auth.signUp', params)\n    .then(async(response) => {\n      // console.log('auth.signUp response:', response);\n\n      switch(response._) {\n        case 'auth.authorization': // success\n          await rootScope.managers.apiManager.setUser(response.user);\n\n          sendAvatar().finally(() => {\n            import('./pageIm').then((m) => {\n              m.default.mount();\n            });\n          });\n\n          break;\n        default:\n          btnI18n.update({key: response._ as any});\n          this.removeAttribute('disabled');\n          preloader.remove();\n          break;\n      }\n\n      /* (document.body.getElementsByClassName('page-sign')[0] as HTMLDivElement).style.display = 'none';\n      pageAuthCode(Object.assign(code, {phoneNumber})); */\n    }).catch((err) => {\n      this.removeAttribute('disabled');\n      preloader.remove();\n\n      switch(err.type) {\n        default:\n          btnI18n.update({key: err.type});\n          break;\n      }\n    });\n  });\n\n  blurActiveElement();\n  return new Promise((resolve) => {\n    window.requestAnimationFrame(resolve);\n  });\n};\n\nconst page = new Page('page-signUp', true, onFirstMount, (_authCode: typeof authCode) => {\n  authCode = _authCode;\n\n  rootScope.managers.appStateManager.pushToState('authState', {_: 'authStateSignUp', authCode: _authCode});\n});\n\nexport default page;\n"],"file":"pageSignUp-fAex3eRP.js"}
\ No newline at end of file

--- public/putPreloader-jxB4tqkF.js ---
@@ -1,5 +1,5 @@
-import{M as o}from"./index-XZA1-3MU.js";function i(r,n=!1){const e=`
+import{M as o}from"./index-M8z-nwNm.js";function i(r,n=!1){const e=`
   <svg xmlns="http://www.w3.org/2000/svg" class="preloader-circular" viewBox="25 25 50 50">
   <circle class="preloader-path" cx="50" cy="50" r="20" fill="none" stroke-miterlimit="10"/>
   </svg>`;if(n){const t=document.createElement("div");return t.classList.add("preloader"),t.innerHTML=e,r&&r.appendChild(t),t}return r.insertAdjacentHTML("beforeend",e),r.lastElementChild}o.putPreloader=i;function a(r,n="check"){const e=r.querySelector(".tgico");return e?.remove(),r.disabled=!0,i(r),()=>{r.replaceChildren(),e&&r.append(e),r.removeAttribute("disabled")}}export{i as p,a as s};
-//# sourceMappingURL=putPreloader--f-Xu9AG.js.map
+//# sourceMappingURL=putPreloader-jxB4tqkF.js.map

--- public/putPreloader-jxB4tqkF.js.map ---
@@ -1 +1 @@
-{"version":3,"file":"putPreloader--f-Xu9AG.js","sources":["../src/components/putPreloader.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {MOUNT_CLASS_TO} from '../config/debug';\nimport {_tgico} from '../helpers/tgico';\n\nexport function putPreloader(elem: Element, returnDiv = false): HTMLElement {\n  const html = `\n  <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"preloader-circular\" viewBox=\"25 25 50 50\">\n  <circle class=\"preloader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n  </svg>`;\n\n  if(returnDiv) {\n    const div = document.createElement('div');\n    div.classList.add('preloader');\n    div.innerHTML = html;\n\n    if(elem) {\n      elem.appendChild(div);\n    }\n\n    return div;\n  }\n\n  elem.insertAdjacentHTML('beforeend', html);\n  return elem.lastElementChild as HTMLElement;\n}\n\nMOUNT_CLASS_TO.putPreloader = putPreloader;\n\nexport function setButtonLoader(elem: HTMLButtonElement, icon: Icon = 'check') {\n  const iconElement = elem.querySelector('.tgico');\n  iconElement?.remove();\n  elem.disabled = true;\n  putPreloader(elem);\n\n  return () => {\n    elem.replaceChildren();\n    if(iconElement) elem.append(iconElement);\n    elem.removeAttribute('disabled');\n  };\n}\n\n/* export function parseMenuButtonsTo(to: {[name: string]: HTMLElement}, elements: HTMLCollection | NodeListOf<HTMLElement>) {\n  Array.from(elements).forEach((el) => {\n    const match = el.className.match(/(?:^|\\s)menu-(.+?)(?:$|\\s)/);\n    if(!match) return;\n    to[match[1]] = el as HTMLElement;\n  });\n} */\n"],"names":["putPreloader","elem","returnDiv","html","div","MOUNT_CLASS_TO","setButtonLoader","icon","iconElement"],"mappings":"wCASgB,SAAAA,EAAaC,EAAeC,EAAY,GAAoB,CAC1E,MAAMC,EAAO;AAAA;AAAA;AAAA,UAKb,GAAGD,EAAW,CACN,MAAAE,EAAM,SAAS,cAAc,KAAK,EACpC,OAAAA,EAAA,UAAU,IAAI,WAAW,EAC7BA,EAAI,UAAYD,EAEbF,GACDA,EAAK,YAAYG,CAAG,EAGfA,CACT,CAEK,OAAAH,EAAA,mBAAmB,YAAaE,CAAI,EAClCF,EAAK,gBACd,CAEAI,EAAe,aAAeL,EAEd,SAAAM,EAAgBL,EAAyBM,EAAa,QAAS,CACvE,MAAAC,EAAcP,EAAK,cAAc,QAAQ,EAC/C,OAAAO,GAAa,OAAO,EACpBP,EAAK,SAAW,GAChBD,EAAaC,CAAI,EAEV,IAAM,CACXA,EAAK,gBAAgB,EAClBO,GAAaP,EAAK,OAAOO,CAAW,EACvCP,EAAK,gBAAgB,UAAU,CAAA,CAEnC"}
\ No newline at end of file
+{"version":3,"file":"putPreloader-jxB4tqkF.js","sources":["../src/components/putPreloader.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport {MOUNT_CLASS_TO} from '../config/debug';\nimport {_tgico} from '../helpers/tgico';\n\nexport function putPreloader(elem: Element, returnDiv = false): HTMLElement {\n  const html = `\n  <svg xmlns=\"http://www.w3.org/2000/svg\" class=\"preloader-circular\" viewBox=\"25 25 50 50\">\n  <circle class=\"preloader-path\" cx=\"50\" cy=\"50\" r=\"20\" fill=\"none\" stroke-miterlimit=\"10\"/>\n  </svg>`;\n\n  if(returnDiv) {\n    const div = document.createElement('div');\n    div.classList.add('preloader');\n    div.innerHTML = html;\n\n    if(elem) {\n      elem.appendChild(div);\n    }\n\n    return div;\n  }\n\n  elem.insertAdjacentHTML('beforeend', html);\n  return elem.lastElementChild as HTMLElement;\n}\n\nMOUNT_CLASS_TO.putPreloader = putPreloader;\n\nexport function setButtonLoader(elem: HTMLButtonElement, icon: Icon = 'check') {\n  const iconElement = elem.querySelector('.tgico');\n  iconElement?.remove();\n  elem.disabled = true;\n  putPreloader(elem);\n\n  return () => {\n    elem.replaceChildren();\n    if(iconElement) elem.append(iconElement);\n    elem.removeAttribute('disabled');\n  };\n}\n\n/* export function parseMenuButtonsTo(to: {[name: string]: HTMLElement}, elements: HTMLCollection | NodeListOf<HTMLElement>) {\n  Array.from(elements).forEach((el) => {\n    const match = el.className.match(/(?:^|\\s)menu-(.+?)(?:$|\\s)/);\n    if(!match) return;\n    to[match[1]] = el as HTMLElement;\n  });\n} */\n"],"names":["putPreloader","elem","returnDiv","html","div","MOUNT_CLASS_TO","setButtonLoader","icon","iconElement"],"mappings":"wCASgB,SAAAA,EAAaC,EAAeC,EAAY,GAAoB,CAC1E,MAAMC,EAAO;AAAA;AAAA;AAAA,UAKb,GAAGD,EAAW,CACN,MAAAE,EAAM,SAAS,cAAc,KAAK,EACpC,OAAAA,EAAA,UAAU,IAAI,WAAW,EAC7BA,EAAI,UAAYD,EAEbF,GACDA,EAAK,YAAYG,CAAG,EAGfA,CACT,CAEK,OAAAH,EAAA,mBAAmB,YAAaE,CAAI,EAClCF,EAAK,gBACd,CAEAI,EAAe,aAAeL,EAEd,SAAAM,EAAgBL,EAAyBM,EAAa,QAAS,CACvE,MAAAC,EAAcP,EAAK,cAAc,QAAQ,EAC/C,OAAAO,GAAa,OAAO,EACpBP,EAAK,SAAW,GAChBD,EAAaC,CAAI,EAEV,IAAM,CACXA,EAAK,gBAAgB,EAClBO,GAAaP,EAAK,OAAOO,CAAW,EACvCP,EAAK,gBAAgB,UAAU,CAAA,CAEnC"}
\ No newline at end of file

--- public/scrollable-ILmNatrX.js ---
@@ -1,2 +1,2 @@
-import{aB as v,ah as L,c2 as P,c,aq as b,av as g,I as A}from"./index-XZA1-3MU.js";import{u as y,j as E}from"./page-eb81Un_i.js";const M=24,a=!P;let u,m;a?(u=n=>requestAnimationFrame(n),m=n=>cancelAnimationFrame(n)):(u=n=>window.setTimeout(n,M),m=n=>window.clearTimeout(n));class S{constructor(t,e="",s=document.createElement("div")){this.el=t,this.container=s,this.onScrollMeasure=0,this.lastScrollPosition=0,this.lastScrollDirection=0,this.isHeavyAnimationInProgress=!1,this.needCheckAfterAnimation=!1,this.onScroll=()=>{if(this.isHeavyAnimationInProgress){this.cancelMeasure(),this.needCheckAfterAnimation=!0;return}!this.onScrolledTop&&!this.onScrolledBottom&&!this.splitUp&&!this.onAdditionalScroll||this.onScrollMeasure||(this.onScrollMeasure=u(()=>{this.onScrollMeasure=0;const i=this.scrollPosition;this.lastScrollDirection=this.lastScrollPosition===i?0:this.lastScrollPosition<i?1:-1,this.lastScrollPosition=i,this.updateThumb(i),this.onAdditionalScroll&&this.onAdditionalScroll(),this.checkForTriggers&&this.checkForTriggers()}))},this.onMouseMove=i=>{c(i);const r=this.scrollSize,l=this.clientSize,o=this.thumb.offsetHeight,h=r-l,d=l-o,p=(i[this.clientAxis]-this.startMousePosition)/d*h,f=this.startScrollPosition+p;this.scrollPosition=f},this.onMouseDown=i=>{c(i),this.startMousePosition=i[this.clientAxis],this.startScrollPosition=this.scrollPosition,this.thumb.classList.add("is-focused"),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp,{once:!0})},this.onMouseUp=i=>{window.removeEventListener("mousemove",this.onMouseMove),this.thumb.classList.remove("is-focused")},this.container.classList.add("scrollable"),this.log=b("SCROLL"+(e?"-"+e:""),g.Error),t&&(Array.from(t.children).forEach(i=>this.container.append(i)),t.append(this.container))}addScrollListener(){this.addedScrollListener||(this.addedScrollListener=!0,this.container.addEventListener("scroll",this.onScroll,{passive:!0,capture:!0}))}removeScrollListener(){this.addedScrollListener&&(this.addedScrollListener=!1,this.container.removeEventListener("scroll",this.onScroll,{capture:!0}))}setListeners(){this.removeHeavyAnimationListener||(window.addEventListener("resize",this.onScroll,{passive:!0}),this.addScrollListener(),this.removeHeavyAnimationListener=y(()=>{this.isHeavyAnimationInProgress=!0,this.onScrollMeasure&&(this.cancelMeasure(),this.needCheckAfterAnimation=!0)},()=>{this.isHeavyAnimationInProgress=!1,this.needCheckAfterAnimation&&(this.onScroll(),this.needCheckAfterAnimation=!1)}))}removeListeners(){this.removeHeavyAnimationListener&&(window.removeEventListener("resize",this.onScroll),this.thumb&&(this.thumb.removeEventListener("mousedown",this.onMouseMove),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp)),this.removeScrollListener(),this.removeHeavyAnimationListener(),this.removeHeavyAnimationListener=void 0)}destroy(){this.removeListeners(),this.onAdditionalScroll=void 0,this.onScrolledTop=void 0,this.onScrolledBottom=void 0}prepend(...t){const e=this.splitUp||this.padding||this.container;this.thumb&&e!==this.container&&t.unshift(this.thumbContainer),e.prepend(...t),this.onSizeChange()}append(...t){(this.splitUp||this.padding||this.container).append(...t),this.onSizeChange()}scrollIntoViewNew(t){return E({...t,container:this.container})}updateThumb(t=this.scrollPosition){if(!a||!this.thumb)return;const e=this.container[this.scrollSizeProperty],s=this.container[this.clientSizeProperty],i=e/s/.75,r=Math.max(20,s/i),l=t/(e-s)*s,o=t/(e-s),h=s-r;s<e?(this.thumb.style.height=r+"px",this.thumb.style.transform=`translateY(${Math.min(h,l-r*o)}px)`):this.thumb.style.height="0px"}cancelMeasure(){this.onScrollMeasure&&(m(this.onScrollMeasure),this.onScrollMeasure=0)}onSizeChange(){a&&this.thumb&&this.onScroll()}getDistanceToEnd(){return this.scrollSize-Math.round(this.scrollPosition+this.offsetSize)}get isScrolledToEnd(){return this.getDistanceToEnd()<=1}get scrollPosition(){return this.container[this.scrollPositionProperty]}set scrollPosition(t){this.container[this.scrollPositionProperty]=t}get scrollSize(){return this.container[this.scrollSizeProperty]}get clientSize(){return this.container[this.clientSizeProperty]}get offsetSize(){return this.container[this.offsetSizeProperty]}get firstElementChild(){return this.thumb?this.thumbContainer.nextElementSibling:this.container.firstElementChild}setScrollPositionSilently(t){this.lastScrollPosition=t,this.ignoreNextScrollEvent(),this.scrollPosition=t}ignoreNextScrollEvent(){this.removeHeavyAnimationListener&&(this.removeScrollListener(),this.container.addEventListener("scroll",t=>{c(t),this.addScrollListener()},{capture:!0,passive:!1,once:!0}))}replaceChildren(...t){this.thumb&&t.unshift(this.thumbContainer),this.container.replaceChildren(...t)}}class T extends S{constructor(t,e="",s=300,i,r){super(t,e,r),this.onScrollOffset=s,this.loadedAll={top:!0,bottom:!1},this.checkForTriggers=()=>{if(!this.onScrolledTop&&!this.onScrolledBottom)return;if(this.isHeavyAnimationInProgress){this.onScroll();return}const{scrollSize:l,scrollPosition:o,clientSize:h}=this;if(!l)return;const d=l-h;this.onScrolledTop&&o<=this.onScrollOffset&&this.lastScrollDirection<=0&&this.onScrolledTop(),this.onScrolledBottom&&d-o<=this.onScrollOffset&&this.lastScrollDirection>=0&&this.onScrolledBottom()},this.scrollPositionProperty="scrollTop",this.scrollSizeProperty="scrollHeight",this.clientSizeProperty="clientHeight",this.offsetSizeProperty="offsetHeight",this.clientAxis="clientY",a&&(this.thumbContainer=document.createElement("div"),this.thumbContainer.classList.add("scrollable-thumb-container"),this.thumb=document.createElement("div"),this.thumb.classList.add("scrollable-thumb"),this.thumbContainer.append(this.thumb),this.container.prepend(this.thumbContainer),this.thumb.addEventListener("mousedown",this.onMouseDown)),this.container.classList.add("scrollable-y"),v&&!L&&this.container.classList.add("no-scrollbar"),this.setListeners()}attachBorderListeners(t=this.container){const e=this.onAdditionalScroll;this.onAdditionalScroll=()=>{e?.(),t.classList.toggle("scrolled-top",!this.scrollPosition),t.classList.toggle("scrolled-bottom",this.isScrolledToEnd)},t.classList.add("scrolled-top","scrolled-bottom","scrollable-y-bordered")}setVirtualContainer(t){this.splitUp=t,this.log("setVirtualContainer:",t,this)}}class H extends S{constructor(t,e="",s=300,i=15,r=document.createElement("div")){if(super(t,e,r),this.onScrollOffset=s,this.splitCount=i,this.container=r,this.container.classList.add("scrollable-x"),!A){const l=o=>{o.stopPropagation(),!o.deltaX&&this.container.scrollWidth>this.container.clientWidth&&(this.container.scrollLeft+=o.deltaY/4,c(o))};this.container.addEventListener("wheel",l,{passive:!1})}this.scrollPositionProperty="scrollLeft",this.scrollSizeProperty="scrollWidth",this.clientSizeProperty="clientWidth",this.offsetSizeProperty="offsetWidth"}}export{T as S,H as a};
-//# sourceMappingURL=scrollable-OU41biYL.js.map
+import{aB as v,ah as L,c2 as P,c,aq as b,av as g,I as A}from"./index-M8z-nwNm.js";import{u as y,j as E}from"./page-kT6kVFv9.js";const M=24,a=!P;let u,m;a?(u=n=>requestAnimationFrame(n),m=n=>cancelAnimationFrame(n)):(u=n=>window.setTimeout(n,M),m=n=>window.clearTimeout(n));class S{constructor(t,e="",s=document.createElement("div")){this.el=t,this.container=s,this.onScrollMeasure=0,this.lastScrollPosition=0,this.lastScrollDirection=0,this.isHeavyAnimationInProgress=!1,this.needCheckAfterAnimation=!1,this.onScroll=()=>{if(this.isHeavyAnimationInProgress){this.cancelMeasure(),this.needCheckAfterAnimation=!0;return}!this.onScrolledTop&&!this.onScrolledBottom&&!this.splitUp&&!this.onAdditionalScroll||this.onScrollMeasure||(this.onScrollMeasure=u(()=>{this.onScrollMeasure=0;const i=this.scrollPosition;this.lastScrollDirection=this.lastScrollPosition===i?0:this.lastScrollPosition<i?1:-1,this.lastScrollPosition=i,this.updateThumb(i),this.onAdditionalScroll&&this.onAdditionalScroll(),this.checkForTriggers&&this.checkForTriggers()}))},this.onMouseMove=i=>{c(i);const r=this.scrollSize,l=this.clientSize,o=this.thumb.offsetHeight,h=r-l,d=l-o,p=(i[this.clientAxis]-this.startMousePosition)/d*h,f=this.startScrollPosition+p;this.scrollPosition=f},this.onMouseDown=i=>{c(i),this.startMousePosition=i[this.clientAxis],this.startScrollPosition=this.scrollPosition,this.thumb.classList.add("is-focused"),window.addEventListener("mousemove",this.onMouseMove),window.addEventListener("mouseup",this.onMouseUp,{once:!0})},this.onMouseUp=i=>{window.removeEventListener("mousemove",this.onMouseMove),this.thumb.classList.remove("is-focused")},this.container.classList.add("scrollable"),this.log=b("SCROLL"+(e?"-"+e:""),g.Error),t&&(Array.from(t.children).forEach(i=>this.container.append(i)),t.append(this.container))}addScrollListener(){this.addedScrollListener||(this.addedScrollListener=!0,this.container.addEventListener("scroll",this.onScroll,{passive:!0,capture:!0}))}removeScrollListener(){this.addedScrollListener&&(this.addedScrollListener=!1,this.container.removeEventListener("scroll",this.onScroll,{capture:!0}))}setListeners(){this.removeHeavyAnimationListener||(window.addEventListener("resize",this.onScroll,{passive:!0}),this.addScrollListener(),this.removeHeavyAnimationListener=y(()=>{this.isHeavyAnimationInProgress=!0,this.onScrollMeasure&&(this.cancelMeasure(),this.needCheckAfterAnimation=!0)},()=>{this.isHeavyAnimationInProgress=!1,this.needCheckAfterAnimation&&(this.onScroll(),this.needCheckAfterAnimation=!1)}))}removeListeners(){this.removeHeavyAnimationListener&&(window.removeEventListener("resize",this.onScroll),this.thumb&&(this.thumb.removeEventListener("mousedown",this.onMouseMove),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp)),this.removeScrollListener(),this.removeHeavyAnimationListener(),this.removeHeavyAnimationListener=void 0)}destroy(){this.removeListeners(),this.onAdditionalScroll=void 0,this.onScrolledTop=void 0,this.onScrolledBottom=void 0}prepend(...t){const e=this.splitUp||this.padding||this.container;this.thumb&&e!==this.container&&t.unshift(this.thumbContainer),e.prepend(...t),this.onSizeChange()}append(...t){(this.splitUp||this.padding||this.container).append(...t),this.onSizeChange()}scrollIntoViewNew(t){return E({...t,container:this.container})}updateThumb(t=this.scrollPosition){if(!a||!this.thumb)return;const e=this.container[this.scrollSizeProperty],s=this.container[this.clientSizeProperty],i=e/s/.75,r=Math.max(20,s/i),l=t/(e-s)*s,o=t/(e-s),h=s-r;s<e?(this.thumb.style.height=r+"px",this.thumb.style.transform=`translateY(${Math.min(h,l-r*o)}px)`):this.thumb.style.height="0px"}cancelMeasure(){this.onScrollMeasure&&(m(this.onScrollMeasure),this.onScrollMeasure=0)}onSizeChange(){a&&this.thumb&&this.onScroll()}getDistanceToEnd(){return this.scrollSize-Math.round(this.scrollPosition+this.offsetSize)}get isScrolledToEnd(){return this.getDistanceToEnd()<=1}get scrollPosition(){return this.container[this.scrollPositionProperty]}set scrollPosition(t){this.container[this.scrollPositionProperty]=t}get scrollSize(){return this.container[this.scrollSizeProperty]}get clientSize(){return this.container[this.clientSizeProperty]}get offsetSize(){return this.container[this.offsetSizeProperty]}get firstElementChild(){return this.thumb?this.thumbContainer.nextElementSibling:this.container.firstElementChild}setScrollPositionSilently(t){this.lastScrollPosition=t,this.ignoreNextScrollEvent(),this.scrollPosition=t}ignoreNextScrollEvent(){this.removeHeavyAnimationListener&&(this.removeScrollListener(),this.container.addEventListener("scroll",t=>{c(t),this.addScrollListener()},{capture:!0,passive:!1,once:!0}))}replaceChildren(...t){this.thumb&&t.unshift(this.thumbContainer),this.container.replaceChildren(...t)}}class T extends S{constructor(t,e="",s=300,i,r){super(t,e,r),this.onScrollOffset=s,this.loadedAll={top:!0,bottom:!1},this.checkForTriggers=()=>{if(!this.onScrolledTop&&!this.onScrolledBottom)return;if(this.isHeavyAnimationInProgress){this.onScroll();return}const{scrollSize:l,scrollPosition:o,clientSize:h}=this;if(!l)return;const d=l-h;this.onScrolledTop&&o<=this.onScrollOffset&&this.lastScrollDirection<=0&&this.onScrolledTop(),this.onScrolledBottom&&d-o<=this.onScrollOffset&&this.lastScrollDirection>=0&&this.onScrolledBottom()},this.scrollPositionProperty="scrollTop",this.scrollSizeProperty="scrollHeight",this.clientSizeProperty="clientHeight",this.offsetSizeProperty="offsetHeight",this.clientAxis="clientY",a&&(this.thumbContainer=document.createElement("div"),this.thumbContainer.classList.add("scrollable-thumb-container"),this.thumb=document.createElement("div"),this.thumb.classList.add("scrollable-thumb"),this.thumbContainer.append(this.thumb),this.container.prepend(this.thumbContainer),this.thumb.addEventListener("mousedown",this.onMouseDown)),this.container.classList.add("scrollable-y"),v&&!L&&this.container.classList.add("no-scrollbar"),this.setListeners()}attachBorderListeners(t=this.container){const e=this.onAdditionalScroll;this.onAdditionalScroll=()=>{e?.(),t.classList.toggle("scrolled-top",!this.scrollPosition),t.classList.toggle("scrolled-bottom",this.isScrolledToEnd)},t.classList.add("scrolled-top","scrolled-bottom","scrollable-y-bordered")}setVirtualContainer(t){this.splitUp=t,this.log("setVirtualContainer:",t,this)}}class H extends S{constructor(t,e="",s=300,i=15,r=document.createElement("div")){if(super(t,e,r),this.onScrollOffset=s,this.splitCount=i,this.container=r,this.container.classList.add("scrollable-x"),!A){const l=o=>{o.stopPropagation(),!o.deltaX&&this.container.scrollWidth>this.container.clientWidth&&(this.container.scrollLeft+=o.deltaY/4,c(o))};this.container.addEventListener("wheel",l,{passive:!1})}this.scrollPositionProperty="scrollLeft",this.scrollSizeProperty="scrollWidth",this.clientSizeProperty="clientWidth",this.offsetSizeProperty="offsetWidth"}}export{T as S,H as a};
+//# sourceMappingURL=scrollable-ILmNatrX.js.map

--- public/scrollable-ILmNatrX.js.map ---
@@ -1 +1 @@
-{"version":3,"file":"scrollable-OU41biYL.js","sources":["../src/components/scrollable.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport IS_TOUCH_SUPPORTED from '../environment/touchSupport';\nimport {logger, LogTypes} from '../lib/logger';\nimport fastSmoothScroll, {ScrollOptions} from '../helpers/fastSmoothScroll';\nimport useHeavyAnimationCheck from '../hooks/useHeavyAnimationCheck';\nimport cancelEvent from '../helpers/dom/cancelEvent';\nimport {IS_OVERLAY_SCROLL_SUPPORTED} from '../environment/overlayScrollSupport';\nimport {IS_MOBILE_SAFARI, IS_SAFARI} from '../environment/userAgent';\n/*\nvar el = $0;\nvar height = 0;\nvar checkUp = false;\n\ndo {\n  height += el.scrollHeight;\n} while(el = (checkUp ? el.previousElementSibling : el.nextElementSibling));\nconsole.log(height);\n*/\n\n/*\nArray.from($0.querySelectorAll('.bubble-content')).forEach((_el) => {\n  //_el.style.display = '';\n  //return;\n\n  let el = _el.parentElement;\n  let height = el.scrollHeight;\n  let width = el.scrollWidth;\n  el.style.width = width + 'px';\n  el.style.height = height + 'px';\n  _el.style.display = 'none';\n});\n*/\n\n/* const scrollables: Map<HTMLElement, Scrollable> = new Map();\nconst scrollsIntersector = new IntersectionObserver((entries) => {\n  for(let entry of entries) {\n    const scrollable = scrollables.get(entry.target as HTMLElement);\n\n    if(entry.isIntersecting) {\n      scrollable.isVisible = true;\n    } else {\n      scrollable.isVisible = false;\n\n      if(!isInDOM(entry.target)) {\n        scrollsIntersector.unobserve(scrollable.container);\n        scrollables.delete(scrollable.container);\n      }\n    }\n  }\n}); */\n\nconst SCROLL_THROTTLE = /* IS_ANDROID ? 200 :  */24;\nconst USE_OWN_SCROLL = !IS_OVERLAY_SCROLL_SUPPORTED;\n\nlet throttleMeasurement: (callback: () => void) => number,\n  cancelMeasurement: (id: number) => void;\nif(USE_OWN_SCROLL) {\n  throttleMeasurement = (callback) => requestAnimationFrame(callback);\n  cancelMeasurement = (id) => cancelAnimationFrame(id);\n} else {\n  throttleMeasurement = (callback) => window.setTimeout(callback, SCROLL_THROTTLE);\n  cancelMeasurement = (id) => window.clearTimeout(id);\n}\n\nexport class ScrollableBase {\n  protected log: ReturnType<typeof logger>;\n\n  public padding: HTMLElement;\n  public splitUp: HTMLElement;\n  public onScrollMeasure: number = 0;\n\n  public lastScrollPosition: number = 0;\n  public lastScrollDirection: number = 0;\n\n  public onAdditionalScroll: () => void;\n  public onScrolledTop: () => void;\n  public onScrolledBottom: () => void;\n\n  public isHeavyAnimationInProgress = false;\n  protected needCheckAfterAnimation = false;\n\n  public checkForTriggers?: () => void;\n\n  public scrollPositionProperty: 'scrollTop' | 'scrollLeft';\n  public scrollSizeProperty: 'scrollHeight' | 'scrollWidth';\n  public clientSizeProperty: 'clientHeight' | 'clientWidth';\n  public offsetSizeProperty: 'offsetHeight' | 'offsetWidth';\n  public clientAxis: 'clientY' | 'clientX';\n\n  protected startMousePosition: number;\n  protected startScrollPosition: number;\n\n  protected thumb: HTMLElement;\n  protected thumbContainer: HTMLElement;\n\n  protected removeHeavyAnimationListener: () => void;\n  protected addedScrollListener: boolean;\n\n  constructor(\n    public el?: HTMLElement,\n    logPrefix = '',\n    public container: HTMLElement = document.createElement('div')\n  ) {\n    this.container.classList.add('scrollable');\n\n    this.log = logger('SCROLL' + (logPrefix ? '-' + logPrefix : ''), LogTypes.Error);\n\n    if(el) {\n      Array.from(el.children).forEach((c) => this.container.append(c));\n\n      el.append(this.container);\n    }\n\n    // this.onScroll();\n  }\n\n  public addScrollListener() {\n    if(this.addedScrollListener) {\n      return;\n    }\n\n    this.addedScrollListener = true;\n    this.container.addEventListener('scroll', this.onScroll, {passive: true, capture: true});\n  }\n\n  public removeScrollListener() {\n    if(!this.addedScrollListener) {\n      return;\n    }\n\n    this.addedScrollListener = false;\n    this.container.removeEventListener('scroll', this.onScroll, {capture: true});\n  }\n\n  public setListeners() {\n    if(this.removeHeavyAnimationListener) {\n      return;\n    }\n\n    window.addEventListener('resize', this.onScroll, {passive: true});\n    this.addScrollListener();\n\n    this.removeHeavyAnimationListener = useHeavyAnimationCheck(() => {\n      this.isHeavyAnimationInProgress = true;\n\n      if(this.onScrollMeasure) {\n        this.cancelMeasure();\n        this.needCheckAfterAnimation = true;\n      }\n    }, () => {\n      this.isHeavyAnimationInProgress = false;\n\n      if(this.needCheckAfterAnimation) {\n        this.onScroll();\n        this.needCheckAfterAnimation = false;\n      }\n    });\n  }\n\n  public removeListeners() {\n    if(!this.removeHeavyAnimationListener) {\n      return;\n    }\n\n    window.removeEventListener('resize', this.onScroll);\n    if(this.thumb) {\n      this.thumb.removeEventListener('mousedown', this.onMouseMove);\n      window.removeEventListener('mousemove', this.onMouseMove);\n      window.removeEventListener('mouseup', this.onMouseUp);\n    }\n    this.removeScrollListener();\n\n    this.removeHeavyAnimationListener();\n    this.removeHeavyAnimationListener = undefined;\n  }\n\n  public destroy() {\n    this.removeListeners();\n    this.onAdditionalScroll = undefined;\n    this.onScrolledTop = undefined;\n    this.onScrolledBottom = undefined;\n  }\n\n  public prepend(...elements: (string | Node)[]) {\n    const prependTo = this.splitUp || this.padding || this.container;\n    this.thumb && prependTo !== this.container && elements.unshift(this.thumbContainer);\n    prependTo.prepend(...elements);\n    this.onSizeChange();\n  }\n\n  public append(...elements: (string | Node)[]) {\n    (this.splitUp || this.padding || this.container).append(...elements);\n    this.onSizeChange();\n  }\n\n  public scrollIntoViewNew(options: Omit<ScrollOptions, 'container'>) {\n    // return Promise.resolve();\n    // this.removeListeners();\n    return fastSmoothScroll({\n      ...options,\n      container: this.container\n    });/* .finally(() => {\n      this.setListeners();\n    }); */\n  }\n\n  public onScroll = () => {\n    // if(this.debug) {\n    // this.log('onScroll call', this.onScrollMeasure);\n    // }\n\n    // return;\n\n    if(this.isHeavyAnimationInProgress) {\n      this.cancelMeasure();\n      this.needCheckAfterAnimation = true;\n      return;\n    }\n\n    // if(this.onScrollMeasure || ((this.scrollLocked || (!this.onScrolledTop && !this.onScrolledBottom)) && !this.splitUp && !this.onAdditionalScroll)) return;\n    if((!this.onScrolledTop && !this.onScrolledBottom) && !this.splitUp && !this.onAdditionalScroll) return;\n    if(this.onScrollMeasure) return;\n    this.onScrollMeasure = throttleMeasurement(() => {\n      this.onScrollMeasure = 0;\n\n      const scrollPosition = this.scrollPosition;\n      this.lastScrollDirection = this.lastScrollPosition === scrollPosition ? 0 : (this.lastScrollPosition < scrollPosition ? 1 : -1); // * 1 - bottom, -1 - top\n      this.lastScrollPosition = scrollPosition;\n\n      this.updateThumb(scrollPosition);\n\n      // lastScrollDirection check is useless here, every callback should decide on its own\n      if(this.onAdditionalScroll/*  && this.lastScrollDirection !== 0 */) {\n        this.onAdditionalScroll();\n      }\n\n      if(this.checkForTriggers) {\n        this.checkForTriggers();\n      }\n    });\n  };\n\n  public updateThumb(scrollPosition = this.scrollPosition) {\n    if(!USE_OWN_SCROLL || !this.thumb) {\n      return;\n    }\n\n    const scrollSize = this.container[this.scrollSizeProperty];\n    const clientSize = this.container[this.clientSizeProperty];\n    const divider = scrollSize / clientSize / 0.75;\n    const thumbSize = Math.max(20, clientSize / divider);\n    const value = scrollPosition / (scrollSize - clientSize) * clientSize;\n    // const b = (scrollPosition + clientSize) / scrollSize;\n    const b = scrollPosition / (scrollSize - clientSize);\n    const maxValue = clientSize - thumbSize;\n    if(clientSize < scrollSize) {\n      this.thumb.style.height = thumbSize + 'px';\n      // this.thumb.style.top = `${Math.min(maxValue, value - thumbSize * b)}px`;\n      this.thumb.style.transform = `translateY(${Math.min(maxValue, value - thumbSize * b)}px)`;\n    } else {\n      this.thumb.style.height = '0px';\n    }\n  }\n\n  public cancelMeasure() {\n    if(this.onScrollMeasure) {\n      cancelMeasurement(this.onScrollMeasure);\n      this.onScrollMeasure = 0;\n    }\n  }\n\n  protected onMouseMove = (e: MouseEvent) => {\n    cancelEvent(e);\n\n    const contentHeight = this.scrollSize;\n    const viewportHeight = this.clientSize;\n    const scrollbarSize = this.thumb.offsetHeight;\n    const maxScrollTop = contentHeight - viewportHeight;\n\n    const maxScrollbarOffset = viewportHeight - scrollbarSize;\n    const deltaY = e[this.clientAxis] - this.startMousePosition;\n    const scrollAmount = (deltaY / maxScrollbarOffset) * maxScrollTop;\n    const newScrollTop = this.startScrollPosition + scrollAmount;\n\n    this.scrollPosition = newScrollTop;\n  };\n\n  protected onMouseDown = (e: MouseEvent) => {\n    cancelEvent(e);\n    this.startMousePosition = e[this.clientAxis];\n    this.startScrollPosition = this.scrollPosition;\n    this.thumb.classList.add('is-focused');\n\n    window.addEventListener('mousemove', this.onMouseMove);\n    window.addEventListener('mouseup', this.onMouseUp, {once: true});\n  };\n\n  protected onMouseUp = (e: MouseEvent) => {\n    window.removeEventListener('mousemove', this.onMouseMove);\n    this.thumb.classList.remove('is-focused');\n  };\n\n  public onSizeChange() {\n    if(USE_OWN_SCROLL && this.thumb) {\n      this.onScroll();\n    }\n  }\n\n  public getDistanceToEnd() {\n    return this.scrollSize - Math.round(this.scrollPosition + this.offsetSize);\n  }\n\n  get isScrolledToEnd() {\n    return this.getDistanceToEnd() <= 1;\n  }\n\n  get scrollPosition() {\n    return this.container[this.scrollPositionProperty];\n  }\n\n  set scrollPosition(value: number) {\n    this.container[this.scrollPositionProperty] = value;\n  }\n\n  get scrollSize() {\n    return this.container[this.scrollSizeProperty];\n  }\n\n  get clientSize() {\n    return this.container[this.clientSizeProperty];\n  }\n\n  get offsetSize() {\n    return this.container[this.offsetSizeProperty];\n  }\n\n  get firstElementChild() {\n    return this.thumb ? this.thumbContainer.nextElementSibling : this.container.firstElementChild;\n  }\n\n  public setScrollPositionSilently(value: number) {\n    this.lastScrollPosition = value;\n    this.ignoreNextScrollEvent();\n\n    this.scrollPosition = value;\n  }\n\n  public ignoreNextScrollEvent() {\n    if(this.removeHeavyAnimationListener) {\n      this.removeScrollListener();\n      this.container.addEventListener('scroll', (e) => {\n        cancelEvent(e);\n        this.addScrollListener();\n      }, {capture: true, passive: false, once: true});\n    }\n  }\n\n  public replaceChildren(...args: (string | Node)[]) {\n    this.thumb && args.unshift(this.thumbContainer);\n    this.container.replaceChildren(...args);\n  }\n}\n\nexport type SliceSides = 'top' | 'bottom';\nexport type SliceSidesContainer = {[k in SliceSides]: boolean};\n\nexport default class Scrollable extends ScrollableBase {\n  public loadedAll: SliceSidesContainer = {top: true, bottom: false};\n\n  constructor(\n    el?: HTMLElement,\n    logPrefix = '',\n    public onScrollOffset = 300,\n    withPaddingContainer?: boolean,\n    container?: HTMLElement\n  ) {\n    super(el, logPrefix, container);\n\n    // withPaddingContainer = true;\n    // if(withPaddingContainer) {\n    //   this.padding = document.createElement('div');\n    //   this.padding.classList.add('scrollable-padding');\n    //   this.padding.append(...Array.from(this.container.children));\n    //   this.container.append(this.padding);\n    // }\n\n    this.scrollPositionProperty = 'scrollTop';\n    this.scrollSizeProperty = 'scrollHeight';\n    this.clientSizeProperty = 'clientHeight';\n    this.offsetSizeProperty = 'offsetHeight';\n    this.clientAxis = 'clientY';\n\n    if(USE_OWN_SCROLL) {\n      this.thumbContainer = document.createElement('div');\n      this.thumbContainer.classList.add('scrollable-thumb-container');\n      this.thumb = document.createElement('div');\n      this.thumb.classList.add('scrollable-thumb');\n      this.thumbContainer.append(this.thumb);\n      this.container.prepend(this.thumbContainer);\n\n      this.thumb.addEventListener('mousedown', this.onMouseDown);\n    }\n\n    this.container.classList.add('scrollable-y');\n    if(IS_SAFARI && !IS_MOBILE_SAFARI) {\n      this.container.classList.add('no-scrollbar');\n    }\n    this.setListeners();\n  }\n\n  public attachBorderListeners(setClassOn = this.container) {\n    const cb = this.onAdditionalScroll;\n    this.onAdditionalScroll = () => {\n      cb?.();\n      setClassOn.classList.toggle('scrolled-top', !this.scrollPosition);\n      setClassOn.classList.toggle('scrolled-bottom', this.isScrolledToEnd);\n    };\n\n    setClassOn.classList.add('scrolled-top', 'scrolled-bottom', 'scrollable-y-bordered');\n  }\n\n  public setVirtualContainer(el?: HTMLElement) {\n    this.splitUp = el;\n    this.log('setVirtualContainer:', el, this);\n  }\n\n  public checkForTriggers = () => {\n    if((!this.onScrolledTop && !this.onScrolledBottom)) return;\n\n    if(this.isHeavyAnimationInProgress) {\n      this.onScroll();\n      return;\n    }\n\n    const {scrollSize, scrollPosition, clientSize} = this;\n    if(!scrollSize) { //         \n      return;\n    }\n\n    const maxScrollPosition = scrollSize - clientSize;\n\n    // this.log('checkForTriggers:', scrollTop, maxScrollTop);\n\n    if(this.onScrolledTop && scrollPosition <= this.onScrollOffset && this.lastScrollDirection <= 0/* && direction === -1 */) {\n      this.onScrolledTop();\n    }\n\n    if(this.onScrolledBottom && (maxScrollPosition - scrollPosition) <= this.onScrollOffset && this.lastScrollDirection >= 0/* && direction === 1 */) {\n      this.onScrolledBottom();\n    }\n  };\n}\n\nexport class ScrollableX extends ScrollableBase {\n  constructor(el: HTMLElement, logPrefix = '', public onScrollOffset = 300, public splitCount = 15, public container: HTMLElement = document.createElement('div')) {\n    super(el, logPrefix, container);\n\n    this.container.classList.add('scrollable-x');\n\n    if(!IS_TOUCH_SUPPORTED) {\n      const scrollHorizontally = (e: WheelEvent) => {\n        e.stopPropagation();\n        if(!e.deltaX && this.container.scrollWidth > this.container.clientWidth) {\n          this.container.scrollLeft += e.deltaY / 4;\n          cancelEvent(e);\n        }\n      };\n\n      this.container.addEventListener('wheel', scrollHorizontally, {passive: false});\n    }\n\n    this.scrollPositionProperty = 'scrollLeft';\n    this.scrollSizeProperty = 'scrollWidth';\n    this.clientSizeProperty = 'clientWidth';\n    this.offsetSizeProperty = 'offsetWidth';\n  }\n}\n"],"names":["SCROLL_THROTTLE","USE_OWN_SCROLL","IS_OVERLAY_SCROLL_SUPPORTED","throttleMeasurement","cancelMeasurement","callback","id","ScrollableBase","el","logPrefix","container","scrollPosition","e","cancelEvent","contentHeight","viewportHeight","scrollbarSize","maxScrollTop","maxScrollbarOffset","scrollAmount","newScrollTop","logger","LogTypes","c","useHeavyAnimationCheck","elements","prependTo","options","fastSmoothScroll","scrollSize","clientSize","divider","thumbSize","value","b","maxValue","args","Scrollable","onScrollOffset","withPaddingContainer","maxScrollPosition","IS_SAFARI","IS_MOBILE_SAFARI","setClassOn","cb","ScrollableX","splitCount","IS_TOUCH_SUPPORTED","scrollHorizontally"],"mappings":"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"}
\ No newline at end of file
+{"version":3,"file":"scrollable-ILmNatrX.js","sources":["../src/components/scrollable.ts"],"sourcesContent":["/*\n * https://github.com/morethanwords/tweb\n * Copyright (C) 2019-2021 Eduard Kuzmenko\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\n */\n\nimport IS_TOUCH_SUPPORTED from '../environment/touchSupport';\nimport {logger, LogTypes} from '../lib/logger';\nimport fastSmoothScroll, {ScrollOptions} from '../helpers/fastSmoothScroll';\nimport useHeavyAnimationCheck from '../hooks/useHeavyAnimationCheck';\nimport cancelEvent from '../helpers/dom/cancelEvent';\nimport {IS_OVERLAY_SCROLL_SUPPORTED} from '../environment/overlayScrollSupport';\nimport {IS_MOBILE_SAFARI, IS_SAFARI} from '../environment/userAgent';\n/*\nvar el = $0;\nvar height = 0;\nvar checkUp = false;\n\ndo {\n  height += el.scrollHeight;\n} while(el = (checkUp ? el.previousElementSibling : el.nextElementSibling));\nconsole.log(height);\n*/\n\n/*\nArray.from($0.querySelectorAll('.bubble-content')).forEach((_el) => {\n  //_el.style.display = '';\n  //return;\n\n  let el = _el.parentElement;\n  let height = el.scrollHeight;\n  let width = el.scrollWidth;\n  el.style.width = width + 'px';\n  el.style.height = height + 'px';\n  _el.style.display = 'none';\n});\n*/\n\n/* const scrollables: Map<HTMLElement, Scrollable> = new Map();\nconst scrollsIntersector = new IntersectionObserver((entries) => {\n  for(let entry of entries) {\n    const scrollable = scrollables.get(entry.target as HTMLElement);\n\n    if(entry.isIntersecting) {\n      scrollable.isVisible = true;\n    } else {\n      scrollable.isVisible = false;\n\n      if(!isInDOM(entry.target)) {\n        scrollsIntersector.unobserve(scrollable.container);\n        scrollables.delete(scrollable.container);\n      }\n    }\n  }\n}); */\n\nconst SCROLL_THROTTLE = /* IS_ANDROID ? 200 :  */24;\nconst USE_OWN_SCROLL = !IS_OVERLAY_SCROLL_SUPPORTED;\n\nlet throttleMeasurement: (callback: () => void) => number,\n  cancelMeasurement: (id: number) => void;\nif(USE_OWN_SCROLL) {\n  throttleMeasurement = (callback) => requestAnimationFrame(callback);\n  cancelMeasurement = (id) => cancelAnimationFrame(id);\n} else {\n  throttleMeasurement = (callback) => window.setTimeout(callback, SCROLL_THROTTLE);\n  cancelMeasurement = (id) => window.clearTimeout(id);\n}\n\nexport class ScrollableBase {\n  protected log: ReturnType<typeof logger>;\n\n  public padding: HTMLElement;\n  public splitUp: HTMLElement;\n  public onScrollMeasure: number = 0;\n\n  public lastScrollPosition: number = 0;\n  public lastScrollDirection: number = 0;\n\n  public onAdditionalScroll: () => void;\n  public onScrolledTop: () => void;\n  public onScrolledBottom: () => void;\n\n  public isHeavyAnimationInProgress = false;\n  protected needCheckAfterAnimation = false;\n\n  public checkForTriggers?: () => void;\n\n  public scrollPositionProperty: 'scrollTop' | 'scrollLeft';\n  public scrollSizeProperty: 'scrollHeight' | 'scrollWidth';\n  public clientSizeProperty: 'clientHeight' | 'clientWidth';\n  public offsetSizeProperty: 'offsetHeight' | 'offsetWidth';\n  public clientAxis: 'clientY' | 'clientX';\n\n  protected startMousePosition: number;\n  protected startScrollPosition: number;\n\n  protected thumb: HTMLElement;\n  protected thumbContainer: HTMLElement;\n\n  protected removeHeavyAnimationListener: () => void;\n  protected addedScrollListener: boolean;\n\n  constructor(\n    public el?: HTMLElement,\n    logPrefix = '',\n    public container: HTMLElement = document.createElement('div')\n  ) {\n    this.container.classList.add('scrollable');\n\n    this.log = logger('SCROLL' + (logPrefix ? '-' + logPrefix : ''), LogTypes.Error);\n\n    if(el) {\n      Array.from(el.children).forEach((c) => this.container.append(c));\n\n      el.append(this.container);\n    }\n\n    // this.onScroll();\n  }\n\n  public addScrollListener() {\n    if(this.addedScrollListener) {\n      return;\n    }\n\n    this.addedScrollListener = true;\n    this.container.addEventListener('scroll', this.onScroll, {passive: true, capture: true});\n  }\n\n  public removeScrollListener() {\n    if(!this.addedScrollListener) {\n      return;\n    }\n\n    this.addedScrollListener = false;\n    this.container.removeEventListener('scroll', this.onScroll, {capture: true});\n  }\n\n  public setListeners() {\n    if(this.removeHeavyAnimationListener) {\n      return;\n    }\n\n    window.addEventListener('resize', this.onScroll, {passive: true});\n    this.addScrollListener();\n\n    this.removeHeavyAnimationListener = useHeavyAnimationCheck(() => {\n      this.isHeavyAnimationInProgress = true;\n\n      if(this.onScrollMeasure) {\n        this.cancelMeasure();\n        this.needCheckAfterAnimation = true;\n      }\n    }, () => {\n      this.isHeavyAnimationInProgress = false;\n\n      if(this.needCheckAfterAnimation) {\n        this.onScroll();\n        this.needCheckAfterAnimation = false;\n      }\n    });\n  }\n\n  public removeListeners() {\n    if(!this.removeHeavyAnimationListener) {\n      return;\n    }\n\n    window.removeEventListener('resize', this.onScroll);\n    if(this.thumb) {\n      this.thumb.removeEventListener('mousedown', this.onMouseMove);\n      window.removeEventListener('mousemove', this.onMouseMove);\n      window.removeEventListener('mouseup', this.onMouseUp);\n    }\n    this.removeScrollListener();\n\n    this.removeHeavyAnimationListener();\n    this.removeHeavyAnimationListener = undefined;\n  }\n\n  public destroy() {\n    this.removeListeners();\n    this.onAdditionalScroll = undefined;\n    this.onScrolledTop = undefined;\n    this.onScrolledBottom = undefined;\n  }\n\n  public prepend(...elements: (string | Node)[]) {\n    const prependTo = this.splitUp || this.padding || this.container;\n    this.thumb && prependTo !== this.container && elements.unshift(this.thumbContainer);\n    prependTo.prepend(...elements);\n    this.onSizeChange();\n  }\n\n  public append(...elements: (string | Node)[]) {\n    (this.splitUp || this.padding || this.container).append(...elements);\n    this.onSizeChange();\n  }\n\n  public scrollIntoViewNew(options: Omit<ScrollOptions, 'container'>) {\n    // return Promise.resolve();\n    // this.removeListeners();\n    return fastSmoothScroll({\n      ...options,\n      container: this.container\n    });/* .finally(() => {\n      this.setListeners();\n    }); */\n  }\n\n  public onScroll = () => {\n    // if(this.debug) {\n    // this.log('onScroll call', this.onScrollMeasure);\n    // }\n\n    // return;\n\n    if(this.isHeavyAnimationInProgress) {\n      this.cancelMeasure();\n      this.needCheckAfterAnimation = true;\n      return;\n    }\n\n    // if(this.onScrollMeasure || ((this.scrollLocked || (!this.onScrolledTop && !this.onScrolledBottom)) && !this.splitUp && !this.onAdditionalScroll)) return;\n    if((!this.onScrolledTop && !this.onScrolledBottom) && !this.splitUp && !this.onAdditionalScroll) return;\n    if(this.onScrollMeasure) return;\n    this.onScrollMeasure = throttleMeasurement(() => {\n      this.onScrollMeasure = 0;\n\n      const scrollPosition = this.scrollPosition;\n      this.lastScrollDirection = this.lastScrollPosition === scrollPosition ? 0 : (this.lastScrollPosition < scrollPosition ? 1 : -1); // * 1 - bottom, -1 - top\n      this.lastScrollPosition = scrollPosition;\n\n      this.updateThumb(scrollPosition);\n\n      // lastScrollDirection check is useless here, every callback should decide on its own\n      if(this.onAdditionalScroll/*  && this.lastScrollDirection !== 0 */) {\n        this.onAdditionalScroll();\n      }\n\n      if(this.checkForTriggers) {\n        this.checkForTriggers();\n      }\n    });\n  };\n\n  public updateThumb(scrollPosition = this.scrollPosition) {\n    if(!USE_OWN_SCROLL || !this.thumb) {\n      return;\n    }\n\n    const scrollSize = this.container[this.scrollSizeProperty];\n    const clientSize = this.container[this.clientSizeProperty];\n    const divider = scrollSize / clientSize / 0.75;\n    const thumbSize = Math.max(20, clientSize / divider);\n    const value = scrollPosition / (scrollSize - clientSize) * clientSize;\n    // const b = (scrollPosition + clientSize) / scrollSize;\n    const b = scrollPosition / (scrollSize - clientSize);\n    const maxValue = clientSize - thumbSize;\n    if(clientSize < scrollSize) {\n      this.thumb.style.height = thumbSize + 'px';\n      // this.thumb.style.top = `${Math.min(maxValue, value - thumbSize * b)}px`;\n      this.thumb.style.transform = `translateY(${Math.min(maxValue, value - thumbSize * b)}px)`;\n    } else {\n      this.thumb.style.height = '0px';\n    }\n  }\n\n  public cancelMeasure() {\n    if(this.onScrollMeasure) {\n      cancelMeasurement(this.onScrollMeasure);\n      this.onScrollMeasure = 0;\n    }\n  }\n\n  protected onMouseMove = (e: MouseEvent) => {\n    cancelEvent(e);\n\n    const contentHeight = this.scrollSize;\n    const viewportHeight = this.clientSize;\n    const scrollbarSize = this.thumb.offsetHeight;\n    const maxScrollTop = contentHeight - viewportHeight;\n\n    const maxScrollbarOffset = viewportHeight - scrollbarSize;\n    const deltaY = e[this.clientAxis] - this.startMousePosition;\n    const scrollAmount = (deltaY / maxScrollbarOffset) * maxScrollTop;\n    const newScrollTop = this.startScrollPosition + scrollAmount;\n\n    this.scrollPosition = newScrollTop;\n  };\n\n  protected onMouseDown = (e: MouseEvent) => {\n    cancelEvent(e);\n    this.startMousePosition = e[this.clientAxis];\n    this.startScrollPosition = this.scrollPosition;\n    this.thumb.classList.add('is-focused');\n\n    window.addEventListener('mousemove', this.onMouseMove);\n    window.addEventListener('mouseup', this.onMouseUp, {once: true});\n  };\n\n  protected onMouseUp = (e: MouseEvent) => {\n    window.removeEventListener('mousemove', this.onMouseMove);\n    this.thumb.classList.remove('is-focused');\n  };\n\n  public onSizeChange() {\n    if(USE_OWN_SCROLL && this.thumb) {\n      this.onScroll();\n    }\n  }\n\n  public getDistanceToEnd() {\n    return this.scrollSize - Math.round(this.scrollPosition + this.offsetSize);\n  }\n\n  get isScrolledToEnd() {\n    return this.getDistanceToEnd() <= 1;\n  }\n\n  get scrollPosition() {\n    return this.container[this.scrollPositionProperty];\n  }\n\n  set scrollPosition(value: number) {\n    this.container[this.scrollPositionProperty] = value;\n  }\n\n  get scrollSize() {\n    return this.container[this.scrollSizeProperty];\n  }\n\n  get clientSize() {\n    return this.container[this.clientSizeProperty];\n  }\n\n  get offsetSize() {\n    return this.container[this.offsetSizeProperty];\n  }\n\n  get firstElementChild() {\n    return this.thumb ? this.thumbContainer.nextElementSibling : this.container.firstElementChild;\n  }\n\n  public setScrollPositionSilently(value: number) {\n    this.lastScrollPosition = value;\n    this.ignoreNextScrollEvent();\n\n    this.scrollPosition = value;\n  }\n\n  public ignoreNextScrollEvent() {\n    if(this.removeHeavyAnimationListener) {\n      this.removeScrollListener();\n      this.container.addEventListener('scroll', (e) => {\n        cancelEvent(e);\n        this.addScrollListener();\n      }, {capture: true, passive: false, once: true});\n    }\n  }\n\n  public replaceChildren(...args: (string | Node)[]) {\n    this.thumb && args.unshift(this.thumbContainer);\n    this.container.replaceChildren(...args);\n  }\n}\n\nexport type SliceSides = 'top' | 'bottom';\nexport type SliceSidesContainer = {[k in SliceSides]: boolean};\n\nexport default class Scrollable extends ScrollableBase {\n  public loadedAll: SliceSidesContainer = {top: true, bottom: false};\n\n  constructor(\n    el?: HTMLElement,\n    logPrefix = '',\n    public onScrollOffset = 300,\n    withPaddingContainer?: boolean,\n    container?: HTMLElement\n  ) {\n    super(el, logPrefix, container);\n\n    // withPaddingContainer = true;\n    // if(withPaddingContainer) {\n    //   this.padding = document.createElement('div');\n    //   this.padding.classList.add('scrollable-padding');\n    //   this.padding.append(...Array.from(this.container.children));\n    //   this.container.append(this.padding);\n    // }\n\n    this.scrollPositionProperty = 'scrollTop';\n    this.scrollSizeProperty = 'scrollHeight';\n    this.clientSizeProperty = 'clientHeight';\n    this.offsetSizeProperty = 'offsetHeight';\n    this.clientAxis = 'clientY';\n\n    if(USE_OWN_SCROLL) {\n      this.thumbContainer = document.createElement('div');\n      this.thumbContainer.classList.add('scrollable-thumb-container');\n      this.thumb = document.createElement('div');\n      this.thumb.classList.add('scrollable-thumb');\n      this.thumbContainer.append(this.thumb);\n      this.container.prepend(this.thumbContainer);\n\n      this.thumb.addEventListener('mousedown', this.onMouseDown);\n    }\n\n    this.container.classList.add('scrollable-y');\n    if(IS_SAFARI && !IS_MOBILE_SAFARI) {\n      this.container.classList.add('no-scrollbar');\n    }\n    this.setListeners();\n  }\n\n  public attachBorderListeners(setClassOn = this.container) {\n    const cb = this.onAdditionalScroll;\n    this.onAdditionalScroll = () => {\n      cb?.();\n      setClassOn.classList.toggle('scrolled-top', !this.scrollPosition);\n      setClassOn.classList.toggle('scrolled-bottom', this.isScrolledToEnd);\n    };\n\n    setClassOn.classList.add('scrolled-top', 'scrolled-bottom', 'scrollable-y-bordered');\n  }\n\n  public setVirtualContainer(el?: HTMLElement) {\n    this.splitUp = el;\n    this.log('setVirtualContainer:', el, this);\n  }\n\n  public checkForTriggers = () => {\n    if((!this.onScrolledTop && !this.onScrolledBottom)) return;\n\n    if(this.isHeavyAnimationInProgress) {\n      this.onScroll();\n      return;\n    }\n\n    const {scrollSize, scrollPosition, clientSize} = this;\n    if(!scrollSize) { //         \n      return;\n    }\n\n    const maxScrollPosition = scrollSize - clientSize;\n\n    // this.log('checkForTriggers:', scrollTop, maxScrollTop);\n\n    if(this.onScrolledTop && scrollPosition <= this.onScrollOffset && this.lastScrollDirection <= 0/* && direction === -1 */) {\n      this.onScrolledTop();\n    }\n\n    if(this.onScrolledBottom && (maxScrollPosition - scrollPosition) <= this.onScrollOffset && this.lastScrollDirection >= 0/* && direction === 1 */) {\n      this.onScrolledBottom();\n    }\n  };\n}\n\nexport class ScrollableX extends ScrollableBase {\n  constructor(el: HTMLElement, logPrefix = '', public onScrollOffset = 300, public splitCount = 15, public container: HTMLElement = document.createElement('div')) {\n    super(el, logPrefix, container);\n\n    this.container.classList.add('scrollable-x');\n\n    if(!IS_TOUCH_SUPPORTED) {\n      const scrollHorizontally = (e: WheelEvent) => {\n        e.stopPropagation();\n        if(!e.deltaX && this.container.scrollWidth > this.container.clientWidth) {\n          this.container.scrollLeft += e.deltaY / 4;\n          cancelEvent(e);\n        }\n      };\n\n      this.container.addEventListener('wheel', scrollHorizontally, {passive: false});\n    }\n\n    this.scrollPositionProperty = 'scrollLeft';\n    this.scrollSizeProperty = 'scrollWidth';\n    this.clientSizeProperty = 'clientWidth';\n    this.offsetSizeProperty = 'offsetWidth';\n  }\n}\n"],"names":["SCROLL_THROTTLE","USE_OWN_SCROLL","IS_OVERLAY_SCROLL_SUPPORTED","throttleMeasurement","cancelMeasurement","callback","id","ScrollableBase","el","logPrefix","container","scrollPosition","e","cancelEvent","contentHeight","viewportHeight","scrollbarSize","maxScrollTop","maxScrollbarOffset","scrollAmount","newScrollTop","logger","LogTypes","c","useHeavyAnimationCheck","elements","prependTo","options","fastSmoothScroll","scrollSize","clientSize","divider","thumbSize","value","b","maxValue","args","Scrollable","onScrollOffset","withPaddingContainer","maxScrollPosition","IS_SAFARI","IS_MOBILE_SAFARI","setClassOn","cb","ScrollableX","splitCount","IS_TOUCH_SUPPORTED","scrollHorizontally"],"mappings":"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"}
\ No newline at end of file

--- public/version ---
@@ -1 +1 @@
-2.0.0 (486)
\ No newline at end of file
+2.0.0 (487)
\ No newline at end of file

--- src/components/peerProfile.ts ---
@@ -11,6 +11,7 @@ import anchorCopy from '../helpers/dom/anchorCopy';
 import cancelEvent from '../helpers/dom/cancelEvent';
 import {attachClickEvent, simulateClickEvent} from '../helpers/dom/clickEvent';
 import replaceContent from '../helpers/dom/replaceContent';
+import safeWindowOpen from '../helpers/dom/safeWindowOpen';
 import setInnerHTML from '../helpers/dom/setInnerHTML';
 import ListenerSetter from '../helpers/listenerSetter';
 import makeError from '../helpers/makeError';
@@ -183,7 +184,7 @@ export default class PeerProfile {
             return a;
           })()],
           onClick: () => {
-            window.open('https://fragment.com/numbers', '_blank');
+            safeWindowOpen('https://fragment.com/numbers');
           },
           separator: true,
           secondary: true,

--- src/components/popups/sponsored.ts ---
@@ -4,6 +4,7 @@
  * https://github.com/morethanwords/tweb/blob/master/LICENSE
  */
 
+import safeWindowOpen from '../../helpers/dom/safeWindowOpen';
 import I18n, {i18n} from '../../lib/langPack';
 import PopupPeer from './peer';
 
@@ -19,7 +20,7 @@ export default class PopupSponsored extends PopupPeer {
       }, {
         langKey: 'Chat.Message.Ad.ReadMore',
         callback: () => {
-          window.open(I18n.format('Chat.Message.Sponsored.Link', true));
+          safeWindowOpen(I18n.format('Chat.Message.Sponsored.Link', true));
         },
         isCancel: true
       }],

--- src/components/popups/webApp.ts ---
@@ -25,6 +25,7 @@ import PopupPeer, {PopupPeerOptions} from './peer';
 import {LangPackKey} from '../../lib/langPack';
 import PopupPickUser from './pickUser';
 import {calculateLuminance, calculateOpacity, getTextColor, hexToRgb, rgbaToRgb} from '../../helpers/color';
+import safeWindowOpen from '../../helpers/dom/safeWindowOpen';
 
 const SANDBOX_ATTRIBUTES = [
   'allow-scripts',
@@ -412,7 +413,7 @@ export default class PopupWebApp extends PopupElement<{
         this.forceHide();
       },
       web_app_open_link: ({url}) => {
-        window.open(url, '_blank');
+        safeWindowOpen(url);
       },
       web_app_open_tg_link: ({path_full}) => {
         appImManager.openUrl('https://t.me' + path_full);

--- src/helpers/dom/safeWindowOpen.ts ---
@@ -0,0 +1,3 @@
+export default function safeWindowOpen(url: string) {
+  window.open(url, '_blank', 'noreferrer');
+}

