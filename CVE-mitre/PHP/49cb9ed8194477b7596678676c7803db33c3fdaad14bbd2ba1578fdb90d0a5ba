--- core/common/PopUpNewsData.class.php ---
@@ -15,14 +15,14 @@ public function popupnewsitem($id)
     {
         $query = 'SELECT *
                  FROM ' . TABLE_PREFIX .'news
-                 WHERE id=' . $id . ' ';
+                 WHERE id=' . DB::escape($id) . ' ';
 
         return DB::get_row($query);
     }
     
     public function get_news_list($howmany) {
         $sql = 'SELECT id, subject, body, postedby, UNIX_TIMESTAMP(postdate) AS postdate
-		FROM ' . TABLE_PREFIX .'news ORDER BY postdate DESC LIMIT '.$howmany;
+		FROM ' . TABLE_PREFIX .'news ORDER BY postdate DESC LIMIT '.DB::escape($howmany);
 
         return DB::get_results($sql);
     }

--- core/modules/PopUpNews/PopUpNews.php ---
@@ -13,6 +13,8 @@ class PopUpNews extends CodonModule
 {
     public function popupnewsitem($id) {
 
+                if(!is_numeric($id)){header('Location: '.url('/'));}
+        
                 $result = PopUpNewsData::popupnewsitem($id);
                 Template::Set('item', $result);
                 Template::Show('popupnews/popupnews_item.tpl');
@@ -21,6 +23,8 @@ public function popupnewsitem($id) {
 
     public function PopUpNewsList($howmany = 5)
     {
+        if(!is_numeric($id)){exit;}
+        
         $res = PopUpNewsData::get_news_list($howmany);
 
         if(!$res)

