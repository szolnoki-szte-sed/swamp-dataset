--- src/Image.php ---
@@ -624,6 +624,9 @@ private function get_attachment_id($url)
      */
     private function fetch_external_image($id, $url)
     {
+        if ( ! $this->is_image_url($url) )
+            return false;
+
         $full_image_path = trailingslashit($this->get_plugin_uploads_dir()['basedir']) . "{$id}_" . sanitize_file_name(rawurldecode(wp_basename($url)));
 
         // if the file exists already, return URL and path
@@ -932,6 +935,15 @@ private function is_image_url($url)
         if ( ! filter_var($parse_url, FILTER_VALIDATE_URL) )
             return false;
 
+        // Check extension
+        $file_name = basename($path);
+        $file_name = sanitize_file_name($file_name);
+        $ext = strtolower(pathinfo($file_name, PATHINFO_EXTENSION));
+        $allowed_ext = ['jpg', 'jpeg', 'png', 'gif'];
+
+        if ( ! in_array($ext, $allowed_ext) )
+            return false;
+
         // sanitize URL, just in case
         $image_url = esc_url($url);
         // remove querystring

