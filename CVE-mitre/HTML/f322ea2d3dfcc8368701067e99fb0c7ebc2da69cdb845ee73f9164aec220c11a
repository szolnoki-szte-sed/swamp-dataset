--- packages/app-cli/tests/md_to_html/sanitize_21.md ---
@@ -1 +1 @@
-Should keep this comment: <!-- keep this &amp; that -->
\ No newline at end of file
+Should keep this comment: <!-- keep this & that -->
\ No newline at end of file

--- packages/app-cli/tests/md_to_html/sanitize_23.html ---
@@ -0,0 +1 @@
+<math class="jop-noMdConv"><p class="jop-noMdConv"><style class="jop-noMdConv"><!--&lt;/style&gt;&lt;img src onerror=alert(1)&gt;--></style>
\ No newline at end of file

--- packages/app-cli/tests/md_to_html/sanitize_23.md ---
@@ -0,0 +1 @@
+<math><p><style><!--</style><img src onerror=alert(1)>--></style>

--- packages/renderer/htmlUtils.ts ---
@@ -260,8 +260,10 @@ class HtmlUtils {
 
 		const parser = new htmlparser2.Parser({
 
-			oncomment: (encodedData: string) => {
-				output.push(`<!--${encodedData}-->`);
+			oncomment: (data: string) => {
+				// Ensure that <s and >s are escaped within comments. In some cases,
+				// these characters can end a comment early (e.g. <style><!--</style>-->)
+				output.push(`<!--${htmlentities(data)}-->`);
 			},
 
 			onopentag: (name: string, attrs: Record<string, string>) => {

