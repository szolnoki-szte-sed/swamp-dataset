--- initialize.php ---
@@ -12,7 +12,7 @@
 // Disable displaying errors on screen.
 ini_set('display_errors', 'Off');
 
-define("APP_VERSION", "1.19.29.5598");
+define("APP_VERSION", "1.19.30.5599");
 define("APP_DIR", dirname(__FILE__));
 define("LIBRARY_DIR", APP_DIR."/WEB-INF/lib");
 define("TEMPLATE_DIR", APP_DIR."/WEB-INF/templates");

--- time.php ---
@@ -32,6 +32,12 @@
     exit();
   }
 }
+// If we are passed in a date, make sure it is in correct format.
+$date = $request->getParameter('date');
+if ($date && !ttValidDate($date)) {
+  header('Location: access_denied.php');
+  exit();
+}
 // End of access checks.
 
 // Determine user for whom we display this page.

