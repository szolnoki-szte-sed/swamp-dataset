--- ajax/addressing.php ---
@@ -59,6 +59,9 @@
 } else {
    Html::popHeader(__s('IP reservation', 'addressing'), $_SERVER['PHP_SELF']);
    $PluginAddressingReserveip = new PluginAddressingReserveip();
-   $PluginAddressingReserveip->showReservationForm($_GET["ip"], $_GET['id_addressing'], $_GET['rand']);
+   if(filter_var($_GET["ip"], FILTER_VALIDATE_IP)) {
+      $PluginAddressingReserveip->showReservationForm($_GET["ip"], $_GET['id_addressing'], $_GET['rand']);
+   }
+
    Html::popFooter();
 }

--- ajax/ping.php ---
@@ -40,7 +40,7 @@
 
 Session::checkLoginUser();
 
-if (!isset($_POST['ip'])) {
+if (!isset($_POST['ip']) || !filter_var($_POST["ip"], FILTER_VALIDATE_IP)) {
    exit();
 }
 $ip = $_POST['ip'];

--- front/reserveip.form.php ---
@@ -37,6 +37,8 @@
    Html::back();
 } else {
    Html::header(PluginAddressingReserveip::getTypeName(), '', "tools", "pluginaddressingmenu");
-   $reserveip->showReservationForm($_REQUEST["ip"], $_REQUEST["id_addressing"], $_REQUEST['rand']);
+   if(filter_var($_REQUEST["ip"], FILTER_VALIDATE_IP)) {
+      $reserveip->showReservationForm($_REQUEST["ip"], $_REQUEST["id_addressing"], $_REQUEST['rand']);
+   }
    Html::footer();
 }

