--- packages/umbreld/package-lock.json ---
@@ -1,12 +1,12 @@
 {
 	"name": "umbreld",
-	"version": "1.0.0",
+	"version": "1.2.1",
 	"lockfileVersion": 2,
 	"requires": true,
 	"packages": {
 		"": {
 			"name": "umbreld",
-			"version": "1.0.0",
+			"version": "1.2.1",
 			"license": "PolyForm Noncommercial License 1.0.0",
 			"dependencies": {
 				"@trpc/client": "^10.34.0",
@@ -31,6 +31,7 @@
 				"express-session": "^1.17.3",
 				"fs-extra": "^11.1.1",
 				"globby": "^13.2.1",
+				"helmet": "^7.1.0",
 				"http-proxy-middleware": "^2.0.6",
 				"isomorphic-git": "^1.24.5",
 				"js-yaml": "^4.1.0",
@@ -5051,6 +5052,14 @@
 				"minimalistic-assert": "^1.0.1"
 			}
 		},
+		"node_modules/helmet": {
+			"version": "7.1.0",
+			"resolved": "https://registry.npmjs.org/helmet/-/helmet-7.1.0.tgz",
+			"integrity": "sha512-g+HZqgfbpXdCkme/Cd/mZkV0aV3BZZZSugecH03kl38m/Kmdx8jKjBikpDj2cr+Iynv4KpYEviojNdTJActJAg==",
+			"engines": {
+				"node": ">=16.0.0"
+			}
+		},
 		"node_modules/hmac-drbg": {
 			"version": "1.0.1",
 			"resolved": "https://registry.npmjs.org/hmac-drbg/-/hmac-drbg-1.0.1.tgz",
@@ -14787,6 +14796,11 @@
 				"minimalistic-assert": "^1.0.1"
 			}
 		},
+		"helmet": {
+			"version": "7.1.0",
+			"resolved": "https://registry.npmjs.org/helmet/-/helmet-7.1.0.tgz",
+			"integrity": "sha512-g+HZqgfbpXdCkme/Cd/mZkV0aV3BZZZSugecH03kl38m/Kmdx8jKjBikpDj2cr+Iynv4KpYEviojNdTJActJAg=="
+		},
 		"hmac-drbg": {
 			"version": "1.0.1",
 			"resolved": "https://registry.npmjs.org/hmac-drbg/-/hmac-drbg-1.0.1.tgz",

--- packages/umbreld/package.json ---
@@ -117,6 +117,7 @@
 		"express-session": "^1.17.3",
 		"fs-extra": "^11.1.1",
 		"globby": "^13.2.1",
+		"helmet": "^7.1.0",
 		"http-proxy-middleware": "^2.0.6",
 		"isomorphic-git": "^1.24.5",
 		"js-yaml": "^4.1.0",

--- packages/umbreld/source/modules/server/index.ts ---
@@ -9,6 +9,7 @@ import {pipeline} from 'node:stream/promises'
 import {$} from 'execa'
 import express from 'express'
 import cookieParser from 'cookie-parser'
+import helmet from 'helmet'
 import cors from 'cors'
 import pty, {IPty} from 'node-pty'
 
@@ -67,10 +68,24 @@ class Server {
 		// Setup cookie parser
 		app.use(cookieParser())
 
+		// Security hardening, CSP
+		app.use(
+			helmet.contentSecurityPolicy({
+				directives: {
+					// Allow inline scripts ONLY in development for vite dev server
+					scriptSrc: this.umbreld.developmentMode ? ["'self'", "'unsafe-inline'"] : null,
+					// Allow 3rd party app images (remove this if we serve them locally in the future)
+					imgSrc: ['*'],
+					// Allow fetching data from our apps API (e.g., for Discover page in App Store)
+					connectSrc: ["'self'", 'https://apps.umbrel.com'],
+					// Allow plain text access over the local network
+					upgradeInsecureRequests: null,
+				},
+			}),
+		)
+		app.use(helmet.referrerPolicy({policy: 'no-referrer'}))
 		app.disable('x-powered-by')
 
-		// TODO: Security hardening, helmet etc.
-
 		// Attach the umbreld and logger instances so they're accessible to routes
 		app.set('umbreld', this.umbreld)
 		app.set('logger', this.logger)

