--- docs/NEWS ---
@@ -4,6 +4,9 @@ Version 2.0.6 ()
     * Fix Bug #428, regression when fetching remote files, wrong call
       to HTTP_Request::getEffectiveUrl()
 
+    * Fix Bug #433, secure variable on first time installation to prevent
+      RCE, thanks to Shinkurt
+
 Version 2.0.5 (November 28th, 2016)
 ------------------------------------------------------------------------
 

--- include/functions_installer.inc.php ---
@@ -629,7 +629,7 @@ function serendipity_checkInstallation() {
         $errs[] = INSTALL_DBPREFIX_INVALID;
     }
 
-    $serendipity['dbType'] = $_POST['dbType'];
+    $serendipity['dbType'] = preg_replace('@[^a-z0-9-]@imsU', '', $_POST['dbType']);
     // Probe database
     // (do it after the dir stuff, as we need to be able to create the sqlite database)
     include_once(S9Y_INCLUDE_PATH . "include/db/{$serendipity['dbType']}.inc.php");

