--- src/embedded_vendor/jpgraph/jpgraph_gantt.php ---
@@ -3648,7 +3648,7 @@ public function Stroke($aImg, $aScale)
                     }
 
                     if (! empty($this->title->csimalt[$i])) {
-                        $tmp             = $this->title->csimalt[$i];
+                        $tmp             = Codendi_HTMLPurifier::instance()->purify($this->title->csimalt[$i]);
                         $this->csimarea .= " title=\"$tmp\" alt=\"$tmp\" ";
                     }
                     $this->csimarea .= " />\n";
@@ -3697,7 +3697,7 @@ public function Stroke($aImg, $aScale)
             }
 
             if ($this->csimalt != '') {
-                $tmp             = $this->csimalt;
+                $tmp             = Codendi_HTMLPurifier::instance()->purify($this->csimalt);
                 $this->csimarea .= " title=\"$tmp\" alt=\"$tmp\" ";
             }
             $this->csimarea .= " />\n";
@@ -3835,7 +3835,7 @@ public function Stroke($aImg, $aScale)
                     }
 
                     if (! empty($this->title->csimalt[$i])) {
-                        $tmp             = $this->title->csimalt[$i];
+                        $tmp             = Codendi_HTMLPurifier::instance()->purify($this->title->csimalt[$i]);
                         $this->csimarea .= " title=\"$tmp\" alt=\"$tmp\" ";
                     }
                     $this->csimarea .= " />\n";

--- src/embedded_vendor/jpgraph/jpgraph_plotmark.inc.php ---
@@ -169,7 +169,7 @@ public function AddCSIMPoly($aPts)
             }
 
             if (! empty($this->csimalt)) {
-                $tmp              = sprintf($this->csimalt, $this->yvalue, $this->xvalue);
+                $tmp              = Codendi_HTMLPurifier::instance()->purify(sprintf($this->csimalt, $this->yvalue, $this->xvalue));
                 $this->csimareas .= " title=\"$tmp\" alt=\"$tmp\"";
             }
             $this->csimareas .= " />\n";
@@ -190,7 +190,7 @@ public function AddCSIMCircle($x, $y, $r)
             }
 
             if (! empty($this->csimalt)) {
-                $tmp              = sprintf($this->csimalt, $this->yvalue, $this->xvalue);
+                $tmp              = Codendi_HTMLPurifier::instance()->purify(sprintf($this->csimalt, $this->yvalue, $this->xvalue));
                 $this->csimareas .= " title=\"$tmp\" alt=\"$tmp\" ";
             }
             $this->csimareas .= " />\n";
@@ -349,7 +349,7 @@ public function Stroke($img, $x, $y)
                 }
 
                 if (! empty($this->csimalt)) {
-                    $tmp              = sprintf($this->csimalt, $this->yvalue, $this->xvalue);
+                    $tmp              = Codendi_HTMLPurifier::instance()->purify(sprintf($this->csimalt, $this->yvalue, $this->xvalue));
                     $this->csimareas .= " title=\"$tmp\" alt=\"$tmp\" ";
                 }
                 $this->csimareas .= " />\n";

