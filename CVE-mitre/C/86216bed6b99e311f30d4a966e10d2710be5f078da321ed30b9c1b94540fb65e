--- ChangeLog ---
@@ -3,6 +3,7 @@ v1.9.2 - February 23, 2017
 Thanks to @hannob for finding some Out-of-bound exceptions in memory handline.
 * [SECURITY] An invalid memory access (heap overrun) in handling LONG datatypes
 * [SECURITY] Missing a check for fields of size 0
+* [SECURITY] Potential buffer overrun on incoming Compressed RTF Streams
 
 This version  & the previous 1.9.1 resolves the following CVEs:
 * CVE-2017-6306

--- lib/ytnef.c ---
@@ -1541,7 +1541,7 @@ BYTE *DecompressRTF(variableLength *p, int *size) {
     ALLOCCHECK_CHAR(dst);
     memcpy(dst, comp_Prebuf.data, comp_Prebuf.size);
     out = comp_Prebuf.size;
-    while (out < (comp_Prebuf.size + uncompressedSize)) {
+    while ((out < (comp_Prebuf.size + uncompressedSize)) && (in < p->size)) {
       // each flag byte flags 8 literals/references, 1 per bit
       flags = (flagCount++ % 8 == 0) ? src[in++] : flags >> 1;
       if ((flags & 1) == 1) { // each flag bit is 1 for reference, 0 for literal

