--- adi-chat/src/main/java/com/moyz/adi/chat/controller/ConversationController.java ---
@@ -48,7 +48,7 @@ public ConvMsgListResp detail(
 
     @PostMapping("/add")
     public ConvDto add(@RequestBody @Validated ConvAddReq convAddReq) {
-        return conversationService.add(convAddReq.getTitle(), convAddReq.getAiSystemMessage());
+        return conversationService.add(convAddReq.getTitle(), convAddReq.getRemark(), convAddReq.getAiSystemMessage());
     }
 
     @Operation(summary = "根据预设会话创建用户自己的会话")

--- adi-common/src/main/java/com/moyz/adi/common/dto/ConvAddReq.java ---
@@ -10,5 +10,8 @@ public class ConvAddReq {
 
     @NotBlank
     private String title;
+
+    private String remark;
+
     private String aiSystemMessage;
 }

--- adi-common/src/main/java/com/moyz/adi/common/dto/ConvEditReq.java ---
@@ -10,6 +10,8 @@ public class ConvEditReq {
     @NotBlank
     private String title;
 
+    private String remark;
+
     @Schema(title = "set the system message to ai, ig: you are a lawyer")
     private String aiSystemMessage;
 

--- adi-common/src/main/java/com/moyz/adi/common/entity/AdiFile.java ---
@@ -4,7 +4,9 @@
 import com.baomidou.mybatisplus.annotation.TableName;
 import io.swagger.v3.oas.annotations.media.Schema;
 import lombok.Data;
+import lombok.EqualsAndHashCode;
 
+@EqualsAndHashCode(callSuper = true)
 @Data
 @TableName("adi_file")
 @Schema(title = "文件表")
@@ -21,9 +23,9 @@ public class AdiFile extends BaseEntity {
     @TableField(value = "uuid")
     private String uuid;
 
-    @Schema(title = "md5")
-    @TableField(value = "md5")
-    private String md5;
+    @Schema(title = "sha256")
+    @TableField(value = "sha256")
+    private String sha256;
 
     @Schema(title = "file extension")
     @TableField(value = "ext")

--- adi-common/src/main/java/com/moyz/adi/common/entity/Conversation.java ---
@@ -30,6 +30,10 @@ public class Conversation extends BaseEntity {
     @TableField("title")
     private String title;
 
+    @Schema(title = "描述")
+    @TableField("remark")
+    private String remark;
+
     @Schema(title = "消耗的token数量")
     @TableField("tokens")
     private Integer tokens;

--- adi-common/src/main/java/com/moyz/adi/common/enums/ErrorEnum.java ---
@@ -57,10 +57,13 @@ public enum ErrorEnum {
     B_ACTIVE_USER_ERROR("B0016", "激活用户失败"),
     B_RESET_PASSWORD_ERROR("B0017", "重置密码失败"),
     B_IMAGE_LOAD_ERROR("B0018", "加载图片失败"),
+    B_IO_EXCEPTION("B0019", "IO异常"),
+    B_SERVER_EXCEPTION("B0020", "服务端异常"),
+    B_DELETE_FILE_ERROR("B0020", "删除文件异常"),
     C_DRAW_FAIL("C0001", "大模型生成图片失败,原因:{0}");
 
-    private String code;
-    private String info;
+    private final String code;
+    private final String info;
 
     ErrorEnum(String code, String info) {
         this.code = code;

--- adi-common/src/main/java/com/moyz/adi/common/service/ConversationService.java ---
@@ -155,7 +155,7 @@ public Conversation createByFirstMessage(Long userId, String uuid, String title)
         return this.lambdaQuery().eq(Conversation::getUuid, uuid).oneOpt().orElse(null);
     }
 
-    public ConvDto add(String title, String systemMessage) {
+    public ConvDto add(String title, String remark, String systemMessage) {
         Conversation conversation = this.lambdaQuery()
                 .eq(Conversation::getUserId, ThreadContext.getCurrentUserId())
                 .eq(Conversation::getTitle, title)
@@ -170,6 +170,7 @@ public ConvDto add(String title, String systemMessage) {
         one.setTitle(title);
         one.setAiSystemMessage(systemMessage);
         one.setUserId(ThreadContext.getCurrentUserId());
+        one.setRemark(remark);
         baseMapper.insert(one);
 
         Conversation conv = this.lambdaQuery().eq(Conversation::getUuid, uuid).one();
@@ -197,7 +198,7 @@ public ConvDto addByPresetConv(String presetConvUuid) {
             Conversation conv = this.getById(presetRel.getUserConvId());
             return MPPageUtil.convertTo(conv, ConvDto.class);
         }
-        ConvDto convDto = self.add(presetConv.getTitle(), presetConv.getAiSystemMessage());
+        ConvDto convDto = self.add(presetConv.getTitle(), presetConv.getRemark(), presetConv.getAiSystemMessage());
         conversationPresetRelService.save(
                 ConversationPresetRel.builder()
                         .presetConvId(presetConv.getId())

--- adi-common/src/main/java/com/moyz/adi/common/service/FileService.java ---
@@ -9,7 +9,7 @@
 import com.moyz.adi.common.exception.BaseException;
 import com.moyz.adi.common.mapper.FileMapper;
 import com.moyz.adi.common.util.FileUtil;
-import com.moyz.adi.common.util.MD5Utils;
+import com.moyz.adi.common.util.HashUtil;
 import com.moyz.adi.common.util.UuidUtil;
 import lombok.extern.slf4j.Slf4j;
 import org.apache.commons.io.FileUtils;
@@ -25,9 +25,12 @@
 import java.io.FileInputStream;
 import java.io.IOException;
 import java.net.URL;
+import java.nio.file.Files;
+import java.nio.file.Paths;
 import java.util.Optional;
 
 import static com.moyz.adi.common.enums.ErrorEnum.*;
+import static org.apache.poi.poifs.crypt.HashAlgorithm.md5;
 
 @Slf4j
 @Service
@@ -52,9 +55,9 @@ public class FileService extends ServiceImpl<FileMapper, AdiFile> {
     private String tmpImagesPath;
 
     public AdiFile writeToLocal(MultipartFile file, boolean image) {
-        String md5 = MD5Utils.md5ByMultipartFile(file);
+        String sha256 = HashUtil.sha256(file);
         Optional<AdiFile> existFile = this.lambdaQuery()
-                .eq(AdiFile::getMd5, md5)
+                .eq(AdiFile::getSha256, md5)
                 .eq(AdiFile::getIsDeleted, false)
                 .oneOpt();
         if (existFile.isPresent()) {
@@ -63,7 +66,7 @@ public AdiFile writeToLocal(MultipartFile file, boolean image) {
             if (exist) {
                 return adiFile;
             } else {
-                log.warn("文件不存在,删除记录以便后续重新生成,fileId:{},uuid:{},md5:{}", adiFile.getId(), adiFile.getUuid(), adiFile.getMd5());
+                log.warn("文件不存在,删除记录以便后续重新生成,fileId:{},uuid:{},sha256:{}", adiFile.getId(), adiFile.getUuid(), adiFile.getSha256());
                 this.lambdaUpdate().eq(AdiFile::getId, adiFile.getId()).set(AdiFile::getIsDeleted, true).update();
             }
         }
@@ -72,7 +75,7 @@ public AdiFile writeToLocal(MultipartFile file, boolean image) {
         AdiFile adiFile = new AdiFile();
         adiFile.setName(file.getOriginalFilename());
         adiFile.setUuid(uuid);
-        adiFile.setMd5(md5);
+        adiFile.setSha256(sha256);
         adiFile.setPath(originalFile.getLeft());
         adiFile.setExt(originalFile.getRight());
         adiFile.setUserId(ThreadContext.getCurrentUserId());
@@ -94,7 +97,7 @@ public String saveImageToLocal(User user, String sourceImageUrl) {
         AdiFile adiFile = new AdiFile();
         adiFile.setName(target.getName());
         adiFile.setUuid(uuid);
-        adiFile.setMd5(MD5Utils.calculateMD5(localPath));
+        adiFile.setSha256(HashUtil.sha256(localPath));
         adiFile.setPath(localPath);
         adiFile.setUserId(user.getId());
         adiFile.setExt("png");
@@ -120,9 +123,12 @@ public void removeFileAndSoftDel(String uuid) {
             return;
         }
         if (StringUtils.isNotBlank(adiFile.getPath())) {
-            File file = new File(adiFile.getPath());
-            if (!file.delete()) {
-                log.warn("Delete file error,uuid:{}", uuid);
+            try {
+                if (!Files.deleteIfExists(Paths.get(adiFile.getPath()))) {
+                    log.warn("Delete file fail,uuid:{}", uuid);
+                }
+            } catch (IOException e) {
+                throw new BaseException(B_DELETE_FILE_ERROR);
             }
         }
         this.softDel(uuid);
@@ -207,7 +213,7 @@ private BufferedImage readImage(AdiFile adiFile, boolean thumbnail) {
             }
             return ImageIO.read(new FileInputStream(currentFilePath));
         } catch (IOException e) {
-            throw new RuntimeException(e);
+            throw new BaseException(B_IO_EXCEPTION);
         }
     }
 

--- adi-common/src/main/java/com/moyz/adi/common/util/HashUtil.java ---
@@ -0,0 +1,61 @@
+package com.moyz.adi.common.util;
+
+import com.moyz.adi.common.enums.ErrorEnum;
+import com.moyz.adi.common.exception.BaseException;
+import lombok.extern.slf4j.Slf4j;
+import org.jetbrains.annotations.NotNull;
+import org.springframework.web.multipart.MultipartFile;
+
+import java.nio.charset.StandardCharsets;
+import java.security.MessageDigest;
+import java.security.NoSuchAlgorithmException;
+
+@Slf4j
+public class HashUtil {
+
+    private HashUtil() {
+    }
+
+    public static String sha256(MultipartFile file) {
+        try {
+            MessageDigest sha256 = MessageDigest.getInstance("SHA-256");
+            byte[] hash = sha256.digest(file.getBytes());
+            // 将哈希值转换为十六进制字符串
+            return getHashStr(hash);
+        } catch (NoSuchAlgorithmException e) {
+            log.error("Calculate file sha256 NoSuchAlgorithmException", e);
+            throw new BaseException(ErrorEnum.B_SERVER_EXCEPTION);
+        } catch (Exception e) {
+            log.error("Calculate file sha256 error", e);
+            throw new BaseException(ErrorEnum.B_SERVER_EXCEPTION);
+        }
+    }
+
+    public static String sha256(String str) {
+        try {
+            MessageDigest sha256 = MessageDigest.getInstance("SHA-256");
+            byte[] hash = sha256.digest(str.getBytes(StandardCharsets.UTF_8));
+            // 将哈希值转换为十六进制字符串
+            return getHashStr(hash);
+        } catch (NoSuchAlgorithmException e) {
+            log.error("Calculate string sha256 NoSuchAlgorithmException", e);
+            throw new BaseException(ErrorEnum.B_SERVER_EXCEPTION);
+        } catch (Exception e) {
+            log.error("Calculate string sha256 error", e);
+            throw new BaseException(ErrorEnum.B_SERVER_EXCEPTION);
+        }
+    }
+
+    @NotNull
+    private static String getHashStr(byte[] hash) {
+        StringBuilder hexString = new StringBuilder();
+        for (byte b : hash) {
+            String hex = Integer.toHexString(0xff & b);
+            if (hex.length() == 1) {
+                hexString.append('0');
+            }
+            hexString.append(hex);
+        }
+        return hexString.toString();
+    }
+}

--- adi-common/src/main/java/com/moyz/adi/common/util/TriConsumer.java ---
@@ -1,6 +0,0 @@
-package com.moyz.adi.common.util;
-
-@FunctionalInterface
-public interface TriConsumer<T, U, V> {
-    void accept(T t, U u, V v);
-}

--- docs/create.sql ---
@@ -168,23 +168,28 @@ execute procedure update_modified_column();
 CREATE TABLE public.adi_conversation
 (
     id                        bigserial primary key,
-    user_id                   bigint                  default 0                     not null,
-    uuid                      character varying(32)   default ''::character varying not null,
-    title                     character varying(45)   default ''::character varying not null,
-    tokens                    integer                 default 0                     not null,
-    ai_system_message         character varying(1000) default ''::character varying not null,
-    understand_context_enable boolean                 default false                 not null,
-    llm_temperature           numeric(2, 1)           default 0.7                   not null,
-    create_time               timestamp               default CURRENT_TIMESTAMP     not null,
-    update_time               timestamp               default CURRENT_TIMESTAMP     not null,
-    is_deleted                boolean                 default false                 not null
+    user_id                   bigint        default 0                 not null,
+    uuid                      varchar(32)   default ''                not null,
+    title                     varchar(45)   default ''                not null,
+    remark                    varchar(500)  default ''                not null,
+    tokens                    integer       default 0                 not null,
+    ai_system_message         varchar(1000) default ''                not null,
+    understand_context_enable boolean       default false             not null,
+    llm_temperature           numeric(2, 1) default 0.7               not null,
+    create_time               timestamp     default CURRENT_TIMESTAMP not null,
+    update_time               timestamp     default CURRENT_TIMESTAMP not null,
+    is_deleted                boolean       default false             not null
 );
 
 COMMENT ON TABLE public.adi_conversation IS '用户会话(角色)表';
 
 COMMENT ON COLUMN public.adi_conversation.user_id IS '用户id';
 
-COMMENT ON COLUMN public.adi_conversation.title IS '标题';
+COMMENT ON COLUMN public.adi_conversation.title IS '标题，如：狄仁杰';
+
+COMMENT ON COLUMN public.adi_conversation.remark IS '备注，如：断案如神、手下能人众多';
+
+COMMENT ON COLUMN public.adi_conversation.ai_system_message IS '角色设定内容，如：你是唐朝的神探狄仁杰，破了很多大案、疑案';
 
 COMMENT ON COLUMN public.adi_conversation.llm_temperature is '指定LLM响应时的创造性/随机性';
 
@@ -278,7 +283,7 @@ CREATE TABLE public.adi_file
     create_time timestamp    default CURRENT_TIMESTAMP not null,
     update_time timestamp    default CURRENT_TIMESTAMP not null,
     is_deleted  boolean      default false             not null,
-    md5         varchar(128) default ''                not null
+    sha256      varchar(64)  default ''                not null
 );
 
 COMMENT ON TABLE public.adi_file IS '文件';
@@ -301,7 +306,7 @@ COMMENT ON COLUMN public.adi_file.update_time IS 'Timestamp of record last updat
 
 COMMENT ON COLUMN public.adi_file.is_deleted IS '0: Normal; 1: Deleted';
 
-COMMENT ON COLUMN public.adi_file.md5 IS 'MD5 hash of the file';
+COMMENT ON COLUMN public.adi_file.sha256 IS 'Hash of the file';
 
 CREATE TRIGGER trigger_file_update_time
     BEFORE UPDATE

