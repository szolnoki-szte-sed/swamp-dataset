--- package.json ---
@@ -62,6 +62,7 @@
     "@types/debug": "^4.1.7",
     "@types/mocha": "^8.2.3",
     "@types/node": "^14.17.17",
+    "@types/passport": "^1.0.4",
     "@types/passport-strategy": "^0.2.35",
     "@types/request": "^2.48.7",
     "@types/sinon": "^10.0.2",

--- src/node-saml/saml.ts ---
@@ -758,9 +758,14 @@ class SAML {
         await this.validateInResponseTo(inResponseTo);
       }
       const certs = await this.certsToCheck();
-      // Check if this document has a valid top-level signature
+      // Check if this document has a valid top-level signature which applies to the entire XML document
       let validSignature = false;
-      if (this.validateSignature(xml, doc.documentElement, certs)) {
+      if (
+        this.validateSignature(xml, doc.documentElement, certs) &&
+        Array.from(doc.childNodes as NodeListOf<Element>).filter(
+          (n) => n.tagName != null && n.childNodes != null
+        ).length === 1
+      ) {
         validSignature = true;
       }
 

