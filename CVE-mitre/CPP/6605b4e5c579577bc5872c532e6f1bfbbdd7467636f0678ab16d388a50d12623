--- tensorflow/core/kernels/unsorted_segment_join_op.cc ---
@@ -94,8 +94,10 @@ class UnsortedSegmentJoinOp : public OpKernel {
                 errors::InvalidArgument("Number of segments cannot be empty."));
     auto num_segments = num_segments_tensor.scalar<NUM_SEGMENTS_TYPE>()();
 
-    OP_REQUIRES(context, num_segments > 0,
-                errors::InvalidArgument("Number of segments must be positive"));
+    OP_REQUIRES(
+        context, num_segments >= 0,
+        errors::InvalidArgument(
+            "Number of segments must be non-negative but got ", num_segments));
     OP_REQUIRES(context, segment_dims != 0,
                 errors::InvalidArgument("Segment_id cannot have rank 0"));
 

