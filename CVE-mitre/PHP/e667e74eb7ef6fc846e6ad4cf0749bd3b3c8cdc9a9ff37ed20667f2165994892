--- doc/Horde/Mime/Viewer/changelog.yml ---
@@ -8,8 +8,9 @@
   license:
     identifier: LGPL-2.1
     uri: http://www.horde.org/licenses/lgpl21
-  notes: |+
-    
+  notes: |
+    [jan] Fix XSS vulnerability in Open Document mime viewer with different code path (Reported by: Mahdi Pasche <pasche@b1-systems.de>).
+    |+
 2.2.3:
   api: 2.1.0
   state:

--- lib/Horde/Mime/Viewer/Ooo.php ---
@@ -98,7 +98,10 @@ protected function _render()
                 } elseif ($file['name'] == 'content.xml') {
                     return array(
                         $this->_mimepart->getMimeId() => array(
-                            'data' => str_replace(array_keys($tags), array_values($tags), $content),
+                            'data' => Horde_Text_Filter::filter(
+                                str_replace(array_keys($tags), array_values($tags), $content),
+                                'xss'
+                            ),
                             'status' => array(),
                             'type' => 'text/html; charset=UTF-8'
                         )

