--- htdocs/editcache.php ---
@@ -123,7 +123,7 @@ function getWaypoints($cacheId)
         $cache_record = sql_fetch_array($cache_rs);
         sql_free_result($cache_rs);
 
-        if ($cache_record !== false) {
+        if (is_array($cache_record)) {
             if ($cache_record['user_id'] == $usr['userid'] || $login->listingAdmin()) {
                 $tplname = 'editcache';
                 tpl_acceptsAndPurifiesHtmlInput();

--- htdocs/lang/de/ocstyle/varset.inc.php ---
@@ -49,7 +49,7 @@
 
 foreach($_REQUEST as $varname => $varvalue) {
     if (in_array($varname, $allowed)) {
-        $target .= $varname . '=' . $varvalue . '&';
+        $target .= $varname . '=' . htmlspecialchars($varvalue) . '&';
     }
 }
 if (mb_substr($target, - 1) == '?' || mb_substr($target, - 1) == '&') {

--- htdocs/lib/clicompatbase.inc.php ---
@@ -506,7 +506,7 @@ function sql_warn($warnmessage): void
 /**
  * @deprecated use DBAL Conenction instead. See adminreports.php for an example implementation
  * @param resource $rs
- * @return array
+ * @return array|false|null
  */
 function sql_fetch_array($rs)
 {

--- htdocs/lib2/db.inc.php ---
@@ -567,7 +567,7 @@ function sql_value_internal($bQuerySlave, $sql, $default)
 /**
  * @deprecated use DBAL Conenction instead. See adminreports.php for an example implementation
  * @param $rs
- * @return array
+ * @return array|false|null
  */
 function sql_fetch_array($rs)
 {

