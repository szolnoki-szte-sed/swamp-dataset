--- account_prof_edit_page.php ---
@@ -61,13 +61,9 @@
 $f_profile_id	= gpc_get_int( 'profile_id' );
 $f_redirect_page = gpc_get_string( 'redirect', 'account_prof_menu_page.php' );
 
-/** @noinspection PhpUnhandledExceptionInspection */
-$t_global_profile = profile_is_global( $f_profile_id );
-if( $t_global_profile ) {
-	access_ensure_global_level( config_get( 'manage_global_profile_threshold' ) );
-}
-$t_row = profile_get_row( $f_profile_id );
+profile_ensure_can_update( $f_profile_id );
 
+$t_row = profile_get_row( $f_profile_id );
 /**
  * @var $v_id
  * @var $v_user_id
@@ -80,7 +76,7 @@
 
 layout_page_header();
 
-if( $t_global_profile ) {
+if( profile_is_global( $f_profile_id ) ) {
 	layout_page_begin( 'manage_overview_page.php' );
 	print_manage_menu( 'manage_prof_menu_page.php' );
 } else {

--- account_prof_update.php ---
@@ -61,6 +61,9 @@
 
 if( $f_action != 'add' ) {
 	$f_profile_id = gpc_get_int( 'profile_id' );
+	profile_ensure_can_update( $f_profile_id );
+
+	$t_user_id = profile_is_global( $f_profile_id ) ? ALL_USERS : auth_get_current_user_id();
 }
 
 switch( $f_action ) {
@@ -72,23 +75,16 @@
 		$t_user_id		= gpc_get_int( 'user_id' );
 
 		if( ALL_USERS == $t_user_id ) {
-			access_ensure_global_level( config_get( 'manage_global_profile_threshold' ) );
+			access_ensure_global_level( config_get( 'manage_global_profile_threshold' ), $t_user_id );
 		} else {
-			access_ensure_global_level( config_get( 'add_profile_threshold' ) );
 			$t_user_id = auth_get_current_user_id();
+			access_ensure_global_level( config_get( 'add_profile_threshold' ), $t_user_id );
 		}
 
 		profile_create( $t_user_id, $f_platform, $f_os, $f_os_build, $f_description );
 		break;
 
 	case 'update':
-		if( profile_is_global( $f_profile_id ) ) {
-			access_ensure_global_level( config_get( 'manage_global_profile_threshold' ) );
-			$t_user_id = ALL_USERS;
-		} else {
-			$t_user_id = auth_get_current_user_id();
-		}
-
 		$f_platform = gpc_get_string( 'platform' );
 		$f_os = gpc_get_string( 'os' );
 		$f_os_build = gpc_get_string( 'os_build' );
@@ -98,13 +94,6 @@
 		break;
 
 	case 'delete':
-		if( profile_is_global( $f_profile_id ) ) {
-			access_ensure_global_level( config_get( 'manage_global_profile_threshold' ) );
-			$t_user_id = ALL_USERS;
-		} else {
-			$t_user_id = auth_get_current_user_id();
-		}
-
 		helper_ensure_confirmed(
 			sprintf( lang_get( 'delete_profile_confirm_msg' ),
 				string_attribute( profile_get_name( $f_profile_id ) )

--- core/profile_api.php ---
@@ -327,3 +327,38 @@ function profile_is_global( $p_profile_id ) {
 	$t_row = profile_get_row( $p_profile_id );
 	return $t_row['user_id'] == ALL_USERS;
 }
+
+/**
+ * Check if user is allowed to update or delete the given Profile.
+ *
+ * @param int      $p_profile_id Profile id
+ * @param int|null $p_user_id    User id or null for current user (default).
+ *
+ * @return bool True if allowed, false otherwise.
+ * @throws ClientException
+ */
+function profile_can_update( $p_profile_id, $p_user_id = null ) {
+	$t_row = profile_get_row( $p_profile_id );
+	$t_user_id = $p_user_id === null ? auth_get_current_user_id() : $p_user_id;
+
+	# Global profile ?
+	if( $t_row['user_id'] == ALL_USERS ) {
+		return access_has_global_level( config_get( 'manage_global_profile_threshold' ) );
+	}
+
+	return $t_row['user_id'] == $t_user_id;
+}
+
+/**
+ * Throws Access Denied error if user is not allowed to update the Profile.
+ *
+ * @param int      $p_profile_id Profile id
+ * @param int|null $p_user_id    User id or null for current user (default).
+ *
+ * @throws ClientException
+ */
+function profile_ensure_can_update( $p_profile_id, $p_user_id = null ) {
+	if( !profile_can_update( $p_profile_id, $p_user_id ) ) {
+		access_denied();
+	}
+}

