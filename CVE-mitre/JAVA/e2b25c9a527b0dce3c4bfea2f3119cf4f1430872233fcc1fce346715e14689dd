--- impl/src/main/java/com/sun/faces/application/applicationimpl/InstanceFactory.java ---
@@ -288,6 +288,10 @@ public UIComponent createComponent(FacesContext context, Resource componentResou
     }
     
     public UIComponent createComponent(FacesContext context, String componentType, String rendererType) {
+        
+        notNull(CONTEXT, context);
+        notNull(COMPONENT_TYPE, componentType);
+        
         return createComponentApplyAnnotations(context, componentType, rendererType, true);
     }
     

--- impl/src/main/java/com/sun/faces/application/resource/ResourceManager.java ---
@@ -565,7 +565,7 @@ private String getLocalePrefix(FacesContext context) {
         
         localePrefix = context.getExternalContext().getRequestParameterMap().get("loc");
         
-        if(localePrefix != null){
+        if(localePrefix != null && !nameContainsForbiddenSequence(localePrefix)){
             return localePrefix;
         }
         

