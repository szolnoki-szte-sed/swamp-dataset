--- C4/Output.pm ---
@@ -143,6 +143,7 @@ sub themelanguage {
       if $http_accept_language;
     # But, if there's a cookie set, obey it
     $lang = $query->cookie('KohaOpacLanguage') if $query->cookie('KohaOpacLanguage');
+    $lang =~ s/[^\p{IsAlnum}\-_]//g;
     # Fall back to English
     my @languages;
     if ($interface eq 'intranet') {

